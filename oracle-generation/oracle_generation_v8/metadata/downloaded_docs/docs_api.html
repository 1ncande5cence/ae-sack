<!doctype html><html lang=en><meta charset=utf-8><title>V8’s public API · V8</title><meta content="width=device-width" name=viewport><meta content="dark light" name=color-scheme><link href=/_css/main.css rel=stylesheet><link href=/favicon.png rel=icon sizes=48x48><link href=/.webmanifest rel=manifest><meta content=#4285F4 name=theme-color><link href=/blog.atom rel=alternate title="V8 Atom feed" type=application/atom+xml><link href=/features.atom rel=alternate title="V8 JS/Wasm features Atom feed" type=application/atom+xml><script>document.documentElement.className+=" js"</script><meta content="This document discusses the stability of V8’s public API, and how developers can make changes to it." name=description><header id=header><h1><a href=/ >V8</a></h1><a href=#navigation-toggle id=nav-toggle>Show navigation</a><nav><ul><li><a href=/ >Home</a><li><a href=/blog>Blog</a><li class=current><a href=/docs>Docs</a><li><a href=/tools>Tools</a><li><a href=/features title="JavaScript and WebAssembly language features">JS/Wasm features</a><li><a href=/grant>Research</a></ul></nav></header><main id=main><h1>V8’s public API</h1><p>This document discusses the stability of V8’s public API, and how developers can make changes to it.<h2 id=api-stability tabindex=-1>API stability <a href=#api-stability class=bookmark>#</a></h2><p>If V8 in a Chromium canary turns out to be crashy, it gets rolled back to the V8 version of the previous canary. It is therefore important to keep V8’s API compatible from one canary version to the next.<p>We continuously run a <a href=https://ci.chromium.org/p/v8/builders/luci.v8.ci/Linux%20V8%20API%20Stability>bot</a> that signals API stability violations. It compiles Chromium’s HEAD with V8’s <a href=https://chromium.googlesource.com/v8/v8/+/refs/heads/canary>current canary version</a>.<p>Failures of this bot are currently only FYI and no action is required. The blame list can be used to easily identify dependent CLs in case of a rollback.<p>If you break this bot, be reminded to increase the window between a V8 change and a dependent Chromium change next time.<h2 id=how-to-change-v8%E2%80%99s-public-api tabindex=-1>How to change V8’s public API <a href=#how-to-change-v8%E2%80%99s-public-api class=bookmark>#</a></h2><p>V8 is used by many different embedders: Chrome, Node.js, gjstest, etc. When changing V8’s public API (basically the files under the <code>include/</code> directory) we need to ensure that the embedders can smoothly update to the new V8 version. In particular, we cannot assume that an embedder updates to the new V8 version and adjusts their code to the new API in one atomic change.<p>The embedder should be able to adjust their code to the new API while still using the previous version of V8. All instructions below follow from this rule.<ul><li><p>Adding new types, constants, and functions is safe with one caveat: do not add a new pure virtual function to an existing class. New virtual functions should have default implementation.<li><p>Adding a new parameter to a function is safe if the parameter has the default value.<li><p>Removing or renaming types, constants, functions is unsafe. Use the <a href="https://cs.chromium.org/chromium/src/v8/include/v8config.h?l=395&rcl=0425b20ad9a8ba38c2e0dd16e8814abb722bfdde"><code>V8_DEPRECATED</code></a> and <a href="https://cs.chromium.org/chromium/src/v8/include/v8config.h?l=403&rcl=0425b20ad9a8ba38c2e0dd16e8814abb722bfdde"><code>V8_DEPRECATE_SOON</code></a> macros, which causes compile-time warnings when the deprecated methods are called by the embedder. For example, let’s say we want to rename function <code>foo</code> to function <code>bar</code>. Then we need to do the following:<ul><li>Add the new function <code>bar</code> near the existing function <code>foo</code>.<li>Wait until the CL rolls in Chrome. Adjust Chrome to use <code>bar</code>.<li>Annotate <code>foo</code> with <code>V8_DEPRECATED("Use bar instead") void foo();</code><li>In the same CL adjust the tests that use <code>foo</code> to use <code>bar</code>.<li>Write in CL motivation for the change and high-level update instructions.<li>Wait until the next V8 branch.<li>Remove function <code>foo</code>.</ul><p><code>V8_DEPRECATE_SOON</code> is a softer version of <code>V8_DEPRECATED</code>. Chrome will not break with it, so step b is not need. <code>V8_DEPRECATE_SOON</code> is not sufficient for removing the function.<p>You still need to annotate with <code>V8_DEPRECATED</code> and wait for the next branch before removing the function.<p><code>V8_DEPRECATED</code> can be tested using the <code>v8_deprecation_warnings</code> GN flag.<br><code>V8_DEPRECATE_SOON</code> can be tested using <code>v8_imminent_deprecation_warnings</code>.<li><p>Changing function signatures is unsafe. Use the <code>V8_DEPRECATED</code> and <code>V8_DEPRECATE_SOON</code> macros as described above.</ul><p>We maintain a <a href=https://docs.google.com/document/d/1g8JFi8T_oAE_7uAri7Njtig7fKaPDfotU6huOa1alds/edit>document mentioning important API changes</a> for each V8 version.<p>There is also a regularly updated <a href=https://v8.dev/api>doxygen api documentation</a>.</main><footer id=footer><div><nav><a href=/logo>Branding</a> <a href=/terms>Terms</a> <a href=https://policies.google.com/privacy>Privacy</a> <a href=https://twitter.com/v8js rel="me nofollow">Twitter</a> <a href=https://github.com/v8/v8.dev/tree/main/./src/docs/api.md rel=nofollow>Edit this page on GitHub</a></nav><dark-mode-toggle dark="Light Mode" light="Dark Mode" permanent></dark-mode-toggle></div><p><small>Except as otherwise noted, any code samples from the V8 project are licensed under <a href=https://chromium.googlesource.com/v8/v8.git/+/main/LICENSE>V8’s BSD-style license</a>. Other content on this page is licensed under <a href=https://creativecommons.org/licenses/by/3.0/ >the Creative Commons Attribution 3.0 License</a>. For details, see <a href=/terms#site-policies>our site policies</a>.</small></footer><script src=/_js/dark-mode-toggle.mjs type=module></script><script src=/_js/main.js></script>