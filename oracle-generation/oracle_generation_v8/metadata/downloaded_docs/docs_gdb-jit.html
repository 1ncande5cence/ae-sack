<!doctype html><html lang=en><meta charset=utf-8><title>GDB JIT Compilation Interface integration · V8</title><meta content="width=device-width" name=viewport><meta content="dark light" name=color-scheme><link href=/_css/main.css rel=stylesheet><link href=/favicon.png rel=icon sizes=48x48><link href=/.webmanifest rel=manifest><meta content=#4285F4 name=theme-color><link href=/blog.atom rel=alternate title="V8 Atom feed" type=application/atom+xml><link href=/features.atom rel=alternate title="V8 JS/Wasm features Atom feed" type=application/atom+xml><script>document.documentElement.className+=" js"</script><meta content="GDB JIT Compilation Interface integration allows V8 to provide GDB with the symbol and debugging information for native code emitted from the V8 runtime." name=description><header id=header><h1><a href=/ >V8</a></h1><a href=#navigation-toggle id=nav-toggle>Show navigation</a><nav><ul><li><a href=/ >Home</a><li><a href=/blog>Blog</a><li class=current><a href=/docs>Docs</a><li><a href=/tools>Tools</a><li><a href=/features title="JavaScript and WebAssembly language features">JS/Wasm features</a><li><a href=/grant>Research</a></ul></nav></header><main id=main><h1>GDB JIT Compilation Interface integration</h1><p>GDB JIT Compilation Interface integration allows V8 to provide GDB with the symbol and debugging information for native code emitted from the V8 runtime.<p>When GDB JIT Compilation Interface is disabled a typical backtrace in GDB contains frames marked with <code>??</code>. These frames correspond to dynamically generated code:<pre><code>#8  0x08281674 in v8::internal::Runtime_SetProperty (args=...) at src/runtime.cc:3758
#9  0xf5cae28e in ?? ()
#10 0xf5cc3a0a in ?? ()
#11 0xf5cc38f4 in ?? ()
#12 0xf5cbef19 in ?? ()
#13 0xf5cb09a2 in ?? ()
#14 0x0809e0a5 in v8::internal::Invoke (construct=false, func=..., receiver=..., argc=0, args=0x0,
    has_pending_exception=0xffffd46f) at src/execution.cc:97
</code></pre><p>However enabling GDB JIT Compilation Interface allows GDB to produce more informative stack trace:<pre><code>#6  0x082857fc in v8::internal::Runtime_SetProperty (args=...) at src/runtime.cc:3758
#7  0xf5cae28e in ?? ()
#8  0xf5cc3a0a in loop () at test.js:6
#9  0xf5cc38f4 in test.js () at test.js:13
#10 0xf5cbef19 in ?? ()
#11 0xf5cb09a2 in ?? ()
#12 0x0809e1f9 in v8::internal::Invoke (construct=false, func=..., receiver=..., argc=0, args=0x0,
    has_pending_exception=0xffffd44f) at src/execution.cc:97
</code></pre><p>Frames still unknown to GDB correspond to native code without source information. See <a href=#known-limitations>known limitations</a> for more details.<p>GDB JIT Compilation Interface is specified in the GDB documentation: <a href=https://sourceware.org/gdb/current/onlinedocs/gdb/JIT-Interface.html>https://sourceware.org/gdb/current/onlinedocs/gdb/JIT-Interface.html</a><h2 id=prerequisites tabindex=-1>Prerequisites <a href=#prerequisites class=bookmark>#</a></h2><ul><li>V8 v3.0.9 or newer<li>GDB 7.0 or newer<li>Linux OS<li>CPU with Intel-compatible architecture (ia32 or x64)</ul><h2 id=enabling-gdb-jit-compilation-interface tabindex=-1>Enabling GDB JIT Compilation Interface <a href=#enabling-gdb-jit-compilation-interface class=bookmark>#</a></h2><p>GDB JIT Compilation Interface is currently excluded from the compilation by default and disabled in runtime. To enable it:<ol><li>Build V8 library with <code>ENABLE_GDB_JIT_INTERFACE</code> defined. If you are using scons to build V8 run it with <code>gdbjit=on</code>.<li>Pass <code>--gdbjit</code> flag when starting V8.</ol><p>To check that you have enabled GDB JIT integration correctly try setting a breakpoint on <code>__jit_debug_register_code</code>. This function is invoked to notify GDB about new code objects.<h2 id=known-limitations tabindex=-1>Known limitations <a href=#known-limitations class=bookmark>#</a></h2><ul><li><p>GDB side of JIT Interface currently (as of GDB 7.2) does not handle registration of code objects very effectively. Each next registration takes more time: with 500 registered objects each next registration takes more than 50ms, with 1000 registered code objects - more than 300 ms. This problem was <a href=https://sourceware.org/ml/gdb/2011-01/msg00002.html>reported to GDB developers</a> but currently there is no solution available. To reduce pressure on GDB current implementation of GDB JIT integration operates in two modes: <em>default</em> and <em>full</em> (enabled by <code>--gdbjit-full</code> flag). In <em>default</em> mode V8 notifies GDB only about code objects that have source information attached (this usually includes all user scripts). In <em>full</em> - about all generated code objects (stubs, ICs, trampolines).<li><p>On x64 GDB is unable to properly unwind stack without <code>.eh_frame</code> section (<a href="https://bugs.chromium.org/p/v8/issues/detail?id=1053">Issue 1053</a>)<li><p>GDB is not notified about code deserialized from the snapshot (<a href="https://bugs.chromium.org/p/v8/issues/detail?id=1054">Issue 1054</a>)<li><p>Only Linux OS on Intel-compatible CPUs is supported. For different OSes either a different ELF-header should be generated or a completely different object format should be used.<li><p>Enabling GDB JIT interface disables compacting GC. This is done to reduce pressure on GDB as unregistering and registering each moved code object will incur considerable overhead.<li><p>GDB JIT integration provides only <em>approximate</em> source information. It does not provide any information about local variables, function’s arguments, stack layout etc. It does not enable stepping through JavaScript code or setting breakpoint on the given line. However one can set a breakpoint on a function by its name.</ul></main><footer id=footer><div><nav><a href=/logo>Branding</a> <a href=/terms>Terms</a> <a href=https://policies.google.com/privacy>Privacy</a> <a href=https://twitter.com/v8js rel="me nofollow">Twitter</a> <a href=https://github.com/v8/v8.dev/tree/main/./src/docs/gdb-jit.md rel=nofollow>Edit this page on GitHub</a></nav><dark-mode-toggle dark="Light Mode" light="Dark Mode" permanent></dark-mode-toggle></div><p><small>Except as otherwise noted, any code samples from the V8 project are licensed under <a href=https://chromium.googlesource.com/v8/v8.git/+/main/LICENSE>V8’s BSD-style license</a>. Other content on this page is licensed under <a href=https://creativecommons.org/licenses/by/3.0/ >the Creative Commons Attribution 3.0 License</a>. For details, see <a href=/terms#site-policies>our site policies</a>.</small></footer><script src=/_js/dark-mode-toggle.mjs type=module></script><script src=/_js/main.js></script>