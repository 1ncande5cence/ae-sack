<!doctype html><html lang=en><meta charset=utf-8><title>Merging & patching · V8</title><meta content="width=device-width" name=viewport><meta content="dark light" name=color-scheme><link href=/_css/main.css rel=stylesheet><link href=/favicon.png rel=icon sizes=48x48><link href=/.webmanifest rel=manifest><meta content=#4285F4 name=theme-color><link href=/blog.atom rel=alternate title="V8 Atom feed" type=application/atom+xml><link href=/features.atom rel=alternate title="V8 JS/Wasm features Atom feed" type=application/atom+xml><script>document.documentElement.className+=" js"</script><meta content="This document explains how to merge V8 patches to a release branch." name=description><header id=header><h1><a href=/ >V8</a></h1><a href=#navigation-toggle id=nav-toggle>Show navigation</a><nav><ul><li><a href=/ >Home</a><li><a href=/blog>Blog</a><li class=current><a href=/docs>Docs</a><li><a href=/tools>Tools</a><li><a href=/features title="JavaScript and WebAssembly language features">JS/Wasm features</a><li><a href=/grant>Research</a></ul></nav></header><main id=main><h1>Merging & patching</h1><p>If you have a patch to the <code>main</code> branch (e.g. an important bug fix) that needs to be merged into one of the release V8 branches (refs/branch-heads/12.5), read on.<p>The following examples use a branched 12.3 version of V8. Substitute <code>12.3</code> with your version number. Read the documentation on <a href=/docs/version-numbers>V8’s version numbering</a> for more information.<p>An associated issue on V8’s issue tracker is <strong>mandatory</strong> if a patch is merged. This helps with keeping track of merges.<h2 id=what-qualifies-a-merge-candidate%3F tabindex=-1>What qualifies a merge candidate? <a href=#what-qualifies-a-merge-candidate%3F class=bookmark>#</a></h2><ul><li>The patch fixes a <em>severe</em> bug (in order of importance):<ol><li>security bug<li>stability bug<li>correctness bug<li>performance bug</ol><li>The patch does not alter APIs.<li>The patch does not change behavior present before branch cut (except if the behavior change fixes a bug).</ul><p>More information can be found on the <a href=https://chromium.googlesource.com/chromium/src/+/HEAD/docs/process/merge_request.md>relevant Chromium page</a>. When in doubt, send an email to <a href=mailto:v8-dev@googlegroups.com>v8-dev@googlegroups.com</a>.<h2 id=the-merge-process tabindex=-1>The merge process <a href=#the-merge-process class=bookmark>#</a></h2><p>The merge process in the V8 tracker is driven by Attributes. Therefore please set the 'Merge-Request' on to the relevant Chrome Milestone. In case the merge is only affecting a V8 <a href=https://v8.dev/docs/ports>port</a> please set the HW attribute accordingliy. E.g:<pre><code>Merge-Request: 123
HW: MIPS,LoongArch64
</code></pre><p>once reviewed, this will be adjusted during the review to:<pre><code>Merge: Approved-123
or
Merge: Rejected-123
</code></pre><p>After the CL landed, this will be adjusted one more time to:<pre><code>Merge: Merged-123, Merged-12.3
</code></pre><h2 id=how-to-check-if-a-commit-was-already-merged%2Freverted%2Fhas-canary-coverage tabindex=-1>How to check if a commit was already merged/reverted/has Canary coverage <a href=#how-to-check-if-a-commit-was-already-merged%2Freverted%2Fhas-canary-coverage class=bookmark>#</a></h2><p>Use <a href=https://chromiumdash.appspot.com/commit/ >chromiumdash</a> to verify if the relevant CL has Canary coverage.<p>On top the <strong>Releases</strong> section should show a Canary.<h2 id=how-to-create-the-merge-cl tabindex=-1>How to create the merge CL <a href=#how-to-create-the-merge-cl class=bookmark>#</a></h2><h3 id=option-1%3A-using-gerrit---recommended tabindex=-1>Option 1: Using <a href=https://chromium-review.googlesource.com/ >gerrit</a> - Recommended <a href=#option-1%3A-using-gerrit---recommended class=bookmark>#</a></h3><ol><li>Open the CL you want to back-merge.<li>Select "Cherry pick" from the extended menu (three vertical dots in the upper right corner).<li>Enter "refs/branch-heads/<em>XX.X</em>" as destination branch (replace <em>XX.X</em> by the proper branch).<li>Modify the commit message:<ol><li>Prefix the title with "Merged: ".<li>Remove lines from the footer that correspond to the original CL ("Change-Id", "Reviewed-on", "Reviewed-by", "Commit-Queue", "Cr-Commit-Position"). Definitely keep the "(cherry picked from commit XXX)" line, as this is needed by some tools to relate merges to original CLs.</ol><li>In case of merge conflict, please also go ahead and create the CL. To resolve conflicts (if any) - either using the gerrit UI or you can easily pull the patch locally by using the "download patch" command from the menu (three vertical dots in the upper right corner).<li>Send out for review.</ol><h3 id=option-2%3A-using-the-automated-script tabindex=-1>Option 2: Using the automated script <a href=#option-2%3A-using-the-automated-script class=bookmark>#</a></h3><p>Let’s assume you’re merging revision af3cf11 to branch 12.2 (please specify full git hashes - abbreviations are used here for simplicity).<pre><code>https://source.chromium.org/chromium/chromium/src/+/main:v8/tools/release/merge_to_branch_gerrit.py --branch 12.3 -r af3cf11
</code></pre><h3 id=after-landing%3A-observe-the-branch-waterfall tabindex=-1>After landing: Observe the <a href=https://ci.chromium.org/p/v8>branch waterfall</a> <a href=#after-landing%3A-observe-the-branch-waterfall class=bookmark>#</a></h3><p>If one of the builders is not green after handling your patch, revert the merge immediately. A bot (<code>AutoTagBot</code>) takes care of the correct versioning after a 10-minute wait.<h2 id=patching-a-version-used-on-canary%2Fdev tabindex=-1>Patching a version used on Canary/Dev <a href=#patching-a-version-used-on-canary%2Fdev class=bookmark>#</a></h2><p>In case you need to patch a Canary/Dev version (which should not happen often), cc vahl@ or machenbach@ on the issue. Googlers: please check out the <a href=http://g3doc/company/teams/v8/patching_a_version>internal site</a> before creating the CL.</main><footer id=footer><div><nav><a href=/logo>Branding</a> <a href=/terms>Terms</a> <a href=https://policies.google.com/privacy>Privacy</a> <a href=https://twitter.com/v8js rel="me nofollow">Twitter</a> <a href=https://github.com/v8/v8.dev/tree/main/./src/docs/merge-patch.md rel=nofollow>Edit this page on GitHub</a></nav><dark-mode-toggle dark="Light Mode" light="Dark Mode" permanent></dark-mode-toggle></div><p><small>Except as otherwise noted, any code samples from the V8 project are licensed under <a href=https://chromium.googlesource.com/v8/v8.git/+/main/LICENSE>V8’s BSD-style license</a>. Other content on this page is licensed under <a href=https://creativecommons.org/licenses/by/3.0/ >the Creative Commons Attribution 3.0 License</a>. For details, see <a href=/terms#site-policies>our site policies</a>.</small></footer><script src=/_js/dark-mode-toggle.mjs type=module></script><script src=/_js/main.js></script>