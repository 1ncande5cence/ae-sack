<!DOCTYPE html>
<html
  lang="en"
  class="color-toggle-hidden"
  
>
  <head>
    <meta charset="UTF-8" />
<meta name="referrer" content="no-referrer" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="color-scheme" content="light dark" />
<meta name="generator" content="Hugo 0.145.0">


  <meta name="description" content=" NAME sudo_logsrv.proto &#x2014; Sudo log server protocol
DESCRIPTION Starting with version 1.9.0, sudo supports sending event and I/O logs to a log server. The protocol used is written in Google&#39;s Protocol Buffers domain specific language. The EXAMPLES section includes a complete description of the protocol in Protocol Buffers format.
Because there is no way to determine message boundaries when using Protocol Buffers, the wire size of each message is sent immediately preceding the message itself as a 32-bit unsigned integer in network byte order. This is referred to as &#x201C;length-prefix framing&#x201D; and is how Google suggests handling the lack of message delimiters." />

    <title>Sudo Log Server Protocol Manual | Sudo</title>

    
<link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
<link rel="manifest" href="/favicon/site.webmanifest">
<link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#2f333e">
<meta name="msapplication-TileColor" content="#2f333e">
<meta name="theme-color" content="#2f333e">

    

    
  <meta
    property="og:title"
    content="Sudo Log Server Protocol Manual"
  />
  <meta property="og:site_name" content="Sudo" />
  <meta property="og:description" content=" NAME sudo_logsrv.proto â Sudo log server protocol
DESCRIPTION Starting with version 1.9.0, sudo supports sending event and I/O logs to a log server. The protocol used is written in Google&#39;s Protocol Buffers domain specific language. The EXAMPLES section includes a complete description of the protocol in Protocol Buffers format.
Because there is no way to determine message boundaries when using Protocol Buffers, the wire size of each message is sent immediately preceding the message itself as a 32-bit unsigned integer in network byte order. This is referred to as âlength-prefix framingâ and is how Google suggests handling the lack of message delimiters." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sudo.ws/docs/man/sudo_logsrv.proto.man/" />

<meta property="article:section" content="Docs" />


  <meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Sudo Log Server Protocol Manual" />
  <meta name="twitter:description" content=" NAME sudo_logsrv.proto â Sudo log server protocol
DESCRIPTION Starting with version 1.9.0, sudo supports sending event and I/O logs to a log server. The protocol used is written in Google&#39;s Protocol Buffers domain specific language. The EXAMPLES section includes a complete description of the protocol in Protocol Buffers format.
Because there is no way to determine message boundaries when using Protocol Buffers, the wire size of each message is sent immediately preceding the message itself as a 32-bit unsigned integer in network byte order. This is referred to as âlength-prefix framingâ and is how Google suggests handling the lack of message delimiters." />


  <script type="application/ld+json">
  {
      "@context": "http://schema.org",
      "@type": "TechArticle",
      "articleSection": "Docs",
      "name": "Sudo Log Server Protocol Manual",
      "url" : "https://www.sudo.ws/docs/man/sudo_logsrv.proto.man/",
      "headline": "Sudo Log Server Protocol Manual",
      "description": " NAME sudo_logsrv.proto â Sudo log server protocol\nDESCRIPTION Starting with version 1.9.0, sudo supports sending event and I\/O logs to a log server. The protocol used is written in Google\u0027s Protocol Buffers domain specific language. The EXAMPLES section includes a complete description of the protocol in Protocol Buffers format.\nBecause there is no way to determine message boundaries when using Protocol Buffers, the wire size of each message is sent immediately preceding the message itself as a 32-bit unsigned integer in network byte order. This is referred to as âlength-prefix framingâ and is how Google suggests handling the lack of message delimiters.",
      "wordCount" : "3205",
      "inLanguage": "en",
      "isFamilyFriendly": "true",
      "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https://www.sudo.ws/docs/man/sudo_logsrv.proto.man/"
      },
      "copyrightHolder" : "Sudo",
      "copyrightYear" : "0001",
      "dateCreated": "0001-01-01T00:00:00.00Z",
      "datePublished": "0001-01-01T00:00:00.00Z",
      "dateModified": "0001-01-01T00:00:00.00Z",
      "publisher":{
          "@type":"Organization",
          "name": "Sudo",
          "url": "https://www.sudo.ws/",
          "logo": {
              "@type": "ImageObject",
              "url": "https://www.sudo.ws/brand.svg",
              "width":"32",
              "height":"32"
          }
      }
  }
  </script>


    <script src="/js/main-902b82d5.bundle.min.js"></script>

<link
  rel="preload"
  as="font"
  href="/fonts/Metropolis.woff2"
  type="font/woff2"
  crossorigin="anonymous"
/>
<link
  rel="preload"
  as="font"
  href="/fonts/LiberationSans.woff2"
  type="font/woff2"
  crossorigin="anonymous"
/>

<link
  rel="preload"
  href="/main-a853cbfd.min.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/main-a853cbfd.min.css"
  media="all"
/>

<link
  rel="preload"
  href="/mobile-c0e18b0e.min.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/mobile-c0e18b0e.min.css"
  media="screen and (max-width: 45rem)"
/>

<link
  rel="preload"
  href="/print-19966b38.min.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/print-19966b38.min.css"
  media="print"
/>

<link
  rel="preload"
  href="/custom.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/custom.css"
  media="all"
/>
  <link href="https://www.sudo.ws/docs/man/sudo_logsrv.proto.man/" rel="canonical" type="text/html" />

<!-- Made with Geekdoc theme https://github.com/thegeeklab/hugo-geekdoc -->

    
  </head>

  <body itemscope itemtype="https://schema.org/WebPage">
    
  <!-- geekdoc include: /sprites/blog.svg -->
  <svg class="svg-sprite" id="fa-blog" xmlns="http://www.w3.org/2000/svg" viewBox="-100 -48 665 665"><!--! Font Awesome Free 6.0.0-beta3 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2021 Fonticons, Inc. --><path d="M217.6 96.1c-12.95-.625-24.66 9.156-25.52 22.37C191.2 131.7 201.2 143.1 214.4 143.1c79.53 5.188 148.4 74.09 153.6 153.6c.8281 12.69 11.39 22.43 23.94 22.43c.5156 0 1.047-.0313 1.578-.0625c13.22-.8438 23.25-12.28 22.39-25.5C409.3 191.8 320.3 102.8 217.6 96.1zM224 0C206.3 0 192 14.31 192 32s14.33 32 32 32c123.5 0 224 100.5 224 224c0 17.69 14.33 32 32 32s32-14.31 32-32C512 129.2 382.8 0 224 0zM172.3 226.8C157.7 223.9 144 235.8 144 250.6v50.37c0 10.25 7.127 18.37 16.75 21.1c18.13 6.75 31.26 24.38 31.26 44.1c0 26.5-21.5 47.1-48.01 47.1c-26.5 0-48.01-21.5-48.01-47.1V120c0-13.25-10.75-23.1-24.01-23.1l-48.01 .0076C10.75 96.02 0 106.8 0 120v247.1c0 89.5 82.14 160.2 175 140.7c54.38-11.5 98.27-55.5 109.8-109.7C302.2 316.1 247.8 241.8 172.3 226.8z"/></svg>


  <!-- geekdoc include: /sprites/book.svg -->
  <svg class="svg-sprite" id="fa-book" xmlns="http://www.w3.org/2000/svg" viewBox="-148 -48 582 665"><!--! Font Awesome Free 6.0.0-beta3 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2021 Fonticons, Inc. --><path d="M448 336v-288C448 21.49 426.5 0 400 0H96C42.98 0 0 42.98 0 96v320c0 53.02 42.98 96 96 96h320c17.67 0 32-14.33 32-31.1c0-11.72-6.607-21.52-16-27.1v-81.36C441.8 362.8 448 350.2 448 336zM143.1 128h192C344.8 128 352 135.2 352 144C352 152.8 344.8 160 336 160H143.1C135.2 160 128 152.8 128 144C128 135.2 135.2 128 143.1 128zM143.1 192h192C344.8 192 352 199.2 352 208C352 216.8 344.8 224 336 224H143.1C135.2 224 128 216.8 128 208C128 199.2 135.2 192 143.1 192zM384 448H96c-17.67 0-32-14.33-32-32c0-17.67 14.33-32 32-32h288V448z"/></svg>


  <!-- geekdoc include: /sprites/bug.svg -->
  <svg class="svg-sprite" id="fa-bug" xmlns="http://www.w3.org/2000/svg" viewBox="-48 -48 665 665"><!--! Font Awesome Free 6.0.0-beta3 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2021 Fonticons, Inc. --><path d="M480 256h-64V205.3l54.63-54.63c12.5-12.5 12.5-32.75 0-45.25s-32.75-12.5-45.25 0L370.8 160h-229.5L86.63 105.4c-12.5-12.5-32.75-12.5-45.25 0s-12.5 32.75 0 45.25L96 205.3V256H32C14.31 256 0 270.3 0 288s14.31 32 32 32h64v32c0 15.11 3.088 29.4 7.895 42.86l-62.52 62.52c-12.5 12.5-12.5 32.75 0 45.25C47.63 508.9 55.81 512 64 512s16.38-3.125 22.62-9.375l54.13-54.13C163.2 467.9 192 480 224 480h16.1V239.9C240.1 231.2 247.2 224 256 224S272 231.2 272 239.9V480H288c31.96 0 60.82-12.13 83.25-31.5l54.13 54.13C431.6 508.9 439.8 512 448 512s16.38-3.125 22.62-9.375c12.5-12.5 12.5-32.75 0-45.25l-62.52-62.52C412.9 381.4 416 367.1 416 352v-32h64c17.69 0 32-14.33 32-32S497.7 256 480 256zM352 96c0-53.02-42.98-96-96-96S160 42.98 160 96v32h192V96z"/></svg>


  <!-- geekdoc include: /sprites/mastodon.svg -->
  <svg class="svg-sprite" id="fa-mastodon" xmlns="http://www.w3.org/2000/svg" viewBox="-148 -48 665 665"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"></svg>


  <!-- geekdoc include: /sprites/mercurial_icon_132219.svg -->
  <svg class="svg-sprite" id="jg-mercurial" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="-48 -48 665 665"><path d="M104.3676376,236.3087616c0-40.0223846-43.6237679-65.1721191-78.3347168-45.1609344c-34.7105675,20.0112-34.7105675,70.3106689,0,90.3215027C60.7438698,301.4804993,104.3676376,276.33078,104.3676376,236.3087616z M47.2328262,238.619812c0.9316254-17.4195404,28.4773483-30.8073578,38.3612366-15.1646118c8.0138016,12.6981049-8.1260452,29.328598-20.3331146,32.5216064C52.3266258,259.3628235,46.3008194,256.0454407,47.2328262,238.619812z M56.0728455,274.9062195c2.0664902-1.866272,12.5426407-1.0996094,21.9980621-6.1877136c9.448967-5.081665,20.6747437-16.2206116,22.6813202-32.055603c1.1803665-9.2999573,1.5345154-6.9642487,2.0065842-1.9011688c-1.4662628,26.3217621-25.6756516,40.8649139-39.5169563,42.7846527C59.502079,278.0620728,52.9295082,277.7450867,56.0728455,274.9062195z M256.6015015,9.6756086C72.808754,32.3940926,69.8519669,225.8470154,231.826767,271.8000488c140.1693573,39.8085327,28.9558868,128.7198792,32.2046356,187.9238281c3.2677002,59.1975098,121.8617859,80.6734619,215.3887939-74.7970276C571.2886963,232.2136993,460.0190735-15.4908123,256.6015015,9.6756086z M286.4643555,278.6645813c-6.5725708-4.3858948-22.2649841-13.5493469-54.4946289-24.1165009c-26.6823578-8.7531891-40.2438354-16.2327423-46.8600159-21.8486633c20.7881317,9.1941681,37.4838409,12.6886292,58.22229,17.9659424c43.908905,13.1656342,54.0039673,17.0483551,54.9420471,33.8263397C297.8391418,293.7355347,293.4282227,283.3299255,286.4643555,278.6645813z M367.8400269,367.5634155c40.4610901,5.006958,83.9104309-78.8473511,93.725708-130.0371246c9.5733337-49.8729095,14.2390442,3.2119598,4.9576721,37.4728241c-11.0270996,40.6351318-49.1399841,103.5227661-74.6540833,132.6401367c-19.5626526,22.3336487-41.4238281,31.6521606-67.8077698,35.5656128C269.1691589,453.902832,327.3857727,362.5571899,367.8400269,367.5634155z M436.2878418,427.8855591c-25.1414185,30.1343384-62.0288086,57.1067505-103.5784912,60.3467712c-11.0832214,1.6585083-19.3157959,0.254425-18.711792-6.9145813c0.7951355-9.4364624,11.9651794-3.4538879,28.1417847-7.3802185c58.1104431-14.1082458,83.3079529-43.2006226,118.059845-97.8321228c27.0546875-42.5238037,38.8829651-89.7004089,39.777832-98.6833801C502.6482849,288.2997131,485.2969666,363.9476318,436.2878418,427.8855591z M103.3271866,335.897583c-53.0496101,30.5836792-53.0496101,107.4578247,0,138.0414734s119.7213669-7.8534241,119.7213669-69.0207214S156.3768005,305.3139343,103.3271866,335.897583z M153.6566162,418.6166687c23.7312622-7.8772888,36.541214-60.520813,39.5726929-37.0318604c5.9950867,46.3815002-25.9058075,59.3579102-36.3235626,62.0860596C121.7500305,452.877533,117.7118454,430.5443115,153.6566162,418.6166687z M215.5815125,414.2740173c-4.8458252,32.5712891-35.6281586,56.5944824-61.8255463,57.4893494c-5.3179016,0.5463867-12.294281-1.770752-5.7960358-3.1312256c7.8970184-1.6531677,53.8238831-13.5553894,64.6083069-51.3262634C215.9292145,405.526886,216.531723,407.8940735,215.5815125,414.2740173z"/></svg>


  <!-- geekdoc include: /sprites/twitter.svg -->
  <svg class="svg-sprite" id="fa-twitter" xmlns="http://www.w3.org/2000/svg" viewBox="-148 -48 665 665"><!--! Font Awesome Free 6.0.0-beta3 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2021 Fonticons, Inc. --><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>


  <!-- geekdoc include: /sprites/geekdoc.svg -->
  <svg class="svg-sprite" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_arrow_back" xmlns="http://www.w3.org/2000/svg"><path d="M24 10.526v2.947H5.755l8.351 8.421-2.105 2.105-12-12 12-12 2.105 2.105-8.351 8.421H24z"/></svg><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_arrow_left_alt" xmlns="http://www.w3.org/2000/svg"><path d="M5.965 10.526V6.035L0 12l5.965 5.965v-4.491H24v-2.947H5.965z"/></svg><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_arrow_right_alt" xmlns="http://www.w3.org/2000/svg"><path d="M18.035 10.526V6.035L24 12l-5.965 5.965v-4.491H0v-2.947h18.035z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_bitbucket" xmlns="http://www.w3.org/2000/svg"><path d="M15.905 13.355c.189 1.444-1.564 2.578-2.784 1.839-1.375-.602-1.375-2.784-.034-3.403 1.151-.705 2.818.223 2.818 1.564zm1.907-.361c-.309-2.44-3.076-4.056-5.328-3.042-1.426.636-2.389 2.148-2.32 3.747.086 2.097 2.08 3.815 4.176 3.626s3.729-2.234 3.472-4.331zm4.108-9.315c-.756-.997-2.045-1.169-3.179-1.358-3.214-.516-6.513-.533-9.727.034-1.066.172-2.269.361-2.939 1.323 1.1 1.031 2.664 1.186 4.073 1.358 2.544.327 5.156.344 7.699.017 1.426-.172 3.008-.309 4.073-1.375zm.979 17.788c-.481 1.684-.206 3.953-1.994 4.932-3.076 1.701-6.806 1.89-10.191 1.289-1.787-.327-3.884-.894-4.864-2.578-.43-1.65-.705-3.334-.98-5.018l.103-.275.309-.155c5.121 3.386 12.288 3.386 17.427 0 .808.241.206 1.22.189 1.805zM26.01 4.951c-.584 3.764-1.255 7.51-1.908 11.257-.189 1.1-1.255 1.719-2.148 2.183-3.214 1.615-6.96 1.89-10.483 1.512-2.389-.258-4.829-.894-6.771-2.389-.911-.705-.911-1.908-1.083-2.922-.602-3.523-1.289-7.046-1.719-10.604.206-1.547 1.942-2.217 3.231-2.698C6.848.654 8.686.362 10.508.19c3.884-.378 7.854-.241 11.618.859 1.341.395 2.784.945 3.695 2.097.412.533.275 1.203.189 1.805z"/></svg><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_bookmark" xmlns="http://www.w3.org/2000/svg"><path d="M15.268 4.392q.868 0 1.532.638t.664 1.506v17.463l-7.659-3.268-7.608 3.268V6.536q0-.868.664-1.506t1.532-.638h10.876zm4.34 14.144V4.392q0-.868-.638-1.532t-1.506-.664H6.537q0-.868.664-1.532T8.733 0h10.876q.868 0 1.532.664t.664 1.532v17.412z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_brightness_auto" xmlns="http://www.w3.org/2000/svg"><path d="M16.846 18.938h2.382L15.22 7.785h-2.44L8.772 18.938h2.382l.871-2.44h3.95zm7.087-9.062L27.999 14l-4.066 4.124v5.809h-5.809L14 27.999l-4.124-4.066H4.067v-5.809L.001 14l4.066-4.124V4.067h5.809L14 .001l4.124 4.066h5.809v5.809zm-11.385 4.937L14 10.282l1.452 4.531h-2.904z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_brightness_dark" xmlns="http://www.w3.org/2000/svg"><path d="M14 21.435q3.079 0 5.257-2.178T21.435 14t-2.178-5.257T14 6.565q-1.51 0-3.079.697 1.917.871 3.108 2.701T15.22 14t-1.191 4.037-3.108 2.701q1.568.697 3.079.697zm9.933-11.559L27.999 14l-4.066 4.124v5.809h-5.809L14 27.999l-4.124-4.066H4.067v-5.809L.001 14l4.066-4.124V4.067h5.809L14 .001l4.124 4.066h5.809v5.809z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_brightness_light" xmlns="http://www.w3.org/2000/svg"><path d="M14 21.435q3.079 0 5.257-2.178T21.435 14t-2.178-5.257T14 6.565 8.743 8.743 6.565 14t2.178 5.257T14 21.435zm9.933-3.311v5.809h-5.809L14 27.999l-4.124-4.066H4.067v-5.809L.001 14l4.066-4.124V4.067h5.809L14 .001l4.124 4.066h5.809v5.809L27.999 14z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_check" xmlns="http://www.w3.org/2000/svg"><path d="M8.885 20.197 25.759 3.323l2.24 2.24L8.885 24.677 0 15.792l2.24-2.24z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_check_circle_outline" xmlns="http://www.w3.org/2000/svg"><path d="M14 25.239q4.601 0 7.92-3.319T25.239 14 21.92 6.08 14 2.761 6.08 6.08 2.761 14t3.319 7.92T14 25.239zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0zm6.441 7.822 1.972 1.972-11.239 11.239L4.207 14l1.972-1.972 4.995 4.995z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_cloud_off" xmlns="http://www.w3.org/2000/svg"><path d="M9.023 10.5H7q-1.914 0-3.281 1.395t-1.367 3.309 1.367 3.281T7 19.852h11.375zM3.5 4.976l1.477-1.477L24.5 23.022l-1.477 1.477-2.352-2.297H6.999q-2.898 0-4.949-2.051t-2.051-4.949q0-2.844 1.969-4.867t4.758-2.133zm19.086 5.578q2.242.164 3.828 1.832T28 16.351q0 3.008-2.461 4.758l-1.695-1.695q1.805-.984 1.805-3.063 0-1.422-1.039-2.461t-2.461-1.039h-1.75v-.602q0-2.68-1.859-4.539t-4.539-1.859q-1.531 0-2.953.711l-1.75-1.695Q11.431 3.5 14.001 3.5q2.953 0 5.496 2.078t3.09 4.977z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_code" xmlns="http://www.w3.org/2000/svg"><path d="M9.917 24.5a1.75 1.75 0 1 0-3.501.001 1.75 1.75 0 0 0 3.501-.001zm0-21a1.75 1.75 0 1 0-3.501.001A1.75 1.75 0 0 0 9.917 3.5zm11.666 2.333a1.75 1.75 0 1 0-3.501.001 1.75 1.75 0 0 0 3.501-.001zm1.75 0a3.502 3.502 0 0 1-1.75 3.026c-.055 6.581-4.721 8.039-7.82 9.023-2.898.911-3.846 1.349-3.846 3.117v.474a3.502 3.502 0 0 1 1.75 3.026c0 1.932-1.568 3.5-3.5 3.5s-3.5-1.568-3.5-3.5c0-1.294.711-2.424 1.75-3.026V6.526A3.502 3.502 0 0 1 4.667 3.5c0-1.932 1.568-3.5 3.5-3.5s3.5 1.568 3.5 3.5a3.502 3.502 0 0 1-1.75 3.026v9.06c.93-.456 1.914-.766 2.807-1.039 3.391-1.075 5.323-1.878 5.359-5.687a3.502 3.502 0 0 1-1.75-3.026c0-1.932 1.568-3.5 3.5-3.5s3.5 1.568 3.5 3.5z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_copy" xmlns="http://www.w3.org/2000/svg"><path d="M23.502 25.438V7.626H9.562v17.812h13.94zm0-20.315q1.013 0 1.787.745t.774 1.757v17.812q0 1.013-.774 1.787t-1.787.774H9.562q-1.013 0-1.787-.774t-.774-1.787V7.625q0-1.013.774-1.757t1.787-.745h13.94zM19.689 0v2.562H4.438v17.812H1.936V2.562q0-1.013.745-1.787T4.438.001h15.251z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_dangerous" xmlns="http://www.w3.org/2000/svg"><path d="M21.802 19.833 15.969 14l5.833-5.833-1.969-1.969L14 12.031 8.167 6.198 6.198 8.167 12.031 14l-5.833 5.833 1.969 1.969L14 15.969l5.833 5.833zM19.833 0 28 8.167v11.666L19.833 28H8.167L0 19.833V8.167L8.167 0h11.666z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_date" xmlns="http://www.w3.org/2000/svg"><path d="M27.192 28.844V11.192H4.808v17.652h22.384zm0-25.689q1.277 0 2.253.976t.976 2.253v22.459q0 1.277-.976 2.216t-2.253.939H4.808q-1.352 0-2.291-.901t-.939-2.253V6.385q0-1.277.939-2.253t2.291-.976h1.577V.001h3.23v3.155h12.769V.001h3.23v3.155h1.577zm-3.155 11.267v3.155h-3.23v-3.155h3.23zm-6.46 0v3.155h-3.155v-3.155h3.155zm-6.384 0v3.155h-3.23v-3.155h3.23z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_download" xmlns="http://www.w3.org/2000/svg"><path d="M2.866 28.209h26.269v3.79H2.866v-3.79zm26.268-16.925L16 24.418 2.866 11.284h7.493V.001h11.283v11.283h7.493z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_email" xmlns="http://www.w3.org/2000/svg"><path d="M28.845 9.615v-3.23L16 14.422 3.155 6.385v3.23L16 17.577zm0-6.46q1.277 0 2.216.977T32 6.385v19.23q0 1.277-.939 2.253t-2.216.977H3.155q-1.277 0-2.216-.977T0 25.615V6.385q0-1.277.939-2.253t2.216-.977h25.69z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_error_outline" xmlns="http://www.w3.org/2000/svg"><path d="M14 25.239q4.601 0 7.92-3.319T25.239 14 21.92 6.08 14 2.761 6.08 6.08 2.761 14t3.319 7.92T14 25.239zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0zm-1.38 6.967h2.761v8.413H12.62V6.967zm0 11.239h2.761v2.826H12.62v-2.826z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_fire" xmlns="http://www.w3.org/2000/svg"><path d="M17.689 21.998q-.32.32-.8.576t-.864.384q-1.152.384-2.272.032t-1.888-.992q-.128-.128-.096-.256t.16-.192q1.216-.384 1.92-1.216t.96-1.792q.192-.896-.064-1.728t-.384-1.728q-.128-.704-.096-1.376t.288-1.312q0-.128.128-.128t.192.064q.384.832.992 1.472t1.28 1.216 1.216 1.248.672 1.568q.064.384.064.704.064.96-.32 1.92t-1.088 1.536zm3.84-10.944q-.768-.704-1.6-1.28t-1.6-1.344q-1.536-1.536-2.016-3.584t.16-4.16q.128-.32-.096-.544t-.544-.096q-.768.32-1.44.768t-1.312.896q-1.984 1.664-3.136 3.936T8.633 10.51t.8 5.088q0 .128.032.256t.032.256q0 .576-.512.832t-1.024-.192q-.128-.192-.192-.32-1.024-1.28-1.376-2.912t-.096-3.232q.064-.384-.288-.576t-.608.128q-1.28 1.664-1.856 3.68t-.448 4.064q0 .576.096 1.184t.288 1.184q.448 1.536 1.216 2.816 1.216 2.048 3.264 3.424t4.416 1.696q2.496.32 5.024-.256t4.448-2.304q1.408-1.344 2.208-3.104t.864-3.68-.704-3.712q-.064-.128-.096-.224t-.096-.224q-.576-1.088-1.28-1.984-.256-.384-.544-.704t-.672-.64z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_git" xmlns="http://www.w3.org/2000/svg"><path d="M27.472 12.753 15.247.529a1.803 1.803 0 0 0-2.55 0l-2.84 2.84 2.137 2.137a2.625 2.625 0 0 1 3.501 3.501l3.499 3.499a2.625 2.625 0 1 1-1.237 1.237l-3.499-3.499c-.083.04-.169.075-.257.106v7.3a2.626 2.626 0 1 1-1.75 0v-7.3a2.626 2.626 0 0 1-1.494-3.607L8.62 4.606l-8.09 8.09a1.805 1.805 0 0 0 0 2.551l12.225 12.224a1.803 1.803 0 0 0 2.55 0l12.168-12.168a1.805 1.805 0 0 0 0-2.551z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_gitea" xmlns="http://www.w3.org/2000/svg"><path d="M5.581 7.229c-2.46-.005-5.755 1.559-5.573 5.48.284 6.125 6.56 6.693 9.068 6.743.275 1.149 3.227 5.112 5.412 5.32h9.573c5.741-.381 10.04-17.363 6.853-17.427-5.271.248-8.395.373-11.073.395v5.3l-.835-.369-.005-4.928c-3.075-.001-5.781-.144-10.919-.397-.643-.004-1.539-.113-2.501-.116zm.348 2.166h.293c.349 3.14.917 4.976 2.067 7.781-2.933-.347-5.429-1.199-5.888-4.38-.237-1.647.563-3.365 3.528-3.401zm11.409 3.087c.2.003.404.04.596.128l.999.431-.716 1.305h-.007a.996.996 0 0 0-.321.053l.006-.002c-.349.114-.593.406-.593.749 0 .097.019.189.055.275l-.002-.006a.767.767 0 0 0 .151.233l-.001-.001-1.235 2.248a.99.99 0 0 0-.302.052l.006-.002c-.349.114-.593.406-.593.749 0 .097.019.189.055.275l-.002-.006c.128.31.457.527.843.527a.987.987 0 0 0 .31-.049l-.006.002c.348-.114.592-.406.592-.749 0-.097-.02-.19-.056-.277l.002.006a.784.784 0 0 0-.211-.293l1.203-2.189a.999.999 0 0 0 .397-.041l-.006.002a.942.942 0 0 0 .285-.15l-.001.001c.464.195.844.353 1.117.488.411.203.556.337.6.487.044.147-.004.429-.236.925-.173.369-.46.893-.799 1.511h-.02a.991.991 0 0 0-.321.053l.006-.002c-.349.114-.593.406-.593.749 0 .097.019.189.055.275l-.002-.006c.128.31.457.527.843.527a.987.987 0 0 0 .31-.049l-.006.002c.348-.114.592-.406.592-.749a.703.703 0 0 0-.055-.275l.002.006a.802.802 0 0 0-.183-.27l.001.001c.335-.611.623-1.136.808-1.531.251-.536.381-.935.267-1.32s-.467-.636-.933-.867c-.307-.151-.689-.311-1.147-.503a.723.723 0 0 0-.052-.324l.002.006a.792.792 0 0 0-.194-.279l.704-1.284 3.899 1.684c.704.305.995 1.053.653 1.68l-2.68 4.907c-.343.625-1.184.884-1.888.58l-5.516-2.384c-.704-.304-.996-1.053-.653-1.68l2.68-4.905c.235-.431.707-.687 1.207-.707z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_github" xmlns="http://www.w3.org/2000/svg"><path d="M16 .394c8.833 0 15.999 7.166 15.999 15.999 0 7.062-4.583 13.062-10.937 15.187-.813.146-1.104-.354-1.104-.771 0-.521.021-2.25.021-4.396 0-1.5-.5-2.458-1.083-2.958 3.562-.396 7.312-1.75 7.312-7.896 0-1.75-.625-3.167-1.646-4.291.167-.417.708-2.042-.167-4.25-1.333-.417-4.396 1.646-4.396 1.646a15.032 15.032 0 0 0-8 0S8.937 6.602 7.603 7.018c-.875 2.208-.333 3.833-.167 4.25-1.021 1.125-1.646 2.542-1.646 4.291 0 6.125 3.729 7.5 7.291 7.896-.458.417-.875 1.125-1.021 2.146-.917.417-3.25 1.125-4.646-1.333-.875-1.521-2.458-1.646-2.458-1.646-1.562-.021-.104.979-.104.979 1.042.479 1.771 2.333 1.771 2.333.938 2.854 5.396 1.896 5.396 1.896 0 1.333.021 2.583.021 2.979 0 .417-.292.917-1.104.771C4.582 29.455-.001 23.455-.001 16.393-.001 7.56 7.165.394 15.998.394zM6.063 23.372c.042-.083-.021-.187-.146-.25-.125-.042-.229-.021-.271.042-.042.083.021.187.146.25.104.062.229.042.271-.042zm.646.709c.083-.062.062-.208-.042-.333-.104-.104-.25-.146-.333-.062-.083.062-.062.208.042.333.104.104.25.146.333.062zm.625.937c.104-.083.104-.25 0-.396-.083-.146-.25-.208-.354-.125-.104.062-.104.229 0 .375s.271.208.354.146zm.875.875c.083-.083.042-.271-.083-.396-.146-.146-.333-.167-.417-.062-.104.083-.062.271.083.396.146.146.333.167.417.062zm1.187.521c.042-.125-.083-.271-.271-.333-.167-.042-.354.021-.396.146s.083.271.271.312c.167.062.354 0 .396-.125zm1.313.104c0-.146-.167-.25-.354-.229-.187 0-.333.104-.333.229 0 .146.146.25.354.229.187 0 .333-.104.333-.229zm1.208-.208c-.021-.125-.187-.208-.375-.187-.187.042-.312.167-.292.312.021.125.187.208.375.167s.312-.167.292-.292z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_gitlab" xmlns="http://www.w3.org/2000/svg"><path d="M1.629 11.034 14 26.888.442 17.048a1.09 1.09 0 0 1-.39-1.203l1.578-4.811zm7.217 0h10.309l-5.154 15.854zM5.753 1.475l3.093 9.559H1.63l3.093-9.559a.548.548 0 0 1 1.031 0zm20.618 9.559 1.578 4.811c.141.437-.016.922-.39 1.203l-13.558 9.84 12.371-15.854zm0 0h-7.216l3.093-9.559a.548.548 0 0 1 1.031 0z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_heart" xmlns="http://www.w3.org/2000/svg"><path d="M16 29.714a1.11 1.11 0 0 1-.786-.321L4.072 18.643c-.143-.125-4.071-3.714-4.071-8 0-5.232 3.196-8.357 8.535-8.357 3.125 0 6.053 2.464 7.464 3.857 1.411-1.393 4.339-3.857 7.464-3.857 5.339 0 8.535 3.125 8.535 8.357 0 4.286-3.928 7.875-4.089 8.035L16.785 29.392c-.214.214-.5.321-.786.321z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_home" xmlns="http://www.w3.org/2000/svg"><path d="M24.003 15.695v8.336c0 .608-.504 1.111-1.111 1.111h-6.669v-6.669h-4.446v6.669H5.108a1.119 1.119 0 0 1-1.111-1.111v-8.336c0-.035.017-.069.017-.104L14 7.359l9.986 8.232a.224.224 0 0 1 .017.104zm3.873-1.198-1.077 1.285a.578.578 0 0 1-.365.191h-.052a.547.547 0 0 1-.365-.122L14 5.831 1.983 15.851a.594.594 0 0 1-.417.122.578.578 0 0 1-.365-.191L.124 14.497a.57.57 0 0 1 .069-.781L12.679 3.314c.729-.608 1.91-.608 2.64 0l4.237 3.543V3.471c0-.313.243-.556.556-.556h3.334c.313 0 .556.243.556.556v7.085l3.803 3.161c.226.191.26.556.069.781z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_info_outline" xmlns="http://www.w3.org/2000/svg"><path d="M12.62 9.793V6.967h2.761v2.826H12.62zM14 25.239q4.601 0 7.92-3.319T25.239 14 21.92 6.08 14 2.761 6.08 6.08 2.761 14t3.319 7.92T14 25.239zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0zm-1.38 21.033V12.62h2.761v8.413H12.62z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_keyboard_arrow_down" xmlns="http://www.w3.org/2000/svg"><path d="M3.281 5.36 14 16.079 24.719 5.36 28 8.641l-14 14-14-14z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_keyboard_arrow_left" xmlns="http://www.w3.org/2000/svg"><path d="M25.875 28.25 22.125 32 6.126 16.001 22.125.002l3.75 3.75-12.25 12.25z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_keyboard_arrow_right" xmlns="http://www.w3.org/2000/svg"><path d="M6.125 28.25 18.375 16 6.125 3.75 9.875 0l15.999 15.999L9.875 31.998z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_keyboard_arrow_up" xmlns="http://www.w3.org/2000/svg"><path d="M24.719 22.64 14 11.921 3.281 22.64 0 19.359l14-14 14 14z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_language" xmlns="http://www.w3.org/2000/svg"><path d="M20.112 16.826h4.732q.394-1.84.394-2.826t-.394-2.826h-4.732q.197 1.38.197 2.826t-.197 2.826zm-2.497 7.756q1.643-.526 3.418-2.005t2.695-2.991h-4.141q-.657 2.629-1.972 4.995zm-.329-7.756q.197-1.38.197-2.826t-.197-2.826h-6.573q-.197 1.38-.197 2.826t.197 2.826h6.573zM14 25.173q1.84-2.695 2.695-5.587h-5.39q.854 2.892 2.695 5.587zM8.413 8.413q.789-2.826 1.972-4.995-1.643.526-3.451 2.005T4.272 8.414h4.141zM4.272 19.587q.854 1.512 2.662 2.991t3.451 2.005q-1.315-2.366-1.972-4.995H4.272zm-1.117-2.761h4.732Q7.69 15.446 7.69 14t.197-2.826H3.155q-.394 1.84-.394 2.826t.394 2.826zM14 2.826q-1.84 2.695-2.695 5.587h5.39Q15.841 5.521 14 2.826zm9.727 5.587q-.92-1.512-2.695-2.991t-3.418-2.005q1.183 2.169 1.972 4.995h4.141zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_link" xmlns="http://www.w3.org/2000/svg"><path d="M24.037 7.963q3.305 0 5.634 2.366T32 16t-2.329 5.671-5.634 2.366h-6.46v-3.08h6.46q2.028 0 3.493-1.465t1.465-3.493-1.465-3.493-3.493-1.465h-6.46v-3.08h6.46zM9.615 17.578v-3.155h12.77v3.155H9.615zM3.005 16q0 2.028 1.465 3.493t3.493 1.465h6.46v3.08h-6.46q-3.305 0-5.634-2.366T0 16.001t2.329-5.671 5.634-2.366h6.46v3.08h-6.46q-2.028 0-3.493 1.465t-1.465 3.493z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_mastodon" xmlns="http://www.w3.org/2000/svg"><path d="M30.924 10.506c0-6.941-4.548-8.976-4.548-8.976C24.083.477 20.144.034 16.054.001h-.101C11.862.034 7.926.477 5.633 1.53c0 0-4.548 2.035-4.548 8.976 0 1.589-.031 3.491.02 5.505.165 6.79 1.245 13.479 7.522 15.14 2.893.765 5.379.927 7.38.816 3.629-.2 5.667-1.296 5.667-1.296l-.12-2.633s-2.593.817-5.505.719c-2.887-.099-5.932-.311-6.399-3.855a7.069 7.069 0 0 1-.064-.967v-.028.001s2.833.693 6.423.857c2.195.1 4.253-.129 6.344-.377 4.009-.479 7.5-2.949 7.939-5.207.689-3.553.633-8.676.633-8.676zm-5.366 8.945h-3.329v-8.159c0-1.72-.724-2.592-2.171-2.592-1.6 0-2.403 1.035-2.403 3.083v4.465h-3.311v-4.467c0-2.048-.803-3.083-2.403-3.083-1.447 0-2.171.873-2.171 2.592v8.159H6.441v-8.404c0-1.719.437-3.084 1.316-4.093.907-1.011 2.092-1.528 3.565-1.528 1.704 0 2.995.655 3.848 1.965l.828 1.391.829-1.391c.853-1.311 2.144-1.965 3.848-1.965 1.472 0 2.659.517 3.565 1.528.877 1.009 1.315 2.375 1.315 4.093z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_matrix" xmlns="http://www.w3.org/2000/svg"><path d="M.843.734v30.532H3.04v.733H0V0h3.04v.733zm9.391 9.68v1.543h.044a4.417 4.417 0 0 1 1.489-1.365c.577-.327 1.248-.487 2-.487.72 0 1.377.143 1.975.419.597.277 1.047.776 1.36 1.477.339-.499.8-.941 1.379-1.323.579-.383 1.267-.573 2.061-.573.604 0 1.163.075 1.68.223a3.34 3.34 0 0 1 1.324.707c.368.327.652.745.861 1.268.203.523.307 1.151.307 1.889v7.637h-3.132v-6.468c0-.381-.013-.745-.043-1.083a2.315 2.315 0 0 0-.246-.893l.006.013a1.484 1.484 0 0 0-.577-.593l-.007-.004c-.259-.147-.609-.221-1.047-.221-.443 0-.8.085-1.071.252-.267.166-.483.39-.635.656l-.005.009a2.558 2.558 0 0 0-.307.915l-.002.013a7.156 7.156 0 0 0-.08 1.044v6.359h-3.133v-6.4c0-.339-.005-.671-.024-1.003a2.772 2.772 0 0 0-.197-.936l.007.019a1.41 1.41 0 0 0-.548-.667l-.006-.003c-.259-.167-.635-.253-1.139-.253-.148 0-.345.032-.585.099-.24.068-.48.191-.707.376-.228.184-.425.449-.585.793-.16.345-.24.8-.24 1.36v6.621H7.279v-11.42zm20.923 20.852V.734H28.96V.001H32V32h-3.04v-.733z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_menu" xmlns="http://www.w3.org/2000/svg"><path d="M.001 5.334h31.998v3.583H.001V5.334zm0 12.416v-3.5h31.998v3.5H.001zm0 8.916v-3.583h31.998v3.583H.001z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_notification" xmlns="http://www.w3.org/2000/svg"><path d="m22.615 19.384 2.894 2.894v1.413H2.49v-1.413l2.894-2.894V12.25q0-3.365 1.716-5.856t4.745-3.231v-1.01q0-.875.606-1.514T13.999 0t1.548.639.606 1.514v1.01q3.029.74 4.745 3.231t1.716 5.856v7.134zM14 27.999q-1.211 0-2.053-.808t-.841-2.019h5.788q0 1.144-.875 1.986T14 27.999z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_path" xmlns="http://www.w3.org/2000/svg"><path d="M28 12.62h-9.793V8.414h-2.826v11.173h2.826v-4.206H28V26.62h-9.793v-4.206H12.62v-14H9.794v4.206H.001V1.381h9.793v4.206h8.413V1.381H28V12.62z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_person" xmlns="http://www.w3.org/2000/svg"><path d="M16 20.023q5.052 0 10.526 2.199t5.473 5.754v4.023H0v-4.023q0-3.555 5.473-5.754t10.526-2.199zM16 16q-3.275 0-5.614-2.339T8.047 8.047t2.339-5.661T16 0t5.614 2.386 2.339 5.661-2.339 5.614T16 16z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_search" xmlns="http://www.w3.org/2000/svg"><path d="M11.925 20.161q3.432 0 5.834-2.402t2.402-5.834-2.402-5.834-5.834-2.402-5.834 2.402-2.402 5.834 2.402 5.834 5.834 2.402zm10.981 0L32 29.255 29.255 32l-9.094-9.094v-1.458l-.515-.515q-3.26 2.831-7.721 2.831-4.976 0-8.45-3.432T.001 11.925t3.474-8.45 8.45-3.474 8.407 3.474 3.432 8.45q0 1.802-.858 4.075t-1.973 3.646l.515.515h1.458z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_shield" xmlns="http://www.w3.org/2000/svg"><path d="M22.167 15.166V3.5h-8.166v20.726c.93-.492 2.424-1.349 3.883-2.497 1.95-1.531 4.284-3.919 4.284-6.562zm3.499-13.999v14c0 7.674-10.737 12.523-11.192 12.724-.146.073-.31.109-.474.109s-.328-.036-.474-.109c-.456-.201-11.192-5.049-11.192-12.724v-14C2.334.529 2.863 0 3.501 0H24.5c.638 0 1.167.529 1.167 1.167z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_star" xmlns="http://www.w3.org/2000/svg"><path d="M14 22.052 5.324 27.31l2.3-9.859L0 10.813l10.056-.854L14 .692l3.944 9.267L28 10.813l-7.624 6.638 2.3 9.859z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_tag" xmlns="http://www.w3.org/2000/svg"><path d="M17.52 17.52v-7.041h-7.041v7.041h7.041zM28 10.479h-7.041v7.041H28v3.439h-7.041V28H17.52v-7.041h-7.041V28H7.04v-7.041H-.001V17.52H7.04v-7.041H-.001V7.04H7.04V-.001h3.439V7.04h7.041V-.001h3.439V7.04H28v3.439z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_timer" xmlns="http://www.w3.org/2000/svg"><path d="M16 29q4.428 0 7.536-3.143t3.107-7.571-3.107-7.536T16 7.643 8.464 10.75t-3.107 7.536 3.107 7.571T16 29zM26.714 9.786q1.214 1.571 2.107 4.036t.893 4.464q0 5.643-4 9.678T16 32t-9.714-4.036-4-9.678 4-9.678T16 4.572q1.929 0 4.464.929t4.107 2.143l2.143-2.214q1.143.929 2.143 2.143zM14.5 19.857v-9.143h3v9.143h-3zM20.571.001v3.071h-9.143V.001h9.143z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_xmpp" xmlns="http://www.w3.org/2000/svg"><path d="M31.995 4.237c-.449.175-1.12.433-1.936.745-1.544.591-2.328.891-2.924 1.093-.613.208-1.287.409-2.635.813-.911.272-1.672.495-2.212.651-.031.875 0 2.177-.292 3.635a21.837 21.837 0 0 1-2.016 5.765c-1.496 2.944-3.236 4.817-3.88 5.476-.056-.059-.112-.117-.168-.179-.707-.763-2.403-2.703-3.815-5.683-1.053-2.223-1.484-4.044-1.605-4.584-.356-1.589-.427-2.955-.427-4.117 0-.075-.036-.129-.101-.149-.721-.223-1.765-.519-2.887-.853-1.271-.379-2.193-.744-3.408-1.2-.493-.185-1.409-.547-2.217-.859C.723 4.499.113 4.236.041 4.236c-.005 0-.015 0-.023.012a.131.131 0 0 0-.019.076c.009.593.08 1.361.256 2.365.615 3.503 2.688 7.061 4.36 9.244 0 0 3.717 5.035 9.128 8.144l.303.176c-.009.008-.02.015-.028.021-1.717 1.316-3.201 1.977-3.579 2.14a15.71 15.71 0 0 1-2.219.772v.407a25.31 25.31 0 0 0 2.72-.487 26.72 26.72 0 0 0 5.075-1.792c.136.067.276.136.42.204 1.527.725 3.571 1.627 6.073 2.048.613.103 1.136.165 1.507.195a.109.109 0 0 0 .115-.091.55.55 0 0 0 .004-.217.107.107 0 0 0-.063-.073c-.505-.209-1.201-.4-1.983-.719-.935-.381-2.241-1.067-3.648-2.128a13.528 13.528 0 0 1-.367-.287c4.64-2.656 7.989-6.588 7.989-6.588 1.735-2.036 4.441-5.623 5.431-9.795.349-1.473.539-2.741.5-3.628z"/></svg></defs></svg>




    <div
      class="wrapper "
    >
      <input type="checkbox" class="hidden" id="menu-control" />
      <input type="checkbox" class="hidden" id="menu-header-control" />
      
      <header class="gdoc-header">
  <div class="container flex align-center justify-between">
    
      <label for="menu-control" class="gdoc-nav__control" tabindex="0">
        <svg class="gdoc-icon gdoc_menu">
          <title>Open Navigation</title>
          <use xlink:href="#gdoc_menu"></use>
        </svg>
        <svg class="gdoc-icon gdoc_arrow_back">
          <title>Close Navigation</title>
          <use xlink:href="#gdoc_arrow_back"></use>
        </svg>
      </label>
    
    <div>
      <a class="gdoc-brand gdoc-header__link" href="https://www.sudo.ws/">
        <span class="flex align-center"><span class="gdoc-brand__title">Sudo</span>
        </span>
      </a>
    </div>
    <div class="gdoc-menu-header">
      <span class="gdoc-menu-header__items">
        
          

  
  
  
  

  
    
      
      
      

      
      

      

      
        <span>
          <a
            href="
              https://github.com/sudo-project/sudo
            "
            class="gdoc-header__link"
          >
            <svg class="gdoc-icon gdoc_github">
              <title>GitHub</title>
              <use xlink:href="#gdoc_github"></use>
            </svg>
          </a>
        </span>
      
    
  
    
      
      
      

      
      

      

      
        <span>
          <a
            href="
              /posts/
            "
            class="gdoc-header__link"
          >
            <svg class="gdoc-icon fa-blog">
              <title>Blog</title>
              <use xlink:href="#fa-blog"></use>
            </svg>
          </a>
        </span>
      
    
  






        


        <span id="gdoc-color-theme">
          <svg class="gdoc-icon gdoc_brightness_dark">
            <title>Toggle Dark/Light/Auto mode</title>
            <use xlink:href="#gdoc_brightness_dark"></use>
          </svg>
          <svg class="gdoc-icon gdoc_brightness_light">
            <title>Toggle Dark/Light/Auto mode</title>
            <use xlink:href="#gdoc_brightness_light"></use>
          </svg>
          <svg class="gdoc-icon gdoc_brightness_auto">
            <title>Toggle Dark/Light/Auto mode</title>
            <use xlink:href="#gdoc_brightness_auto"></use>
          </svg>
        </span>

        <span class="gdoc-menu-header__home">
          <a href="https://www.sudo.ws/" class="gdoc-header__link">
            <svg class="gdoc-icon gdoc_home">
              <title>Back to homepage</title>
              <use xlink:href="#gdoc_home"></use>
            </svg>
          </a>
        </span>

        



        <span class="gdoc-menu-header__control">
          <label for="menu-header-control">
            <svg class="gdoc-icon gdoc_keyboard_arrow_right">
              <use xlink:href="#gdoc_keyboard_arrow_right"></use>
              <title>Close Menu Bar</title>
            </svg>
          </label>
        </span>
      </span>
      <label for="menu-header-control" class="gdoc-menu-header__control">
        <svg class="gdoc-icon gdoc_keyboard_arrow_left">
          <use xlink:href="#gdoc_keyboard_arrow_left"></use>
          <title>Open Menu Bar</title>
        </svg>
      </label>
    </div>
  </div>
</header>



      <main class="container flex flex-even">
        
          <aside class="gdoc-nav">
            <nav><a class="container hidden-mobile" href="/">
          <img src="/images/sudo-sandwich-logo-65.png" alt="Sudo Logo" />
      </a>
  <div class="gdoc-search flex align-center">
    <svg class="gdoc-icon gdoc_search"><use xlink:href="#gdoc_search"></use></svg>
    <input
      type="text"
      id="gdoc-search-input"
      class="gdoc-search__input"
      placeholder="Search"
      aria-label="Search"
      maxlength="64"
      data-site-base-url="https://www.sudo.ws/"
      data-site-lang="en"
    />
    <div class="gdoc-search__spinner spinner hidden"></div>
    <ul id="gdoc-search-results" class="gdoc-search__list"></ul>
  </div>




  <section class="gdoc-nav--main">
    
      

  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">About Sudo</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/intro/"
                    class="gdoc-nav__entry"
                  >
                    A Short Introduction
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/history/"
                    class="gdoc-nav__entry"
                  >
                    A Brief History of Sudo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/contributors/"
                    class="gdoc-nav__entry"
                  >
                    Contributors
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/translations/"
                    class="gdoc-nav__entry"
                  >
                    Translations
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/plugins/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Plugins
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/license/"
                    class="gdoc-nav__entry"
                  >
                    Sudo License
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/logo/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Logo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/export/"
                    class="gdoc-nav__entry"
                  >
                    Export Controls
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Releases</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/releases/stable/"
                    class="gdoc-nav__entry"
                  >
                    Stable Release
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/releases/legacy/"
                    class="gdoc-nav__entry"
                  >
                    Legacy Release
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/releases/devel/"
                    class="gdoc-nav__entry"
                  >
                    Development Release
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/releases/changelog/"
                    class="gdoc-nav__entry"
                  >
                    ChangeLog
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Getting Sudo</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
      
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/getting/repo/"
                    class="gdoc-nav__entry"
                  >
                    Source Repo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/getting/source/"
                    class="gdoc-nav__entry"
                  >
                    Source Distribution
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/getting/packages/"
                    class="gdoc-nav__entry"
                  >
                    Prebuilt Packages
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/getting/download_mirrors/"
                    class="gdoc-nav__entry"
                  >
                    Download Mirrors
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/getting/mirror/"
                    class="gdoc-nav__entry"
                  >
                    Mirroring Sudo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Documentation</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="gdoc-nav__toggle" id="navtree-7533376e"
                checked
              
            />
            <label
              
                for="navtree-7533376e" class="flex justify-between align-center"
              
            >
              
                <span class="flex">Manual Pages (latest)</span>
              
              
                <svg class="gdoc-icon toggle gdoc_keyboard_arrow_left">
                  <use xlink:href="#gdoc_keyboard_arrow_left"></use>
                </svg>
                <svg class="gdoc-icon toggle gdoc_keyboard_arrow_down">
                  <use xlink:href="#gdoc_keyboard_arrow_down"></use>
                </svg>
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/cvtsudoers.man/"
                    class="gdoc-nav__entry"
                  >
                    Cvtsudoers Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo.conf.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Configuration Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_sendlog.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Log Client Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_logsrvd.conf.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Log Server Configuration Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_logsrvd.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Log Server Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_logsrv.proto.man/"
                    class="gdoc-nav__entry is-active"
                  >
                    Sudo Log Server Protocol Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_plugin.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Plugin API
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_plugin_python.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Python Plugin API
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudoers.ldap.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudoers LDAP Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudoers.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudoers Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudoers_timestamp.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudoers Time Stamp Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudoreplay.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudoreplay Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/visudo.man/"
                    class="gdoc-nav__entry"
                  >
                    Visudo Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man_all/"
                    class="gdoc-nav__entry"
                  >
                    Manual Pages (all versions)
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="gdoc-nav__toggle" id="navtree-3f8f9cdc"
                
              
            />
            <label
              
                for="navtree-3f8f9cdc" class="flex justify-between align-center"
              
            >
              
                <span class="flex">README Files</span>
              
              
                <svg class="gdoc-icon toggle gdoc_keyboard_arrow_left">
                  <use xlink:href="#gdoc_keyboard_arrow_left"></use>
                </svg>
                <svg class="gdoc-icon toggle gdoc_keyboard_arrow_down">
                  <use xlink:href="#gdoc_keyboard_arrow_down"></use>
                </svg>
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/readme/readme/"
                    class="gdoc-nav__entry"
                  >
                    README
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/readme/readme_ldap/"
                    class="gdoc-nav__entry"
                  >
                    README.LDAP
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/install/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Installation Notes
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/upgrade/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Upgrade Notes
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/contributing/"
                    class="gdoc-nav__entry"
                  >
                    Contributing to Sudo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/troubleshooting/"
                    class="gdoc-nav__entry"
                  >
                    Troubleshooting FAQ
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/packaging/"
                    class="gdoc-nav__entry"
                  >
                    Building Sudo Packages
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/other/"
                    class="gdoc-nav__entry"
                  >
                    Other Documentation
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/alternatives/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Alternatives
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Security</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/security/advisories/"
                    class="gdoc-nav__entry"
                  >
                    Security Advisories
                  </a>
                </span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/security/policy/"
                    class="gdoc-nav__entry"
                  >
                    Security Policy
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/security/static_analysis/"
                    class="gdoc-nav__entry"
                  >
                    Static Analysis
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/security/fuzzing/"
                    class="gdoc-nav__entry"
                  >
                    Fuzzing Sudo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/security/sanitizers/"
                    class="gdoc-nav__entry"
                  >
                    Sanitizers and Sudo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
  </ul>






    
  </section>

  


  <section class="gdoc-nav--more">
    
      

  
  


  <ul class="gdoc-nav__list">
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon fa-blog"><use xlink:href="#fa-blog"></use></svg>
                
                <a
                  href="/posts"
                  class="gdoc-nav__entry"
                >
                  Blog
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon fa-bug"><use xlink:href="#fa-bug"></use></svg>
                
                <a
                  href="
                    https://bugzilla.sudo.ws"
                  class="gdoc-nav__entry"
                >
                  Bug Tracker
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon gdoc_notification"><use xlink:href="#gdoc_notification"></use></svg>
                
                <a
                  href="/news"
                  class="gdoc-nav__entry"
                >
                  News
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon gdoc_email"><use xlink:href="#gdoc_email"></use></svg>
                
                <a
                  href="/lists"
                  class="gdoc-nav__entry"
                >
                  Mailing Lists
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon gdoc_github"><use xlink:href="#gdoc_github"></use></svg>
                
                <a
                  href="
                    https://github.com/sudo-project/sudo"
                  class="gdoc-nav__entry"
                >
                  GitHub Repo
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon gdoc_git"><use xlink:href="#gdoc_git"></use></svg>
                
                <a
                  href="
                    https://git.sudo.ws/sudo"
                  class="gdoc-nav__entry"
                >
                  Git Mirror
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon fa-mastodon"><use xlink:href="#fa-mastodon"></use></svg>
                
                <a
                  href="
                    https://fosstodon.org/@sudoproject"
                  class="gdoc-nav__entry"
                >
                  Mastodon
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon fa-book"><use xlink:href="#fa-book"></use></svg>
                
                <a
                  href="
                    https://mwl.io/nonfiction/tools#sudo2"
                  class="gdoc-nav__entry"
                >
                  Sudo Mastery Book
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
  </ul>






    
  </section>
</nav>

          </aside>
        


        <div class="gdoc-page">
          
  


  






<div
  class="gdoc-page__header flex flex-wrap
  
    justify-end
  
  hidden-mobile
  hidden"
  itemprop="breadcrumb"
>
  
  
</div>



  <article
    class="gdoc-markdown gdoc-markdown__align--left"
  >
    <h1>Sudo Log Server Protocol Manual</h1>
    






<div class="gdoc-include"><link rel="preload" href="/mandoc.css" as="style">
<link rel="stylesheet" href="/mandoc.css" media="all">
<main class="manual-text">
<section class="Sh">
<h2 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h2>
<p class="Pp"><code class="Nm">sudo_logsrv.proto</code> &#x2014;
    <span class="Nd" role="doc-subtitle">Sudo log server protocol</span></p>
</section>
<section class="Sh">
<h2 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h2>
<p class="Pp">Starting with version 1.9.0, <code class="Nm">sudo</code> supports
    sending event and I/O logs to a log server. The protocol used is written in
    Google's Protocol Buffers domain specific language. The
    <a class="Sx" href="#EXAMPLES">EXAMPLES</a> section includes a complete
    description of the protocol in Protocol Buffers format.</p>
<p class="Pp">Because there is no way to determine message boundaries when using
    Protocol Buffers, the wire size of each message is sent immediately
    preceding the message itself as a 32-bit unsigned integer in network byte
    order. This is referred to as &#x201C;length-prefix framing&#x201D; and is
    how Google suggests handling the lack of message delimiters.</p>
<p class="Pp">The protocol is made up of two basic messages,
    <i class="Em">ClientMessage</i> and <i class="Em">ServerMessage</i>,
    described below. The server must accept messages up to two megabytes in
    size. The server may return an error if the client tries to send a message
    larger than two megabytes.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="Client_Messages"><a class="permalink" href="#Client_Messages">Client
  Messages</a></h2>
<p class="Pp">A <i class="Em">ClientMessage</i> is a container used to
    encapsulate all the possible message types a client may send to the
  server.</p>
<div class="Bd Pp Li">
<pre>message ClientMessage {
  oneof type {
    AcceptMessage accept_msg = 1;
    RejectMessage reject_msg = 2;
    ExitMessage exit_msg = 3;
    RestartMessage restart_msg = 4;
    AlertMessage alert_msg = 5;
    IoBuffer ttyin_buf = 6;
    IoBuffer ttyout_buf = 7;
    IoBuffer stdin_buf = 8;
    IoBuffer stdout_buf = 9;
    IoBuffer stderr_buf = 10;
    ChangeWindowSize winsize_event = 11;
    CommandSuspend suspend_event = 12;
    ClientHello hello_msg = 13;
  }
}</pre>
</div>
<p class="Pp">The different <i class="Em">ClientMessage</i> sub-messages the
    client may sent to the server are described below.</p>
<section class="Ss">
<h3 class="Ss" id="TimeSpec"><a class="permalink" href="#TimeSpec">TimeSpec</a></h3>
<div class="Bd Li">
<pre>message TimeSpec {
    int64 tv_sec = 1;
    int32 tv_nsec = 2;
}</pre>
</div>
<p class="Pp" id="tv_sec">A <i class="Em">TimeSpec</i> is the equivalent of a
    POSIX <var class="Vt">struct timespec</var>, containing seconds and
    nanoseconds members. The
    <a class="permalink" href="#tv_sec"><i class="Em">tv_sec</i></a> member is a
    64-bit integer to support dates after the year 2038.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="InfoMessage"><a class="permalink" href="#InfoMessage">InfoMessage</a></h3>
<div class="Bd Li">
<pre>message InfoMessage {
  message StringList {
    repeated string strings = 1;
  }
  message NumberList {
    repeated int64 numbers = 1;
  }
  string key = 1;
  oneof value {
    int64 numval = 2;
    string strval = 3;
    StringList strlistval = 4;
    NumberList numlistval = 5;
  }
}</pre>
</div>
<p class="Pp">An <i class="Em">InfoMessage</i> is used to represent information
    about the invoking user as well as the execution environment the command
    runs in the form of key-value pairs. The key is always a string but the
    value may be a 64-bit integer, a string, an array of strings, or an array of
    64-bit integers. The event log data is composed of
    <i class="Em">InfoMessage</i> entries. See the
    <a class="Sx" href="#EVENT_LOG_VARIABLES">EVENT LOG VARIABLES</a> section
    for more information.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="ClientHello_hello_msg"><a class="permalink" href="#ClientHello_hello_msg">ClientHello
  hello_msg</a></h3>
<div class="Bd Li">
<pre>message ClientHello {
  string client_id = 1;
}</pre>
</div>
<p class="Pp">A <i class="Em">ClientHello</i> message consists of client
    information that may be sent to the server when the client first
  connects.</p>
<dl class="Bl-tag">
  <dt>client_id</dt>
  <dd>A free-form client description. This usually includes the name and version
      of the client implementation.</dd>
</dl>
</section>
<section class="Ss">
<h3 class="Ss" id="AcceptMessage_accept_msg"><a class="permalink" href="#AcceptMessage_accept_msg">AcceptMessage
  accept_msg</a></h3>
<div class="Bd Li">
<pre>message AcceptMessage {
  TimeSpec submit_time = 1;
  repeated InfoMessage info_msgs = 2;
  bool expect_iobufs = 3;
}</pre>
</div>
<p class="Pp">An <i class="Em">AcceptMessage</i> is sent by the client when a
    command is allowed by the security policy. It contains the following
    members:</p>
<dl class="Bl-tag">
  <dt>submit_time</dt>
  <dd>The wall clock time when the command was submitted to the security
    policy.</dd>
  <dt>info_msgs</dt>
  <dd>An array of <i class="Em">InfoMessage</i> describing the user who
      submitted the command as well as the execution environment of the command.
      This information is used to generate an event log entry and may also be
      used by server to determine where and how the I/O log is stored.</dd>
  <dt>expect_iobufs</dt>
  <dd>Set to true if the server should expect <i class="Em">IoBuffer</i>
      messages to follow (for I/O logging) or false if the server should only
      store the event log.</dd>
</dl>
<p class="Pp">If an <i class="Em">AcceptMessage</i> is sent, the client must not
    send a <i class="Em">RejectMessage</i> or
  <i class="Em">RestartMessage</i>.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="RejectMessage_reject_msg"><a class="permalink" href="#RejectMessage_reject_msg">RejectMessage
  reject_msg</a></h3>
<div class="Bd Li">
<pre>message RejectMessage {
  TimeSpec submit_time = 1;
  string reason = 2;
  repeated InfoMessage info_msgs = 3;
}</pre>
</div>
<p class="Pp">A <i class="Em">RejectMessage</i> is sent by the client when a
    command is denied by the security policy. It contains the following
  members:</p>
<dl class="Bl-tag">
  <dt>submit_time</dt>
  <dd>The wall clock time when the command was submitted to the security
    policy.</dd>
  <dt>reason</dt>
  <dd>The reason the security policy gave for denying the command.</dd>
  <dt>info_msgs</dt>
  <dd>An array of <i class="Em">InfoMessage</i> describing the user who
      submitted the command as well as the execution environment of the command.
      This information is used to generate an event log entry.</dd>
</dl>
<p class="Pp">If a <i class="Em">RejectMessage</i> is sent, the client must not
    send an <i class="Em">AcceptMessage</i> or
  <i class="Em">RestartMessage</i>.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="ExitMessage_exit_msg"><a class="permalink" href="#ExitMessage_exit_msg">ExitMessage
  exit_msg</a></h3>
<div class="Bd Li">
<pre>message ExitMessage {
  TimeSpec run_time = 1;
  int32 exit_value = 2;
  bool dumped_core = 3;
  string signal = 4;
  string error = 5;
}
<p></pre></p>
</div>
<p class="Pp">An <i class="Em">ExitMessage</i> is sent by the client after the
    command has exited or has been terminated by a signal. It contains the
    following members:</p>
<dl class="Bl-tag">
  <dt>run_time</dt>
  <dd>The total amount of elapsed time since the command started, calculated
      using a monotonic clock where possible. This is not the wall clock
    time.</dd>
  <dt>exit_value</dt>
  <dd>The command's exit value in the range 0&#x2013;255.</dd>
  <dt>dumped_core</dt>
  <dd>True if the command was terminated by a signal and dumped core.</dd>
  <dt>signal</dt>
  <dd>If the command was terminated by a signal, this is set to the name of the
      signal without the leading &#x201C;SIG&#x201D;. For example,
      <code class="Dv">INT</code>, <code class="Dv">TERM</code>,
      <code class="Dv">KILL</code>, <code class="Dv">SEGV</code>.</dd>
  <dt>error</dt>
  <dd>A message from the client indicating that the command was terminated
      unexpectedly due to an error.</dd>
</dl>
<p class="Pp">When performing I/O logging, the client should wait for a
    <i class="Em">commit_point</i> corresponding to the final
    <i class="Em">IoBuffer</i> before closing the connection unless the final
    <i class="Em">commit_point</i> has already been received.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="RestartMessage_restart_msg"><a class="permalink" href="#RestartMessage_restart_msg">RestartMessage
  restart_msg</a></h3>
<div class="Bd Li">
<pre>message RestartMessage {
  string log_id = 1;
  TimeSpec resume_point = 2;
}</pre>
</div>
<p class="Pp">A <i class="Em">RestartMessage</i> is sent by the client to resume
    sending an existing I/O log that was previously interrupted. It contains the
    following members:</p>
<dl class="Bl-tag">
  <dt>log_id</dt>
  <dd>The server-side name for an I/O log that was previously sent to the client
      by the server. This may be a path name on the server or some other kind of
      server-side identifier.</dd>
  <dt>resume_point</dt>
  <dd>The point in time after which to resume the I/O log. This is in the form
      of a <i class="Em">TimeSpec</i> representing the amount of time since the
      command started, not the wall clock time. The
      <i class="Em">resume_point</i> should correspond to a
      <i class="Em">commit_point</i> previously sent to the client by the
      server. If the server receives a <i class="Em">RestartMessage</i>
      containing a <i class="Em">resume_point</i> it has not previously seen, an
      error will be returned to the client and the connection will be
    dropped.</dd>
</dl>
<p class="Pp">If a <i class="Em">RestartMessage</i> is sent, the client must not
    send an <i class="Em">AcceptMessage</i> or
  <i class="Em">RejectMessage</i>.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="AlertMessage_alert_msg"><a class="permalink" href="#AlertMessage_alert_msg">AlertMessage
  alert_msg</a></h3>
<div class="Bd Li">
<pre>message AlertMessage {
  TimeSpec alert_time = 1;
  string reason = 2;
  repeated InfoMessage info_msgs = 3;
}</pre>
</div>
<p class="Pp">An <i class="Em">AlertMessage</i> is sent by the client to
    indicate a problem detected by the security policy while the command is
    running that should be stored in the event log. It contains the following
    members:</p>
<dl class="Bl-tag">
  <dt>alert_time</dt>
  <dd>The wall clock time when the alert occurred.</dd>
  <dt>reason</dt>
  <dd>The reason for the alert.</dd>
  <dt>info_msgs</dt>
  <dd>An optional array of <i class="Em">InfoMessage</i> describing the user who
      submitted the command as well as the execution environment of the command.
      This information is used to generate an event log entry.</dd>
</dl>
</section>
<section class="Ss">
<h3 class="Ss" id="IoBuffer_ttyin_buf___ttyout_buf___stdin_buf___stdout_buf___stderr_buf"><a class="permalink" href="#IoBuffer_ttyin_buf___ttyout_buf___stdin_buf___stdout_buf___stderr_buf">IoBuffer
  ttyin_buf | ttyout_buf | stdin_buf | stdout_buf | stderr_buf</a></h3>
<div class="Bd Li">
<pre>message IoBuffer {
  TimeSpec delay = 1;
  bytes data = 2;
}</pre>
</div>
<p class="Pp">An <i class="Em">IoBuffer</i> is used to represent data from
    terminal input, terminal output, standard input, standard output, or
    standard error. It contains the following members:</p>
<dl class="Bl-tag">
  <dt>delay</dt>
  <dd>The elapsed time since the last record in the form of a
      <i class="Em">TimeSpec</i>. The <i class="Em">delay</i> should be
      calculated using a monotonic clock where possible.</dd>
  <dt>data</dt>
  <dd>The binary I/O log data from terminal input, terminal output, standard
      input, standard output, or standard error.</dd>
</dl>
</section>
<section class="Ss">
<h3 class="Ss" id="ChangeWindowSize_winsize_event"><a class="permalink" href="#ChangeWindowSize_winsize_event">ChangeWindowSize
  winsize_event</a></h3>
<div class="Bd Li">
<pre>message ChangeWindowSize {
  TimeSpec delay = 1;
  int32 rows = 2;
  int32 cols = 3;
}</pre>
</div>
<p class="Pp" id="ChangeWindowSize">A
    <a class="permalink" href="#ChangeWindowSize"><i class="Em">ChangeWindowSize</i></a>
    message is sent by the client when the terminal running the command changes
    size. It contains the following members:</p>
<dl class="Bl-tag">
  <dt>delay</dt>
  <dd>The elapsed time since the last record in the form of a
      <i class="Em">TimeSpec</i>. The <i class="Em">delay</i> should be
      calculated using a monotonic clock where possible.</dd>
  <dt>rows</dt>
  <dd>The new number of terminal rows.</dd>
  <dt>cols</dt>
  <dd>The new number of terminal columns.</dd>
</dl>
</section>
<section class="Ss">
<h3 class="Ss" id="CommandSuspend_suspend_event"><a class="permalink" href="#CommandSuspend_suspend_event">CommandSuspend
  suspend_event</a></h3>
<div class="Bd Li">
<pre>message CommandSuspend {
  TimeSpec delay = 1;
  string signal = 2;
}</pre>
</div>
<p class="Pp" id="CommandSuspend">A
    <a class="permalink" href="#CommandSuspend"><i class="Em">CommandSuspend</i></a>
    message is sent by the client when the command is either suspended or
    resumed. It contains the following members:</p>
<dl class="Bl-tag">
  <dt>delay</dt>
  <dd>The elapsed time since the last record in the form of a
      <i class="Em">TimeSpec</i>. The <i class="Em">delay</i> should be
      calculated using a monotonic clock where possible.</dd>
  <dt>signal</dt>
  <dd>The signal name without the leading &#x201C;SIG&#x201D;. For example,
      <code class="Dv">STOP</code>, <code class="Dv">TSTP</code>,
      <code class="Dv">CONT</code>.</dd>
</dl>
</section>
</section>
<section class="Sh">
<h2 class="Sh" id="Server_Messages"><a class="permalink" href="#Server_Messages">Server
  Messages</a></h2>
<p class="Pp">A <i class="Em">ServerMessage</i> is a container used to
    encapsulate all the possible message types the server may send to a
  client.</p>
<div class="Bd Pp Li">
<pre>message ServerMessage {
  oneof type {
    ServerHello hello = 1;
    TimeSpec commit_point = 2;
    string log_id = 3;
    string error = 4;
    string abort = 5;
  }
}</pre>
</div>
<p class="Pp">The different <i class="Em">ServerMessage</i> sub-messages the
    server may sent to the client are described below.</p>
<section class="Ss">
<h3 class="Ss" id="ServerHello_hello"><a class="permalink" href="#ServerHello_hello">ServerHello
  hello</a></h3>
<div class="Bd Li">
<pre>message ServerHello {
  string server_id = 1;
  string redirect = 2;
  repeated string servers = 3;
  bool subcommands = 4;
}</pre>
</div>
<p class="Pp">The <i class="Em">ServerHello</i> message consists of server
    information sent when the client first connects. It contains the following
    members:</p>
<dl class="Bl-tag">
  <dt>server_id</dt>
  <dd>A free-form server description. Usually this includes the name and version
      of the implementation running on the log server. This member is always
      present.</dd>
  <dt id="redirect">redirect</dt>
  <dd>A host and port separated by a colon
      (&#x2018;<code class="Li"></code>&#x2019;): that the client should connect
      to instead. The host may be a host name, an IPv4 address, or an IPv6
      address in square brackets. This may be used for server load balancing.
      The server will disconnect after sending the <i class="Em">ServerHello</i>
      when it includes a
      <a class="permalink" href="#redirect"><b class="Sy">redirect</b></a>.</dd>
  <dt>servers</dt>
  <dd>A list of other known log servers. This can be used to implement log
      server redundancy and allows the client to discover all other log servers
      simply by connecting to one known server. This member may be omitted when
      there is only a single log server.</dd>
  <dt id="intercept">subcommands</dt>
  <dd>If set, the server supports logging additional commands during a session.
      The client may send an <i class="Em">AcceptMessage</i> or
      <i class="Em">RejectMessage</i> when <code class="Nm">sudo</code> is
      running in
      <a class="permalink" href="#intercept"><i class="Em">intercept</i></a>
      mode. In this mode, commands spawned from the initial command authorized
      by <code class="Nm">sudo</code> are subject to policy restrictions and/or
      are logged. If
      <a class="permalink" href="#subcommands"><i class="Em" id="subcommands">subcommands</i></a>
      is false, the client must not attempt to log additional commands.</dd>
</dl>
</section>
<section class="Ss">
<h3 class="Ss" id="TimeSpec_commit_point"><a class="permalink" href="#TimeSpec_commit_point">TimeSpec
  commit_point</a></h3>
<p class="Pp">A periodic time stamp sent by the server to indicate when I/O log
    buffers have been committed to storage. This message is not sent after every
    <i class="Em">IoBuffer</i> but rather at a server-configurable interval.
    When the server receives an <i class="Em">ExitMessage</i>, it will respond
    with a <i class="Em">commit_point</i> corresponding to the last received
    <i class="Em">IoBuffer</i> before closing the connection.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="string_log_id"><a class="permalink" href="#string_log_id">string
  log_id</a></h3>
<p class="Pp">The server-side ID of the I/O log being stored, sent in response
    to an <i class="Em">AcceptMessage</i> where <i class="Em">expect_iobufs</i>
    is true.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="string_error"><a class="permalink" href="#string_error">string
  error</a></h3>
<p class="Pp">A fatal server-side error. The server will close the connection
    after sending the <i class="Em">error</i> message.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="string_abort"><a class="permalink" href="#string_abort">string
  abort</a></h3>
<p class="Pp">An <i class="Em">abort</i> message from the server indicates that
    the client should kill the command and terminate the session. It may be used
    to implement simple server-side policy. The server will close the connection
    after sending the <i class="Em">abort</i> message.</p>
</section>
</section>
<section class="Sh">
<h2 class="Sh" id="Protocol_flow_of_control"><a class="permalink" href="#Protocol_flow_of_control">Protocol
  flow of control</a></h2>
<p class="Pp">The expected protocol flow is as follows:</p>
<ol class="Bl-enum">
  <li>Client connects to the first available server. If the client is configured
      to use TLS, a TLS handshake will be attempted.</li>
  <li>Client sends <i class="Em">ClientHello</i>. This is currently optional but
      allows the server to detect a non-TLS connection on the TLS port.</li>
  <li>Server sends <i class="Em">ServerHello</i>.</li>
  <li>Client responds with either <i class="Em">AcceptMessage</i>,
      <i class="Em">RejectMessage</i>, or <i class="Em">RestartMessage</i>.</li>
  <li id="log_id">If client sent a <i class="Em">AcceptMessage</i> with
      <i class="Em">expect_iobufs</i> set, server creates a new I/O log and
      responds with a
      <a class="permalink" href="#log_id"><i class="Em">log_id</i></a>.</li>
  <li>Client sends zero or more <i class="Em">IoBuffer</i> messages.</li>
  <li>Server periodically responds to <i class="Em">IoBuffer</i> messages with a
      <i class="Em">commit_point</i>.</li>
  <li>Client sends an <i class="Em">ExitMessage</i> when the command exits or is
      killed.</li>
  <li>Server sends the final <i class="Em">commit_point</i> if one is
    pending.</li>
  <li>Server closes the connection. After receiving the final
      <i class="Em">commit_point</i>, the client shuts down its side of the TLS
      connection if TLS is in use, and closes the connection.</li>
  <li>Server shuts down its side of the TLS connection if TLS is in use, and
      closes the connection.</li>
</ol>
<p class="Pp">At any point, the server may send an <i class="Em">error</i> or
    <i class="Em">abort</i> message to the client at which point the server will
    close the connection. If an <i class="Em">abort</i> message is received, the
    client should terminate the running command.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="EVENT_LOG_VARIABLES"><a class="permalink" href="#EVENT_LOG_VARIABLES">EVENT
  LOG VARIABLES</a></h2>
<p class="Pp"><i class="Em">AcceptMessage</i>, <i class="Em">AlertMessage</i>
    and <i class="Em">RejectMessage</i> classes contain an array of
    <i class="Em">InfoMessage</i> that should contain information about the user
    who submitted the command as well as information about the execution
    environment of the command if it was accepted.</p>
<p class="Pp">Some variables have a <i class="Em">client</i>,
    <i class="Em">run</i>, or <i class="Em">submit</i> prefix. These prefixes
    are used to eliminate ambiguity for variables that could apply to the client
    program, the user submitting the command, or the command being run.
    Variables with a <i class="Em">client</i> prefix pertain to the program
    performing the connection to the log server, for example
    <code class="Nm">sudo</code>. Variables with a <i class="Em">run</i> prefix
    pertain to the command that the user requested be run. Variables with a
    <i class="Em">submit</i> prefix pertain to the user submitting the request
    (the user running <code class="Nm">sudo</code>).</p>
<p class="Pp">The following <i class="Em">InfoMessage</i> entries are
  required:</p>
<table class="Bl-column">
  <tr id="Key">
    <td><a class="permalink" href="#Key"><b class="Sy">Key</b></a></td>
    <td><a class="permalink" href="#Type"><b class="Sy" id="Type">Type</b></a></td>
    <td><a class="permalink" href="#Description"><b class="Sy" id="Description">Description</b></a></td>
  </tr>
  <tr>
    <td>command</td>
    <td>string</td>
    <td>command that was submitted</td>
  </tr>
  <tr>
    <td>runuser</td>
    <td>string</td>
    <td>name of user the command was run as</td>
  </tr>
  <tr>
    <td>submithost</td>
    <td>string</td>
    <td>name of host the command was submitted on</td>
  </tr>
  <tr>
    <td>submituser</td>
    <td>string</td>
    <td>name of user submitting the command</td>
  </tr>
</table>
<p class="Pp">The following <i class="Em">InfoMessage</i> entries are
    recognized, but not required:</p>
<table class="Bl-column">
  <tr id="Key~2">
    <td><a class="permalink" href="#Key~2"><b class="Sy">Key</b></a></td>
    <td><a class="permalink" href="#Type~2"><b class="Sy" id="Type~2">Type</b></a></td>
    <td><a class="permalink" href="#Description~2"><b class="Sy" id="Description~2">Description</b></a></td>
  </tr>
  <tr>
    <td>clientargv</td>
    <td>StringList</td>
    <td>client's original argument vector</td>
  </tr>
  <tr>
    <td>clientpid</td>
    <td>int64</td>
    <td>client's process ID</td>
  </tr>
  <tr>
    <td>clientppid</td>
    <td>int64</td>
    <td>client's parent process ID</td>
  </tr>
  <tr>
    <td>clientsid</td>
    <td>int64</td>
    <td>client's terminal session ID</td>
  </tr>
  <tr>
    <td>columns</td>
    <td>int64</td>
    <td>number of columns in the terminal</td>
  </tr>
  <tr>
    <td>lines</td>
    <td>int64</td>
    <td>number of lines in the terminal</td>
  </tr>
  <tr>
    <td>runargv</td>
    <td>StringList</td>
    <td>argument vector of command to run</td>
  </tr>
  <tr>
    <td>runchroot</td>
    <td>string</td>
    <td>root directory of command to run</td>
  </tr>
  <tr>
    <td>runcwd</td>
    <td>string</td>
    <td>running command's working directory</td>
  </tr>
  <tr>
    <td>runenv</td>
    <td>StringList</td>
    <td>the running command's environment</td>
  </tr>
  <tr>
    <td>rungid</td>
    <td>int64</td>
    <td>primary group-ID of the command</td>
  </tr>
  <tr>
    <td>rungids</td>
    <td>NumberList</td>
    <td>supplementary group-IDs for the command</td>
  </tr>
  <tr>
    <td>rungroup</td>
    <td>string</td>
    <td>primary group name of the command</td>
  </tr>
  <tr>
    <td>rungroups</td>
    <td>StringList</td>
    <td>supplementary group names for the command</td>
  </tr>
  <tr>
    <td>runuid</td>
    <td>int64</td>
    <td>run user's user-ID</td>
  </tr>
  <tr>
    <td>submitcwd</td>
    <td>string</td>
    <td>submit user's current working directory</td>
  </tr>
  <tr>
    <td>submitenv</td>
    <td>StringList</td>
    <td>the submit user's environment</td>
  </tr>
  <tr>
    <td>submitgid</td>
    <td>int64</td>
    <td>submit user's primary group-ID</td>
  </tr>
  <tr>
    <td>submitgids</td>
    <td>NumberList</td>
    <td>submit user's supplementary group-IDs</td>
  </tr>
  <tr>
    <td>submitgroup</td>
    <td>string</td>
    <td>submitting user's primary group name</td>
  </tr>
  <tr>
    <td>submitgroups</td>
    <td>StringList</td>
    <td>submit user's supplementary group names</td>
  </tr>
  <tr>
    <td>submituid</td>
    <td>int64</td>
    <td>submit user's user-ID</td>
  </tr>
  <tr>
    <td>ttyname</td>
    <td>string</td>
    <td>terminal the command was submitted from</td>
  </tr>
</table>
<p class="Pp">The server must accept other variables not listed above but may
    ignore them.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h2>
<p class="Pp">The Protocol Buffers description of the log server protocol, using
    &#x201C;proto3&#x201D; syntax, is included in full below.</p>
<div class="Bd Pp Li">
<pre>syntax = &quot;proto3&quot;;
<p>/*</p>
<ul>
<li>Client message to the server.  Messages on the wire are</li>
<li>prefixed with a 32-bit size in network byte order.
*/
message ClientMessage {
oneof type {
AcceptMessage accept_msg = 1;
RejectMessage reject_msg = 2;
ExitMessage exit_msg = 3;
RestartMessage restart_msg = 4;
AlertMessage alert_msg = 5;
IoBuffer ttyin_buf = 6;
IoBuffer ttyout_buf = 7;
IoBuffer stdin_buf = 8;
IoBuffer stdout_buf = 9;
IoBuffer stderr_buf = 10;
ChangeWindowSize winsize_event = 11;
CommandSuspend suspend_event = 12;
}
}</li>
</ul>
<p>/* Equivalent of POSIX struct timespec <em>/
message TimeSpec {
int64 tv_sec = 1;		/</em> seconds <em>/
int32 tv_nsec = 2;		/</em> nanoseconds */
}</p>
<p>/* I/O buffer with keystroke data <em>/
message IoBuffer {
TimeSpec delay = 1;		/</em> elapsed time since last record <em>/
bytes data = 2;		/</em> keystroke data */
}</p>
<p>/*</p>
<ul>
<li>Key/value pairs, like Privilege Manager struct info.</li>
<li>The value may be a number, a string, or a list of strings.
*/
message InfoMessage {
message StringList {
repeated string strings = 1;
}
message NumberList {
repeated int64 numbers = 1;
}
string key = 1;
oneof value {
int64 numval = 2;
string strval = 3;
StringList strlistval = 4;
NumberList numlistval = 5;
}
}</li>
</ul>
<p>/*</p>
<ul>
<li>Event log data for command accepted by the policy.
<em>/
message AcceptMessage {
TimeSpec submit_time = 1;		/</em> when command was submitted <em>/
repeated InfoMessage info_msgs = 2;	/</em> key,value event log data <em>/
bool expect_iobufs = 3;		/</em> true if I/O logging enabled */
}</li>
</ul>
<p>/*</p>
<ul>
<li>Event log data for command rejected by the policy.
<em>/
message RejectMessage {
TimeSpec submit_time = 1;		/</em> when command was submitted <em>/
string reason = 2;			/</em> reason command was rejected <em>/
repeated InfoMessage info_msgs = 3;	/</em> key,value event log data */
}</li>
</ul>
<p>/* Message sent by client when command exits. <em>/
/</em> Might revisit runtime and use end_time instead <em>/
message ExitMessage {
TimeSpec run_time = 1;	/</em> total elapsed run time <em>/
int32 exit_value = 2;		/</em> 0â255 <em>/
bool dumped_core = 3;		/</em> true if command dumped core <em>/
string signal = 4;		/</em> signal name if killed by signal <em>/
string error = 5;		/</em> if killed due to other error */
}</p>
<p>/* Alert message, policy module-specific. <em>/
message AlertMessage {
TimeSpec alert_time = 1;		/</em> time alert message occurred <em>/
string reason = 2;			/</em> policy alert error string <em>/
repeated InfoMessage info_msgs = 3;	/</em> key,value event log data */
}</p>
<p>/* Used to restart an existing I/O log on the server. <em>/
message RestartMessage {
string log_id = 1;		/</em> ID of log being restarted <em>/
TimeSpec resume_point = 2;	/</em> resume point (elapsed time) */
}</p>
<p>/* Window size change event. <em>/
message ChangeWindowSize {
TimeSpec delay = 1;		/</em> elapsed time since last record <em>/
int32 rows = 2;		/</em> new number of rows <em>/
int32 cols = 3;		/</em> new number of columns */
}</p>
<p>/* Command suspend/resume event. <em>/
message CommandSuspend {
TimeSpec delay = 1;		/</em> elapsed time since last record <em>/
string signal = 2;		/</em> signal that caused suspend/resume */
}</p>
<p>/*</p>
<ul>
<li>Server messages to the client.  Messages on the wire are</li>
<li>prefixed with a 32-bit size in network byte order.
<em>/
message ServerMessage {
oneof type {
ServerHello hello = 1;	/</em> server hello message <em>/
TimeSpec commit_point = 2;	/</em> cumulative time of records stored <em>/
string log_id = 3;		/</em> ID of server-side I/O log <em>/
string error = 4;		/</em> error message from server <em>/
string abort = 5;		/</em> abort message, kill command */
}
}</li>
</ul>
<p>/* Hello message from server when client connects. <em>/
message ServerHello {
string server_id = 1;		/</em> free-form server description <em>/
string redirect = 2;		/</em> optional redirect if busy <em>/
repeated string servers = 3;	/</em> optional list of known servers */
}</pre></p>
</div>
</section>
<section class="Sh">
<h2 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h2>
<p class="Pp"><a class="Xr" aria-label="sudo_logsrvd.conf, section
    5">sudo_logsrvd.conf(5)</a>, <a class="Xr" aria-label="sudoers, section
    5">sudoers(5)</a>, <a class="Xr" aria-label="sudo, section 8">sudo(8)</a>,
    <a class="Xr" aria-label="sudo_logsrvd, section 8">sudo_logsrvd(8)</a></p>
<p class="Pp"><span class="Rs"><cite class="RsB">Protocol Buffers</cite>,
    <a class="RsU" href="https://protobuf.dev/">https://protobuf.dev/</a>.</span></p>
</section>
<section class="Sh">
<h2 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h2>
<p class="Pp">Many people have worked on <code class="Nm">sudo</code> over the
    years; this version consists of code written primarily by:</p>
<div class="Bd Pp Bd-indent"><span class="An">Todd C. Miller</span></div>
<p class="Pp">See the CONTRIBUTORS.md file in the <code class="Nm">sudo</code>
    distribution (<a href="https://www.sudo.ws/about/contributors/">https://www.sudo.ws/about/contributors/</a>) for an exhaustive
    list of people who have contributed to <code class="Nm">sudo</code>.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h2>
<p class="Pp">If you believe you have found a bug in
    <code class="Nm">sudo_logsrv.proto</code>, you can either file a bug report
    in the sudo bug database, <a href="https://bugzilla.sudo.ws/">https://bugzilla.sudo.ws/</a>, or open an issue at
    <a href="https://github.com/sudo-project/sudo/issues.">https://github.com/sudo-project/sudo/issues.</a> If you would prefer to use
    email, messages may be sent to the sudo-workers mailing list,
    <a href="https://www.sudo.ws/mailman/listinfo/sudo-workers">https://www.sudo.ws/mailman/listinfo/sudo-workers</a> (public) or
    &lt;sudo@sudo.ws&gt; (private).</p>
<p class="Pp">Please do not report security vulnerabilities through public
    GitHub issues, Bugzilla or mailing lists. Instead, report them via email to
    &lt;Todd.Miller@sudo.ws&gt;. You may encrypt your message with PGP if you
    would like, using the key found at <a href="https://www.sudo.ws/dist/PGPKEYS.">https://www.sudo.ws/dist/PGPKEYS.</a></p>
</section>
<section class="Sh">
<h2 class="Sh" id="SUPPORT"><a class="permalink" href="#SUPPORT">SUPPORT</a></h2>
<p class="Pp">Limited free support is available via the sudo-users mailing list,
    see <a href="https://www.sudo.ws/mailman/listinfo/sudo-users">https://www.sudo.ws/mailman/listinfo/sudo-users</a> to subscribe or search
    the archives.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="DISCLAIMER"><a class="permalink" href="#DISCLAIMER">DISCLAIMER</a></h2>
<p class="Pp"><code class="Nm">sudo</code> is provided &#x201C;AS IS&#x201D; and
    any express or implied warranties, including, but not limited to, the
    implied warranties of merchantability and fitness for a particular purpose
    are disclaimed. See the LICENSE.md file distributed with
    <code class="Nm">sudo</code> or <a href="https://www.sudo.ws/about/license/">https://www.sudo.ws/about/license/</a> for
    complete details.</p>
</section>
</main>
</div>


  </article>



          <div class="gdoc-page__footer flex flex-wrap justify-between">
            








  
  

  







          </div>
        </div>
      </main>

      

    </div>

    
  <script defer src="/js/search-835dce8f.bundle.min.js"></script>

  </body>
</html>
