<!DOCTYPE html>
<html
  lang="en"
  class="color-toggle-hidden"
  
>
  <head>
    <meta charset="UTF-8" />
<meta name="referrer" content="no-referrer" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="color-scheme" content="light dark" />
<meta name="generator" content="Hugo 0.145.0">


  <meta name="description" content=" NAME sudoers &#x2014; default sudo security policy plugin
DESCRIPTION The sudoers policy plugin determines a user&#39;s sudo privileges. It is the default sudo policy plugin. The policy is driven by the /etc/sudoers file or, optionally, in LDAP. The policy format is described in detail in the SUDOERS FILE FORMAT section. For information on storing sudoers policy information in LDAP, see sudoers.ldap(5).
Configuring sudo.conf for sudoers sudo consults the sudo.conf(5) file to determine which plugins to load. If no sudo.conf(5) file is present, or if it contains no Plugin lines, sudoers will be used for auditing, policy decisions and I/O logging. To explicitly configure sudo.conf(5) to use the sudoers plugin, the following configuration can be used." />

    <title>Sudoers Manual | Sudo</title>

    
<link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
<link rel="manifest" href="/favicon/site.webmanifest">
<link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#2f333e">
<meta name="msapplication-TileColor" content="#2f333e">
<meta name="theme-color" content="#2f333e">

    

    
  <meta
    property="og:title"
    content="Sudoers Manual"
  />
  <meta property="og:site_name" content="Sudo" />
  <meta property="og:description" content=" NAME sudoers â default sudo security policy plugin
DESCRIPTION The sudoers policy plugin determines a user&#39;s sudo privileges. It is the default sudo policy plugin. The policy is driven by the /etc/sudoers file or, optionally, in LDAP. The policy format is described in detail in the SUDOERS FILE FORMAT section. For information on storing sudoers policy information in LDAP, see sudoers.ldap(5).
Configuring sudo.conf for sudoers sudo consults the sudo.conf(5) file to determine which plugins to load. If no sudo.conf(5) file is present, or if it contains no Plugin lines, sudoers will be used for auditing, policy decisions and I/O logging. To explicitly configure sudo.conf(5) to use the sudoers plugin, the following configuration can be used." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sudo.ws/docs/man/sudoers.man/" />

<meta property="article:section" content="Docs" />


  <meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Sudoers Manual" />
  <meta name="twitter:description" content=" NAME sudoers â default sudo security policy plugin
DESCRIPTION The sudoers policy plugin determines a user&#39;s sudo privileges. It is the default sudo policy plugin. The policy is driven by the /etc/sudoers file or, optionally, in LDAP. The policy format is described in detail in the SUDOERS FILE FORMAT section. For information on storing sudoers policy information in LDAP, see sudoers.ldap(5).
Configuring sudo.conf for sudoers sudo consults the sudo.conf(5) file to determine which plugins to load. If no sudo.conf(5) file is present, or if it contains no Plugin lines, sudoers will be used for auditing, policy decisions and I/O logging. To explicitly configure sudo.conf(5) to use the sudoers plugin, the following configuration can be used." />


  <script type="application/ld+json">
  {
      "@context": "http://schema.org",
      "@type": "TechArticle",
      "articleSection": "Docs",
      "name": "Sudoers Manual",
      "url" : "https://www.sudo.ws/docs/man/sudoers.man/",
      "headline": "Sudoers Manual",
      "description": " NAME sudoers â default sudo security policy plugin\nDESCRIPTION The sudoers policy plugin determines a user\u0027s sudo privileges. It is the default sudo policy plugin. The policy is driven by the \/etc\/sudoers file or, optionally, in LDAP. The policy format is described in detail in the SUDOERS FILE FORMAT section. For information on storing sudoers policy information in LDAP, see sudoers.ldap(5).\nConfiguring sudo.conf for sudoers sudo consults the sudo.conf(5) file to determine which plugins to load. If no sudo.conf(5) file is present, or if it contains no Plugin lines, sudoers will be used for auditing, policy decisions and I\/O logging. To explicitly configure sudo.conf(5) to use the sudoers plugin, the following configuration can be used.",
      "wordCount" : "27694",
      "inLanguage": "en",
      "isFamilyFriendly": "true",
      "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https://www.sudo.ws/docs/man/sudoers.man/"
      },
      "copyrightHolder" : "Sudo",
      "copyrightYear" : "0001",
      "dateCreated": "0001-01-01T00:00:00.00Z",
      "datePublished": "0001-01-01T00:00:00.00Z",
      "dateModified": "0001-01-01T00:00:00.00Z",
      "publisher":{
          "@type":"Organization",
          "name": "Sudo",
          "url": "https://www.sudo.ws/",
          "logo": {
              "@type": "ImageObject",
              "url": "https://www.sudo.ws/brand.svg",
              "width":"32",
              "height":"32"
          }
      }
  }
  </script>


    <script src="/js/main-902b82d5.bundle.min.js"></script>

<link
  rel="preload"
  as="font"
  href="/fonts/Metropolis.woff2"
  type="font/woff2"
  crossorigin="anonymous"
/>
<link
  rel="preload"
  as="font"
  href="/fonts/LiberationSans.woff2"
  type="font/woff2"
  crossorigin="anonymous"
/>

<link
  rel="preload"
  href="/main-a853cbfd.min.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/main-a853cbfd.min.css"
  media="all"
/>

<link
  rel="preload"
  href="/mobile-c0e18b0e.min.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/mobile-c0e18b0e.min.css"
  media="screen and (max-width: 45rem)"
/>

<link
  rel="preload"
  href="/print-19966b38.min.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/print-19966b38.min.css"
  media="print"
/>

<link
  rel="preload"
  href="/custom.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/custom.css"
  media="all"
/>
  <link href="https://www.sudo.ws/docs/man/sudoers.man/" rel="canonical" type="text/html" />

<!-- Made with Geekdoc theme https://github.com/thegeeklab/hugo-geekdoc -->

    
  </head>

  <body itemscope itemtype="https://schema.org/WebPage">
    
  <!-- geekdoc include: /sprites/blog.svg -->
  <svg class="svg-sprite" id="fa-blog" xmlns="http://www.w3.org/2000/svg" viewBox="-100 -48 665 665"><!--! Font Awesome Free 6.0.0-beta3 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2021 Fonticons, Inc. --><path d="M217.6 96.1c-12.95-.625-24.66 9.156-25.52 22.37C191.2 131.7 201.2 143.1 214.4 143.1c79.53 5.188 148.4 74.09 153.6 153.6c.8281 12.69 11.39 22.43 23.94 22.43c.5156 0 1.047-.0313 1.578-.0625c13.22-.8438 23.25-12.28 22.39-25.5C409.3 191.8 320.3 102.8 217.6 96.1zM224 0C206.3 0 192 14.31 192 32s14.33 32 32 32c123.5 0 224 100.5 224 224c0 17.69 14.33 32 32 32s32-14.31 32-32C512 129.2 382.8 0 224 0zM172.3 226.8C157.7 223.9 144 235.8 144 250.6v50.37c0 10.25 7.127 18.37 16.75 21.1c18.13 6.75 31.26 24.38 31.26 44.1c0 26.5-21.5 47.1-48.01 47.1c-26.5 0-48.01-21.5-48.01-47.1V120c0-13.25-10.75-23.1-24.01-23.1l-48.01 .0076C10.75 96.02 0 106.8 0 120v247.1c0 89.5 82.14 160.2 175 140.7c54.38-11.5 98.27-55.5 109.8-109.7C302.2 316.1 247.8 241.8 172.3 226.8z"/></svg>


  <!-- geekdoc include: /sprites/book.svg -->
  <svg class="svg-sprite" id="fa-book" xmlns="http://www.w3.org/2000/svg" viewBox="-148 -48 582 665"><!--! Font Awesome Free 6.0.0-beta3 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2021 Fonticons, Inc. --><path d="M448 336v-288C448 21.49 426.5 0 400 0H96C42.98 0 0 42.98 0 96v320c0 53.02 42.98 96 96 96h320c17.67 0 32-14.33 32-31.1c0-11.72-6.607-21.52-16-27.1v-81.36C441.8 362.8 448 350.2 448 336zM143.1 128h192C344.8 128 352 135.2 352 144C352 152.8 344.8 160 336 160H143.1C135.2 160 128 152.8 128 144C128 135.2 135.2 128 143.1 128zM143.1 192h192C344.8 192 352 199.2 352 208C352 216.8 344.8 224 336 224H143.1C135.2 224 128 216.8 128 208C128 199.2 135.2 192 143.1 192zM384 448H96c-17.67 0-32-14.33-32-32c0-17.67 14.33-32 32-32h288V448z"/></svg>


  <!-- geekdoc include: /sprites/bug.svg -->
  <svg class="svg-sprite" id="fa-bug" xmlns="http://www.w3.org/2000/svg" viewBox="-48 -48 665 665"><!--! Font Awesome Free 6.0.0-beta3 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2021 Fonticons, Inc. --><path d="M480 256h-64V205.3l54.63-54.63c12.5-12.5 12.5-32.75 0-45.25s-32.75-12.5-45.25 0L370.8 160h-229.5L86.63 105.4c-12.5-12.5-32.75-12.5-45.25 0s-12.5 32.75 0 45.25L96 205.3V256H32C14.31 256 0 270.3 0 288s14.31 32 32 32h64v32c0 15.11 3.088 29.4 7.895 42.86l-62.52 62.52c-12.5 12.5-12.5 32.75 0 45.25C47.63 508.9 55.81 512 64 512s16.38-3.125 22.62-9.375l54.13-54.13C163.2 467.9 192 480 224 480h16.1V239.9C240.1 231.2 247.2 224 256 224S272 231.2 272 239.9V480H288c31.96 0 60.82-12.13 83.25-31.5l54.13 54.13C431.6 508.9 439.8 512 448 512s16.38-3.125 22.62-9.375c12.5-12.5 12.5-32.75 0-45.25l-62.52-62.52C412.9 381.4 416 367.1 416 352v-32h64c17.69 0 32-14.33 32-32S497.7 256 480 256zM352 96c0-53.02-42.98-96-96-96S160 42.98 160 96v32h192V96z"/></svg>


  <!-- geekdoc include: /sprites/mastodon.svg -->
  <svg class="svg-sprite" id="fa-mastodon" xmlns="http://www.w3.org/2000/svg" viewBox="-148 -48 665 665"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"></svg>


  <!-- geekdoc include: /sprites/mercurial_icon_132219.svg -->
  <svg class="svg-sprite" id="jg-mercurial" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="-48 -48 665 665"><path d="M104.3676376,236.3087616c0-40.0223846-43.6237679-65.1721191-78.3347168-45.1609344c-34.7105675,20.0112-34.7105675,70.3106689,0,90.3215027C60.7438698,301.4804993,104.3676376,276.33078,104.3676376,236.3087616z M47.2328262,238.619812c0.9316254-17.4195404,28.4773483-30.8073578,38.3612366-15.1646118c8.0138016,12.6981049-8.1260452,29.328598-20.3331146,32.5216064C52.3266258,259.3628235,46.3008194,256.0454407,47.2328262,238.619812z M56.0728455,274.9062195c2.0664902-1.866272,12.5426407-1.0996094,21.9980621-6.1877136c9.448967-5.081665,20.6747437-16.2206116,22.6813202-32.055603c1.1803665-9.2999573,1.5345154-6.9642487,2.0065842-1.9011688c-1.4662628,26.3217621-25.6756516,40.8649139-39.5169563,42.7846527C59.502079,278.0620728,52.9295082,277.7450867,56.0728455,274.9062195z M256.6015015,9.6756086C72.808754,32.3940926,69.8519669,225.8470154,231.826767,271.8000488c140.1693573,39.8085327,28.9558868,128.7198792,32.2046356,187.9238281c3.2677002,59.1975098,121.8617859,80.6734619,215.3887939-74.7970276C571.2886963,232.2136993,460.0190735-15.4908123,256.6015015,9.6756086z M286.4643555,278.6645813c-6.5725708-4.3858948-22.2649841-13.5493469-54.4946289-24.1165009c-26.6823578-8.7531891-40.2438354-16.2327423-46.8600159-21.8486633c20.7881317,9.1941681,37.4838409,12.6886292,58.22229,17.9659424c43.908905,13.1656342,54.0039673,17.0483551,54.9420471,33.8263397C297.8391418,293.7355347,293.4282227,283.3299255,286.4643555,278.6645813z M367.8400269,367.5634155c40.4610901,5.006958,83.9104309-78.8473511,93.725708-130.0371246c9.5733337-49.8729095,14.2390442,3.2119598,4.9576721,37.4728241c-11.0270996,40.6351318-49.1399841,103.5227661-74.6540833,132.6401367c-19.5626526,22.3336487-41.4238281,31.6521606-67.8077698,35.5656128C269.1691589,453.902832,327.3857727,362.5571899,367.8400269,367.5634155z M436.2878418,427.8855591c-25.1414185,30.1343384-62.0288086,57.1067505-103.5784912,60.3467712c-11.0832214,1.6585083-19.3157959,0.254425-18.711792-6.9145813c0.7951355-9.4364624,11.9651794-3.4538879,28.1417847-7.3802185c58.1104431-14.1082458,83.3079529-43.2006226,118.059845-97.8321228c27.0546875-42.5238037,38.8829651-89.7004089,39.777832-98.6833801C502.6482849,288.2997131,485.2969666,363.9476318,436.2878418,427.8855591z M103.3271866,335.897583c-53.0496101,30.5836792-53.0496101,107.4578247,0,138.0414734s119.7213669-7.8534241,119.7213669-69.0207214S156.3768005,305.3139343,103.3271866,335.897583z M153.6566162,418.6166687c23.7312622-7.8772888,36.541214-60.520813,39.5726929-37.0318604c5.9950867,46.3815002-25.9058075,59.3579102-36.3235626,62.0860596C121.7500305,452.877533,117.7118454,430.5443115,153.6566162,418.6166687z M215.5815125,414.2740173c-4.8458252,32.5712891-35.6281586,56.5944824-61.8255463,57.4893494c-5.3179016,0.5463867-12.294281-1.770752-5.7960358-3.1312256c7.8970184-1.6531677,53.8238831-13.5553894,64.6083069-51.3262634C215.9292145,405.526886,216.531723,407.8940735,215.5815125,414.2740173z"/></svg>


  <!-- geekdoc include: /sprites/twitter.svg -->
  <svg class="svg-sprite" id="fa-twitter" xmlns="http://www.w3.org/2000/svg" viewBox="-148 -48 665 665"><!--! Font Awesome Free 6.0.0-beta3 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2021 Fonticons, Inc. --><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>


  <!-- geekdoc include: /sprites/geekdoc.svg -->
  <svg class="svg-sprite" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_arrow_back" xmlns="http://www.w3.org/2000/svg"><path d="M24 10.526v2.947H5.755l8.351 8.421-2.105 2.105-12-12 12-12 2.105 2.105-8.351 8.421H24z"/></svg><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_arrow_left_alt" xmlns="http://www.w3.org/2000/svg"><path d="M5.965 10.526V6.035L0 12l5.965 5.965v-4.491H24v-2.947H5.965z"/></svg><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_arrow_right_alt" xmlns="http://www.w3.org/2000/svg"><path d="M18.035 10.526V6.035L24 12l-5.965 5.965v-4.491H0v-2.947h18.035z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_bitbucket" xmlns="http://www.w3.org/2000/svg"><path d="M15.905 13.355c.189 1.444-1.564 2.578-2.784 1.839-1.375-.602-1.375-2.784-.034-3.403 1.151-.705 2.818.223 2.818 1.564zm1.907-.361c-.309-2.44-3.076-4.056-5.328-3.042-1.426.636-2.389 2.148-2.32 3.747.086 2.097 2.08 3.815 4.176 3.626s3.729-2.234 3.472-4.331zm4.108-9.315c-.756-.997-2.045-1.169-3.179-1.358-3.214-.516-6.513-.533-9.727.034-1.066.172-2.269.361-2.939 1.323 1.1 1.031 2.664 1.186 4.073 1.358 2.544.327 5.156.344 7.699.017 1.426-.172 3.008-.309 4.073-1.375zm.979 17.788c-.481 1.684-.206 3.953-1.994 4.932-3.076 1.701-6.806 1.89-10.191 1.289-1.787-.327-3.884-.894-4.864-2.578-.43-1.65-.705-3.334-.98-5.018l.103-.275.309-.155c5.121 3.386 12.288 3.386 17.427 0 .808.241.206 1.22.189 1.805zM26.01 4.951c-.584 3.764-1.255 7.51-1.908 11.257-.189 1.1-1.255 1.719-2.148 2.183-3.214 1.615-6.96 1.89-10.483 1.512-2.389-.258-4.829-.894-6.771-2.389-.911-.705-.911-1.908-1.083-2.922-.602-3.523-1.289-7.046-1.719-10.604.206-1.547 1.942-2.217 3.231-2.698C6.848.654 8.686.362 10.508.19c3.884-.378 7.854-.241 11.618.859 1.341.395 2.784.945 3.695 2.097.412.533.275 1.203.189 1.805z"/></svg><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_bookmark" xmlns="http://www.w3.org/2000/svg"><path d="M15.268 4.392q.868 0 1.532.638t.664 1.506v17.463l-7.659-3.268-7.608 3.268V6.536q0-.868.664-1.506t1.532-.638h10.876zm4.34 14.144V4.392q0-.868-.638-1.532t-1.506-.664H6.537q0-.868.664-1.532T8.733 0h10.876q.868 0 1.532.664t.664 1.532v17.412z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_brightness_auto" xmlns="http://www.w3.org/2000/svg"><path d="M16.846 18.938h2.382L15.22 7.785h-2.44L8.772 18.938h2.382l.871-2.44h3.95zm7.087-9.062L27.999 14l-4.066 4.124v5.809h-5.809L14 27.999l-4.124-4.066H4.067v-5.809L.001 14l4.066-4.124V4.067h5.809L14 .001l4.124 4.066h5.809v5.809zm-11.385 4.937L14 10.282l1.452 4.531h-2.904z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_brightness_dark" xmlns="http://www.w3.org/2000/svg"><path d="M14 21.435q3.079 0 5.257-2.178T21.435 14t-2.178-5.257T14 6.565q-1.51 0-3.079.697 1.917.871 3.108 2.701T15.22 14t-1.191 4.037-3.108 2.701q1.568.697 3.079.697zm9.933-11.559L27.999 14l-4.066 4.124v5.809h-5.809L14 27.999l-4.124-4.066H4.067v-5.809L.001 14l4.066-4.124V4.067h5.809L14 .001l4.124 4.066h5.809v5.809z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_brightness_light" xmlns="http://www.w3.org/2000/svg"><path d="M14 21.435q3.079 0 5.257-2.178T21.435 14t-2.178-5.257T14 6.565 8.743 8.743 6.565 14t2.178 5.257T14 21.435zm9.933-3.311v5.809h-5.809L14 27.999l-4.124-4.066H4.067v-5.809L.001 14l4.066-4.124V4.067h5.809L14 .001l4.124 4.066h5.809v5.809L27.999 14z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_check" xmlns="http://www.w3.org/2000/svg"><path d="M8.885 20.197 25.759 3.323l2.24 2.24L8.885 24.677 0 15.792l2.24-2.24z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_check_circle_outline" xmlns="http://www.w3.org/2000/svg"><path d="M14 25.239q4.601 0 7.92-3.319T25.239 14 21.92 6.08 14 2.761 6.08 6.08 2.761 14t3.319 7.92T14 25.239zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0zm6.441 7.822 1.972 1.972-11.239 11.239L4.207 14l1.972-1.972 4.995 4.995z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_cloud_off" xmlns="http://www.w3.org/2000/svg"><path d="M9.023 10.5H7q-1.914 0-3.281 1.395t-1.367 3.309 1.367 3.281T7 19.852h11.375zM3.5 4.976l1.477-1.477L24.5 23.022l-1.477 1.477-2.352-2.297H6.999q-2.898 0-4.949-2.051t-2.051-4.949q0-2.844 1.969-4.867t4.758-2.133zm19.086 5.578q2.242.164 3.828 1.832T28 16.351q0 3.008-2.461 4.758l-1.695-1.695q1.805-.984 1.805-3.063 0-1.422-1.039-2.461t-2.461-1.039h-1.75v-.602q0-2.68-1.859-4.539t-4.539-1.859q-1.531 0-2.953.711l-1.75-1.695Q11.431 3.5 14.001 3.5q2.953 0 5.496 2.078t3.09 4.977z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_code" xmlns="http://www.w3.org/2000/svg"><path d="M9.917 24.5a1.75 1.75 0 1 0-3.501.001 1.75 1.75 0 0 0 3.501-.001zm0-21a1.75 1.75 0 1 0-3.501.001A1.75 1.75 0 0 0 9.917 3.5zm11.666 2.333a1.75 1.75 0 1 0-3.501.001 1.75 1.75 0 0 0 3.501-.001zm1.75 0a3.502 3.502 0 0 1-1.75 3.026c-.055 6.581-4.721 8.039-7.82 9.023-2.898.911-3.846 1.349-3.846 3.117v.474a3.502 3.502 0 0 1 1.75 3.026c0 1.932-1.568 3.5-3.5 3.5s-3.5-1.568-3.5-3.5c0-1.294.711-2.424 1.75-3.026V6.526A3.502 3.502 0 0 1 4.667 3.5c0-1.932 1.568-3.5 3.5-3.5s3.5 1.568 3.5 3.5a3.502 3.502 0 0 1-1.75 3.026v9.06c.93-.456 1.914-.766 2.807-1.039 3.391-1.075 5.323-1.878 5.359-5.687a3.502 3.502 0 0 1-1.75-3.026c0-1.932 1.568-3.5 3.5-3.5s3.5 1.568 3.5 3.5z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_copy" xmlns="http://www.w3.org/2000/svg"><path d="M23.502 25.438V7.626H9.562v17.812h13.94zm0-20.315q1.013 0 1.787.745t.774 1.757v17.812q0 1.013-.774 1.787t-1.787.774H9.562q-1.013 0-1.787-.774t-.774-1.787V7.625q0-1.013.774-1.757t1.787-.745h13.94zM19.689 0v2.562H4.438v17.812H1.936V2.562q0-1.013.745-1.787T4.438.001h15.251z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_dangerous" xmlns="http://www.w3.org/2000/svg"><path d="M21.802 19.833 15.969 14l5.833-5.833-1.969-1.969L14 12.031 8.167 6.198 6.198 8.167 12.031 14l-5.833 5.833 1.969 1.969L14 15.969l5.833 5.833zM19.833 0 28 8.167v11.666L19.833 28H8.167L0 19.833V8.167L8.167 0h11.666z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_date" xmlns="http://www.w3.org/2000/svg"><path d="M27.192 28.844V11.192H4.808v17.652h22.384zm0-25.689q1.277 0 2.253.976t.976 2.253v22.459q0 1.277-.976 2.216t-2.253.939H4.808q-1.352 0-2.291-.901t-.939-2.253V6.385q0-1.277.939-2.253t2.291-.976h1.577V.001h3.23v3.155h12.769V.001h3.23v3.155h1.577zm-3.155 11.267v3.155h-3.23v-3.155h3.23zm-6.46 0v3.155h-3.155v-3.155h3.155zm-6.384 0v3.155h-3.23v-3.155h3.23z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_download" xmlns="http://www.w3.org/2000/svg"><path d="M2.866 28.209h26.269v3.79H2.866v-3.79zm26.268-16.925L16 24.418 2.866 11.284h7.493V.001h11.283v11.283h7.493z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_email" xmlns="http://www.w3.org/2000/svg"><path d="M28.845 9.615v-3.23L16 14.422 3.155 6.385v3.23L16 17.577zm0-6.46q1.277 0 2.216.977T32 6.385v19.23q0 1.277-.939 2.253t-2.216.977H3.155q-1.277 0-2.216-.977T0 25.615V6.385q0-1.277.939-2.253t2.216-.977h25.69z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_error_outline" xmlns="http://www.w3.org/2000/svg"><path d="M14 25.239q4.601 0 7.92-3.319T25.239 14 21.92 6.08 14 2.761 6.08 6.08 2.761 14t3.319 7.92T14 25.239zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0zm-1.38 6.967h2.761v8.413H12.62V6.967zm0 11.239h2.761v2.826H12.62v-2.826z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_fire" xmlns="http://www.w3.org/2000/svg"><path d="M17.689 21.998q-.32.32-.8.576t-.864.384q-1.152.384-2.272.032t-1.888-.992q-.128-.128-.096-.256t.16-.192q1.216-.384 1.92-1.216t.96-1.792q.192-.896-.064-1.728t-.384-1.728q-.128-.704-.096-1.376t.288-1.312q0-.128.128-.128t.192.064q.384.832.992 1.472t1.28 1.216 1.216 1.248.672 1.568q.064.384.064.704.064.96-.32 1.92t-1.088 1.536zm3.84-10.944q-.768-.704-1.6-1.28t-1.6-1.344q-1.536-1.536-2.016-3.584t.16-4.16q.128-.32-.096-.544t-.544-.096q-.768.32-1.44.768t-1.312.896q-1.984 1.664-3.136 3.936T8.633 10.51t.8 5.088q0 .128.032.256t.032.256q0 .576-.512.832t-1.024-.192q-.128-.192-.192-.32-1.024-1.28-1.376-2.912t-.096-3.232q.064-.384-.288-.576t-.608.128q-1.28 1.664-1.856 3.68t-.448 4.064q0 .576.096 1.184t.288 1.184q.448 1.536 1.216 2.816 1.216 2.048 3.264 3.424t4.416 1.696q2.496.32 5.024-.256t4.448-2.304q1.408-1.344 2.208-3.104t.864-3.68-.704-3.712q-.064-.128-.096-.224t-.096-.224q-.576-1.088-1.28-1.984-.256-.384-.544-.704t-.672-.64z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_git" xmlns="http://www.w3.org/2000/svg"><path d="M27.472 12.753 15.247.529a1.803 1.803 0 0 0-2.55 0l-2.84 2.84 2.137 2.137a2.625 2.625 0 0 1 3.501 3.501l3.499 3.499a2.625 2.625 0 1 1-1.237 1.237l-3.499-3.499c-.083.04-.169.075-.257.106v7.3a2.626 2.626 0 1 1-1.75 0v-7.3a2.626 2.626 0 0 1-1.494-3.607L8.62 4.606l-8.09 8.09a1.805 1.805 0 0 0 0 2.551l12.225 12.224a1.803 1.803 0 0 0 2.55 0l12.168-12.168a1.805 1.805 0 0 0 0-2.551z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_gitea" xmlns="http://www.w3.org/2000/svg"><path d="M5.581 7.229c-2.46-.005-5.755 1.559-5.573 5.48.284 6.125 6.56 6.693 9.068 6.743.275 1.149 3.227 5.112 5.412 5.32h9.573c5.741-.381 10.04-17.363 6.853-17.427-5.271.248-8.395.373-11.073.395v5.3l-.835-.369-.005-4.928c-3.075-.001-5.781-.144-10.919-.397-.643-.004-1.539-.113-2.501-.116zm.348 2.166h.293c.349 3.14.917 4.976 2.067 7.781-2.933-.347-5.429-1.199-5.888-4.38-.237-1.647.563-3.365 3.528-3.401zm11.409 3.087c.2.003.404.04.596.128l.999.431-.716 1.305h-.007a.996.996 0 0 0-.321.053l.006-.002c-.349.114-.593.406-.593.749 0 .097.019.189.055.275l-.002-.006a.767.767 0 0 0 .151.233l-.001-.001-1.235 2.248a.99.99 0 0 0-.302.052l.006-.002c-.349.114-.593.406-.593.749 0 .097.019.189.055.275l-.002-.006c.128.31.457.527.843.527a.987.987 0 0 0 .31-.049l-.006.002c.348-.114.592-.406.592-.749 0-.097-.02-.19-.056-.277l.002.006a.784.784 0 0 0-.211-.293l1.203-2.189a.999.999 0 0 0 .397-.041l-.006.002a.942.942 0 0 0 .285-.15l-.001.001c.464.195.844.353 1.117.488.411.203.556.337.6.487.044.147-.004.429-.236.925-.173.369-.46.893-.799 1.511h-.02a.991.991 0 0 0-.321.053l.006-.002c-.349.114-.593.406-.593.749 0 .097.019.189.055.275l-.002-.006c.128.31.457.527.843.527a.987.987 0 0 0 .31-.049l-.006.002c.348-.114.592-.406.592-.749a.703.703 0 0 0-.055-.275l.002.006a.802.802 0 0 0-.183-.27l.001.001c.335-.611.623-1.136.808-1.531.251-.536.381-.935.267-1.32s-.467-.636-.933-.867c-.307-.151-.689-.311-1.147-.503a.723.723 0 0 0-.052-.324l.002.006a.792.792 0 0 0-.194-.279l.704-1.284 3.899 1.684c.704.305.995 1.053.653 1.68l-2.68 4.907c-.343.625-1.184.884-1.888.58l-5.516-2.384c-.704-.304-.996-1.053-.653-1.68l2.68-4.905c.235-.431.707-.687 1.207-.707z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_github" xmlns="http://www.w3.org/2000/svg"><path d="M16 .394c8.833 0 15.999 7.166 15.999 15.999 0 7.062-4.583 13.062-10.937 15.187-.813.146-1.104-.354-1.104-.771 0-.521.021-2.25.021-4.396 0-1.5-.5-2.458-1.083-2.958 3.562-.396 7.312-1.75 7.312-7.896 0-1.75-.625-3.167-1.646-4.291.167-.417.708-2.042-.167-4.25-1.333-.417-4.396 1.646-4.396 1.646a15.032 15.032 0 0 0-8 0S8.937 6.602 7.603 7.018c-.875 2.208-.333 3.833-.167 4.25-1.021 1.125-1.646 2.542-1.646 4.291 0 6.125 3.729 7.5 7.291 7.896-.458.417-.875 1.125-1.021 2.146-.917.417-3.25 1.125-4.646-1.333-.875-1.521-2.458-1.646-2.458-1.646-1.562-.021-.104.979-.104.979 1.042.479 1.771 2.333 1.771 2.333.938 2.854 5.396 1.896 5.396 1.896 0 1.333.021 2.583.021 2.979 0 .417-.292.917-1.104.771C4.582 29.455-.001 23.455-.001 16.393-.001 7.56 7.165.394 15.998.394zM6.063 23.372c.042-.083-.021-.187-.146-.25-.125-.042-.229-.021-.271.042-.042.083.021.187.146.25.104.062.229.042.271-.042zm.646.709c.083-.062.062-.208-.042-.333-.104-.104-.25-.146-.333-.062-.083.062-.062.208.042.333.104.104.25.146.333.062zm.625.937c.104-.083.104-.25 0-.396-.083-.146-.25-.208-.354-.125-.104.062-.104.229 0 .375s.271.208.354.146zm.875.875c.083-.083.042-.271-.083-.396-.146-.146-.333-.167-.417-.062-.104.083-.062.271.083.396.146.146.333.167.417.062zm1.187.521c.042-.125-.083-.271-.271-.333-.167-.042-.354.021-.396.146s.083.271.271.312c.167.062.354 0 .396-.125zm1.313.104c0-.146-.167-.25-.354-.229-.187 0-.333.104-.333.229 0 .146.146.25.354.229.187 0 .333-.104.333-.229zm1.208-.208c-.021-.125-.187-.208-.375-.187-.187.042-.312.167-.292.312.021.125.187.208.375.167s.312-.167.292-.292z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_gitlab" xmlns="http://www.w3.org/2000/svg"><path d="M1.629 11.034 14 26.888.442 17.048a1.09 1.09 0 0 1-.39-1.203l1.578-4.811zm7.217 0h10.309l-5.154 15.854zM5.753 1.475l3.093 9.559H1.63l3.093-9.559a.548.548 0 0 1 1.031 0zm20.618 9.559 1.578 4.811c.141.437-.016.922-.39 1.203l-13.558 9.84 12.371-15.854zm0 0h-7.216l3.093-9.559a.548.548 0 0 1 1.031 0z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_heart" xmlns="http://www.w3.org/2000/svg"><path d="M16 29.714a1.11 1.11 0 0 1-.786-.321L4.072 18.643c-.143-.125-4.071-3.714-4.071-8 0-5.232 3.196-8.357 8.535-8.357 3.125 0 6.053 2.464 7.464 3.857 1.411-1.393 4.339-3.857 7.464-3.857 5.339 0 8.535 3.125 8.535 8.357 0 4.286-3.928 7.875-4.089 8.035L16.785 29.392c-.214.214-.5.321-.786.321z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_home" xmlns="http://www.w3.org/2000/svg"><path d="M24.003 15.695v8.336c0 .608-.504 1.111-1.111 1.111h-6.669v-6.669h-4.446v6.669H5.108a1.119 1.119 0 0 1-1.111-1.111v-8.336c0-.035.017-.069.017-.104L14 7.359l9.986 8.232a.224.224 0 0 1 .017.104zm3.873-1.198-1.077 1.285a.578.578 0 0 1-.365.191h-.052a.547.547 0 0 1-.365-.122L14 5.831 1.983 15.851a.594.594 0 0 1-.417.122.578.578 0 0 1-.365-.191L.124 14.497a.57.57 0 0 1 .069-.781L12.679 3.314c.729-.608 1.91-.608 2.64 0l4.237 3.543V3.471c0-.313.243-.556.556-.556h3.334c.313 0 .556.243.556.556v7.085l3.803 3.161c.226.191.26.556.069.781z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_info_outline" xmlns="http://www.w3.org/2000/svg"><path d="M12.62 9.793V6.967h2.761v2.826H12.62zM14 25.239q4.601 0 7.92-3.319T25.239 14 21.92 6.08 14 2.761 6.08 6.08 2.761 14t3.319 7.92T14 25.239zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0zm-1.38 21.033V12.62h2.761v8.413H12.62z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_keyboard_arrow_down" xmlns="http://www.w3.org/2000/svg"><path d="M3.281 5.36 14 16.079 24.719 5.36 28 8.641l-14 14-14-14z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_keyboard_arrow_left" xmlns="http://www.w3.org/2000/svg"><path d="M25.875 28.25 22.125 32 6.126 16.001 22.125.002l3.75 3.75-12.25 12.25z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_keyboard_arrow_right" xmlns="http://www.w3.org/2000/svg"><path d="M6.125 28.25 18.375 16 6.125 3.75 9.875 0l15.999 15.999L9.875 31.998z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_keyboard_arrow_up" xmlns="http://www.w3.org/2000/svg"><path d="M24.719 22.64 14 11.921 3.281 22.64 0 19.359l14-14 14 14z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_language" xmlns="http://www.w3.org/2000/svg"><path d="M20.112 16.826h4.732q.394-1.84.394-2.826t-.394-2.826h-4.732q.197 1.38.197 2.826t-.197 2.826zm-2.497 7.756q1.643-.526 3.418-2.005t2.695-2.991h-4.141q-.657 2.629-1.972 4.995zm-.329-7.756q.197-1.38.197-2.826t-.197-2.826h-6.573q-.197 1.38-.197 2.826t.197 2.826h6.573zM14 25.173q1.84-2.695 2.695-5.587h-5.39q.854 2.892 2.695 5.587zM8.413 8.413q.789-2.826 1.972-4.995-1.643.526-3.451 2.005T4.272 8.414h4.141zM4.272 19.587q.854 1.512 2.662 2.991t3.451 2.005q-1.315-2.366-1.972-4.995H4.272zm-1.117-2.761h4.732Q7.69 15.446 7.69 14t.197-2.826H3.155q-.394 1.84-.394 2.826t.394 2.826zM14 2.826q-1.84 2.695-2.695 5.587h5.39Q15.841 5.521 14 2.826zm9.727 5.587q-.92-1.512-2.695-2.991t-3.418-2.005q1.183 2.169 1.972 4.995h4.141zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_link" xmlns="http://www.w3.org/2000/svg"><path d="M24.037 7.963q3.305 0 5.634 2.366T32 16t-2.329 5.671-5.634 2.366h-6.46v-3.08h6.46q2.028 0 3.493-1.465t1.465-3.493-1.465-3.493-3.493-1.465h-6.46v-3.08h6.46zM9.615 17.578v-3.155h12.77v3.155H9.615zM3.005 16q0 2.028 1.465 3.493t3.493 1.465h6.46v3.08h-6.46q-3.305 0-5.634-2.366T0 16.001t2.329-5.671 5.634-2.366h6.46v3.08h-6.46q-2.028 0-3.493 1.465t-1.465 3.493z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_mastodon" xmlns="http://www.w3.org/2000/svg"><path d="M30.924 10.506c0-6.941-4.548-8.976-4.548-8.976C24.083.477 20.144.034 16.054.001h-.101C11.862.034 7.926.477 5.633 1.53c0 0-4.548 2.035-4.548 8.976 0 1.589-.031 3.491.02 5.505.165 6.79 1.245 13.479 7.522 15.14 2.893.765 5.379.927 7.38.816 3.629-.2 5.667-1.296 5.667-1.296l-.12-2.633s-2.593.817-5.505.719c-2.887-.099-5.932-.311-6.399-3.855a7.069 7.069 0 0 1-.064-.967v-.028.001s2.833.693 6.423.857c2.195.1 4.253-.129 6.344-.377 4.009-.479 7.5-2.949 7.939-5.207.689-3.553.633-8.676.633-8.676zm-5.366 8.945h-3.329v-8.159c0-1.72-.724-2.592-2.171-2.592-1.6 0-2.403 1.035-2.403 3.083v4.465h-3.311v-4.467c0-2.048-.803-3.083-2.403-3.083-1.447 0-2.171.873-2.171 2.592v8.159H6.441v-8.404c0-1.719.437-3.084 1.316-4.093.907-1.011 2.092-1.528 3.565-1.528 1.704 0 2.995.655 3.848 1.965l.828 1.391.829-1.391c.853-1.311 2.144-1.965 3.848-1.965 1.472 0 2.659.517 3.565 1.528.877 1.009 1.315 2.375 1.315 4.093z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_matrix" xmlns="http://www.w3.org/2000/svg"><path d="M.843.734v30.532H3.04v.733H0V0h3.04v.733zm9.391 9.68v1.543h.044a4.417 4.417 0 0 1 1.489-1.365c.577-.327 1.248-.487 2-.487.72 0 1.377.143 1.975.419.597.277 1.047.776 1.36 1.477.339-.499.8-.941 1.379-1.323.579-.383 1.267-.573 2.061-.573.604 0 1.163.075 1.68.223a3.34 3.34 0 0 1 1.324.707c.368.327.652.745.861 1.268.203.523.307 1.151.307 1.889v7.637h-3.132v-6.468c0-.381-.013-.745-.043-1.083a2.315 2.315 0 0 0-.246-.893l.006.013a1.484 1.484 0 0 0-.577-.593l-.007-.004c-.259-.147-.609-.221-1.047-.221-.443 0-.8.085-1.071.252-.267.166-.483.39-.635.656l-.005.009a2.558 2.558 0 0 0-.307.915l-.002.013a7.156 7.156 0 0 0-.08 1.044v6.359h-3.133v-6.4c0-.339-.005-.671-.024-1.003a2.772 2.772 0 0 0-.197-.936l.007.019a1.41 1.41 0 0 0-.548-.667l-.006-.003c-.259-.167-.635-.253-1.139-.253-.148 0-.345.032-.585.099-.24.068-.48.191-.707.376-.228.184-.425.449-.585.793-.16.345-.24.8-.24 1.36v6.621H7.279v-11.42zm20.923 20.852V.734H28.96V.001H32V32h-3.04v-.733z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_menu" xmlns="http://www.w3.org/2000/svg"><path d="M.001 5.334h31.998v3.583H.001V5.334zm0 12.416v-3.5h31.998v3.5H.001zm0 8.916v-3.583h31.998v3.583H.001z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_notification" xmlns="http://www.w3.org/2000/svg"><path d="m22.615 19.384 2.894 2.894v1.413H2.49v-1.413l2.894-2.894V12.25q0-3.365 1.716-5.856t4.745-3.231v-1.01q0-.875.606-1.514T13.999 0t1.548.639.606 1.514v1.01q3.029.74 4.745 3.231t1.716 5.856v7.134zM14 27.999q-1.211 0-2.053-.808t-.841-2.019h5.788q0 1.144-.875 1.986T14 27.999z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_path" xmlns="http://www.w3.org/2000/svg"><path d="M28 12.62h-9.793V8.414h-2.826v11.173h2.826v-4.206H28V26.62h-9.793v-4.206H12.62v-14H9.794v4.206H.001V1.381h9.793v4.206h8.413V1.381H28V12.62z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_person" xmlns="http://www.w3.org/2000/svg"><path d="M16 20.023q5.052 0 10.526 2.199t5.473 5.754v4.023H0v-4.023q0-3.555 5.473-5.754t10.526-2.199zM16 16q-3.275 0-5.614-2.339T8.047 8.047t2.339-5.661T16 0t5.614 2.386 2.339 5.661-2.339 5.614T16 16z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_search" xmlns="http://www.w3.org/2000/svg"><path d="M11.925 20.161q3.432 0 5.834-2.402t2.402-5.834-2.402-5.834-5.834-2.402-5.834 2.402-2.402 5.834 2.402 5.834 5.834 2.402zm10.981 0L32 29.255 29.255 32l-9.094-9.094v-1.458l-.515-.515q-3.26 2.831-7.721 2.831-4.976 0-8.45-3.432T.001 11.925t3.474-8.45 8.45-3.474 8.407 3.474 3.432 8.45q0 1.802-.858 4.075t-1.973 3.646l.515.515h1.458z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_shield" xmlns="http://www.w3.org/2000/svg"><path d="M22.167 15.166V3.5h-8.166v20.726c.93-.492 2.424-1.349 3.883-2.497 1.95-1.531 4.284-3.919 4.284-6.562zm3.499-13.999v14c0 7.674-10.737 12.523-11.192 12.724-.146.073-.31.109-.474.109s-.328-.036-.474-.109c-.456-.201-11.192-5.049-11.192-12.724v-14C2.334.529 2.863 0 3.501 0H24.5c.638 0 1.167.529 1.167 1.167z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_star" xmlns="http://www.w3.org/2000/svg"><path d="M14 22.052 5.324 27.31l2.3-9.859L0 10.813l10.056-.854L14 .692l3.944 9.267L28 10.813l-7.624 6.638 2.3 9.859z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_tag" xmlns="http://www.w3.org/2000/svg"><path d="M17.52 17.52v-7.041h-7.041v7.041h7.041zM28 10.479h-7.041v7.041H28v3.439h-7.041V28H17.52v-7.041h-7.041V28H7.04v-7.041H-.001V17.52H7.04v-7.041H-.001V7.04H7.04V-.001h3.439V7.04h7.041V-.001h3.439V7.04H28v3.439z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_timer" xmlns="http://www.w3.org/2000/svg"><path d="M16 29q4.428 0 7.536-3.143t3.107-7.571-3.107-7.536T16 7.643 8.464 10.75t-3.107 7.536 3.107 7.571T16 29zM26.714 9.786q1.214 1.571 2.107 4.036t.893 4.464q0 5.643-4 9.678T16 32t-9.714-4.036-4-9.678 4-9.678T16 4.572q1.929 0 4.464.929t4.107 2.143l2.143-2.214q1.143.929 2.143 2.143zM14.5 19.857v-9.143h3v9.143h-3zM20.571.001v3.071h-9.143V.001h9.143z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_xmpp" xmlns="http://www.w3.org/2000/svg"><path d="M31.995 4.237c-.449.175-1.12.433-1.936.745-1.544.591-2.328.891-2.924 1.093-.613.208-1.287.409-2.635.813-.911.272-1.672.495-2.212.651-.031.875 0 2.177-.292 3.635a21.837 21.837 0 0 1-2.016 5.765c-1.496 2.944-3.236 4.817-3.88 5.476-.056-.059-.112-.117-.168-.179-.707-.763-2.403-2.703-3.815-5.683-1.053-2.223-1.484-4.044-1.605-4.584-.356-1.589-.427-2.955-.427-4.117 0-.075-.036-.129-.101-.149-.721-.223-1.765-.519-2.887-.853-1.271-.379-2.193-.744-3.408-1.2-.493-.185-1.409-.547-2.217-.859C.723 4.499.113 4.236.041 4.236c-.005 0-.015 0-.023.012a.131.131 0 0 0-.019.076c.009.593.08 1.361.256 2.365.615 3.503 2.688 7.061 4.36 9.244 0 0 3.717 5.035 9.128 8.144l.303.176c-.009.008-.02.015-.028.021-1.717 1.316-3.201 1.977-3.579 2.14a15.71 15.71 0 0 1-2.219.772v.407a25.31 25.31 0 0 0 2.72-.487 26.72 26.72 0 0 0 5.075-1.792c.136.067.276.136.42.204 1.527.725 3.571 1.627 6.073 2.048.613.103 1.136.165 1.507.195a.109.109 0 0 0 .115-.091.55.55 0 0 0 .004-.217.107.107 0 0 0-.063-.073c-.505-.209-1.201-.4-1.983-.719-.935-.381-2.241-1.067-3.648-2.128a13.528 13.528 0 0 1-.367-.287c4.64-2.656 7.989-6.588 7.989-6.588 1.735-2.036 4.441-5.623 5.431-9.795.349-1.473.539-2.741.5-3.628z"/></svg></defs></svg>




    <div
      class="wrapper "
    >
      <input type="checkbox" class="hidden" id="menu-control" />
      <input type="checkbox" class="hidden" id="menu-header-control" />
      
      <header class="gdoc-header">
  <div class="container flex align-center justify-between">
    
      <label for="menu-control" class="gdoc-nav__control" tabindex="0">
        <svg class="gdoc-icon gdoc_menu">
          <title>Open Navigation</title>
          <use xlink:href="#gdoc_menu"></use>
        </svg>
        <svg class="gdoc-icon gdoc_arrow_back">
          <title>Close Navigation</title>
          <use xlink:href="#gdoc_arrow_back"></use>
        </svg>
      </label>
    
    <div>
      <a class="gdoc-brand gdoc-header__link" href="https://www.sudo.ws/">
        <span class="flex align-center"><span class="gdoc-brand__title">Sudo</span>
        </span>
      </a>
    </div>
    <div class="gdoc-menu-header">
      <span class="gdoc-menu-header__items">
        
          

  
  
  
  

  
    
      
      
      

      
      

      

      
        <span>
          <a
            href="
              https://github.com/sudo-project/sudo
            "
            class="gdoc-header__link"
          >
            <svg class="gdoc-icon gdoc_github">
              <title>GitHub</title>
              <use xlink:href="#gdoc_github"></use>
            </svg>
          </a>
        </span>
      
    
  
    
      
      
      

      
      

      

      
        <span>
          <a
            href="
              /posts/
            "
            class="gdoc-header__link"
          >
            <svg class="gdoc-icon fa-blog">
              <title>Blog</title>
              <use xlink:href="#fa-blog"></use>
            </svg>
          </a>
        </span>
      
    
  






        


        <span id="gdoc-color-theme">
          <svg class="gdoc-icon gdoc_brightness_dark">
            <title>Toggle Dark/Light/Auto mode</title>
            <use xlink:href="#gdoc_brightness_dark"></use>
          </svg>
          <svg class="gdoc-icon gdoc_brightness_light">
            <title>Toggle Dark/Light/Auto mode</title>
            <use xlink:href="#gdoc_brightness_light"></use>
          </svg>
          <svg class="gdoc-icon gdoc_brightness_auto">
            <title>Toggle Dark/Light/Auto mode</title>
            <use xlink:href="#gdoc_brightness_auto"></use>
          </svg>
        </span>

        <span class="gdoc-menu-header__home">
          <a href="https://www.sudo.ws/" class="gdoc-header__link">
            <svg class="gdoc-icon gdoc_home">
              <title>Back to homepage</title>
              <use xlink:href="#gdoc_home"></use>
            </svg>
          </a>
        </span>

        



        <span class="gdoc-menu-header__control">
          <label for="menu-header-control">
            <svg class="gdoc-icon gdoc_keyboard_arrow_right">
              <use xlink:href="#gdoc_keyboard_arrow_right"></use>
              <title>Close Menu Bar</title>
            </svg>
          </label>
        </span>
      </span>
      <label for="menu-header-control" class="gdoc-menu-header__control">
        <svg class="gdoc-icon gdoc_keyboard_arrow_left">
          <use xlink:href="#gdoc_keyboard_arrow_left"></use>
          <title>Open Menu Bar</title>
        </svg>
      </label>
    </div>
  </div>
</header>



      <main class="container flex flex-even">
        
          <aside class="gdoc-nav">
            <nav><a class="container hidden-mobile" href="/">
          <img src="/images/sudo-sandwich-logo-65.png" alt="Sudo Logo" />
      </a>
  <div class="gdoc-search flex align-center">
    <svg class="gdoc-icon gdoc_search"><use xlink:href="#gdoc_search"></use></svg>
    <input
      type="text"
      id="gdoc-search-input"
      class="gdoc-search__input"
      placeholder="Search"
      aria-label="Search"
      maxlength="64"
      data-site-base-url="https://www.sudo.ws/"
      data-site-lang="en"
    />
    <div class="gdoc-search__spinner spinner hidden"></div>
    <ul id="gdoc-search-results" class="gdoc-search__list"></ul>
  </div>




  <section class="gdoc-nav--main">
    
      

  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">About Sudo</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/intro/"
                    class="gdoc-nav__entry"
                  >
                    A Short Introduction
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/history/"
                    class="gdoc-nav__entry"
                  >
                    A Brief History of Sudo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/contributors/"
                    class="gdoc-nav__entry"
                  >
                    Contributors
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/translations/"
                    class="gdoc-nav__entry"
                  >
                    Translations
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/plugins/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Plugins
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/license/"
                    class="gdoc-nav__entry"
                  >
                    Sudo License
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/logo/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Logo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/export/"
                    class="gdoc-nav__entry"
                  >
                    Export Controls
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Releases</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/releases/stable/"
                    class="gdoc-nav__entry"
                  >
                    Stable Release
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/releases/legacy/"
                    class="gdoc-nav__entry"
                  >
                    Legacy Release
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/releases/devel/"
                    class="gdoc-nav__entry"
                  >
                    Development Release
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/releases/changelog/"
                    class="gdoc-nav__entry"
                  >
                    ChangeLog
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Getting Sudo</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
      
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/getting/repo/"
                    class="gdoc-nav__entry"
                  >
                    Source Repo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/getting/source/"
                    class="gdoc-nav__entry"
                  >
                    Source Distribution
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/getting/packages/"
                    class="gdoc-nav__entry"
                  >
                    Prebuilt Packages
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/getting/download_mirrors/"
                    class="gdoc-nav__entry"
                  >
                    Download Mirrors
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/getting/mirror/"
                    class="gdoc-nav__entry"
                  >
                    Mirroring Sudo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Documentation</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="gdoc-nav__toggle" id="navtree-7533376e"
                checked
              
            />
            <label
              
                for="navtree-7533376e" class="flex justify-between align-center"
              
            >
              
                <span class="flex">Manual Pages (latest)</span>
              
              
                <svg class="gdoc-icon toggle gdoc_keyboard_arrow_left">
                  <use xlink:href="#gdoc_keyboard_arrow_left"></use>
                </svg>
                <svg class="gdoc-icon toggle gdoc_keyboard_arrow_down">
                  <use xlink:href="#gdoc_keyboard_arrow_down"></use>
                </svg>
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/cvtsudoers.man/"
                    class="gdoc-nav__entry"
                  >
                    Cvtsudoers Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo.conf.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Configuration Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_sendlog.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Log Client Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_logsrvd.conf.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Log Server Configuration Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_logsrvd.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Log Server Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_logsrv.proto.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Log Server Protocol Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_plugin.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Plugin API
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_plugin_python.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Python Plugin API
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudoers.ldap.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudoers LDAP Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudoers.man/"
                    class="gdoc-nav__entry is-active"
                  >
                    Sudoers Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudoers_timestamp.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudoers Time Stamp Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudoreplay.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudoreplay Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/visudo.man/"
                    class="gdoc-nav__entry"
                  >
                    Visudo Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man_all/"
                    class="gdoc-nav__entry"
                  >
                    Manual Pages (all versions)
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="gdoc-nav__toggle" id="navtree-3f8f9cdc"
                
              
            />
            <label
              
                for="navtree-3f8f9cdc" class="flex justify-between align-center"
              
            >
              
                <span class="flex">README Files</span>
              
              
                <svg class="gdoc-icon toggle gdoc_keyboard_arrow_left">
                  <use xlink:href="#gdoc_keyboard_arrow_left"></use>
                </svg>
                <svg class="gdoc-icon toggle gdoc_keyboard_arrow_down">
                  <use xlink:href="#gdoc_keyboard_arrow_down"></use>
                </svg>
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/readme/readme/"
                    class="gdoc-nav__entry"
                  >
                    README
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/readme/readme_ldap/"
                    class="gdoc-nav__entry"
                  >
                    README.LDAP
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/install/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Installation Notes
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/upgrade/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Upgrade Notes
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/contributing/"
                    class="gdoc-nav__entry"
                  >
                    Contributing to Sudo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/troubleshooting/"
                    class="gdoc-nav__entry"
                  >
                    Troubleshooting FAQ
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/packaging/"
                    class="gdoc-nav__entry"
                  >
                    Building Sudo Packages
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/other/"
                    class="gdoc-nav__entry"
                  >
                    Other Documentation
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/alternatives/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Alternatives
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Security</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/security/advisories/"
                    class="gdoc-nav__entry"
                  >
                    Security Advisories
                  </a>
                </span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/security/policy/"
                    class="gdoc-nav__entry"
                  >
                    Security Policy
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/security/static_analysis/"
                    class="gdoc-nav__entry"
                  >
                    Static Analysis
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/security/fuzzing/"
                    class="gdoc-nav__entry"
                  >
                    Fuzzing Sudo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/security/sanitizers/"
                    class="gdoc-nav__entry"
                  >
                    Sanitizers and Sudo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
  </ul>






    
  </section>

  


  <section class="gdoc-nav--more">
    
      

  
  


  <ul class="gdoc-nav__list">
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon fa-blog"><use xlink:href="#fa-blog"></use></svg>
                
                <a
                  href="/posts"
                  class="gdoc-nav__entry"
                >
                  Blog
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon fa-bug"><use xlink:href="#fa-bug"></use></svg>
                
                <a
                  href="
                    https://bugzilla.sudo.ws"
                  class="gdoc-nav__entry"
                >
                  Bug Tracker
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon gdoc_notification"><use xlink:href="#gdoc_notification"></use></svg>
                
                <a
                  href="/news"
                  class="gdoc-nav__entry"
                >
                  News
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon gdoc_email"><use xlink:href="#gdoc_email"></use></svg>
                
                <a
                  href="/lists"
                  class="gdoc-nav__entry"
                >
                  Mailing Lists
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon gdoc_github"><use xlink:href="#gdoc_github"></use></svg>
                
                <a
                  href="
                    https://github.com/sudo-project/sudo"
                  class="gdoc-nav__entry"
                >
                  GitHub Repo
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon gdoc_git"><use xlink:href="#gdoc_git"></use></svg>
                
                <a
                  href="
                    https://git.sudo.ws/sudo"
                  class="gdoc-nav__entry"
                >
                  Git Mirror
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon fa-mastodon"><use xlink:href="#fa-mastodon"></use></svg>
                
                <a
                  href="
                    https://fosstodon.org/@sudoproject"
                  class="gdoc-nav__entry"
                >
                  Mastodon
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon fa-book"><use xlink:href="#fa-book"></use></svg>
                
                <a
                  href="
                    https://mwl.io/nonfiction/tools#sudo2"
                  class="gdoc-nav__entry"
                >
                  Sudo Mastery Book
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
  </ul>






    
  </section>
</nav>

          </aside>
        


        <div class="gdoc-page">
          
  


  






<div
  class="gdoc-page__header flex flex-wrap
  
    justify-end
  
  hidden-mobile
  hidden"
  itemprop="breadcrumb"
>
  
  
</div>



  <article
    class="gdoc-markdown gdoc-markdown__align--left"
  >
    <h1>Sudoers Manual</h1>
    






<div class="gdoc-include"><link rel="preload" href="/mandoc.css" as="style">
<link rel="stylesheet" href="/mandoc.css" media="all">
<main class="manual-text">
<section class="Sh">
<h2 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h2>
<p class="Pp"><code class="Nm">sudoers</code> &#x2014;
    <span class="Nd" role="doc-subtitle">default sudo security policy
    plugin</span></p>
</section>
<section class="Sh">
<h2 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h2>
<p class="Pp">The <code class="Nm">sudoers</code> policy plugin determines a
    user's <code class="Nm">sudo</code> privileges. It is the default
    <code class="Nm">sudo</code> policy plugin. The policy is driven by the
    <span class="Pa">/etc/sudoers</span> file or, optionally, in LDAP. The
    policy format is described in detail in the
    <a class="Sx" href="#SUDOERS_FILE_FORMAT">SUDOERS FILE FORMAT</a> section.
    For information on storing <code class="Nm">sudoers</code> policy
    information in LDAP, see <a class="Xr" aria-label="sudoers.ldap, section
    5">sudoers.ldap(5)</a>.</p>
<section class="Ss">
<h3 class="Ss" id="Configuring_sudo.conf_for_sudoers"><a class="permalink" href="#Configuring_sudo.conf_for_sudoers">Configuring
  sudo.conf for sudoers</a></h3>
<p class="Pp"><code class="Nm">sudo</code> consults the
    <a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a> file to
    determine which plugins to load. If no <a class="Xr" aria-label="sudo.conf,
    section 5">sudo.conf(5)</a> file is present, or if it contains no
    <i class="Em">Plugin</i> lines, <code class="Nm">sudoers</code> will be used
    for auditing, policy decisions and I/O logging. To explicitly configure
    <a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a> to use the
    <code class="Nm">sudoers</code> plugin, the following configuration can be
    used.</p>
<div class="Bd Pp Bd-indent Li">
<pre>Plugin sudoers_audit sudoers.so
Plugin sudoers_policy sudoers.so
Plugin sudoers_io sudoers.so</pre>
</div>
<p class="Pp">Starting with <code class="Nm">sudo</code> 1.8.5, it is possible
    to specify optional arguments to the <code class="Nm">sudoers</code> plugin
    in the <a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a>
    file. Plugin arguments, if any, should be listed after the path to the
    plugin (i.e., after <span class="Pa">sudoers.so</span>). The arguments are
    only effective for the plugin that opens (and parses) the
    <i class="Em">sudoers</i> file.</p>
<p class="Pp" id="sudoers_audit">For <code class="Nm">sudo</code> version 1.9.1
    and higher, this is the
    <a class="permalink" href="#sudoers_audit"><i class="Em">sudoers_audit</i></a>
    plugin. For older versions, it is the
    <a class="permalink" href="#sudoers_policy"><i class="Em" id="sudoers_policy">sudoers_policy</i></a>
    plugin. Multiple arguments may be specified, separated by white space. For
    example:</p>
<div class="Bd Pp Bd-indent Li">
<pre>Plugin sudoers_audit sudoers.so sudoers_mode=0400 error_recovery=false</pre>
</div>
<p class="Pp">The following plugin arguments are supported:</p>
<dl class="Bl-tag">
  <dt id="error_recovery">error_recovery=bool</dt>
  <dd>The
      <a class="permalink" href="#error_recovery"><i class="Em">error_recovery</i></a>
      argument can be used to control whether <code class="Nm">sudoers</code>
      should attempt to recover from syntax errors in the
      <i class="Em">sudoers</i> file. If set to
      <a class="permalink" href="#true"><i class="Em" id="true">true</i></a>
      (the default), <code class="Nm">sudoers</code> will try to recover from a
      syntax error by discarding the portion of the line that contains the error
      until the end of the line. A value of <i class="Em">false</i> will disable
      error recovery. Prior to version 1.9.3, no error recovery was
    performed.</dd>
  <dt id="ignore_perms">ignore_perms=bool</dt>
  <dd>The
      <a class="permalink" href="#ignore_perms"><i class="Em">ignore_perms</i></a>
      argument can be used to disable security checks when loading the
      <i class="Em">sudoers</i> file. If enabled, the <i class="Em">sudoers</i>
      file will be loaded regardless of the owner or file mode. This argument is
      intended to be used for testing purposes and should not be enabled on
      production systems.</dd>
  <dt id="ldap_conf">ldap_conf=pathname</dt>
  <dd>The <a class="permalink" href="#ldap_conf"><i class="Em">ldap_conf</i></a>
      argument can be used to override the default path to the
      <span class="Pa">ldap.conf</span> file.</dd>
  <dt id="ldap_secret">ldap_secret=pathname</dt>
  <dd>The
      <a class="permalink" href="#ldap_secret"><i class="Em">ldap_secret</i></a>
      argument can be used to override the default path to the
      <span class="Pa">ldap.secret</span> file.</dd>
  <dt id="sudoers_file">sudoers_file=pathname</dt>
  <dd>The
      <a class="permalink" href="#sudoers_file"><i class="Em">sudoers_file</i></a>
      argument can be used to override the default path to the
      <i class="Em">sudoers</i> file.</dd>
  <dt id="sudoers_uid">sudoers_uid=user-ID</dt>
  <dd>The
      <a class="permalink" href="#sudoers_uid"><i class="Em">sudoers_uid</i></a>
      argument can be used to override the default owner of the sudoers file. It
      should be specified as a numeric user-ID.</dd>
  <dt id="sudoers_gid">sudoers_gid=group-ID</dt>
  <dd>The
      <a class="permalink" href="#sudoers_gid"><i class="Em">sudoers_gid</i></a>
      argument can be used to override the default group of the sudoers file. It
      must be specified as a numeric group-ID (not a group name).</dd>
  <dt id="sudoers_mode">sudoers_mode=mode</dt>
  <dd>The
      <a class="permalink" href="#sudoers_mode"><i class="Em">sudoers_mode</i></a>
      argument can be used to override the default file mode for the sudoers
      file. It should be specified as an octal value.</dd>
</dl>
<p class="Pp">For more information on configuring
    <a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a>, refer to
    its manual.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="User_Authentication"><a class="permalink" href="#User_Authentication">User
  Authentication</a></h3>
<p class="Pp">The <code class="Nm">sudoers</code> security policy requires that
    most users authenticate themselves before they can use
    <code class="Nm">sudo</code>. A password is not required if the invoking
    user is <b class="Sy">root</b>, if the target user is the same as the
    invoking user, or if the policy has disabled authentication for the user or
    command. Unlike <a class="Xr" aria-label="su, section 1">su(1)</a>, when
    <code class="Nm">sudoers</code> requires authentication, it validates the
    invoking user's credentials, not the target user's (or
    <b class="Sy">root</b><span class="No">'s</span>) credentials. This can be
    changed via the <i class="Em">rootpw</i>, <i class="Em">targetpw</i> and
    <i class="Em">runaspw</i> flags, described later.</p>
<p class="Pp">If a user who is not listed in the policy tries to run a command
    via <code class="Nm">sudo</code>, mail is sent to the proper authorities.
    The address used for such mail is configurable via the
    <i class="Em">mailto</i> Defaults entry (described later) and defaults to
    <i class="Em">root</i>.</p>
<p class="Pp">No mail will be sent if an unauthorized user tries to run
    <code class="Nm">sudo</code> with the <code class="Fl">-l</code> or
    <code class="Fl">-v</code> option unless there is an authentication error
    and either the <i class="Em">mail_always</i> or
    <i class="Em">mail_badpass</i> flags are enabled. This allows users to
    determine for themselves whether or not they are allowed to use
    <code class="Nm">sudo</code>. By default, all attempts to run
    <code class="Nm">sudo</code> (successful or not) are logged, regardless of
    whether or not mail is sent.</p>
<p class="Pp">If <code class="Nm">sudo</code> is run by <b class="Sy">root</b>
    and the <code class="Ev">SUDO_USER</code> environment variable is set, the
    <code class="Nm">sudoers</code> policy will use this value to determine who
    the actual user is. This can be used by a user to log commands through sudo
    even when a <b class="Sy">root</b> shell has been invoked. It also allows
    the <code class="Fl">-e</code> option to remain useful even when invoked via
    a sudo-run script or program. Note, however, that the
    <i class="Em">sudoers</i> file lookup is still done for
    <b class="Sy">root</b>, not the user specified by
    <code class="Ev">SUDO_USER</code>.</p>
<p class="Pp"><code class="Nm">sudoers</code> uses per-user time stamp files for
    credential caching. Once a user has been authenticated, a record is written
    containing the user-ID that was used to authenticate, the terminal session
    ID, the start time of the session leader (or parent process) and a time
    stamp (using a monotonic clock if one is available). The user may then use
    <code class="Nm">sudo</code> without a password for a short period of time
    (5 minutes unless overridden by the <i class="Em">timestamp_timeout</i>
    option). By default, <code class="Nm">sudoers</code> uses a separate record
    for each terminal, which means that a user's login sessions are
    authenticated separately. The <i class="Em">timestamp_type</i> option can be
    used to select the type of time stamp record <code class="Nm">sudoers</code>
    will use.</p>
<p class="Pp">The <code class="Nm">tsdump</code> utility, included with the sudo
    source distribution, can be used to display the contents of a time stamp
    file. See <a class="Xr" aria-label="sudoers_timestamp, section
    5">sudoers_timestamp(5)</a> for details of the time stamp file format.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Logging"><a class="permalink" href="#Logging">Logging</a></h3>
<p class="Pp">By default, <code class="Nm">sudoers</code> logs both successful
    and unsuccessful attempts (as well as errors). The
    <a class="permalink" href="#log_allowed"><i class="Em" id="log_allowed">log_allowed</i></a>
    and
    <a class="permalink" href="#log_denied"><i class="Em" id="log_denied">log_denied</i></a>
    flags can be used to control this behavior. Messages can be logged to
    <a class="Xr" aria-label="syslog, section 3">syslog(3)</a>, a log file, or
    both. The default is to log to <a class="Xr" aria-label="syslog, section
    3">syslog(3)</a> but this is configurable via the <i class="Em">syslog</i>
    and <i class="Em">logfile</i> settings. See
    <a class="Sx" href="#EVENT_LOGGING">EVENT LOGGING</a> for a description of
    the log file format.</p>
<p class="Pp"><code class="Nm">sudoers</code> is also capable of running a
    command in a pseudo-terminal and logging input and/or output. The standard
    input, standard output, and standard error can be logged even when not
    associated with a terminal. For more information about I/O logging, see the
    <a class="Sx" href="#I/O_LOGGING">I/O LOGGING</a> section.</p>
<p class="Pp">Starting with version 1.9, the <i class="Em">log_servers</i>
    setting may be used to send event and I/O log data to a remote server
    running <code class="Nm">sudo_logsrvd</code> or another service that
    implements the protocol described by
    <a class="Xr" aria-label="sudo_logsrv.proto, section
    5">sudo_logsrv.proto(5)</a>.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Command_environment"><a class="permalink" href="#Command_environment">Command
  environment</a></h3>
<p class="Pp">Since environment variables can influence program behavior,
    <code class="Nm">sudoers</code> provides a means to restrict which variables
    from the user's environment are inherited by the command to be run. There
    are two distinct ways <code class="Nm">sudoers</code> can deal with
    environment variables.</p>
<p class="Pp">By default, the <i class="Em">env_reset</i> flag is enabled. This
    causes commands to be executed with a new, minimal environment. On AIX (and
    Linux systems without PAM), the environment is initialized with the contents
    of the <span class="Pa">/etc/environment</span> file. On
    <span class="Ux">BSD</span> systems, if the <i class="Em">use_loginclass</i>
    flag is enabled, the environment is initialized based on the
    <i class="Em">path</i> and <i class="Em">setenv</i> settings in
    <span class="Pa">/etc/login.conf</span>. The <code class="Ev">HOME</code>,
    <code class="Ev">MAIL</code>, <code class="Ev">SHELL</code>,
    <code class="Ev">LOGNAME</code> and <code class="Ev">USER</code> environment
    variables are initialized based on the target user and the
    <code class="Ev">SUDO_*</code> variables are set based on the invoking user.
    Additional variables, such as <code class="Ev">DISPLAY</code>,
    <code class="Ev">PATH</code> and <code class="Ev">TERM</code>, are preserved
    from the invoking user's environment if permitted by the
    <i class="Em">env_check</i>, or <i class="Em">env_keep</i> options. A few
    environment variables are treated specially. If the
    <code class="Ev">PATH</code> and <code class="Ev">TERM</code> variables are
    not preserved from the user's environment, they will be set to default
    values. The <code class="Ev">LOGNAME</code> and <code class="Ev">USER</code>
    are handled as a single entity. If one of them is preserved (or removed)
    from the user's environment, the other will be as well. If
    <code class="Ev">LOGNAME</code> and <code class="Ev">USER</code> are to be
    preserved but only one of them is present in the user's environment, the
    other will be set to the same value. This avoids an inconsistent environment
    where one of the variables describing the user name is set to the invoking
    user and one is set to the target user. Environment variables with a value
    beginning with &#x2018;<code class="Li">()</code>&#x2019; are removed unless
    both the name and value parts are matched by <i class="Em">env_keep</i> or
    <i class="Em">env_check</i>, as they may be interpreted as functions by the
    <b class="Sy">bash</b> shell. Prior to version 1.8.11, such variables were
    always removed.</p>
<p class="Pp">If, however, the <i class="Em">env_reset</i> flag is disabled, any
    variables not explicitly denied by the <i class="Em">env_check</i> and
    <i class="Em">env_delete</i> options are allowed and their values are
    inherited from the invoking process. Prior to version 1.8.21, environment
    variables with a value beginning with
    &#x2018;<code class="Li">()</code>&#x2019; were always removed. Beginning
    with version 1.8.21, a pattern in <i class="Em">env_delete</i> is used to
    match <b class="Sy">bash</b> shell functions instead. Since it is not
    possible to block all potentially dangerous environment variables, use of
    the default <i class="Em">env_reset</i> behavior is encouraged.</p>
<p class="Pp">Environment variables specified by <i class="Em">env_check</i>,
    <i class="Em">env_delete</i>, or <i class="Em">env_keep</i> may include one
    or more &#x2018;<code class="Li">*</code>&#x2019; characters which will
    match zero or more characters. No other wildcard characters are
  supported.</p>
<p class="Pp">By default, environment variables are matched by name. However, if
    the pattern includes an equal sign
    (&#x2018;<code class="Li">=</code>&#x2019;), both the variables name and
    value must match. For example, a <b class="Sy">bash</b> shell function could
    be matched as follows:</p>
<div class="Bd Pp Bd-indent Li">
<pre>env_keep += &quot;BASH_FUNC_my_func%%=()*&quot;</pre>
</div>
<p class="Pp">Without the &#x2018;<code class="Li">=()*</code>&#x2019; suffix,
    this would not match, as <b class="Sy">bash</b> shell functions are not
    preserved by default.</p>
<p class="Pp">The complete list of environment variables that are preserved or
    removed, as modified by global Defaults parameters in
    <i class="Em">sudoers</i>, is displayed when <code class="Nm">sudo</code> is
    run by <b class="Sy">root</b> with the <code class="Fl">-V</code> option.
    The list of environment variables to remove varies based on the operating
    system <code class="Nm">sudo</code> is running on.</p>
<p class="Pp">Other settings may influence the command environment:</p>
<ul class="Bl-bullet">
  <li id="always_set_home"><code class="Nm">sudoers</code> options such as
      <a class="permalink" href="#always_set_home"><i class="Em">always_set_home</i></a>,
      <i class="Em">secure_path</i>, <i class="Em">set_logname</i>,
      <a class="permalink" href="#set_home"><i class="Em" id="set_home">set_home</i></a>,
      and <i class="Em">setenv</i>.</li>
  <li>Command tags, such as <code class="Dv">SETENV</code> and
      <code class="Dv">NOSETENV</code>. Note that <code class="Dv">SETENV</code>
      is implied if the command matched is <b class="Sy">ALL</b>.</li>
  <li><code class="Nm">sudo</code> options, such as <code class="Fl">-E</code>
      and <code class="Fl">-i</code>.</li>
</ul>
<p class="Pp" id="pam_env">On systems that support PAM where the
    <a class="permalink" href="#pam_env"><b class="Sy">pam_env</b></a> module is
    enabled for <code class="Nm">sudo</code>, variables in the PAM environment
    may be merged in to the environment. If a variable in the PAM environment is
    already present in the user's environment, the value will only be overridden
    if the variable was not preserved by <code class="Nm">sudoers</code>. When
    <i class="Em">env_reset</i> is enabled, variables preserved from the
    invoking user's environment by the <i class="Em">env_keep</i> list take
    precedence over those in the PAM environment. When
    <i class="Em">env_reset</i> is disabled, variables present the invoking
    user's environment take precedence over those in the PAM environment unless
    they match a pattern in the <i class="Em">env_delete</i> list.</p>
<p class="Pp">The dynamic linker on most operating systems will remove variables
    that can control dynamic linking from the environment of set-user-ID
    executables, including <code class="Nm">sudo</code>. Depending on the
    operating system this may include <code class="Ev">_RLD*</code>,
    <code class="Ev">DYLD_*</code>, <code class="Ev">LD_*</code>,
    <code class="Ev">LDR_*</code>, <code class="Ev">LIBPATH</code>,
    <code class="Ev">SHLIB_PATH</code>, and others. These type of variables are
    removed from the environment before <code class="Nm">sudo</code> even begins
    execution and, as such, it is not possible for <code class="Nm">sudo</code>
    to preserve them.</p>
<p class="Pp">As a special case, if the <code class="Fl">-i</code> option
    (initial login) is specified, <code class="Nm">sudoers</code> will
    initialize the environment regardless of the value of
    <i class="Em">env_reset</i>. The <code class="Ev">DISPLAY</code>,
    <code class="Ev">PATH</code> and <code class="Ev">TERM</code> variables
    remain unchanged; <code class="Ev">HOME</code>,
    <code class="Ev">MAIL</code>, <code class="Ev">SHELL</code>,
    <code class="Ev">USER</code>, and <code class="Ev">LOGNAME</code> are set
    based on the target user. On AIX (and Linux systems without PAM), the
    contents of <span class="Pa">/etc/environment</span> are also included. On
    <span class="Ux">BSD</span> systems, if the <i class="Em">use_loginclass</i>
    flag is enabled, the <i class="Em">path</i> and <i class="Em">setenv</i>
    variables in <span class="Pa">/etc/login.conf</span> are also applied. All
    other environment variables are removed unless permitted by
    <i class="Em">env_keep</i> or <i class="Em">env_check</i>, described
  above.</p>
<p class="Pp">Finally, the <i class="Em">restricted_env_file</i> and
    <i class="Em">env_file</i> files are applied, if present. The variables in
    <i class="Em">restricted_env_file</i> are applied first and are subject to
    the same restrictions as the invoking user's environment, as detailed above.
    The variables in <i class="Em">env_file</i> are applied last and are not
    subject to these restrictions. In both cases, variables present in the files
    will only be set to their specified values if they would not conflict with
    an existing environment variable.</p>
</section>
</section>
<section class="Sh">
<h2 class="Sh" id="SUDOERS_FILE_FORMAT"><a class="permalink" href="#SUDOERS_FILE_FORMAT">SUDOERS
  FILE FORMAT</a></h2>
<p class="Pp">The <i class="Em">sudoers</i> file is composed of two types of
    entries: aliases (basically variables) and user specifications (which
    specify who may run what).</p>
<p class="Pp">When multiple entries match for a user, they are applied in order.
    Where there are multiple matches, the last match is used (which is not
    necessarily the most specific match).</p>
<p class="Pp">The <i class="Em">sudoers</i> file grammar will be described below
    in Extended Backus-Naur Form (EBNF). Don't despair if you are unfamiliar
    with EBNF; it is fairly simple, and the definitions below are annotated.</p>
<section class="Ss">
<h3 class="Ss" id="Resource_limits"><a class="permalink" href="#Resource_limits">Resource
  limits</a></h3>
<p class="Pp">By default, <code class="Nm">sudoers</code> uses the operating
    system's native method of setting resource limits for the target user. On
    Linux systems, resource limits are usually set by the
    <span class="Pa">pam_limits.so</span> PAM module. On some BSD systems, the
    <span class="Pa">/etc/login.conf</span> file specifies resource limits for
    the user. On AIX systems, resource limits are configured in the
    <span class="Pa">/etc/security/limits</span> file. If there is no system
    mechanism to set per-user resource limits, the command will run with the
    same limits as the invoking user. The one exception to this is the core dump
    file size, which is set by <code class="Nm">sudoers</code> to 0 by default.
    Disabling core dumps by default makes it possible to avoid potential
    security problems where the core file is treated as trusted input.</p>
<p class="Pp" id="rlimit_as">Resource limits may also be set in the
    <i class="Em">sudoers</i> file itself, in which case they override those set
    by the system. See the
    <a class="permalink" href="#rlimit_as"><i class="Em">rlimit_as</i></a>,
    <a class="permalink" href="#rlimit_core"><i class="Em" id="rlimit_core">rlimit_core</i></a>,
    <a class="permalink" href="#rlimit_cpu"><i class="Em" id="rlimit_cpu">rlimit_cpu</i></a>,
    <a class="permalink" href="#rlimit_data"><i class="Em" id="rlimit_data">rlimit_data</i></a>,
    <a class="permalink" href="#rlimit_fsize"><i class="Em" id="rlimit_fsize">rlimit_fsize</i></a>,
    <a class="permalink" href="#rlimit_locks"><i class="Em" id="rlimit_locks">rlimit_locks</i></a>,
    <a class="permalink" href="#rlimit_memlock"><i class="Em" id="rlimit_memlock">rlimit_memlock</i></a>,
    <a class="permalink" href="#rlimit_nofile"><i class="Em" id="rlimit_nofile">rlimit_nofile</i></a>,
    <a class="permalink" href="#rlimit_nproc"><i class="Em" id="rlimit_nproc">rlimit_nproc</i></a>,
    <a class="permalink" href="#rlimit_rss"><i class="Em" id="rlimit_rss">rlimit_rss</i></a>,
    <a class="permalink" href="#rlimit_stack"><i class="Em" id="rlimit_stack">rlimit_stack</i></a>
    options described below. Resource limits in <code class="Nm">sudoers</code>
    may be specified in one of the following formats:</p>
<dl class="Bl-tag">
  <dt>&#x201C;value&#x201D;</dt>
  <dd>Both the soft and hard resource limits are set to the same value. The
      special value &#x201C;infinity&#x201D; can be used to indicate that the
      value is unlimited.</dd>
  <dt>&#x201C;soft,hard&#x201D;</dt>
  <dd>Two comma-separated values. The soft limit is set to the first value and
      the hard limit is set to the second. Both values must either be enclosed
      in a set of double quotes, or the comma must be escaped with a backslash
      (&#x2018;<code class="Li">\</code>&#x2019;). The special value
      &#x201C;infinity&#x201D; may be used in place of either value.</dd>
  <dt>&#x201C;default&#x201D;</dt>
  <dd>The default resource limit for the user will be used. This may be a
      user-specific value (see above) or the value of the resource limit when
      <code class="Nm">sudo</code> was invoked for systems that don't support
      per-user limits.</dd>
  <dt>&#x201C;user&#x201D;</dt>
  <dd>The invoking user's resource limits will be preserved when running the
      command.</dd>
</dl>
<p class="Pp">For example, to restore the historic core dump file size behavior,
    a line like the following may be used.</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">Defaults
  rlimit_core=default</code></div>
<p class="Pp">Resource limits in <code class="Nm">sudoers</code> are only
    supported by version 1.8.7 or higher.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Quick_guide_to_EBNF"><a class="permalink" href="#Quick_guide_to_EBNF">Quick
  guide to EBNF</a></h3>
<p class="Pp">EBNF is a concise and exact way of describing the grammar of a
    language. Each EBNF definition is made up of <i class="Em">production
    rules</i>. For example:</p>
<div class="Bd Pp Bd-indent Li">
<pre>symbol ::= definition | alternate1 | alternate2 ...</pre>
</div>
<p class="Pp">Each <i class="Em">production rule</i> references others and thus
    makes up a grammar for the language. EBNF also contains the following
    operators, which many readers will recognize from regular expressions. Do
    not, however, confuse them with &#x201C;wildcard&#x201D; characters, which
    have different meanings.</p>
<dl class="Bl-tag">
  <dt>?</dt>
  <dd>Means that the preceding symbol (or group of symbols) is optional. That
      is, it may appear once or not at all.</dd>
  <dt>*</dt>
  <dd>Means that the preceding symbol (or group of symbols) may appear zero or
      more times.</dd>
  <dt>+</dt>
  <dd>Means that the preceding symbol (or group of symbols) may appear one or
      more times.</dd>
</dl>
<p class="Pp">Parentheses may be used to group symbols together. For clarity, we
    will use single quotes ('') to designate what is a verbatim character string
    (as opposed to a symbol name).</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Aliases"><a class="permalink" href="#Aliases">Aliases</a></h3>
<p class="Pp">There are four kinds of aliases: <i class="Em">User_Alias</i>,
    <i class="Em">Runas_Alias</i>, <i class="Em">Host_Alias</i> and
    <i class="Em">Cmnd_Alias</i>. Beginning with <code class="Nm">sudo</code>
    1.9.0,
    <a class="permalink" href="#Cmd_Alias"><i class="Em" id="Cmd_Alias">Cmd_Alias</i></a>
    may be used in place of <i class="Em">Cmnd_Alias</i> if desired.</p>
<div class="Bd Pp Li">
<pre>Alias ::= 'User_Alias'  User_Alias_Spec (':' User_Alias_Spec)* |
          'Runas_Alias' Runas_Alias_Spec (':' Runas_Alias_Spec)* |
          'Host_Alias'  Host_Alias_Spec (':' Host_Alias_Spec)* |
          'Cmnd_Alias'  Cmnd_Alias_Spec (':' Cmnd_Alias_Spec)* |
          'Cmd_Alias'   Cmnd_Alias_Spec (':' Cmnd_Alias_Spec)*
<p>User_Alias ::= NAME</p>
<p>User_Alias_Spec ::= User_Alias &lsquo;=&rsquo; User_List</p>
<p>Runas_Alias ::= NAME</p>
<p>Runas_Alias_Spec ::= Runas_Alias &lsquo;=&rsquo; Runas_List</p>
<p>Host_Alias ::= NAME</p>
<p>Host_Alias_Spec ::= Host_Alias &lsquo;=&rsquo; Host_List</p>
<p>Cmnd_Alias ::= NAME</p>
<p>Cmnd_Alias_Spec ::= Cmnd_Alias &lsquo;=&rsquo; Cmnd_List</p>
<p>NAME ::= <a
  class="gdoc-markdown__link"
  href="[A&amp;#x2013;Z][0&amp;#x2013;9]_"
>AâZ</a>*</pre></p>
</div>
<p class="Pp">Each <i class="Em">alias</i> definition is of the form</p>
<div class="Bd Pp Li">
<pre>Alias_Type NAME = item1, item2, ...</pre>
</div>
<p class="Pp" id="Alias_Type">where
    <a class="permalink" href="#Alias_Type"><i class="Em">Alias_Type</i></a> is
    one of <i class="Em">User_Alias</i>, <i class="Em">Runas_Alias</i>,
    <i class="Em">Host_Alias</i>, or <i class="Em">Cmnd_Alias</i>. A
    <code class="Dv">NAME</code> is a string of uppercase letters, numbers, and
    underscore characters (&#x2018;<code class="Li">_</code>&#x2019;). A
    <code class="Dv">NAME</code>
    <a class="permalink" href="#must"><b class="Sy" id="must">must</b></a> start
    with an uppercase letter. It is possible to put several alias definitions of
    the same type on a single line, joined by a colon
    (&#x2018;<code class="Li">:</code>&#x2019;). For example:</p>
<div class="Bd Pp Li">
<pre>Alias_Type NAME = item1, item2, item3 : NAME = item4, item5</pre>
</div>
<p class="Pp">It is a syntax error to redefine an existing
    <i class="Em">alias</i>. It is possible to use the same name for
    <i class="Em">aliases</i> of different types, but this is not
  recommended.</p>
<p class="Pp">The definitions of what constitutes a valid
    <i class="Em">alias</i> member follow.</p>
<div class="Bd Pp Li">
<pre>User_List ::= User |
              User ',' User_List
<p>User ::= &lsquo;!&rsquo;* user name |
&lsquo;!&rsquo;* #user-ID |
&lsquo;!&rsquo;* %group |
&lsquo;!&rsquo;* %#group-ID |
&lsquo;!&rsquo;* +netgroup |
&lsquo;!&rsquo;* %:nonunix_group |
&lsquo;!&rsquo;* %:#nonunix_gid |
&lsquo;!&rsquo;* User_Alias</pre></p>
</div>
<p class="Pp">A <i class="Em">User_List</i> is made up of one or more user
    names, user-IDs (prefixed with &#x2018;<code class="Li">#</code>&#x2019;),
    system group names and IDs (prefixed with
    &#x2018;<code class="Li">%</code>&#x2019; and
    &#x2018;<code class="Li">%#</code>&#x2019; respectively), netgroups
    (prefixed with &#x2018;<code class="Li">+</code>&#x2019;), non-Unix group
    names and IDs (prefixed with &#x2018;<code class="Li">%:</code>&#x2019; and
    &#x2018;<code class="Li">%:#</code>&#x2019; respectively), and
    <i class="Em">User_Alias</i>es. Each list item may be prefixed with zero or
    more &#x2018;<code class="Li">!</code>&#x2019; operators. An odd number of
    &#x2018;<code class="Li">!</code>&#x2019; operators negate the value of the
    item; an even number just cancel each other out. User netgroups are matched
    using the user and domain members only; the host member is not used when
    matching.</p>
<p class="Pp" id="user-ID">A <i class="Em">user name</i>,
    <a class="permalink" href="#user-ID"><i class="Em">user-ID</i></a>,
    <a class="permalink" href="#group"><i class="Em" id="group">group</i></a>,
    <a class="permalink" href="#group-ID"><i class="Em" id="group-ID">group-ID</i></a>,
    <a class="permalink" href="#netgroup"><i class="Em" id="netgroup">netgroup</i></a>,
    <i class="Em">nonunix_group</i> or <i class="Em">nonunix_gid</i> may be
    enclosed in double quotes to avoid the need for escaping special characters.
    Alternately, special characters may be specified in escaped hex mode, e.g.,
    \x20 for space. When using double quotes, any prefix characters must be
    included inside the quotes.</p>
<p class="Pp">The actual <i class="Em">nonunix_group</i> and
    <i class="Em">nonunix_gid</i> syntax depends on the underlying group
    provider plugin. For instance, the QAS AD plugin supports the following
    formats:</p>
<ul class="Bl-bullet">
  <li>Group in the same domain: &quot;%:Group Name&quot;</li>
  <li>Group in any domain: &quot;%:Group Name@FULLY.QUALIFIED.DOMAIN&quot;</li>
  <li>Group SID:
    &quot;%:S-1-2-34-5678901234-5678901234-5678901234-567&quot;</li>
</ul>
<p class="Pp">See <a class="Sx" href="#GROUP_PROVIDER_PLUGINS">GROUP PROVIDER
    PLUGINS</a> for more information.</p>
<p class="Pp">Quotes around group names are optional. Unquoted strings must use
    a backslash (&#x2018;<code class="Li">\</code>&#x2019;) to escape spaces and
    special characters. See
    <a class="Sx" href="#Other_special_characters_and_reserved_words">Other
    special characters and reserved words</a> for a list of characters that need
    to be escaped.</p>
<div class="Bd Pp Li">
<pre>Runas_List ::= Runas_Member |
               Runas_Member ',' Runas_List
<p>Runas_Member ::= &lsquo;!&rsquo;* user name |
&lsquo;!&rsquo;* #user-ID |
&lsquo;!&rsquo;* %group |
&lsquo;!&rsquo;* %#group-ID |
&lsquo;!&rsquo;* %:nonunix_group |
&lsquo;!&rsquo;* %:#nonunix_gid |
&lsquo;!&rsquo;* +netgroup |
&lsquo;!&rsquo;* Runas_Alias |
&lsquo;!&rsquo;* ALL</pre></p>
</div>
<p class="Pp" id="toor">A <i class="Em">Runas_List</i> is similar to a
    <i class="Em">User_List</i> except that instead of
    <i class="Em">User_Alias</i>es it can contain
    <i class="Em">Runas_Alias</i>es. User names and groups are matched as
    strings. In other words, two users (groups) with the same user (group) ID
    are considered to be distinct. If you wish to match all user names with the
    same user-ID (e.g., <b class="Sy">root</b> and
    <a class="permalink" href="#toor"><b class="Sy">toor</b></a>), you can use a
    user-ID instead of a name (#0 in the example given). The user-ID or group-ID
    specified in a
    <a class="permalink" href="#Runas_Member"><i class="Em" id="Runas_Member">Runas_Member</i></a>
    need not be listed in the password or group database.</p>
<div class="Bd Pp Li">
<pre>Host_List ::= Host |
              Host ',' Host_List
<p>Host ::= &lsquo;!&rsquo;* host name |
&lsquo;!&rsquo;* ip_addr |
&lsquo;!&rsquo;* network(/netmask)? |
&lsquo;!&rsquo;* +netgroup |
&lsquo;!&rsquo;* Host_Alias |
&lsquo;!&rsquo;* ALL</pre></p>
</div>
<p class="Pp">A <i class="Em">Host_List</i> is made up of one or more host
    names, IP addresses, network numbers, netgroups (prefixed with
    &#x2018;<code class="Li">+</code>&#x2019;), and other aliases. Again, the
    value of an item may be negated with the
    &#x2018;<code class="Li">!</code>&#x2019; operator. Host netgroups are
    matched using the host (both qualified and unqualified) and domain members
    only; the user member is not used when matching. If you specify a network
    number without a netmask, <code class="Nm">sudo</code> will query each of
    the local host's network interfaces and, if the network number corresponds
    to one of the hosts's network interfaces, will use the netmask of that
    interface. The netmask may be specified either in standard IP address
    notation (e.g., 255.255.255.0 or ffff:ffff:ffff:ffff::), or CIDR notation
    (number of bits, e.g., 24 or 64). A host name may include shell-style
    wildcards (see the <a class="Sx" href="#Wildcards">Wildcards</a> section
    below), but unless the <i class="Em">hostname</i> command on your machine
    returns the fully qualified host name, you'll need to use the
    <i class="Em">fqdn</i> flag for wildcards to be useful.
    <code class="Nm">sudo</code> only inspects actual network interfaces; this
    means that IP address 127.0.0.1 (localhost) will never match. Also, the host
    name &#x201C;localhost&#x201D; will only match if that is the actual host
    name, which is usually only the case for non-networked systems.</p>
<div class="Bd Pp Li">
<pre>digest ::= [A&#x2013;Fa&#x2013;f0&#x2013;9]+ |
           [A&#x2013;Za&#x2013;z0&#x2013;9\+/=]+
<p>Digest_Spec ::= &quot;sha224&quot; &lsquo;:&rsquo; digest |
&quot;sha256&quot; &lsquo;:&rsquo; digest |
&quot;sha384&quot; &lsquo;:&rsquo; digest |
&quot;sha512&quot; &lsquo;:&rsquo; digest</p>
<p>Digest_List ::= Digest_Spec |
Digest_Spec &lsquo;,&rsquo; Digest_List</p>
<p>Cmnd_List ::= Cmnd |
Cmnd &lsquo;,&rsquo; Cmnd_List</p>
<p>command name ::= regex |
file name</p>
<p>command ::= command name |
command name args |
command name regex |
command name &lsquo;&quot;&quot;&rsquo; |
ALL</p>
<p>Edit_Spec ::= &quot;sudoedit&quot; file name+ |
&quot;sudoedit&quot; regex |
&quot;sudoedit&quot;</p>
<p>List_Spec ::= &quot;list&quot;</p>
<p>Cmnd ::= Digest_List? &lsquo;!&rsquo;* command |
&lsquo;!&rsquo;* directory |
&lsquo;!&rsquo;* Edit_Spec |
&lsquo;!&rsquo;* List_Spec |
&lsquo;!&rsquo;* Cmnd_Alias</pre></p>
</div>
<p class="Pp" id="no">A <i class="Em">Cmnd_List</i> is a list of one or more
    commands, directories, or aliases. A command is a fully qualified file name,
    which may include shell-style wildcards (see the
    <a class="Sx" href="#Wildcards">Wildcards</a> section below), or a regular
    expression that starts with &#x2018;<code class="Li">^</code>&#x2019; and
    ends with &#x2018;<code class="Li">$</code>&#x2019; (see the
    <a class="Sx" href="#Regular_expressions">Regular expressions</a> section
    below). A directory is a fully qualified path name ending in a
    &#x2018;<code class="Li">/</code>&#x2019;. When you specify a directory in a
    <i class="Em">Cmnd_List</i>, the user will be able to run any file within
    that directory (but not in any sub-directories therein). If no command line
    arguments are specified, the user may run the command with any arguments
    they choose. Command line arguments can include wildcards or be a regular
    expression that starts with &#x2018;<code class="Li">^</code>&#x2019; and
    ends with &#x2018;<code class="Li">$</code>&#x2019;. If the command line
    arguments consist of &#x2018;<code class="Li">&quot;&quot;</code>&#x2019;,
    the command may only be run with
    <a class="permalink" href="#no"><i class="Em">no</i></a> arguments.</p>
<p class="Pp">If a <i class="Em">Cmnd</i> has associated command line arguments,
    the arguments in the <i class="Em">Cmnd</i> must match those given by the
    user on the command line. If the arguments in a <i class="Em">Cmnd</i> begin
    with the &#x2018;<code class="Li">^</code>&#x2019; character, they will be
    interpreted as a regular expression and matched accordingly. Otherwise,
    shell-style wildcards are used when matching. Unless a regular expression is
    specified, the following characters must be escaped with a
    &#x2018;<code class="Li">\</code>&#x2019; if they are used in command
    arguments: &#x2018;<code class="Li">,</code>&#x2019;,
    &#x2018;<code class="Li">:</code>&#x2019;,
    &#x2018;<code class="Li">=</code>&#x2019;,
    &#x2018;<code class="Li">\</code>&#x2019;. To prevent arguments in a
    <i class="Em">Cmnd</i> that begin with a
    &#x2018;<code class="Li">^</code>&#x2019; character from being interpreted
    as a regular expression, the &#x2018;<code class="Li">^</code>&#x2019; must
    be escaped with a &#x2018;<code class="Li">\</code>&#x2019;.</p>
<p class="Pp">There are two commands built into <code class="Nm">sudo</code>
    itself: &#x201C;list&#x201D; and &#x201C;sudoedit&#x201D;. Unlike other
    commands, these two must be specified in the <i class="Em">sudoers</i> file
    <i class="Em">without</i> a leading path.</p>
<p class="Pp">The &#x201C;list&#x201D; built-in can be used to permit a user to
    list another user's privileges with <code class="Nm">sudo</code>'s
    <code class="Fl">-U</code> option. For example, &#x201C;sudo -l -U
    otheruser&#x201D;. A user with the &#x201C;list&#x201D; privilege is able to
    list another user's privileges even if they don't have permission to run
    commands as that user. By default, only root or a user with the ability to
    run any command as either root or the specified <var class="Ar">user</var>
    on the current host may use the <code class="Fl">-U</code> option. No
    command line arguments may be specified with the &#x201C;list&#x201D;
    built-in.</p>
<p class="Pp">The &#x201C;sudoedit&#x201D; built-in is used to permit a user to
    run <code class="Nm">sudo</code> with the <code class="Fl">-e</code> option
    (or as <code class="Nm">sudoedit</code>). It may take command line arguments
    just as a normal command does. Unlike other commands,
    &#x201C;sudoedit&#x201D; is built into <code class="Nm">sudo</code> itself
    and must be specified in the <i class="Em">sudoers</i> file
    <i class="Em">without</i> a leading path. If a leading path is present, for
    example <span class="Pa">/usr/bin/sudoedit</span>, the path name will be
    silently converted to &#x201C;sudoedit&#x201D;. A fully-qualified path for
    <code class="Nm">sudoedit</code> is treated as an error by
    <code class="Nm">visudo</code>.</p>
<p class="Pp" id="command">A
    <a class="permalink" href="#command"><i class="Em">command</i></a> may be
    preceded by a <i class="Em">Digest_List</i>, a comma-separated list of one
    or more
    <a class="permalink" href="#Digest_Spec"><i class="Em" id="Digest_Spec">Digest_Spec</i></a>
    entries. If a <i class="Em">Digest_List</i> is present, the command will
    only match successfully if it can be verified using one of the SHA-2 digests
    in the list. Starting with version 1.9.0, the <b class="Sy">ALL</b> reserved
    word can be used in conjunction with a <i class="Em">Digest_List</i>. The
    following digest formats are supported: sha224, sha256, sha384, and sha512.
    The string may be specified in either hex or base64 format (base64 is more
    compact). There are several utilities capable of generating SHA-2 digests in
    hex format such as openssl, shasum, sha224sum, sha256sum, sha384sum,
    sha512sum.</p>
<p class="Pp">For example, using openssl:</p>
<div class="Bd Pp Li">
<pre>$ openssl dgst -sha224 /bin/ls
SHA224(/bin/ls)= 118187da8364d490b4a7debbf483004e8f3e053ec954309de2c41a25</pre>
</div>
<p class="Pp">It is also possible to use openssl to generate base64 output:</p>
<div class="Bd Pp Li">
<pre>$ openssl dgst -binary -sha224 /bin/ls | openssl base64
EYGH2oNk1JC0p9679IMATo8+BT7JVDCd4sQaJQ==</pre>
</div>
<p class="Pp">Warning, if the user has write access to the command itself
    (directly or via a <code class="Nm">sudo</code> command), it may be possible
    for the user to replace the command after the digest check has been
    performed but before the command is executed. A similar race condition
    exists on systems that lack the <a class="Xr" aria-label="fexecve, section
    2">fexecve(2)</a> system call when the directory in which the command is
    located is writable by the user. See the description of the
    <i class="Em">fdexec</i> setting for more information on how
    <code class="Nm">sudo</code> executes commands that have an associated
    digest.</p>
<p class="Pp">Command digests are only supported by version 1.8.7 or higher.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Defaults"><a class="permalink" href="#Defaults">Defaults</a></h3>
<p class="Pp">Certain configuration options may be changed from their default
    values at run-time via one or more <i class="Em">Default_Entry</i> lines.
    These may affect all users on any host (&#x2018;Defaults&#x2019;), all users
    on a specific host (&#x2018;Defaults@host&#x2019;), a specific user
    (&#x2018;Defaults:user&#x2019;), a specific command
    (&#x2018;Defaults!cmnd&#x2019;), or commands being run as a specific user
    (&#x2018;Defaults&gt;runasuser&#x2019;).</p>
<p class="Pp">White space is not permitted between &#x2018;Defaults&#x2019; and
    the &#x2018;<code class="Li">@</code>&#x2019;,
    &#x2018;<code class="Li">:</code>&#x2019;,
    &#x2018;<code class="Li">!</code>&#x2019;, or
    &#x2018;<code class="Li">&gt;</code>&#x2019; characters. While a
    comma-separated list may be used in place of a single value after the
    &#x2018;<code class="Li">@</code>&#x2019;,
    &#x2018;<code class="Li">:</code>&#x2019;,
    &#x2018;<code class="Li">!</code>&#x2019;, or
    &#x2018;<code class="Li">&gt;</code>&#x2019; character, using an alias
    instead of a list is often improve readability. Per-command entries may not
    include command line arguments. If you need to specify arguments, define a
    <i class="Em">Cmnd_Alias</i> and reference that instead.</p>
<div class="Bd Pp Li">
<pre>Default_Type ::= 'Defaults' |
                 'Defaults@' Host_List |
                 'Defaults:' User_List |
                 'Defaults!' Cmnd_List |
                 'Defaults&gt;' Runas_List
<p>Default_Entry ::= Default_Type Parameter_List</p>
<p>Parameter_List ::= Parameter |
Parameter &lsquo;,&rsquo; Parameter_List</p>
<p>Parameter ::= Parameter &lsquo;=&rsquo; Value |
Parameter &lsquo;+=&rsquo; Value |
Parameter &lsquo;-=&rsquo; Value |
&lsquo;!&rsquo;* Parameter</pre></p>
</div>
<p class="Pp" id="flags">Parameters may be
    <a class="permalink" href="#flags"><b class="Sy">flags</b></a>,
    <a class="permalink" href="#integer"><b class="Sy" id="integer">integer</b></a>
    values,
    <a class="permalink" href="#strings"><b class="Sy" id="strings">strings</b></a>,
    or
    <a class="permalink" href="#lists"><b class="Sy" id="lists">lists</b></a>.
    Flags are implicitly boolean and can be turned off via the
    &#x2018;<code class="Li">!</code>&#x2019; operator. Some integer, string and
    list parameters may also be used in a boolean context to disable them.
    Values may be enclosed in double quotes (&quot;&quot;) when they contain
    multiple words. Special characters may be escaped with a backslash
    (&#x2018;<code class="Li">\</code>&#x2019;).</p>
<p class="Pp">To include a literal backslash character in a command line
    argument you must escape the backslash twice. For example, to match
    &#x2018;<code class="Li">\n</code>&#x2019; as part of a command line
    argument, you must use &#x2018;<code class="Li">\\\\n</code>&#x2019; in the
    <i class="Em">sudoers</i> file. This is due to there being two levels of
    escaping, one in the <i class="Em">sudoers</i> parser itself and another
    when command line arguments are matched by the
    <a class="Xr" aria-label="fnmatch, section 3">fnmatch(3)</a> or
    <a class="Xr" aria-label="regexec, section 3">regexec(3)</a> function.</p>
<p class="Pp">Lists have two additional assignment operators,
    &#x2018;<code class="Li">+=</code>&#x2019; and
    &#x2018;<code class="Li">-=</code>&#x2019;. These operators are used to add
    to and delete from a list respectively. It is not an error to use the
    &#x2018;<code class="Li">-=</code>&#x2019; operator to remove an element
    that does not exist in a list.</p>
<p class="Pp" id="ignore_unknown_defaults">In general Defaults settings are
    applied in order, later entries will override earlier ones. However,
    command-specific Defaults settings are applied later, once the command's
    path is known. In addition, the following Defaults settings must be applied
    before all others since they may affect subsequent entries:
    <i class="Em">fqdn</i>, <i class="Em">group_plugin</i>,
    <a class="permalink" href="#ignore_unknown_defaults"><i class="Em">ignore_unknown_defaults</i></a>,
    <i class="Em">match_group_by_gid</i>, <i class="Em">runas_default</i>,
    <i class="Em">sudoers_locale</i>.</p>
<p class="Pp">See <a class="Sx" href="#SUDOERS_OPTIONS">SUDOERS OPTIONS</a> for
    a list of supported Defaults parameters.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="User_specification"><a class="permalink" href="#User_specification">User
  specification</a></h3>
<div class="Bd Li">
<pre>User_Spec ::= User_List Host_List '=' Cmnd_Spec_List \
              (':' Host_List '=' Cmnd_Spec_List)*
<p>Cmnd_Spec_List ::= Cmnd_Spec |
Cmnd_Spec &lsquo;,&rsquo; Cmnd_Spec_List</p>
<p>Cmnd_Spec ::= Runas_Spec? Option_Spec* (Tag_Spec &lsquo;:&rsquo;)* Cmnd</p>
<p>Runas_Spec ::= &lsquo;(&rsquo; Runas_List? (&rsquo;:&rsquo; Runas_List)? &lsquo;)&rsquo;</p>
<p>Option_Spec ::= (SELinux_Spec | Solaris_Priv_Spec | Date_Spec | Timeout_Spec | Chdir_Spec | Chroot_Spec)</p>
<p>SELinux_Spec ::= (&lsquo;ROLE=role&rsquo; | &lsquo;TYPE=type&rsquo;)</p>
<p>Solaris_Priv_Spec ::= (&lsquo;PRIVS=privset&rsquo; | &lsquo;LIMITPRIVS=privset&rsquo;)</p>
<p>Date_Spec ::= (&lsquo;NOTBEFORE=timestamp&rsquo; | &lsquo;NOTAFTER=timestamp&rsquo;)</p>
<p>Timeout_Spec ::= &lsquo;TIMEOUT=timeout&rsquo;</p>
<p>Chdir_Spec ::= &lsquo;CWD=directory&rsquo;</p>
<p>Chroot_Spec ::= &lsquo;CHROOT=directory&rsquo;</p>
<p>Tag_Spec ::= (&lsquo;EXEC&rsquo; | &lsquo;NOEXEC&rsquo; | &lsquo;FOLLOW&rsquo; | &lsquo;NOFOLLOW&rsquo; |
&lsquo;LOG_INPUT&rsquo; | &lsquo;NOLOG_INPUT&rsquo; | &lsquo;LOG_OUTPUT&rsquo; |
&lsquo;NOLOG_OUTPUT&rsquo; | &lsquo;MAIL&rsquo; | &lsquo;NOMAIL&rsquo; | &lsquo;INTERCEPT&rsquo; |
&lsquo;NOINTERCEPT&rsquo; | &lsquo;PASSWD&rsquo; | &lsquo;NOPASSWD&rsquo; | &lsquo;SETENV&rsquo; |
&lsquo;NOSETENV&rsquo;)</pre></p>
</div>
<p class="Pp">A <b class="Sy">user specification</b> determines which commands a
    user may run (and as what user) on specified hosts. By default, commands are
    run as <b class="Sy">root</b> (unless <i class="Em">runas_default</i> has
    been set to a different value) but this can also be changed on a per-command
    basis.</p>
<p class="Pp">The basic structure of a user specification is &#x201C;who where =
    (as_whom) what&#x201D;. Let's break that down into its constituent
  parts:</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Runas_Spec"><a class="permalink" href="#Runas_Spec">Runas_Spec</a></h3>
<p class="Pp">A <i class="Em">Runas_Spec</i> determines the user and/or the
    group that a command may be run as. A fully-specified
    <i class="Em">Runas_Spec</i> consists of two <i class="Em">Runas_List</i>s
    (as defined above) separated by a colon
    (&#x2018;<code class="Li">:</code>&#x2019;) and enclosed in a set of
    parentheses. The first <i class="Em">Runas_List</i> indicates which users
    the command may be run as via the <code class="Fl">-u</code> option. The
    second defines a list of groups that may be specified via the
    <code class="Fl">-g</code> option (in addition to any of the target user's
    groups). If both <i class="Em">Runas_List</i>s are specified, the command
    may be run with any combination of users and groups listed in their
    respective <i class="Em">Runas_List</i>s. If only the first is specified,
    the command may be run as any user in the list and, optionally, with any
    group the target user belongs to. If the first <i class="Em">Runas_List</i>
    is empty but the second is specified, the command may be run as the invoking
    user with the group set to any listed in the <i class="Em">Runas_List</i>.
    If both <i class="Em">Runas_List</i>s are empty, the command may only be run
    as the invoking user and the group, if specified, must be one that the
    invoking user is a member of. If no <i class="Em">Runas_Spec</i> is
    specified, the command may only be run as the
    <i class="Em">runas_default</i> user (<b class="Sy">root</b> by default) and
    the group, if specified, must be one that the
    <i class="Em">runas_default</i> user is a member of.</p>
<p class="Pp">A <i class="Em">Runas_Spec</i> sets the default for the commands
    that follow it. What this means is that for the entry:</p>
<div class="Bd Pp Li">
<pre>dgb	boulder = (operator) /bin/ls, /bin/kill, /usr/bin/lprm</pre>
</div>
<p class="Pp">The user <b class="Sy">dgb</b> may run
    <span class="Pa">/bin/ls</span>, <span class="Pa">/bin/kill</span>, and
    <span class="Pa">/usr/bin/lprm</span> on the host
    <span class="No">boulder</span>&#x2014;but only as
    <b class="Sy">operator</b>. For example:</p>
<div class="Bd Pp Li">
<pre>$ sudo -u operator /bin/ls</pre>
</div>
<p class="Pp">It is also possible to override a <i class="Em">Runas_Spec</i>
    later on in an entry. If we modify the entry like so:</p>
<div class="Bd Pp Li">
<pre>dgb	boulder = (operator) /bin/ls, (root) /bin/kill, /usr/bin/lprm</pre>
</div>
<p class="Pp">Then user <b class="Sy">dgb</b> is now allowed to run
    <span class="Pa">/bin/ls</span> as <b class="Sy">operator</b>, but
    <span class="Pa">/bin/kill</span> and <span class="Pa">/usr/bin/lprm</span>
    as <b class="Sy">root</b>.</p>
<p class="Pp">We can extend this to allow <b class="Sy">dgb</b> to run
    <span class="Pa">/bin/ls</span> with either the user or group set to
    <b class="Sy">operator</b>:</p>
<div class="Bd Pp Li">
<pre>dgb	boulder = (operator : operator) /bin/ls, (root) /bin/kill,\
	/usr/bin/lprm</pre>
</div>
<p class="Pp">While the group portion of the <i class="Em">Runas_Spec</i>
    permits the user to run as command with that group, it does not force the
    user to do so. If no group is specified on the command line, the command
    will run with the group listed in the target user's password database entry.
    The following would all be permitted by the sudoers entry above:</p>
<div class="Bd Pp Li">
<pre>$ sudo -u operator /bin/ls
$ sudo -u operator -g operator /bin/ls
$ sudo -g operator /bin/ls</pre>
</div>
<p class="Pp">In the following example, user <b class="Sy">tcm</b> may run
    commands that access a modem device file with the dialer group.</p>
<div class="Bd Pp Li">
<pre>tcm	boulder = (:dialer) /usr/bin/tip, /usr/bin/cu,\
	/usr/local/bin/minicom</pre>
</div>
<p class="Pp">In this example only the group will be set, the command still runs
    as user <b class="Sy">tcm</b>. For example:</p>
<div class="Bd Pp Li">
<pre>$ sudo -g dialer /usr/bin/cu</pre>
</div>
<p class="Pp">Multiple users and groups may be present in a
    <i class="Em">Runas_Spec</i>, in which case the user may select any
    combination of users and groups via the <code class="Fl">-u</code> and
    <code class="Fl">-g</code> options. In this example:</p>
<div class="Bd Pp Li">
<pre>alan	ALL = (root, bin : operator, system) ALL</pre>
</div>
<p class="Pp" id="alan">user
    <a class="permalink" href="#alan"><b class="Sy">alan</b></a> may run any
    command as either user <b class="Sy">root</b> or
    <a class="permalink" href="#bin"><b class="Sy" id="bin">bin</b></a>,
    optionally setting the group to operator or system.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Option_Spec"><a class="permalink" href="#Option_Spec">Option_Spec</a></h3>
<p class="Pp">A <i class="Em">Cmnd</i> may have zero or more options associated
    with it. Options may consist of SELinux roles and/or types, Solaris
    privileges sets, start and/or end dates and command timeouts. Once an option
    is set for a <i class="Em">Cmnd</i>, subsequent <i class="Em">Cmnd</i>s in
    the <i class="Em">Cmnd_Spec_List</i>, inherit that option unless it is
    overridden by another option. Option names are reserved words in
    <i class="Em">sudoers</i>. This means that none of the valid option names
    (see below) can be used when declaring an alias.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="SELinux_Spec"><a class="permalink" href="#SELinux_Spec">SELinux_Spec</a></h3>
<p class="Pp">On systems with SELinux support, <i class="Em">sudoers</i> file
    entries may optionally have an SELinux role and/or type associated with a
    command. This can be used to implement a form of role-based access control
    (RBAC). If a role or type is specified with the command it will override any
    default values specified in <i class="Em">sudoers</i>. A role or type
    specified on the command line, however, will supersede the values in
    <i class="Em">sudoers</i>.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Solaris_Priv_Spec"><a class="permalink" href="#Solaris_Priv_Spec">Solaris_Priv_Spec</a></h3>
<p class="Pp">On Solaris systems, <i class="Em">sudoers</i> file entries may
    optionally specify Solaris privilege set and/or limit privilege set
    associated with a command. If privileges or limit privileges are specified
    with the command it will override any default values specified in
    <i class="Em">sudoers</i>.</p>
<p class="Pp">A privilege set is a comma-separated list of privilege names. The
    <a class="Xr" aria-label="ppriv, section 1">ppriv(1)</a> command can be used
    to list all privileges known to the system. For example:</p>
<div class="Bd Pp Li">
<pre>$ ppriv -l</pre>
</div>
<p class="Pp">In addition, there are several &#x201C;special&#x201D; privilege
    strings:</p>
<dl class="Bl-tag">
  <dt>none</dt>
  <dd>the empty set</dd>
  <dt>all</dt>
  <dd>the set of all privileges</dd>
  <dt>zone</dt>
  <dd>the set of all privileges available in the current zone</dd>
  <dt>basic</dt>
  <dd>the default set of privileges normal users are granted at login time</dd>
</dl>
<p class="Pp">Privileges can be excluded from a set by prefixing the privilege
    name with either an &#x2018;<code class="Li">!</code>&#x2019; or
    &#x2018;<code class="Li">-</code>&#x2019; character.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Date_Spec"><a class="permalink" href="#Date_Spec">Date_Spec</a></h3>
<p class="Pp"><code class="Nm">sudoers</code> rules can be specified with a
    start and end date via the <code class="Dv">NOTBEFORE</code> and
    <code class="Dv">NOTAFTER</code> settings. The time stamp must be specified
    in &#x201C;Generalized Time&#x201D; as defined by RFC 4517. The format is
    effectively &#x2018;<code class="Li">yyyymmddHHMMSSZ</code>&#x2019; where
    the minutes and seconds are optional. The
    &#x2018;<code class="Li">Z</code>&#x2019; suffix indicates that the time
    stamp is in Coordinated Universal Time (UTC). It is also possible to specify
    a timezone offset from UTC in hours and minutes instead of a
    &#x2018;<code class="Li">Z</code>&#x2019;. For example,
    &#x2018;<code class="Li">-0500</code>&#x2019; would correspond to Eastern
    Standard time in the US. As an extension, if no
    &#x2018;<code class="Li">Z</code>&#x2019; or timezone offset is specified,
    local time will be used.</p>
<p class="Pp">The following are all valid time stamps:</p>
<div class="Bd Pp Bd-indent Li">
<pre>20170214083000Z
2017021408Z
20160315220000-0500
20151201235900</pre>
</div>
</section>
<section class="Ss">
<h3 class="Ss" id="Timeout_Spec"><a class="permalink" href="#Timeout_Spec">Timeout_Spec</a></h3>
<p class="Pp">A command may have a timeout associated with it. If the timeout
    expires before the command has exited, the command will be terminated. The
    timeout may be specified in combinations of days, hours, minutes, and
    seconds with a single-letter case-insensitive suffix that indicates the unit
    of time. For example, a timeout of 7 days, 8 hours, 30 minutes, and 10
    seconds would be written as
    &#x2018;<code class="Li">7d8h30m10s</code>&#x2019;. If a number is specified
    without a unit, seconds are assumed. Any of the days, minutes, hours, or
    seconds may be omitted. The order must be from largest to smallest unit and
    a unit may not be specified more than once.</p>
<p class="Pp" id="valid">The following are all
    <a class="permalink" href="#valid"><i class="Em">valid</i></a> timeout
    values: &#x2018;<code class="Li">7d8h30m10s</code>&#x2019;,
    &#x2018;<code class="Li">14d</code>&#x2019;,
    &#x2018;<code class="Li">8h30m</code>&#x2019;,
    &#x2018;<code class="Li">600s</code>&#x2019;,
    &#x2018;<code class="Li">3600</code>&#x2019;. The following are
    <a class="permalink" href="#invalid"><i class="Em" id="invalid">invalid</i></a>
    timeout values: &#x2018;<code class="Li">12m2w1d</code>&#x2019;,
    &#x2018;<code class="Li">30s10m4h</code>&#x2019;,
    &#x2018;<code class="Li">1d2d3h</code>&#x2019;.</p>
<p class="Pp">This setting is only supported by version 1.8.20 or higher.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Chdir_Spec"><a class="permalink" href="#Chdir_Spec">Chdir_Spec</a></h3>
<p class="Pp">The working directory that the command will be run in can be
    specified using the <code class="Dv">CWD</code> setting. The
    <var class="Fa">directory</var> must be a fully-qualified path name
    beginning with a &#x2018;/&#x2019; or &#x2018;~&#x2019; character, or the
    special value &#x201C;*&#x201D;. A value of &#x201C;*&#x201D; indicates that
    the user may specify the working directory by running
    <code class="Nm">sudo</code> with the <code class="Fl">-D</code> option. By
    default, commands are run from the invoking user's current working
    directory, unless the <code class="Fl">-i</code> option is given. Path names
    of the form <span class="Pa">~user/path/name</span> are interpreted as being
    relative to the named user's home directory. If the user name is omitted,
    the path will be relative to the runas user's home directory.</p>
<p class="Pp">This setting is only supported by version 1.9.3 or higher.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Chroot_Spec"><a class="permalink" href="#Chroot_Spec">Chroot_Spec</a></h3>
<p class="Pp">The root directory that the command will be run in can be
    specified using the <code class="Dv">CHROOT</code> setting. The
    <var class="Fa">directory</var> must be a fully-qualified path name
    beginning with a &#x2018;/&#x2019; or &#x2018;~&#x2019; character, or the
    special value &#x201C;*&#x201D;. A value of &#x201C;*&#x201D; indicates that
    the user may specify the root directory by running
    <code class="Nm">sudo</code> with the <code class="Fl">-R</code> option.
    This setting can be used to run the command in a
    <a class="Xr" aria-label="chroot, section 2">chroot(2)</a>
    &#x201C;sandbox&#x201D; similar to the <a class="Xr" aria-label="chroot,
    section 8">chroot(8)</a> utility. Path names of the form
    <span class="Pa">~user/path/name</span> are interpreted as being relative to
    the named user's home directory. If the user name is omitted, the path will
    be relative to the runas user's home directory.</p>
<p class="Pp">This setting is only supported by version 1.9.3 or higher.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Tag_Spec"><a class="permalink" href="#Tag_Spec">Tag_Spec</a></h3>
<p class="Pp">A command may have zero or more tags associated with it. The
    following tag values are supported: <code class="Dv">EXEC</code>,
    <code class="Dv">NOEXEC</code>, <code class="Dv">FOLLOW</code>,
    <code class="Dv">NOFOLLOW</code>, <code class="Dv">LOG_INPUT</code>,
    <code class="Dv">NOLOG_INPUT</code>, <code class="Dv">LOG_OUTPUT</code>,
    <code class="Dv">NOLOG_OUTPUT</code>, <code class="Dv">MAIL</code>,
    <code class="Dv">NOMAIL</code>, <code class="Dv">INTERCEPT</code>,
    <code class="Dv">NOINTERCEPT</code>, <code class="Dv">PASSWD</code>,
    <code class="Dv">NOPASSWD</code>, <code class="Dv">SETENV</code>, and
    <code class="Dv">NOSETENV</code>. Once a tag is set on a
    <i class="Em">Cmnd</i>, subsequent <i class="Em">Cmnd</i>s in the
    <i class="Em">Cmnd_Spec_List</i>, inherit the tag unless it is overridden by
    the opposite tag (in other words, <code class="Dv">PASSWD</code> overrides
    <code class="Dv">NOPASSWD</code> and <code class="Dv">NOEXEC</code>
    overrides <code class="Dv">EXEC</code>).</p>
<dl class="Bl-hang">
  <dt id="EXEC"><a class="permalink" href="#EXEC"><code class="Dv">EXEC</code></a>
    <span class="No">and</span> <code class="Dv">NOEXEC</code></dt>
  <dd>
    <p class="Pp">If <code class="Nm">sudo</code> has been compiled with
        <i class="Em">noexec</i> support and the underlying operating system
        supports it, the <code class="Dv">NOEXEC</code> tag can be used to
        prevent a dynamically-linked executable from running further commands
        itself.</p>
    <p class="Pp">In the following example, user <b class="Sy">aaron</b> may run
        <span class="Pa">/usr/bin/more</span> and
        <span class="Pa">/usr/bin/vi</span> on the host shanty, but shell
        escapes will be disabled.</p>
    <div class="Bd Pp Li">
    <pre>aaron	shanty = NOEXEC: /usr/bin/more, /usr/bin/vi</pre>
    </div>
    <p class="Pp">See the
        <a class="Sx" href="#Preventing_shell_escapes">Preventing shell
        escapes</a> section below for more details on how
        <code class="Dv">NOEXEC</code> works and whether or not it will work on
        your system.</p>
  </dd>
  <dt id="FOLLOW"><a class="permalink" href="#FOLLOW"><code class="Dv">FOLLOW</code></a>
    <span class="No">and</span> <code class="Dv">NOFOLLOW</code></dt>
  <dd>
    <p class="Pp">Starting with version 1.8.15, <code class="Nm">sudoedit</code>
        will not open a file that is a symbolic link unless the
        <i class="Em">sudoedit_follow</i> flag is enabled. The
        <code class="Dv">FOLLOW</code> and <code class="Dv">NOFOLLOW</code> tags
        override the value of <i class="Em">sudoedit_follow</i> and can be used
        to permit (or deny) the editing of symbolic links on a per-command
        basis. These tags are only effective for the <i class="Em">sudoedit</i>
        command and are ignored for all other commands.</p>
  </dd>
  <dt id="LOG_INPUT"><a class="permalink" href="#LOG_INPUT"><code class="Dv">LOG_INPUT</code></a>
    <span class="No">and</span> <code class="Dv">NOLOG_INPUT</code></dt>
  <dd>
    <p class="Pp">These tags override the value of the
        <i class="Em">log_input</i> flag on a per-command basis. For more
        information, see <a class="Sx" href="#I/O_LOGGING">I/O LOGGING</a>.</p>
  </dd>
  <dt id="LOG_OUTPUT"><a class="permalink" href="#LOG_OUTPUT"><code class="Dv">LOG_OUTPUT</code></a>
    <span class="No">and</span> <code class="Dv">NOLOG_OUTPUT</code></dt>
  <dd>
    <p class="Pp">These tags override the value of the
        <i class="Em">log_output</i> flag on a per-command basis. For more
        information, see <a class="Sx" href="#I/O_LOGGING">I/O LOGGING</a>.</p>
  </dd>
  <dt id="MAIL"><a class="permalink" href="#MAIL"><code class="Dv">MAIL</code></a>
    <span class="No">and</span> <code class="Dv">NOMAIL</code></dt>
  <dd>
    <p class="Pp">These tags provide fine-grained control over whether mail will
        be sent when a user runs a command by overriding the value of the
        <i class="Em">mail_all_cmnds</i> flag on a per-command basis. They have
        no effect when <code class="Nm">sudo</code> is run with the
        <code class="Fl">-l</code> or <code class="Fl">-v</code> options. A
        <code class="Dv">NOMAIL</code> tag will also override the
        <i class="Em">mail_always</i> and <i class="Em">mail_no_perms</i>
        options. For more information, see the descriptions of
        <i class="Em">mail_all_cmnds</i>, <i class="Em">mail_always</i>, and
        <i class="Em">mail_no_perms</i> in the
        <a class="Sx" href="#SUDOERS_OPTIONS">SUDOERS OPTIONS</a> section
      below.</p>
  </dd>
  <dt id="PASSWD"><a class="permalink" href="#PASSWD"><code class="Dv">PASSWD</code></a>
    <span class="No">and</span> <code class="Dv">NOPASSWD</code></dt>
  <dd>
    <p class="Pp">By default, <code class="Nm">sudo</code> requires that a user
        authenticate before running a command. This behavior can be modified via
        the <code class="Dv">NOPASSWD</code> tag. Like a
        <i class="Em">Runas_Spec</i>, the <code class="Dv">NOPASSWD</code> tag
        sets a default for the commands that follow it in the
        <i class="Em">Cmnd_Spec_List</i>. Conversely, the
        <code class="Dv">PASSWD</code> tag can be used to reverse things. For
        example:</p>
    <div class="Bd Pp Li">
    <pre>ray	rushmore = NOPASSWD: /bin/kill, /bin/ls, /usr/bin/lprm</pre>
    </div>
    <p class="Pp">would allow the user <b class="Sy">ray</b> to run
        <span class="Pa">/bin/kill</span>, <span class="Pa">/bin/ls</span>, and
        <span class="Pa">/usr/bin/lprm</span> as <b class="Sy">root</b> on the
        machine &#x201C;rushmore&#x201D; without authenticating himself. If we
        only want <b class="Sy">ray</b> to be able to run
        <span class="Pa">/bin/kill</span> without a password the entry would
      be:</p>
    <div class="Bd Pp Li">
    <pre>ray	rushmore = NOPASSWD: /bin/kill, PASSWD: /bin/ls, /usr/bin/lprm</pre>
    </div>
    <p class="Pp">Note, however, that the <code class="Dv">PASSWD</code> tag has
        no effect on users who are in the group specified by the
        <i class="Em">exempt_group</i> setting.</p>
    <p class="Pp" id="verifypw">By default, if the
        <code class="Dv">NOPASSWD</code> tag is applied to any of a user's
        entries for the current host, the user will be able to run
        &#x2018;<code class="Li">sudo -l</code>&#x2019; without a password.
        Additionally, a user may only run &#x2018;<code class="Li">sudo
        -v</code>&#x2019; without a password if all of the user's entries for
        the current host have the <code class="Dv">NOPASSWD</code> tag. This
        behavior may be overridden via the
        <a class="permalink" href="#verifypw"><i class="Em">verifypw</i></a> and
        <a class="permalink" href="#listpw"><i class="Em" id="listpw">listpw</i></a>
        options.</p>
  </dd>
  <dt id="SETENV"><a class="permalink" href="#SETENV"><code class="Dv">SETENV</code></a>
    <span class="No">and</span> <code class="Dv">NOSETENV</code></dt>
  <dd>
    <p class="Pp">These tags override the value of the <i class="Em">setenv</i>
        flag on a per-command basis. If <code class="Dv">SETENV</code> has been
        set for a command, the user may disable the <i class="Em">env_reset</i>
        flag from the command line via the <code class="Fl">-E</code> option.
        Additionally, environment variables set on the command line are not
        subject to the restrictions imposed by <i class="Em">env_check</i>,
        <i class="Em">env_delete</i>, or <i class="Em">env_keep</i>. As such,
        only trusted users should be allowed to set variables in this manner. If
        the command matched is <b class="Sy">ALL</b>, the
        <code class="Dv">SETENV</code> tag is implied for that command; this
        default may be overridden by use of the <code class="Dv">NOSETENV</code>
        tag.</p>
  </dd>
  <dt id="INTERCEPT"><a class="permalink" href="#INTERCEPT"><code class="Dv">INTERCEPT</code></a>
    <span class="No">and</span> <code class="Dv">NOINTERCEPT</code></dt>
  <dd>
    <p class="Pp">If <code class="Nm">sudo</code> has been compiled with
        <i class="Em">intercept</i> support and the underlying operating system
        supports it, the <code class="Dv">INTERCEPT</code> tag can be used to
        cause programs spawned by a command to be validated against
        <i class="Em">sudoers</i> and logged just like they would be if run
        through <code class="Nm">sudo</code> directly. This is useful in
        conjunction with commands that allow shell escapes such as editors,
        shells, and paginators. There is additional overhead due to the policy
        check that may add latency when running commands such as shell scripts
        that execute a large number of sub-commands. For interactive commands,
        such as a shell or editor, the overhead is not usually noticeable.</p>
    <p class="Pp">In the following example, user <b class="Sy">chuck</b> may run
        any command on the machine &#x201C;research&#x201D; in intercept
      mode.</p>
    <div class="Bd Pp Li">
    <pre>chuck	research = INTERCEPT: ALL</pre>
    </div>
    <p class="Pp">See the
        <a class="Sx" href="#Preventing_shell_escapes">Preventing shell
        escapes</a> section below for more details on how
        <code class="Dv">INTERCEPT</code> works and whether or not it will work
        on your system.</p>
  </dd>
</dl>
</section>
<section class="Ss">
<h3 class="Ss" id="Wildcards"><a class="permalink" href="#Wildcards">Wildcards</a></h3>
<p class="Pp"><code class="Nm">sudo</code> allows shell-style
    <i class="Em">wildcards</i> (aka meta or glob characters) to be used in host
    names, path names, and command line arguments in the
    <i class="Em">sudoers</i> file. Wildcard matching is done via the
    <a class="Xr" aria-label="glob, section 3">glob(3)</a> and
    <a class="Xr" aria-label="fnmatch, section 3">fnmatch(3)</a> functions as
    specified by <span class="St">IEEE Std 1003.1
    (&#x201C;POSIX.1&#x201D;)</span>.</p>
<dl class="Bl-tag">
  <dt>*</dt>
  <dd>Matches any set of zero or more characters (including white space).</dd>
  <dt>?</dt>
  <dd>Matches any single character (including white space).</dd>
  <dt>[...]</dt>
  <dd>Matches any character in the specified range.</dd>
  <dt>[!...]</dt>
  <dd>Matches any character <i class="Em">not</i> in the specified range.</dd>
  <dt>\x</dt>
  <dd>For any character &#x2018;x&#x2019;, evaluates to &#x2018;x&#x2019;. This
      is used to escape special characters such as:
      &#x2018;<code class="Li">*</code>&#x2019;,
      &#x2018;<code class="Li">?</code>&#x2019;,
      &#x2018;<code class="Li">[</code>&#x2019;, and
      &#x2018;<code class="Li">]</code>&#x2019;.</dd>
</dl>
<p class="Pp"></p>
<div class="Bf Sy">These are not regular expressions.</div>
Unlike a regular expression there is no way to match one or more characters
  within a range.
<p class="Pp">Character classes may be used if your system's
    <a class="Xr" aria-label="glob, section 3">glob(3)</a> and
    <a class="Xr" aria-label="fnmatch, section 3">fnmatch(3)</a> functions
    support them. However, because the &#x2018;<code class="Li">:</code>&#x2019;
    character has special meaning in <i class="Em">sudoers</i>, it must be
    escaped. For example:</p>
<div class="Bd Pp Bd-indent Li">
<pre>/bin/ls [[\:alpha\:]]*</pre>
</div>
<p class="Pp">Would match any file name beginning with a letter.</p>
<p class="Pp">A forward slash (&#x2018;<code class="Li">/</code>&#x2019;) will
    <i class="Em">not</i> be matched by wildcards used in the file name portion
    of the command. This is to make a path like:</p>
<div class="Bd Pp Bd-indent Li">
<pre>/usr/bin/*</pre>
</div>
<p class="Pp">match <span class="Pa">/usr/bin/who</span> but not
    <span class="Pa">/usr/bin/X11/xterm</span>.</p>
<p class="Pp" id="does">When matching the command line arguments, however, a
    slash <a class="permalink" href="#does"><i class="Em">does</i></a> get
    matched by wildcards since command line arguments may contain arbitrary
    strings and not just path names.</p>
<p class="Pp"></p>
<div class="Bf Sy">Wildcards in command line arguments should be used with
  care.</div>
<br/>
Wildcards can match any character, including white space. In most cases, it is
  safer to use a regular expression to match command line arguments. For more
  information, see
  <a class="Sx" href="#Wildcards_in_command_arguments">Wildcards in command
  arguments</a> below.
</section>
<section class="Ss">
<h3 class="Ss" id="Exceptions_to_wildcard_rules"><a class="permalink" href="#Exceptions_to_wildcard_rules">Exceptions
  to wildcard rules</a></h3>
<p class="Pp">The following exceptions apply to the above rules:</p>
<dl class="Bl-tag">
  <dt>&quot;&quot;</dt>
  <dd>If the empty string &#x2018;<code class="Li">&quot;&quot;</code>&#x2019;
      is the only command line argument in the <i class="Em">sudoers</i> file
      entry it means that command is not allowed to be run with
      <i class="Em">any</i> arguments.</dd>
  <dt>sudoedit</dt>
  <dd>Command line arguments to the <i class="Em">sudoedit</i> built-in command
      should always be path names, so a forward slash
      (&#x2018;<code class="Li">/</code>&#x2019;) will not be matched by a
      wildcard.</dd>
</dl>
</section>
<section class="Ss">
<h3 class="Ss" id="Regular_expressions"><a class="permalink" href="#Regular_expressions">Regular
  expressions</a></h3>
<p class="Pp">Starting with version 1.9.10, it is possible to use regular
    expressions for path names and command line arguments. Regular expressions
    are more expressive than shell-style <i class="Em">wildcards</i> and are
    usually safer because they provide a greater degree of control when
    matching. The type of regular expressions supported by
    <code class="Nm">sudoers</code> are POSIX extended regular expressions,
    similar to those used by the <a class="Xr" aria-label="egrep, section
    1">egrep(1)</a> utility. They are usually documented in the
    <a class="Xr" aria-label="regex, section
    @mansectmisc@">regex(@mansectmisc@)</a> or
    <a class="Xr" aria-label="re_format, section
    @mansectmisc@">re_format(@mansectmisc@)</a> manual, depending on the system.
    As an extension, if the regular expression begins with &#x201C;(?i)&#x201D;,
    it will be matched in a case-insensitive manner.</p>
<p class="Pp">In <i class="Em">sudoers</i>, regular expressions must start with
    a &#x2018;<code class="Li">^</code>&#x2019; character and end with a
    &#x2018;<code class="Li">$</code>&#x2019;. This makes it explicit what is,
    or is not, a regular expression. Either the path name, the command line
    arguments or both may be regular expressions. Because the path name and
    arguments are matched separately, it is even possible to use wildcards for
    the path name and regular expressions for the arguments. It is not possible
    to use a single regular expression to match both the command and its
    arguments. Regular expressions in <i class="Em">sudoers</i> are limited to
    1024 characters.</p>
<p class="Pp">There is no need to escape <i class="Em">sudoers</i> special
    characters in a regular expression other than the pound sign
    (&#x2018;<code class="Li">#</code>&#x2019;).</p>
<p class="Pp">In the following example, user <b class="Sy">john</b> can run the
    <a class="Xr" aria-label="passwd, section 1">passwd(1)</a> command as
    <b class="Sy">root</b> on any host but is not allowed to change
    <b class="Sy">root</b><span class="No">'s</span> password. This kind of rule
    is impossible to express safely using wildcards.</p>
<div class="Bd Pp Bd-indent Li">
<pre>john	ALL = /usr/bin/passwd ^[a-zA-Z0-9_]+$,\
              !/usr/bin/passwd root</pre>
</div>
<p class="Pp">It is also possible to use a regular expression in conjunction
    with <code class="Nm">sudoedit</code> rules. The following rule would give
    user bob the ability to edit the <span class="Pa">/etc/motd</span>,
    <span class="Pa">/etc/issue</span>, and <span class="Pa">/etc/hosts</span>
    files only.</p>
<div class="Bd Pp Bd-indent Li">
<pre>bob    ALL = sudoedit ^/etc/(motd|issue|hosts)$</pre>
</div>
<p class="Pp" id="sid">Regular expressions may also be used to match the command
    itself. In this example, a regular expression is used to allow user
    <a class="permalink" href="#sid"><b class="Sy">sid</b></a> to run the
    <span class="Pa">/usr/sbin/groupadd</span>,
    <span class="Pa">/usr/sbin/groupmod</span>,
    <span class="Pa">/usr/sbin/groupdel</span>,
    <span class="Pa">/usr/sbin/useradd</span>,
    <span class="Pa">/usr/sbin/usermod</span>, and
    <span class="Pa">/usr/sbin/userdel</span> commands as
    <b class="Sy">root</b>.</p>
<div class="Bd Pp Bd-indent Li">
<pre>sid    ALL = ^/usr/sbin/(group|user)(add|mod|del)$</pre>
</div>
<p class="Pp" id="strongly">One disadvantage of using a regular expression to
    match the command name is that it is not possible to match relative paths
    such as <span class="Pa">./useradd</span> or
    <span class="Pa">../sbin/useradd</span>. This has security implications when
    a regular expression is used for the command name in conjunction with the
    negation operator, &#x2018;<code class="Li">!</code>&#x2019;, as such rules
    can be trivially bypassed. Because of this, using a negated regular
    expression for the command name is
    <a class="permalink" href="#strongly"><b class="Sy">strongly
    discouraged</b></a>. This does not apply to negated commands that only use a
    regular expression to match the command arguments. See
    <a class="Sx" href="#Regular_expressions_in_command_names">Regular
    expressions in command names</a> below for more information.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Including_other_files_from_within_sudoers"><a class="permalink" href="#Including_other_files_from_within_sudoers">Including
  other files from within sudoers</a></h3>
<p class="Pp">It is possible to include other <i class="Em">sudoers</i> files
    from within the <i class="Em">sudoers</i> file currently being parsed using
    the <i class="Em">@include</i> and <i class="Em">@includedir</i> directives.
    For compatibility with sudo versions prior to 1.9.1,
    <a class="permalink" href="#_include"><i class="Em" id="_include">#include</i></a>
    and
    <a class="permalink" href="#_includedir"><i class="Em" id="_includedir">#includedir</i></a>
    are also accepted.</p>
<p class="Pp">An include file can be used, for example, to keep a site-wide
    <i class="Em">sudoers</i> file in addition to a local, per-machine file. For
    the sake of this example the site-wide <i class="Em">sudoers</i> file will
    be <span class="Pa">/etc/sudoers</span> and the per-machine one will be
    <span class="Pa">/etc/sudoers.local</span>. To include
    <span class="Pa">/etc/sudoers.local</span> from within
    <span class="Pa">/etc/sudoers</span> one would use the following line in
    <span class="Pa">/etc/sudoers</span>:</p>
<div class="Bd Pp Bd-indent Li">
<pre>@include /etc/sudoers.local</pre>
</div>
<p class="Pp">When <code class="Nm">sudo</code> reaches this line it will
    suspend processing of the current file
    (<span class="Pa">/etc/sudoers</span>) and switch to
    <span class="Pa">/etc/sudoers.local</span>. Upon reaching the end of
    <span class="Pa">/etc/sudoers.local</span>, the rest of
    <span class="Pa">/etc/sudoers</span> will be processed. Files that are
    included may themselves include other files. A hard limit of 128 nested
    include files is enforced to prevent include file loops.</p>
<p class="Pp">Starting with version 1.9.1, the path to the include file may
    contain white space if it is escaped with a backslash
    (&#x2018;<code class="Li">\</code>&#x2019;). Alternately, the entire path
    may be enclosed in double quotes (&quot;&quot;), in which case no escaping
    is necessary. To include a literal backslash in the path,
    &#x2018;<code class="Li">\\</code>&#x2019; should be used.</p>
<p class="Pp">If the path to the include file is not fully-qualified (does not
    begin with a &#x2018;<code class="Li">/</code>&#x2019;), it must be located
    in the same directory as the sudoers file it was included from. For example,
    if <span class="Pa">/etc/sudoers</span> contains the line:</p>
<div class="Bd Pp Bd-indent Li">
<pre>@include sudoers.local</pre>
</div>
<p class="Pp">the file that will be included is
    <span class="Pa">/etc/sudoers.local</span>.</p>
<p class="Pp">The file name may also include the
    &#x2018;<code class="Li">%h</code>&#x2019; escape, signifying the short form
    of the host name. In other words, if the machine's host name is
    &#x201C;xerxes&#x201D;, then</p>
<div class="Bd Pp Bd-indent Li">
<pre>@include /etc/sudoers.%h</pre>
</div>
<p class="Pp">will cause <code class="Nm">sudo</code> to include the file
    <span class="Pa">/etc/sudoers.xerxes</span>. Any path name separator
    characters (&#x2018;<code class="Li">/</code>&#x2019;) present in the host
    name will be replaced with an underbar
    (&#x2018;<code class="Li">_</code>&#x2019;) during expansion.</p>
<p class="Pp">The <i class="Em">@includedir</i> directive can be used to create
    a <span class="Pa">sudoers.d</span> directory that the system package
    manager can drop <i class="Em">sudoers</i> file rules into as part of
    package installation. For example, given:</p>
<div class="Bd Pp Bd-indent Li">
<pre>@includedir /etc/sudoers.d</pre>
</div>
<p class="Pp"><code class="Nm">sudo</code> will suspend processing of the
    current file and read each file in <span class="Pa">/etc/sudoers.d</span>,
    skipping file names that end in &#x2018;<code class="Li">~</code>&#x2019; or
    contain a &#x2018;<code class="Li">.</code>&#x2019; character to avoid
    causing problems with package manager or editor temporary/backup files.</p>
<p class="Pp" id="after">Files are parsed in sorted lexical order. That is,
    <span class="Pa">/etc/sudoers.d/01_first</span> will be parsed before
    <span class="Pa">/etc/sudoers.d/10_second</span>. Be aware that because the
    sorting is lexical, not numeric,
    <span class="Pa">/etc/sudoers.d/1_whoops</span> would be loaded
    <a class="permalink" href="#after"><i class="Em">after</i></a>
    <span class="Pa">/etc/sudoers.d/10_second</span>. Using a consistent number
    of leading zeroes in the file names can be used to avoid such problems.
    After parsing the files in the directory, control returns to the file that
    contained the <i class="Em">@includedir</i> directive.</p>
<p class="Pp">Unlike files included via <i class="Em">@include</i>,
    <code class="Nm">visudo</code> will not edit the files in a
    <i class="Em">@includedir</i> directory unless one of them contains a syntax
    error. It is still possible to run <code class="Nm">visudo</code> with the
    <code class="Fl">-f</code> flag to edit the files directly, but this will
    not catch the redefinition of an <i class="Em">alias</i> that is also
    present in a different file.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Other_special_characters_and_reserved_words"><a class="permalink" href="#Other_special_characters_and_reserved_words">Other
  special characters and reserved words</a></h3>
<p class="Pp">The pound sign (&#x2018;<code class="Li">#</code>&#x2019;) is used
    to indicate a comment (unless it is part of a #include directive or unless
    it occurs in the context of a user name and is followed by one or more
    digits, in which case it is treated as a user-ID). Both the comment
    character and any text after it, up to the end of the line, are ignored.</p>
<p class="Pp">The reserved word <b class="Sy">ALL</b> is a built-in
    <i class="Em">alias</i> that always causes a match to succeed. It can be
    used wherever one might otherwise use a <i class="Em">Cmnd_Alias</i>,
    <i class="Em">User_Alias</i>, <i class="Em">Runas_Alias</i>, or
    <i class="Em">Host_Alias</i>. Attempting to define an
    <i class="Em">alias</i> named <b class="Sy">ALL</b> will result in a syntax
    error. Using <b class="Sy">ALL</b> can be dangerous since in a command
    context, it allows the user to run <i class="Em">any</i> command on the
    system.</p>
<p class="Pp">The following option names permitted in an
    <i class="Em">Option_Spec</i> are also considered reserved words:
    <code class="Dv">CHROOT</code>, <code class="Dv">PRIVS</code>,
    <code class="Dv">LIMITPRIVS</code>, <code class="Dv">ROLE</code>,
    <code class="Dv">TYPE</code>, <code class="Dv">TIMEOUT</code>,
    <code class="Dv">CWD</code>, <code class="Dv">NOTBEFORE</code> and
    <code class="Dv">NOTAFTER</code>. Attempting to define an
    <i class="Em">alias</i> with the same name as one of the options will result
    in a syntax error.</p>
<p class="Pp">An exclamation point (&#x2018;<code class="Li">!</code>&#x2019;)
    can be used as a logical <i class="Em">not</i> operator in a list or
    <i class="Em">alias</i> as well as in front of a <i class="Em">Cmnd</i>.
    This allows one to exclude certain values. For the
    &#x2018;<code class="Li">!</code>&#x2019; operator to be effective, there
    must be something for it to exclude. For example, to match all users except
    for <b class="Sy">root</b> one would use:</p>
<div class="Bd Pp Bd-indent Li">
<pre>ALL, !root</pre>
</div>
<p class="Pp">If the <b class="Sy">ALL</b>, is omitted, as in:</p>
<div class="Bd Pp Bd-indent Li">
<pre>!root</pre>
</div>
<p class="Pp">it would explicitly deny <b class="Sy">root</b> but not match any
    other users. This is different from a true &#x201C;negation&#x201D;
    operator.</p>
<p class="Pp">Note, however, that using a
    &#x2018;<code class="Li">!</code>&#x2019; in conjunction with the built-in
    <b class="Sy">ALL</b> alias to allow a user to run &#x201C;all but a
    few&#x201D; commands rarely works as intended (see
    <a class="Sx" href="#SECURITY_NOTES">SECURITY NOTES</a> below).</p>
<p class="Pp">Long lines can be continued with a backslash
    (&#x2018;<code class="Li">\</code>&#x2019;) as the last character on the
    line.</p>
<p class="Pp">White space between elements in a list as well as special
    syntactic characters in a <i class="Em">User Specification</i>
    (&#x2018;<code class="Li">=</code>&#x2019;,
    &#x2018;<code class="Li">:</code>&#x2019;,
    &#x2018;<code class="Li">(</code>&#x2019;,
    &#x2018;<code class="Li">)</code>&#x2019;) is optional.</p>
<p class="Pp">The following characters must be escaped with a backslash
    (&#x2018;<code class="Li">\</code>&#x2019;) when used as part of a word
    (e.g., a user name or host name): &#x2018;<code class="Li">!</code>&#x2019;,
    &#x2018;<code class="Li">=</code>&#x2019;,
    &#x2018;<code class="Li">:</code>&#x2019;,
    &#x2018;<code class="Li">,</code>&#x2019;,
    &#x2018;<code class="Li">(</code>&#x2019;,
    &#x2018;<code class="Li">)</code>&#x2019;,
    &#x2018;<code class="Li">\</code>&#x2019;.</p>
</section>
</section>
<section class="Sh">
<h2 class="Sh" id="SUDOERS_OPTIONS"><a class="permalink" href="#SUDOERS_OPTIONS">SUDOERS
  OPTIONS</a></h2>
<p class="Pp"><code class="Nm">sudo</code>'s behavior can be modified by
    <i class="Em">Default_Entry</i> lines, as explained earlier. A list of all
    supported Defaults parameters, grouped by type, are listed below.</p>
<p class="Pp" id="Boolean"><a class="permalink" href="#Boolean"><b class="Sy">Boolean
    Flags</b></a>:</p>
<dl class="Bl-tag">
  <dt>always_query_group_plugin</dt>
  <dd>If a <i class="Em">group_plugin</i> is configured, use it to resolve
      groups of the form &#x2018;<code class="Li">%group</code>&#x2019; as long
      as there is not also a system group of the same name. Normally, only
      groups of the form &#x2018;<code class="Li">%:group</code>&#x2019; are
      passed to the <i class="Em">group_plugin</i>. This flag is
      <i class="Em">off</i> by default.</dd>
  <dt>always_set_home</dt>
  <dd>If enabled, <code class="Nm">sudo</code> will set the
      <code class="Ev">HOME</code> environment variable to the home directory of
      the target user (which is the <i class="Em">runas_default</i> user unless
      the <code class="Fl">-u</code> option is used). This flag is largely
      obsolete and has no effect unless the <i class="Em">env_reset</i> flag has
      been disabled or <code class="Ev">HOME</code> is present in the
      <i class="Em">env_keep</i> list, both of which are strongly discouraged.
      This flag is <i class="Em">off</i> by default.</dd>
  <dt>authenticate</dt>
  <dd>If set, users must authenticate themselves via a password (or other means
      of authentication) before they may run commands. This default may be
      overridden via the <code class="Dv">PASSWD</code> and
      <code class="Dv">NOPASSWD</code> tags. This flag is <i class="Em">on</i>
      by default.</dd>
  <dt>case_insensitive_group</dt>
  <dd>If enabled, group names in <i class="Em">sudoers</i> will be matched in a
      case insensitive manner. This may be necessary when users are stored in
      LDAP or AD. This flag is <i class="Em">on</i> by default.</dd>
  <dt>case_insensitive_user</dt>
  <dd>If enabled, user names in <i class="Em">sudoers</i> will be matched in a
      case insensitive manner. This may be necessary when groups are stored in
      LDAP or AD. This flag is <i class="Em">on</i> by default.</dd>
  <dt>closefrom_override</dt>
  <dd>If set, the user may use the <code class="Fl">-C</code> option which
      overrides the default starting point at which <code class="Nm">sudo</code>
      begins closing open file descriptors. This flag is <i class="Em">off</i>
      by default.</dd>
  <dt>compress_io</dt>
  <dd>If set, and <code class="Nm">sudo</code> is configured to log a command's
      input or output, the I/O logs will be compressed using
      <b class="Sy">zlib</b>. This flag is <i class="Em">on</i> by default when
      <code class="Nm">sudo</code> is compiled with <b class="Sy">zlib</b>
      support.</dd>
  <dt id="exec_background">exec_background</dt>
  <dd>By default, <code class="Nm">sudo</code> runs a command as the foreground
      process as long as <code class="Nm">sudo</code> itself is running in the
      foreground. When the
      <a class="permalink" href="#exec_background"><i class="Em">exec_background</i></a>
      flag is enabled and the command is being run in a pseudo-terminal (due to
      I/O logging or the <i class="Em">use_pty</i> flag), the command will be
      run as a background process. Attempts to read from the controlling
      terminal (or to change terminal settings) will result in the command being
      suspended with the <code class="Dv">SIGTTIN</code> signal (or
      <code class="Dv">SIGTTOU</code> in the case of terminal settings). If this
      happens when <code class="Nm">sudo</code> is a foreground process, the
      command will be granted the controlling terminal and resumed in the
      foreground with no user intervention required. The advantage of initially
      running the command in the background is that <code class="Nm">sudo</code>
      need not read from the terminal unless the command explicitly requests it.
      Otherwise, any terminal input must be passed to the command, whether it
      has required it or not (the kernel buffers terminals so it is not possible
      to tell whether the command really wants the input). This is different
      from historic <i class="Em">sudo</i> behavior or when the command is not
      being run in a pseudo-terminal.
    <p class="Pp">For this to work seamlessly, the operating system must support
        the automatic restarting of system calls. Unfortunately, not all
        operating systems do this by default, and even those that do may have
        bugs. For example, macOS fails to restart the
        <a class="Xr" aria-label="tcgetattr, section 3">tcgetattr(3)</a> and
        <a class="Xr" aria-label="tcsetattr, section 3">tcsetattr(3)</a>
        functions (this is a bug in macOS). Furthermore, because this behavior
        depends on the command stopping with the <code class="Dv">SIGTTIN</code>
        or <code class="Dv">SIGTTOU</code> signals, programs that catch these
        signals and suspend themselves with a different signal (usually
        <code class="Dv">SIGTOP</code>) will not be automatically foregrounded.
        Some versions of the linux <a class="Xr" aria-label="su, section
        1">su(1)</a> command behave this way. This flag is <i class="Em">off</i>
        by default.</p>
    <p class="Pp">This setting is only supported by version 1.8.7 or higher. It
        has no effect unless I/O logging is enabled or the
        <i class="Em">use_pty</i> flag is enabled.</p>
  </dd>
  <dt id="env_editor">env_editor</dt>
  <dd>If set, <code class="Nm">visudo</code> will use the value of the
      <code class="Ev">SUDO_EDITOR</code>, <code class="Ev">VISUAL</code> or
      <code class="Ev">EDITOR</code> environment variables before falling back
      on the default editor list. <code class="Nm">visudo</code> is typically
      run as <b class="Sy">root</b> so this flag may allow a user with
      <code class="Nm">visudo</code> privileges to run arbitrary commands as
      <b class="Sy">root</b> without logging. An alternative is to place a
      colon-separated list of &#x201C;safe&#x201D; editors int the
      <i class="Em">editor</i> setting. <code class="Nm">visudo</code> will then
      only use <code class="Ev">SUDO_EDITOR</code>,
      <code class="Ev">VISUAL</code> or <code class="Ev">EDITOR</code> if they
      match a value specified in <i class="Em">editor</i>. If the
      <i class="Em">env_reset</i> flag is enabled, the
      <code class="Ev">SUDO_EDITOR</code>, <code class="Ev">VISUAL</code> and/or
      <code class="Ev">EDITOR</code> environment variables must be present in
      the <i class="Em">env_keep</i> list for the
      <a class="permalink" href="#env_editor"><i class="Em">env_editor</i></a>
      flag to function when <code class="Nm">visudo</code> is invoked via
      <code class="Nm">sudo</code>. This flag is <i class="Em">on</i> by
      default.</dd>
  <dt>env_reset</dt>
  <dd>If set, <code class="Nm">sudo</code> will run the command in a minimal
      environment containing the <code class="Ev">TERM</code>,
      <code class="Ev">PATH</code>, <code class="Ev">HOME</code>,
      <code class="Ev">MAIL</code>, <code class="Ev">SHELL</code>,
      <code class="Ev">LOGNAME</code>, <code class="Ev">USER</code> and
      <code class="Ev">SUDO_*</code> variables. Any variables in the caller's
      environment or in the file specified by the
      <i class="Em">restricted_env_file</i> setting that match the
      <i class="Em">env_keep</i> and <i class="Em">env_check</i> lists are then
      added, followed by any variables present in the file specified by the
      <i class="Em">env_file</i> setting (if any). The contents of the
      <i class="Em">env_keep</i> and <i class="Em">env_check</i> lists, as
      modified by global Defaults parameters in <i class="Em">sudoers</i>, are
      displayed when <code class="Nm">sudo</code> is run by
      <b class="Sy">root</b> with the <code class="Fl">-V</code> option. If the
      <i class="Em">secure_path</i> setting is enabled, its value will be used
      for the <code class="Ev">PATH</code> environment variable. This flag is
      <i class="Em">on</i> by default.</dd>
  <dt>fast_glob</dt>
  <dd>Normally, <code class="Nm">sudo</code> uses the
      <a class="Xr" aria-label="glob, section 3">glob(3)</a> function to do
      shell-style globbing when matching path names. However, since it accesses
      the file system, <a class="Xr" aria-label="glob, section 3">glob(3)</a>
      can take a long time to complete for some patterns, especially when the
      pattern references a network file system that is mounted on demand (auto
      mounted). The <i class="Em">fast_glob</i> flag causes
      <code class="Nm">sudo</code> to use the <a class="Xr" aria-label="fnmatch,
      section 3">fnmatch(3)</a> function, which does not access the file system
      to do its matching. The disadvantage of <i class="Em">fast_glob</i> is
      that it is unable to match relative paths such as
      <span class="Pa">./ls</span> or <span class="Pa">../bin/ls</span>. This
      has security implications when path names that include globbing characters
      are used with the negation operator,
      &#x2018;<code class="Li">!</code>&#x2019;, as such rules can be trivially
      bypassed. As such, this flag should not be used when the
      <i class="Em">sudoers</i> file contains rules that contain negated path
      names which include globbing characters. This flag is
      <i class="Em">off</i> by default.</dd>
  <dt id="passprompt_regex">log_passwords</dt>
  <dd>Most programs that require a user's password will disable echo before
      reading the password to avoid displaying the plaintext password on the
      screen. However, if terminal input is being logged (see
      <a class="Sx" href="#I/O_LOGGING">I/O LOGGING</a>), the password will
      still be present in the I/O log. If the <i class="Em">log_passwords</i>
      option is disabled, <code class="Nm">sudoers</code> will attempt to
      prevent passwords from being logged. It does this by using the regular
      expressions in
      <a class="permalink" href="#passprompt_regex"><i class="Em">passprompt_regex</i></a>
      to match a password prompt in the terminal output buffer. When a match is
      found, input characters in the I/O log will be replaced with
      &#x2018;<code class="Li">*</code>&#x2019; until either a line feed or
      carriage return is found in the terminal input or a new terminal output
      buffer is received. If, however, a program displays characters as the user
      types (such as <code class="Nm">sudo</code> when
      <i class="Em">pwfeedback</i> is set), only the first character of the
      password will be replaced in the I/O log. This option has no effect unless
      <i class="Em">log_input</i> or <i class="Em">log_ttyin</i> are also set.
      This flag is <i class="Em">on</i> by default.
    <p class="Pp">This setting is only supported by version 1.9.10 or
      higher.</p>
  </dd>
  <dt>fqdn</dt>
  <dd>Set this flag if you want to put fully qualified host names in the
      <i class="Em">sudoers</i> file when the local host name (as returned by
      the &#x2018;<code class="Li">hostname</code>&#x2019; command) does not
      contain the domain name. In other words, instead of myhost you would use
      myhost.mydomain.edu. You may still use the short form if you wish (and
      even mix the two). This flag is only effective when the
      &#x201C;canonical&#x201D; host name, as returned by the
      <a class="Xr" aria-label="getaddrinfo, section 3">getaddrinfo(3)</a> or
      <a class="Xr" aria-label="gethostbyname, section 3">gethostbyname(3)</a>
      function, is a fully-qualified domain name. This is usually the case when
      the system is configured to use DNS for host name resolution.
    <p class="Pp">If the system is configured to use the
        <span class="Pa">/etc/hosts</span> file in preference to DNS, the
        &#x201C;canonical&#x201D; host name may not be fully-qualified. The
        order that sources are queried for host name resolution is usually
        specified in the <span class="Pa">/etc/nsswitch.conf</span>,
        <span class="Pa">/etc/netsvc.conf</span>,
        <span class="Pa">/etc/host.conf</span>, or, in some cases,
        <span class="Pa">/etc/resolv.conf</span> file. In the
        <span class="Pa">/etc/hosts</span> file, the first host name of the
        entry is considered to be the &#x201C;canonical&#x201D; name; subsequent
        names are aliases that are not used by <code class="Nm">sudoers</code>.
        For example, the following hosts file line for the machine
        &#x201C;xyzzy&#x201D; has the fully-qualified domain name as the
        &#x201C;canonical&#x201D; host name, and the short version as an
      alias.</p>
    <p class="Pp"></p>
    <div class="Bd Bd-indent"><code class="Li">192.168.1.1 xyzzy.sudo.ws
      xyzzy</code></div>
    <p class="Pp">If the machine's hosts file entry is not formatted properly,
        the <i class="Em">fqdn</i> flag will not be effective if it is queried
        before DNS.</p>
    <p class="Pp">Beware that when using DNS for host name resolution, turning
        on <i class="Em">fqdn</i> requires <code class="Nm">sudoers</code> to
        make DNS lookups which renders <code class="Nm">sudo</code> unusable if
        DNS stops working (for example if the machine is disconnected from the
        network). Just like with the hosts file, you must use the
        &#x201C;canonical&#x201D; name as DNS knows it. That is, you may not use
        a host alias (CNAME entry) due to performance issues and the fact that
        there is no way to get all aliases from DNS.</p>
    <p class="Pp">This flag is <i class="Em">off</i> by default.</p>
  </dd>
  <dt>ignore_audit_errors</dt>
  <dd>Allow commands to be run even if <code class="Nm">sudoers</code> cannot
      write to the audit log. If enabled, an audit log write failure is not
      treated as a fatal error. If disabled, a command may only be run after the
      audit event is successfully written. This flag is only effective on
      systems for which <code class="Nm">sudoers</code> supports audit logging,
      including <span class="Ux">FreeBSD</span>, Linux, macOS, and Solaris. This
      flag is <i class="Em">on</i> by default.</dd>
  <dt>ignore_dot</dt>
  <dd>If set, <code class="Nm">sudo</code> will ignore &quot;.&quot; or
      &quot;&quot; (both denoting the current directory) in the
      <code class="Ev">PATH</code> environment variable; the
      <code class="Ev">PATH</code> itself is not modified. This flag is
      <i class="Em">on</i> by default.</dd>
  <dt>ignore_iolog_errors</dt>
  <dd>Allow commands to be run even if <code class="Nm">sudoers</code> cannot
      write to the I/O log (local or remote). If enabled, an I/O log write
      failure is not treated as a fatal error. If disabled, the command will be
      terminated if the I/O log cannot be written to. This flag is
      <i class="Em">off</i> by default.</dd>
  <dt>ignore_logfile_errors</dt>
  <dd>Allow commands to be run even if <code class="Nm">sudoers</code> cannot
      write to the log file. If enabled, a log file write failure is not treated
      as a fatal error. If disabled, a command may only be run after the log
      file entry is successfully written. This flag only has an effect when
      <code class="Nm">sudoers</code> is configured to use file-based logging
      via the <i class="Em">logfile</i> setting. This flag is
      <i class="Em">on</i> by default.</dd>
  <dt>ignore_local_sudoers</dt>
  <dd>If set via LDAP, parsing of <span class="Pa">/etc/sudoers</span> will be
      skipped. This is intended for sites that wish to prevent the usage of
      local sudoers files so that only LDAP is used. This thwarts the efforts of
      rogue operators who would attempt to add roles to
      <span class="Pa">/etc/sudoers</span>. When this flag is enabled,
      <span class="Pa">/etc/sudoers</span> does not even need to exist. Since
      this flag tells <code class="Nm">sudo</code> how to behave when no
      specific LDAP entries have been matched, this sudoOption is only
      meaningful for the &#x2018;<code class="Li">cn=defaults</code>&#x2019;
      section. This flag is <i class="Em">off</i> by default.</dd>
  <dt>ignore_unknown_defaults</dt>
  <dd>If set, <code class="Nm">sudo</code> will not produce a warning if it
      encounters an unknown Defaults entry in the <i class="Em">sudoers</i> file
      or an unknown sudoOption in LDAP. This flag is <i class="Em">off</i> by
      default.</dd>
  <dt>insults</dt>
  <dd>If set, <code class="Nm">sudo</code> will insult users when they enter an
      incorrect password. This flag is <i class="Em">off</i> by default.</dd>
  <dt>log_allowed</dt>
  <dd>If set, <code class="Nm">sudoers</code> will log commands allowed by the
      policy to the system audit log (where supported) as well as to syslog
      and/or a log file. This flag is <i class="Em">on</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.29 or
      higher.</p>
  </dd>
  <dt>log_denied</dt>
  <dd>If set, <code class="Nm">sudoers</code> will log commands denied by the
      policy to the system audit log (where supported) as well as to syslog
      and/or a log file. This flag is <i class="Em">on</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.29 or
      higher.</p>
  </dd>
  <dt>log_exit_status</dt>
  <dd>If set, <code class="Nm">sudoers</code> will log the exit value of
      commands that are run to syslog and/or a log file. If a command was
      terminated by a signal, the signal name is logged as well. This flag is
      <i class="Em">off</i> by default.
    <p class="Pp">This setting is only supported by version 1.9.8 or higher.</p>
  </dd>
  <dt>log_host</dt>
  <dd>If set, the host name will be included in log entries written to the file
      configured by the <i class="Em">logfile</i> setting. This flag is
      <i class="Em">off</i> by default.</dd>
  <dt>log_input</dt>
  <dd>If set, <code class="Nm">sudo</code> will run the command in a
      pseudo-terminal (if <code class="Nm">sudo</code> was run from a terminal)
      and log all user input. If the standard input is not connected to the
      user's terminal, due to I/O redirection or because the command is part of
      a pipeline, that input is also logged. For more information about I/O
      logging, see the <a class="Sx" href="#I/O_LOGGING">I/O LOGGING</a>
      section. This flag is <i class="Em">off</i> by default.</dd>
  <dt>log_output</dt>
  <dd>If set, <code class="Nm">sudo</code> will run the command in a
      pseudo-terminal (if <code class="Nm">sudo</code> was run from a terminal)
      and log all output that is sent to the user's terminal, the standard
      output or the standard error. If the standard output or standard error is
      not connected to the user's terminal, due to I/O redirection or because
      the command is part of a pipeline, that output is also logged. For more
      information about I/O logging, see the
      <a class="Sx" href="#I/O_LOGGING">I/O LOGGING</a> section. This flag is
      <i class="Em">off</i> by default.</dd>
  <dt>log_server_keepalive</dt>
  <dd>If set, <code class="Nm">sudo</code> will enable the TCP keepalive socket
      option on the connection to the log server. This enables the periodic
      transmission of keepalive messages to the server. If the server does not
      respond to a message, the connection will be closed and the running
      command will be terminated unless the
      <i class="Em">ignore_iolog_errors</i> flag (I/O logging enabled) or the
      <i class="Em">ignore_log_errors</i> flag (I/O logging disabled) is set.
      This flag is <i class="Em">on</i> by default.
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt>log_server_verify</dt>
  <dd>If set, the server certificate received during the TLS handshake must be
      valid and it must contain either the server name (from
      <i class="Em">log_servers</i>) or its IP address. If either of these
      conditions is not met, the TLS handshake will fail. This flag is
      <i class="Em">on</i> by default.
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt>log_stderr</dt>
  <dd>If set, <code class="Nm">sudo</code> will log the standard error if it is
      not connected to the user's terminal. This can be used to log output to a
      pipe or redirected to a file. This flag is <i class="Em">off</i> by
      default but is enabled when either the <i class="Em">log_output</i> flag
      or the <code class="Dv">LOG_OUTPUT</code> command tag is set.</dd>
  <dt>log_stdin</dt>
  <dd>If set, <code class="Nm">sudo</code> will log the standard input if it is
      not connected to the user's terminal. This can be used to log input from a
      pipe or redirected from a file. This flag is <i class="Em">off</i> by
      default but is enabled when either the <i class="Em">log_input</i> flag or
      the <code class="Dv">LOG_INPUT</code> command tag is set.</dd>
  <dt>log_stdout</dt>
  <dd>If set, <code class="Nm">sudo</code> will log the standard output if it is
      not connected to the user's terminal. This can be used to log output to a
      pipe or redirected to a file. This flag is <i class="Em">off</i> by
      default but is enabled when either the <i class="Em">log_output</i> flag
      or the <code class="Dv">LOG_OUTPUT</code> command tag is set.</dd>
  <dt>log_subcmds</dt>
  <dd>If set, <code class="Nm">sudoers</code> will log when a command spawns a
      child process and executes a program using the
      <a class="Xr" aria-label="execve, section 2">execve(2)</a>,
      <a class="Xr" aria-label="execl, section 3">execl(3)</a>,
      <a class="Xr" aria-label="execle, section 3">execle(3)</a>,
      <a class="Xr" aria-label="execlp, section 3">execlp(3)</a>,
      <a class="Xr" aria-label="execv, section 3">execv(3)</a>,
      <a class="Xr" aria-label="execvp, section 3">execvp(3)</a>,
      <a class="Xr" aria-label="execvpe, section 3">execvpe(3)</a>, or
      <a class="Xr" aria-label="system, section 3">system(3)</a> library
      functions. For example, if a shell is run by <code class="Nm">sudo</code>,
      the individual commands run via the shell will be logged. This flag is
      <i class="Em">off</i> by default.
    <p class="Pp">The <i class="Em">log_subcmds</i> flag uses the same
        underlying mechanism as the <i class="Em">intercept</i> setting. Some
        commands may not work properly when <i class="Em">log_subcmds</i> is
        enabled, due to the way it intercepts sub-commands. See
        <a class="Sx" href="#Preventing_shell_escapes">Preventing shell
        escapes</a> for more information on what systems support this option and
        its limitations. This setting is only supported by version 1.9.8 or
        higher and is incompatible with SELinux RBAC support unless the system
        supports <a class="Xr" aria-label="seccomp, section 2">seccomp(2)</a>
        filter mode.</p>
  </dd>
  <dt>log_ttyin</dt>
  <dd>If set, <code class="Nm">sudo</code> will run the command in a
      pseudo-terminal and log user keystrokes sent to the user's terminal, if
      one is present. This flag is <i class="Em">off</i> by default but is
      enabled when either the <i class="Em">log_input</i> flag or the
      <code class="Dv">LOG_INPUT</code> command tag is set. If no terminal is
      present, for example when running a remote command using
      <a class="Xr" aria-label="ssh, section 1">ssh(1)</a>, this flag will have
      no effect.</dd>
  <dt>log_ttyout</dt>
  <dd>If set, <code class="Nm">sudo</code> will run the command in a
      pseudo-terminal and log all output displayed on the user's terminal, if
      one is present. This flag is <i class="Em">off</i> by default but is
      enabled when either the <i class="Em">log_output</i> flag or the
      <code class="Dv">LOG_OUTPUT</code> command tag is set. If no terminal is
      present, for example when running a remote command using
      <a class="Xr" aria-label="ssh, section 1">ssh(1)</a>, this flag will have
      no effect.</dd>
  <dt>log_year</dt>
  <dd>If set, the four-digit year will be logged in the (non-syslog)
      <code class="Nm">sudo</code> log file. This flag is <i class="Em">off</i>
      by default.</dd>
  <dt id="S/Key">long_otp_prompt</dt>
  <dd>When validating with a One Time Password (OTP) scheme such as
      <a class="permalink" href="#S/Key"><b class="Sy">S/Key</b></a> or
      <a class="permalink" href="#OPIE"><b class="Sy" id="OPIE">OPIE</b></a>, a
      two-line prompt is used to make it easier to cut and paste the challenge
      to a local window. It's not as pretty as the default but some people find
      it more convenient. This flag is <i class="Em">off</i> by default.</dd>
  <dt>mail_all_cmnds</dt>
  <dd>Send mail to the <i class="Em">mailto</i> user every time a user attempts
      to run a command via <code class="Nm">sudo</code> (this includes
      <code class="Nm">sudoedit</code>). No mail will be sent if the user runs
      <code class="Nm">sudo</code> with the <code class="Fl">-l</code> or
      <code class="Fl">-v</code> option unless there is an authentication error
      and the <i class="Em">mail_badpass</i> flag is also set. This flag is
      <i class="Em">off</i> by default.</dd>
  <dt>mail_always</dt>
  <dd>Send mail to the <i class="Em">mailto</i> user every time a user runs
      <code class="Nm">sudo</code>. This flag is <i class="Em">off</i> by
      default.</dd>
  <dt id="mail_no_host">mail_badpass</dt>
  <dd>Send mail to the <i class="Em">mailto</i> user if the user running
      <code class="Nm">sudo</code> does not enter the correct password. If the
      command the user is attempting to run is not permitted by
      <code class="Nm">sudoers</code> and one of the
      <i class="Em">mail_all_cmnds</i>, <i class="Em">mail_always</i>,
      <a class="permalink" href="#mail_no_host"><i class="Em">mail_no_host</i></a>,
      <i class="Em">mail_no_perms</i> or
      <a class="permalink" href="#mail_no_user"><i class="Em" id="mail_no_user">mail_no_user</i></a>
      flags are set, this flag will have no effect. This flag is
      <i class="Em">off</i> by default.</dd>
  <dt>mail_no_host</dt>
  <dd>If set, mail will be sent to the <i class="Em">mailto</i> user if the
      invoking user exists in the <i class="Em">sudoers</i> file, but is not
      allowed to run commands on the current host. This flag is
      <i class="Em">off</i> by default.</dd>
  <dt>mail_no_perms</dt>
  <dd>If set, mail will be sent to the <i class="Em">mailto</i> user if the
      invoking user is allowed to use <code class="Nm">sudo</code> but the
      command they are trying is not listed in their <i class="Em">sudoers</i>
      file entry or is explicitly denied. This flag is <i class="Em">off</i> by
      default.</dd>
  <dt>mail_no_user</dt>
  <dd>If set, mail will be sent to the <i class="Em">mailto</i> user if the
      invoking user is not in the <i class="Em">sudoers</i> file. This flag is
      <i class="Em">on</i> by default.</dd>
  <dt>match_group_by_gid</dt>
  <dd>By default, <code class="Nm">sudoers</code> will look up each group the
      user is a member of by group-ID to determine the group name (this is only
      done once). The resulting list of the user's group names is used when
      matching groups listed in the <i class="Em">sudoers</i> file. This works
      well on systems where the number of groups listed in the
      <i class="Em">sudoers</i> file is larger than the number of groups a
      typical user belongs to. On systems where group lookups are slow, where
      users may belong to a large number of groups, or where the number of
      groups listed in the <i class="Em">sudoers</i> file is relatively small,
      it may be prohibitively expensive and running commands via
      <code class="Nm">sudo</code> may take longer than normal. On such systems
      it may be faster to use the <i class="Em">match_group_by_gid</i> flag to
      avoid resolving the user's group-IDs to group names. In this case,
      <code class="Nm">sudoers</code> must look up any group name listed in the
      <i class="Em">sudoers</i> file and use the group-ID instead of the group
      name when determining whether the user is a member of the group.
    <p class="Pp">If <i class="Em">match_group_by_gid</i> is enabled, group
        database lookups performed by <code class="Nm">sudoers</code> will be
        keyed by group name as opposed to group-ID. On systems where there are
        multiple sources for the group database, it is possible to have
        conflicting group names or group-IDs in the local
        <span class="Pa">/etc/group</span> file and the remote group database.
        On such systems, enabling or disabling
        <i class="Em">match_group_by_gid</i> can be used to choose whether group
        database queries are performed by name (enabled) or ID (disabled), which
        may aid in working around group entry conflicts.</p>
    <p class="Pp">The <i class="Em">match_group_by_gid</i> flag has no effect
        when <i class="Em">sudoers</i> data is stored in LDAP. This flag is
        <i class="Em">off</i> by default.</p>
    <p class="Pp">This setting is only supported by version 1.8.18 or
      higher.</p>
  </dd>
  <dt>intercept</dt>
  <dd>If set, all commands run via <code class="Nm">sudo</code> will behave as
      if the <code class="Dv">INTERCEPT</code> tag has been set, unless
      overridden by an <code class="Dv">NOINTERCEPT</code> tag. Some commands
      may not work properly when <i class="Em">intercept</i> is enabled, due to
      the way it intercept sub-commands. See the description of
      <code class="Dv">INTERCEPT and NOINTERCEPT</code> above as well as the
      <a class="Sx" href="#Preventing_shell_escapes">Preventing shell
      escapes</a> section at the end of this manual. This flag is
      <i class="Em">off</i> by default.
    <p class="Pp">This setting is only supported by version 1.9.8 or higher and
        is incompatible with SELinux RBAC support unless the system supports
        <a class="Xr" aria-label="seccomp, section 2">seccomp(2)</a> filter
        mode.</p>
  </dd>
  <dt id="intercept_allow_setid">intercept_allow_setid</dt>
  <dd>On most systems, the dynamic loader will ignore
      <code class="Ev">LD_PRELOAD</code> (or the equivalent) when running
      set-user-ID and set-group-ID programs, effectively disabling intercept
      mode. To prevent this from happening, <code class="Nm">sudoers</code> will
      not permit a set-user-ID or set-group-ID program to be run in intercept
      mode unless
      <a class="permalink" href="#intercept_allow_setid"><i class="Em">intercept_allow_setid</i></a>
      is enable. This flag has no effect unless the <i class="Em">intercept</i>
      flag is enabled or the <code class="Dv">INTERCEPT</code> tag has been set
      for the command. This flag is <i class="Em">on</i> by default when the
      <i class="Em">intercept_type</i> option is set to <i class="Em">trace</i>,
      otherwise it default to <i class="Em">off</i>.
    <p class="Pp">This setting is only supported by version 1.9.8 or higher.</p>
  </dd>
  <dt>intercept_authenticate</dt>
  <dd>If set, commands run by an intercepted process must be authenticated when
      the user's time stamp is not current. For example, if a shell is run with
      <i class="Em">intercept</i> enabled, as soon as the invoking user's time
      stamp is out of date, subsequent commands will need to be authenticated.
      This flag has no effect unless the <i class="Em">intercept</i> flag is
      enabled or the <code class="Dv">INTERCEPT</code> tag has been set for the
      command. This flag is <i class="Em">off</i> by default.
    <p class="Pp">This setting is only supported by version 1.9.8 or higher.</p>
  </dd>
  <dt>intercept_verify</dt>
  <dd>If set, <code class="Nm">sudo</code> will attempt to verify that a command
      run in intercept mode has the expected path name, command line arguments
      and environment.
    <p class="Pp">The process will be stopped after
        <a class="Xr" aria-label="execve, section 2">execve(2)</a> has completed
        but before the new command has had a chance to run. To verify the
        command, <code class="Nm">sudo</code> will read the command's path from
        <span class="Pa">/proc/PID/exe</span>, the command line arguments and
        environment from the process's memory, and compare them against the
        arguments that were passed to <a class="Xr" aria-label="execve, section
        2">execve(2)</a>. In the event of a mismatch, the command will be sent a
        <code class="Dv">SIGKILL</code> signal and terminated.</p>
    <p class="Pp">This can help prevent a time of check versus time of use issue
        with intercept mode where the <a class="Xr" aria-label="execve, section
        2">execve(2)</a> arguments could be altered after the
        <code class="Nm">sudoers</code> policy check. The checks can only be
        performed if the <a class="Xr" aria-label="proc, section 5">proc(5)</a>
        file system is available. This flag has no effect unless the
        <i class="Em">intercept</i> flag is enabled or the
        <code class="Dv">INTERCEPT</code> tag has been set for the command and
        the <i class="Em">intercept_type</i> option is set to
        <i class="Em">trace</i>.</p>
    <p class="Pp">This setting is incompatible with programs that change their
        root directory via <a class="Xr" aria-label="chroot, section
        2">chroot(2)</a>. If a program changes its root directory, path names
        will no longer match those seen by the <code class="Nm">sudo</code>
        parent process and sub-commands will be terminated before they have a
        chance to run. This flag is <i class="Em">on</i> by default.</p>
    <p class="Pp">This setting is only supported by version 1.9.12 or
      higher.</p>
  </dd>
  <dt>netgroup_tuple</dt>
  <dd>If set, netgroup lookups will be performed using the full netgroup tuple:
      host name, user name, and domain (if one is set). Historically,
      <code class="Nm">sudo</code> only matched the user name and domain for
      netgroups used in a <i class="Em">User_List</i> and only matched the host
      name and domain for netgroups used in a <i class="Em">Host_List</i>. This
      flag is <i class="Em">off</i> by default.</dd>
  <dt>noexec</dt>
  <dd>If set, all commands run via <code class="Nm">sudo</code> will behave as
      if the <code class="Dv">NOEXEC</code> tag has been set, unless overridden
      by an <code class="Dv">EXEC</code> tag. See the description of
      <code class="Dv">EXEC and NOEXEC</code> above as well as the
      <a class="Sx" href="#Preventing_shell_escapes">Preventing shell
      escapes</a> section at the end of this manual. This flag is
      <i class="Em">off</i> by default.</dd>
  <dt>noninteractive_auth</dt>
  <dd>If set, authentication will be attempted even in non-interactive mode
      (when <code class="Nm">sudo</code>'s <code class="Fl">-n</code> option is
      specified). This allows authentication methods that don't require user
      interaction to succeed. Authentication methods that require input from the
      user's terminal will still fail. If disabled, authentication will not be
      attempted in non-interactive mode. This flag is <i class="Em">off</i> by
      default.
    <p class="Pp">This setting is only supported by version 1.9.10 or
      higher.</p>
  </dd>
  <dt>pam_acct_mgmt</dt>
  <dd>On systems that use PAM for authentication, <code class="Nm">sudo</code>
      will perform PAM account validation for the invoking user by default. The
      actual checks performed depend on which PAM modules are configured. If
      enabled, account validation will be performed regardless of whether or not
      a password is required. This flag is <i class="Em">on</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.28 or
      higher.</p>
  </dd>
  <dt>pam_rhost</dt>
  <dd>On systems that use PAM for authentication, <code class="Nm">sudo</code>
      will set the PAM remote host value to the name of the local host when the
      <i class="Em">pam_rhost</i> flag is enabled. On Linux systems, enabling
      <i class="Em">pam_rhost</i> may result in DNS lookups of the local host
      name when PAM is initialized. On Solaris versions prior to Solaris 8,
      <i class="Em">pam_rhost</i> must be enabled if <i class="Em">pam_ruser</i>
      is also enabled to avoid a crash in the Solaris PAM implementation.
    <p class="Pp">This flag is <i class="Em">off</i> by default on systems other
        than Solaris.</p>
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt>pam_ruser</dt>
  <dd>On systems that use PAM for authentication, <code class="Nm">sudo</code>
      will set the PAM remote user value to the name of the user that invoked
      sudo when the <i class="Em">pam_ruser</i> flag is enabled. This flag is
      <i class="Em">on</i> by default.
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt>pam_session</dt>
  <dd>On systems that use PAM for authentication, <code class="Nm">sudo</code>
      will create a new PAM session for the command to be run in. Unless
      <code class="Nm">sudo</code> is given the <code class="Fl">-i</code> or
      <code class="Fl">-s</code> options, PAM session modules are run with the
      &#x201C;silent&#x201D; flag enabled. This prevents last login information
      from being displayed for every command on some systems. Disabling
      <i class="Em">pam_session</i> may be needed on older PAM implementations
      or on operating systems where opening a PAM session changes the utmp or
      wtmp files. If PAM session support is disabled, resource limits may not be
      updated for the command being run. If <i class="Em">pam_session</i>,
      <i class="Em">pam_setcred</i>, and <i class="Em">use_pty</i> are disabled,
      <i class="Em">log_servers</i> has not been set and I/O logging has not
      been configured, <code class="Nm">sudo</code> will execute the command
      directly instead of running it as a child process. This flag is
      <i class="Em">on</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.7 or higher.</p>
  </dd>
  <dt>pam_setcred</dt>
  <dd>On systems that use PAM for authentication, <code class="Nm">sudo</code>
      will attempt to establish credentials for the target user by default, if
      supported by the underlying authentication system. One example of a
      credential is a Kerberos ticket. If <i class="Em">pam_session</i>,
      <i class="Em">pam_setcred</i>, and <i class="Em">use_pty</i> are disabled,
      <i class="Em">log_servers</i> has not been set and I/O logging has not
      been configured, <code class="Nm">sudo</code> will execute the command
      directly instead of running it as a child process. This flag is
      <i class="Em">on</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.8 or higher.</p>
  </dd>
  <dt id="pam_faillock">pam_silent</dt>
  <dd>If set, PAM authentication will be performed in silent mode. This prevents
      PAM authentication modules from generating output. In some cases, this may
      suppress important information about why authentication failed. For
      example, PAM modules such as
      <a class="permalink" href="#pam_faillock"><i class="Em">pam_faillock</i></a>
      will only display a warning if
      <a class="permalink" href="#pam_silent"><i class="Em" id="pam_silent">pam_silent</i></a>
      is disabled. This flag is <i class="Em">on</i> by default.
    <p class="Pp">This setting is only supported by version 1.9.16 or
      higher.</p>
  </dd>
  <dt>passprompt_override</dt>
  <dd>If set, the prompt specified by <i class="Em">passprompt</i> or the
      <code class="Ev">SUDO_PROMPT</code> environment variable will always be
      used and will replace the prompt provided by a PAM module or other
      authentication method. This flag is <i class="Em">off</i> by default.</dd>
  <dt>path_info</dt>
  <dd>Normally, <code class="Nm">sudo</code> will tell the user when a command
      could not be found in their <code class="Ev">PATH</code> environment
      variable. Some sites may wish to disable this as it could be used to
      gather information on the location of executables that the normal user
      does not have access to. The disadvantage is that if the executable is
      simply not in the user's <code class="Ev">PATH</code>,
      <code class="Nm">sudo</code> will tell the user that they are not allowed
      to run it, which can be confusing. This flag is <i class="Em">on</i> by
      default.</dd>
  <dt id="preserve_groups">preserve_groups</dt>
  <dd>By default, <code class="Nm">sudo</code> will initialize the group vector
      to the list of groups the target user is in. When
      <a class="permalink" href="#preserve_groups"><i class="Em">preserve_groups</i></a>
      is set, the user's existing group vector is left unaltered. The real and
      effective group-IDs, however, are still set to match the target user. This
      flag is <i class="Em">off</i> by default.</dd>
  <dt>pwfeedback</dt>
  <dd>By default, <code class="Nm">sudo</code> reads the password like most
      other Unix programs, by turning off echo until the user hits the return
      (or enter) key. Some users become confused by this as it appears to them
      that <code class="Nm">sudo</code> has hung at this point. When
      <i class="Em">pwfeedback</i> is set, <code class="Nm">sudo</code> will
      provide visual feedback when the user presses a key. This does have a
      security impact as an onlooker may be able to determine the length of the
      password being entered. This flag is <i class="Em">off</i> by
    default.</dd>
  <dt>requiretty</dt>
  <dd>If set, <code class="Nm">sudo</code> will only run when the user is logged
      in to a real tty. When this flag is set, <code class="Nm">sudo</code> can
      only be run from a login session and not via other means such as
      <a class="Xr" aria-label="cron, section 8">cron(8)</a> or cgi-bin scripts.
      This flag is <i class="Em">off</i> by default.</dd>
  <dt>root_sudo</dt>
  <dd>If set, <b class="Sy">root</b> is allowed to run
      <code class="Nm">sudo</code> too. Disabling this prevents users from
      &#x201C;chaining&#x201D; <code class="Nm">sudo</code> commands to get a
      <b class="Sy">root</b> shell by doing something like
      &#x2018;<code class="Li">sudo sudo /bin/sh</code>&#x2019;. Note, however,
      that turning off <i class="Em">root_sudo</i> will also prevent
      <b class="Sy">root</b> from running <code class="Nm">sudoedit</code>.
      Disabling <i class="Em">root_sudo</i> provides no real additional
      security; it exists purely for historical reasons. This flag is
      <i class="Em">on</i> by default.</dd>
  <dt>rootpw</dt>
  <dd>If set, <code class="Nm">sudo</code> will prompt for the
      <b class="Sy">root</b> password instead of the password of the invoking
      user when running a command or editing a file. This flag is
      <i class="Em">off</i> by default.</dd>
  <dt>runas_allow_unknown_id</dt>
  <dd>If enabled, allow matching of runas user and group IDs that are not
      present in the password or group databases. In addition to explicitly
      matching unknown user or group IDs in a <i class="Em">Runas_List</i>, this
      option also allows the <b class="Sy">ALL</b> alias to match unknown IDs.
      This flag is <i class="Em">off</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.30 or higher.
        Older versions of <code class="Nm">sudo</code> always allowed matching
        of unknown user and group IDs.</p>
  </dd>
  <dt>runas_check_shell</dt>
  <dd>If enabled, <code class="Nm">sudo</code> will only run commands as a user
      whose shell appears in the <span class="Pa">/etc/shells</span> file, even
      if the invoking user's <i class="Em">Runas_List</i> would otherwise permit
      it. If no <span class="Pa">/etc/shells</span> file is present, a
      system-dependent list of built-in default shells is used. On many
      operating systems, system users such as &#x201C;bin&#x201D;, do not have a
      valid shell and this flag can be used to prevent commands from being run
      as those users. This flag is <i class="Em">off</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.30 or
      higher.</p>
  </dd>
  <dt>runaspw</dt>
  <dd>If set, <code class="Nm">sudo</code> will prompt for the password of the
      user defined by the <i class="Em">runas_default</i> option (defaults to
      <b class="Sy">root</b>) instead of the password of the invoking user when
      running a command or editing a file. This flag is <i class="Em">off</i> by
      default.</dd>
  <dt>selinux</dt>
  <dd>If enabled, the user may specify an SELinux role and/or type to use when
      running the command, as permitted by the SELinux policy. If SELinux is
      disabled on the system, this flag has no effect. This flag is
      <i class="Em">on</i> by default.</dd>
  <dt>set_home</dt>
  <dd>If enabled and <code class="Nm">sudo</code> is invoked with the
      <code class="Fl">-s</code> option, the <code class="Ev">HOME</code>
      environment variable will be set to the home directory of the target user
      (which is the <i class="Em">runas_default</i> user unless the
      <code class="Fl">-u</code> option is used). This flag is largely obsolete
      and has no effect unless the <i class="Em">env_reset</i> flag has been
      disabled or <code class="Ev">HOME</code> is present in the
      <i class="Em">env_keep</i> list, both of which are strongly discouraged.
      This flag is <i class="Em">off</i> by default.</dd>
  <dt>set_logname</dt>
  <dd>Normally, <code class="Nm">sudo</code> will set the
      <code class="Ev">LOGNAME</code> and <code class="Ev">USER</code>
      environment variables to the name of the target user (the user specified
      by <i class="Em">runas_default</i> unless the <code class="Fl">-u</code>
      option is given). However, since some programs (including the RCS revision
      control system) use <code class="Ev">LOGNAME</code> to determine the real
      identity of the user, it may be desirable to change this behavior. This
      can be done by negating the set_logname option. The
      <i class="Em">set_logname</i> option will have no effect if the
      <i class="Em">env_reset</i> option has not been disabled and the
      <i class="Em">env_keep</i> list contains <code class="Ev">LOGNAME</code>
      or <code class="Ev">USER</code>. This flag is <i class="Em">on</i> by
      default.</dd>
  <dt>set_utmp</dt>
  <dd>When enabled, <code class="Nm">sudo</code> will create an entry in the
      utmp (or utmpx) file when a pseudo-terminal is allocated. A
      pseudo-terminal is allocated by <code class="Nm">sudo</code> when it is
      running in a terminal and one or more of the <i class="Em">log_input</i>,
      <i class="Em">log_output</i>, <i class="Em">log_stdin</i>,
      <i class="Em">log_stdout</i>, <i class="Em">log_stderr</i>,
      <i class="Em">log_ttyin</i>, <i class="Em">log_ttyout</i>, or
      <i class="Em">use_pty</i> flags is enabled. By default, the new entry will
      be a copy of the user's existing utmp entry (if any), with the tty, time,
      type, and pid fields updated. This flag is <i class="Em">on</i> by
      default.</dd>
  <dt>setenv</dt>
  <dd>Allow the user to disable the <i class="Em">env_reset</i> option from the
      command line via the <code class="Fl">-E</code> option. Additionally,
      environment variables set via the command line are not subject to the
      restrictions imposed by <i class="Em">env_check</i>,
      <i class="Em">env_delete</i>, or <i class="Em">env_keep</i>. As such, only
      trusted users should be allowed to set variables in this manner. This flag
      is <i class="Em">off</i> by default.</dd>
  <dt>shell_noargs</dt>
  <dd>If set and <code class="Nm">sudo</code> is invoked with no arguments it
      acts as if the <code class="Fl">-s</code> option had been given. That is,
      it runs a shell as <b class="Sy">root</b> (the shell is determined by the
      <code class="Ev">SHELL</code> environment variable if it is set, falling
      back on the shell listed in the invoking user's /etc/passwd entry if not).
      This flag is <i class="Em">off</i> by default.</dd>
  <dt>stay_setuid</dt>
  <dd>Normally, when <code class="Nm">sudo</code> executes a command the real
      and effective user-IDs are set to the target user (<b class="Sy">root</b>
      by default). This option changes that behavior such that the real user-ID
      is left as the invoking user's user-ID. In other words, this makes
      <code class="Nm">sudo</code> act as a set-user-ID wrapper. This can be
      useful on systems that disable some potentially dangerous functionality
      when a program is run set-user-ID. This option is only effective on
      systems that support either the <a class="Xr" aria-label="setreuid,
      section 2">setreuid(2)</a> or <a class="Xr" aria-label="setresuid, section
      2">setresuid(2)</a> system call. This flag is <i class="Em">off</i> by
      default.</dd>
  <dt>sudoedit_checkdir</dt>
  <dd>If set, <code class="Nm">sudoedit</code> will check all directory
      components of the path to be edited for writability by the invoking user.
      Symbolic links will not be followed in writable directories and
      <code class="Nm">sudoedit</code> will refuse to edit a file located in a
      writable directory. These restrictions are not enforced when
      <code class="Nm">sudoedit</code> is run by <b class="Sy">root</b>. On some
      systems, if all directory components of the path to be edited are not
      readable by the target user, <code class="Nm">sudoedit</code> will be
      unable to edit the file. This flag is <i class="Em">on</i> by default.
    <p class="Pp">This setting was first introduced in version 1.8.15 but
        initially suffered from a race condition. The check for symbolic links
        in writable intermediate directories was added in version 1.8.16.</p>
  </dd>
  <dt>sudoedit_follow</dt>
  <dd>By default, <code class="Nm">sudoedit</code> will not follow symbolic
      links when opening files. The <i class="Em">sudoedit_follow</i> option can
      be enabled to allow <code class="Nm">sudoedit</code> to open symbolic
      links. It may be overridden on a per-command basis by the
      <code class="Dv">FOLLOW</code> and <code class="Dv">NOFOLLOW</code> tags.
      This flag is <i class="Em">off</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.15 or
      higher.</p>
  </dd>
  <dt>syslog_pid</dt>
  <dd>When logging via <a class="Xr" aria-label="syslog, section
      3">syslog(3)</a>, include the process ID in the log entry. This flag is
      <i class="Em">off</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.21 or
      higher.</p>
  </dd>
  <dt>targetpw</dt>
  <dd>If set, <code class="Nm">sudo</code> will prompt for the password of the
      user specified by the <code class="Fl">-u</code> option (defaults to the
      value of <i class="Em">runas_default</i>) instead of the password of the
      invoking user when running a command or editing a file. This flag
      precludes the use of a user-ID not listed in the passwd database as an
      argument to the <code class="Fl">-u</code> option. This flag is
      <i class="Em">off</i> by default.</dd>
  <dt>tty_tickets</dt>
  <dd>If set, users must authenticate on a per-tty basis. With this flag
      enabled, <code class="Nm">sudo</code> will use a separate record in the
      time stamp file for each terminal. If disabled, a single record is used
      for all login sessions.
    <p class="Pp">This option has been superseded by the
        <i class="Em">timestamp_type</i> option.</p>
  </dd>
  <dt>umask_override</dt>
  <dd>If set, <code class="Nm">sudo</code> will set the umask as specified in
      the <i class="Em">sudoers</i> file without modification. This makes it
      possible to specify a umask in the <i class="Em">sudoers</i> file that is
      more permissive than the user's own umask and matches historical behavior.
      If <i class="Em">umask_override</i> is not set,
      <code class="Nm">sudo</code> will set the umask to be the union of the
      user's umask and what is specified in <i class="Em">sudoers</i>. This flag
      is <i class="Em">off</i> by default.</dd>
  <dt>use_loginclass</dt>
  <dd>If set, <code class="Nm">sudo</code> will apply the defaults specified for
      the target user's login class if one exists. Only available if
      <code class="Nm">sudo</code> is configured with the
      <code class="Li">--with-logincap</code> option. This flag is
      <i class="Em">off</i> by default.</dd>
  <dt id="NETGROUP_BASE">use_netgroups</dt>
  <dd>If set, netgroups (prefixed with
      &#x2018;<code class="Li">+</code>&#x2019;), may be used in place of a user
      or host. For LDAP-based sudoers, netgroup support requires an expensive
      sub-string match on the server unless the
      <a class="permalink" href="#NETGROUP_BASE"><b class="Sy">NETGROUP_BASE</b></a>
      directive is present in the <span class="Pa">/etc/ldap.conf</span> file.
      If netgroups are not needed, this option can be disabled to reduce the
      load on the LDAP server. This flag is <i class="Em">on</i> by
    default.</dd>
  <dt>use_pty</dt>
  <dd>If set, and <code class="Nm">sudo</code> is running in a terminal, the
      command will be run in a new pseudo-terminal. If the
      <code class="Nm">sudo</code> process is not attached to a terminal,
      <i class="Em">use_pty</i> has no effect.
    <p class="Pp">A malicious program run under <code class="Nm">sudo</code> may
        be capable of injecting commands into the user's terminal or running a
        background process that retains access to the user's terminal device
        even after the main program has finished executing. By running the
        command in a separate pseudo-terminal, this attack is no longer
        possible.</p>
    <p class="Pp">A side effect of running the command in a new pseudo-terminal
        is that input will be passed to the command even if it is
        non-interactive. This means that, for example, keys pressed while a
        non-interactive command is running will be consumed by
        <code class="Nm">sudo</code> instead of being passed to the shell after
        the command exits.</p>
    <p class="Pp">This flag is <i class="Em">on</i> by default for
        <code class="Nm">sudo</code> 1.9.14 and above.</p>
  </dd>
  <dt>user_command_timeouts</dt>
  <dd>If set, the user may specify a timeout on the command line. If the timeout
      expires before the command has exited, the command will be terminated. If
      a timeout is specified both in the <span class="Pa">sudoers</span> file
      and on the command line, the smaller of the two timeouts will be used. See
      the <i class="Em">Timeout_Spec</i> section for a description of the
      timeout syntax. This flag is <i class="Em">off</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.20 or
      higher.</p>
  </dd>
  <dt>utmp_runas</dt>
  <dd>If set, <code class="Nm">sudo</code> will store the name of the runas user
      when updating the utmp (or utmpx) file. By default,
      <code class="Nm">sudo</code> stores the name of the invoking user. This
      flag is <i class="Em">off</i> by default.</dd>
  <dt id="visiblepw">visiblepw</dt>
  <dd>By default, <code class="Nm">sudo</code> will refuse to run if the user
      must enter a password but it is not possible to disable echo on the
      terminal. If the
      <a class="permalink" href="#visiblepw"><i class="Em">visiblepw</i></a>
      flag is set, <code class="Nm">sudo</code> will prompt for a password even
      when it would be visible on the screen. This makes it possible to run
      things like &#x2018;<code class="Li">ssh somehost sudo ls</code>&#x2019;
      since by default, <a class="Xr" aria-label="ssh, section 1">ssh(1)</a>
      does not allocate a tty when running a command. This flag is
      <i class="Em">off</i> by default.</dd>
</dl>
<p class="Pp"><b class="Sy">Integers</b>:</p>
<dl class="Bl-tag">
  <dt id="closefrom">closefrom</dt>
  <dd>Before it executes a command, <code class="Nm">sudo</code> will close all
      open file descriptors other than standard input, standard output, and
      standard error (file descriptors 0&#x2013;2). The
      <a class="permalink" href="#closefrom"><i class="Em">closefrom</i></a>
      option can be used to specify a different file descriptor at which to
      start closing. The default is 3.</dd>
  <dt>command_timeout</dt>
  <dd>The maximum amount of time a command is allowed to run before it is
      terminated. See the <i class="Em">Timeout_Spec</i> section for a
      description of the timeout syntax.
    <p class="Pp">This setting is only supported by version 1.8.20 or
      higher.</p>
  </dd>
  <dt>log_server_timeout</dt>
  <dd>The maximum amount of time to wait when connecting to a log server or
      waiting for a server response. See the <i class="Em">Timeout_Spec</i>
      section for a description of the timeout syntax. The default value is 30
      seconds.
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt>maxseq</dt>
  <dd>The maximum sequence number that will be substituted for the
      &#x2018;<code class="Li">%{seq}</code>&#x2019; escape in the I/O log file
      (see the <i class="Em">iolog_dir</i> description below for more
      information). While the value substituted for
      &#x2018;<code class="Li">%{seq}</code>&#x2019; is in base 36,
      <i class="Em">maxseq</i> itself should be expressed in decimal. Values
      larger than 2176782336 (which corresponds to the base 36 sequence number
      &#x201C;ZZZZZZ&#x201D;) will be silently truncated to 2176782336. The
      default value is 2176782336.
    <p class="Pp">Once the local sequence number reaches the value of
        <i class="Em">maxseq</i>, it will &#x201C;roll over&#x201D; to zero,
        after which <code class="Nm">sudoers</code> will truncate and reuse any
        existing I/O log path names.</p>
    <p class="Pp">This setting is only supported by version 1.8.7 or higher.</p>
  </dd>
  <dt>passwd_tries</dt>
  <dd>The number of tries a user gets to enter his/her password before
      <code class="Nm">sudo</code> logs the failure and exits. The default is
    3.</dd>
  <dt>syslog_maxlen</dt>
  <dd>On many systems, <a class="Xr" aria-label="syslog, section
      3">syslog(3)</a> has a relatively small log buffer. IETF RFC 5424 states
      that syslog servers must support messages of at least 480 bytes and should
      support messages up to 2048 bytes. By default,
      <code class="Nm">sudoers</code> creates log messages up to 980 bytes which
      corresponds to the historic <span class="Ux">BSD</span> syslog
      implementation which used a 1024 byte buffer to store the message, date,
      hostname, and program name. To prevent syslog messages from being
      truncated, <code class="Nm">sudoers</code> will split up log messages that
      are larger than <i class="Em">syslog_maxlen</i> bytes. When a message is
      split, additional parts will include the string &#x201C;(command
      continued)&#x201D; after the user name and before the continued command
      line arguments.
    <p class="Pp">This setting is only supported by version 1.8.19 or
      higher.</p>
  </dd>
</dl>
<p class="Pp"><b class="Sy">Integers that can be used in a boolean
  context</b>:</p>
<dl class="Bl-tag">
  <dt>loglinelen</dt>
  <dd>Number of characters per line for the file log. This value is used to
      decide when to wrap lines for nicer log files. This has no effect on the
      syslog log file, only the file log. The default is 80 (use 0 or negate the
      option to disable word wrap).</dd>
  <dt>passwd_timeout</dt>
  <dd>Number of minutes before the <code class="Nm">sudo</code> password prompt
      times out, or 0 for no timeout. The timeout may include a fractional
      component if minute granularity is insufficient, for example 2.5. The
      default is 5.</dd>
  <dt>timestamp_timeout</dt>
  <dd>Number of minutes that can elapse before <code class="Nm">sudo</code> will
      ask for a password again. The timeout may include a fractional component
      if minute granularity is insufficient, for example 2.5. The default is 5.
      Set this to 0 to always prompt for a password. If set to a value less than
      0 the user's time stamp will not expire until the system is rebooted. This
      can be used to allow users to create or delete their own time stamps via
      &#x2018;<code class="Li">sudo -v</code>&#x2019; and
      &#x2018;<code class="Li">sudo -k</code>&#x2019; respectively.</dd>
  <dt>umask</dt>
  <dd>File mode creation mask to use when running the command. Negate this
      option or set it to 0777 to prevent <code class="Nm">sudoers</code> from
      changing the umask. Unless the <i class="Em">umask_override</i> flag is
      set, the actual umask will be the union of the user's umask and the value
      of the <i class="Em">umask</i> setting, which defaults to 0022. This
      guarantees that <code class="Nm">sudo</code> never lowers the umask when
      running a command.
    <p class="Pp">If <i class="Em">umask</i> is explicitly set in
        <i class="Em">sudoers</i>, it will override any umask setting in PAM or
        login.conf. If <i class="Em">umask</i> is not set in
        <i class="Em">sudoers</i>, the umask specified by PAM or login.conf will
        take precedence. The umask setting in PAM is not used for
        <code class="Nm">sudoedit</code>, which does not create a new PAM
        session.</p>
  </dd>
</dl>
<p class="Pp"><b class="Sy">Strings</b>:</p>
<dl class="Bl-tag">
  <dt>cmddenial_message</dt>
  <dd>It set, <code class="Nm">sudo</code> will display this message when a user
      is denied access to run the specified command, but is listed in the
      <i class="Em">sudoers</i> file for the host. This can be used to provide
      additional, site-specific information to the user when a command is denied
      by the security policy. It does not override the standard warning the user
      receives when a command is denied.</dd>
  <dt>authfail_message</dt>
  <dd>Message that is displayed after a user fails to authenticate. The message
      may include the &#x2018;<code class="Li">%d</code>&#x2019; escape which
      will expand to the number of failed password attempts. If set, it
      overrides the default message, &#x201C;%d incorrect password
      attempt(s)&#x201D;.</dd>
  <dt>badpass_message</dt>
  <dd>Message that is displayed if a user enters an incorrect password. The
      default is &#x201C;Sorry, try again.&#x201D; unless insults are
    enabled.</dd>
  <dt>editor</dt>
  <dd>A colon (&#x2018;<code class="Li">:</code>&#x2019;) separated list of
      editor path names used by <code class="Nm">sudoedit</code> and
      <code class="Nm">visudo</code>. For <code class="Nm">sudoedit</code>, this
      list is used to find an editor when none of the
      <code class="Ev">SUDO_EDITOR</code>, <code class="Ev">VISUAL</code> or
      <code class="Ev">EDITOR</code> environment variables are set to an editor
      that exists and is executable. For <code class="Nm">visudo</code>, it is
      used as a white list of allowed editors; <code class="Nm">visudo</code>
      will choose the editor that matches the user's
      <code class="Ev">SUDO_EDITOR</code>, <code class="Ev">VISUAL</code> or
      <code class="Ev">EDITOR</code> environment variable if possible, or the
      first editor in the list that exists and is executable if not. Unless
      invoked as <code class="Nm">sudoedit</code>, <code class="Nm">sudo</code>
      does not preserve the <code class="Ev">SUDO_EDITOR</code>,
      <code class="Ev">VISUAL</code> or <code class="Ev">EDITOR</code>
      environment variables unless they are present in the
      <i class="Em">env_keep</i> list or the <i class="Em">env_reset</i> option
      is disabled. The default is <span class="Pa">vi</span>.</dd>
  <dt>intercept_type</dt>
  <dd>The underlying mechanism used by the <i class="Em">intercept</i> and
      <i class="Em">log_subcmds</i> options. It has the following possible
      values:
    <dl class="Bl-tag">
      <dt>dso</dt>
      <dd>Preload a dynamic shared object (shared library) that intercepts the
          <a class="Xr" aria-label="execve, section 2">execve(2)</a>,
          <a class="Xr" aria-label="execl, section 3">execl(3)</a>,
          <a class="Xr" aria-label="execle, section 3">execle(3)</a>,
          <a class="Xr" aria-label="execlp, section 3">execlp(3)</a>,
          <a class="Xr" aria-label="execv, section 3">execv(3)</a>,
          <a class="Xr" aria-label="execvp, section 3">execvp(3)</a>,
          <a class="Xr" aria-label="execvpe, section 3">execvpe(3)</a>, and
          <a class="Xr" aria-label="system, section 3">system(3)</a> library
          functions. A value of <i class="Em">dso</i> is incompatible with
          <code class="Nm">sudo</code>'s SELinux RBAC support.</dd>
      <dt>trace</dt>
      <dd>Use <a class="Xr" aria-label="ptrace, section 2">ptrace(2)</a> to
          intercept the <a class="Xr" aria-label="execve, section
          2">execve(2)</a> system call. This is only supported on Linux systems
          where <a class="Xr" aria-label="seccomp, section 2">seccomp(2)</a>
          filtering is enabled. If the
          <span class="Pa">/proc/sys/kernel/seccomp/actions_avail</span> file is
          missing or does not contain a &#x201C;trap&#x201D; element, setting
          <i class="Em">intercept_type</i> to <i class="Em">trace</i> will have
          no effect and <i class="Em">dso</i> will be used instead.</dd>
    </dl>
    <p class="Pp">The default is to use <i class="Em">trace</i> if it is
        supported by the system and <i class="Em">dso</i> if it is not.</p>
  </dd>
  <dt>iolog_dir</dt>
  <dd>The top-level directory to use when constructing the path name for the
      input/output log directory. Only used if the <i class="Em">log_input</i>
      or <i class="Em">log_output</i> options are enabled or when the
      <code class="Dv">LOG_INPUT</code> or <code class="Dv">LOG_OUTPUT</code>
      tags are present for a command. The session sequence number, if any, is
      stored in the directory. The default is
      <span class="Pa">/var/log/sudo-io</span>.
    <p class="Pp">The following percent
        (&#x2018;<code class="Li">%</code>&#x2019;) escape sequences are
        supported:</p>
    <dl class="Bl-tag">
      <dt>%{seq}</dt>
      <dd>expanded to a monotonically increasing base-36 sequence number, such
          as 0100A5, where every two digits are used to form a new directory,
          e.g., <span class="Pa">01/00/A5</span></dd>
      <dt>%{user}</dt>
      <dd>expanded to the invoking user's login name</dd>
      <dt>%{group}</dt>
      <dd>expanded to the name of the invoking user's real group-ID</dd>
      <dt>%{runas_user}</dt>
      <dd>expanded to the login name of the user the command will be run as
          (e.g., <b class="Sy">root</b>)</dd>
      <dt>%{runas_group}</dt>
      <dd>expanded to the group name of the user the command will be run as
          (e.g., <b class="Sy">wheel</b>)</dd>
      <dt>%{hostname}</dt>
      <dd>expanded to the local host name without the domain name</dd>
      <dt>%{command}</dt>
      <dd>expanded to the base name of the command being run</dd>
    </dl>
    <p class="Pp">In addition, any escape sequences supported by the system's
        <a class="Xr" aria-label="strftime, section 3">strftime(3)</a> function
        will be expanded.</p>
    <p class="Pp">To include a literal &#x2018;<code class="Li">%</code>&#x2019;
        character, the string &#x2018;<code class="Li">%%</code>&#x2019; should
        be used.</p>
    <p class="Pp">Any path name separator characters
        (&#x2018;<code class="Li">/</code>&#x2019;) present in the user, group
        or host name will be replaced with an underbar
        (&#x2018;<code class="Li">_</code>&#x2019;) during expansion.</p>
  </dd>
  <dt>iolog_file</dt>
  <dd>The path name, relative to <i class="Em">iolog_dir</i>, in which to store
      input/output logs when the <i class="Em">log_input</i> or
      <i class="Em">log_output</i> options are enabled or when the
      <code class="Dv">LOG_INPUT</code> or <code class="Dv">LOG_OUTPUT</code>
      tags are present for a command. <i class="Em">iolog_file</i> may contain
      directory components. The default is
      &#x2018;<code class="Li">%{seq}</code>&#x2019;.
    <p class="Pp">See the <i class="Em">iolog_dir</i> option above for a list of
        supported percent (&#x2018;<code class="Li">%</code>&#x2019;) escape
        sequences.</p>
    <p class="Pp">In addition to the escape sequences, path names that end in
        six or more <i class="Em">X</i>s will have the <i class="Em">X</i>s
        replaced with a unique combination of digits and letters, similar to the
        <a class="Xr" aria-label="mktemp, section 3">mktemp(3)</a> function.</p>
    <p class="Pp">If the path created by concatenating
        <i class="Em">iolog_dir</i> and <i class="Em">iolog_file</i> already
        exists, the existing I/O log file will be truncated and overwritten
        unless <i class="Em">iolog_file</i> ends in six or more
        <i class="Em">X</i>s.</p>
  </dd>
  <dt>iolog_flush</dt>
  <dd>If set, <code class="Nm">sudo</code> will flush I/O log data to disk after
      each write instead of buffering it. This makes it possible to view the
      logs in real-time as the program is executing but may significantly reduce
      the effectiveness of I/O log compression. This flag is
      <i class="Em">off</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.20 or
      higher.</p>
  </dd>
  <dt>iolog_group</dt>
  <dd>The group name to look up when setting the group-ID on new I/O log files
      and directories. If <i class="Em">iolog_group</i> is not set, the primary
      group-ID of the user specified by <i class="Em">iolog_user</i> is used. If
      neither <i class="Em">iolog_group</i> nor <i class="Em">iolog_user</i> are
      set, I/O log files and directories are created with group-ID 0.
    <p class="Pp">This setting is only supported by version 1.8.19 or
      higher.</p>
  </dd>
  <dt id="iolog_mode">iolog_mode</dt>
  <dd>The file mode to use when creating I/O log files. Mode bits for read and
      write permissions for owner, group, or other are honored, everything else
      is ignored. The file permissions will always include the owner read and
      write bits, even if they are not present in the specified mode. When
      creating I/O log directories, search (execute) bits are added to match the
      read and write bits specified by
      <a class="permalink" href="#iolog_mode"><i class="Em">iolog_mode</i></a>.
      Defaults to 0600 (read and write by user only).
    <p class="Pp">This setting is only supported by version 1.8.19 or
      higher.</p>
  </dd>
  <dt>iolog_user</dt>
  <dd>The user name to look up when setting the user and group-IDs on new I/O
      log files and directories. If <i class="Em">iolog_group</i> is set, it
      will be used instead of the user's primary group-ID. By default, I/O log
      files and directories are created with user and group-ID 0.
    <p class="Pp">This setting can be useful when the I/O logs are stored on a
        Network File System (NFS) share. Having a dedicated user own the I/O log
        files means that <code class="Nm">sudoers</code> does not write to the
        log files as user-ID 0, which is usually not permitted by NFS.</p>
    <p class="Pp">This setting is only supported by version 1.8.19 or
      higher.</p>
  </dd>
  <dt>lecture_status_dir</dt>
  <dd>The directory in which <code class="Nm">sudo</code> stores per-user
      lecture status files. Once a user has received the lecture, a zero-length
      file is created in this directory so that <code class="Nm">sudo</code>
      will not lecture the user again. This directory should
      <i class="Em">not</i> be cleared when the system reboots. The default is
      <span class="Pa">/var/adm/sudo/lectured</span>.</dd>
  <dt>limitprivs</dt>
  <dd>The default Solaris limit privileges to use when constructing a new
      privilege set for a command. This bounds all privileges of the executing
      process. The default limit privileges may be overridden on a per-command
      basis in <i class="Em">sudoers</i>. This option is only available if
      <code class="Nm">sudoers</code> is built on Solaris 10 or higher.</dd>
  <dt>log_server_cabundle</dt>
  <dd>The path to a certificate authority bundle file, in PEM format, to use
      instead of the system's default certificate authority database when
      authenticating the log server. The default is to use the system's default
      certificate authority database. This setting has no effect unless
      <i class="Em">log_servers</i> is set and the remote log server is secured
      with TLS.
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt>log_server_peer_cert</dt>
  <dd>The path to the <code class="Nm">sudo</code> client's certificate file, in
      PEM format. This setting is required when the remote log server is secured
      with TLS and client certificate validation is enabled. For
      <code class="Nm">sudo_logsrvd</code>, client certificate validation is
      controlled by the <i class="Em">tls_checkpeer</i> option, which defaults
      to <i class="Em">false</i>.
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt>log_server_peer_key</dt>
  <dd>The path to the <code class="Nm">sudo</code> client's private key file, in
      PEM format. This setting is required when the remote log server is secured
      with TLS and client certificate validation is enabled. For
      <code class="Nm">sudo_logsrvd</code>, client certificate validation is
      controlled by the <i class="Em">tls_checkpeer</i> flag, which defaults to
      <i class="Em">false</i>.
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt>mailsub</dt>
  <dd>Subject of the mail sent to the <i class="Em">mailto</i> user. The escape
      &#x2018;<code class="Li">%h</code>&#x2019; will expand to the host name of
      the machine. Default is &#x201C;*** SECURITY information for %h
      ***&#x201D;.</dd>
  <dt>noexec_file</dt>
  <dd>As of <code class="Nm">sudo</code> version 1.8.1 this option is no longer
      supported. The path to the noexec file should now be set in the
      <a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a>
    file.</dd>
  <dt>pam_askpass_service</dt>
  <dd>On systems that use PAM for authentication, this is the service name used
      when the <code class="Fl">-A</code> option is specified. The default value
      is either &#x2018;<code class="Li">sudo</code>&#x2019; or
      &#x2018;<code class="Li">sudo</code>&#x2019;, depending on whether or not
      the <code class="Fl">-i</code> option is also specified. See the
      description of <i class="Em">pam_service</i> for more information.
    <p class="Pp">This setting is only supported by version 1.9.9 or higher.</p>
  </dd>
  <dt>pam_login_service</dt>
  <dd>On systems that use PAM for authentication, this is the service name used
      when the <code class="Fl">-i</code> option is specified. The default value
      is &#x2018;<code class="Li">sudo</code>&#x2019;. See the description of
      <i class="Em">pam_service</i> for more information.
    <p class="Pp">This setting is only supported by version 1.8.8 or higher.</p>
  </dd>
  <dt>pam_service</dt>
  <dd>On systems that use PAM for authentication, the service name specifies the
      PAM policy to apply. This usually corresponds to an entry in the
      <span class="Pa">pam.conf</span> file or a file in the
      <span class="Pa">/etc/pam.d</span> directory. The default value is
      &#x2018;<code class="Li">sudo</code>&#x2019;.
    <p class="Pp">This setting is only supported by version 1.8.8 or higher.</p>
  </dd>
  <dt>passprompt</dt>
  <dd>The default prompt to use when asking for a password; can be overridden
      via the <code class="Fl">-p</code> option or the
      <code class="Ev">SUDO_PROMPT</code> environment variable. The following
      percent (&#x2018;<code class="Li">%</code>&#x2019;) escape sequences are
      supported:
    <dl class="Bl-tag">
      <dt>%H</dt>
      <dd>expanded to the local host name including the domain name (only if the
          machine's host name is fully qualified or the <i class="Em">fqdn</i>
          option is set)</dd>
      <dt>%h</dt>
      <dd>expanded to the local host name without the domain name</dd>
      <dt>%p</dt>
      <dd>expanded to the user whose password is being asked for (respects the
          <i class="Em">rootpw</i>, <i class="Em">targetpw</i> and
          <i class="Em">runaspw</i> flags in <i class="Em">sudoers</i>)</dd>
      <dt>%U</dt>
      <dd>expanded to the login name of the user the command will be run as
          (defaults to <b class="Sy">root</b>)</dd>
      <dt>%u</dt>
      <dd>expanded to the invoking user's login name</dd>
      <dt>%%</dt>
      <dd>two consecutive &#x2018;<code class="Li">%</code>&#x2019; characters
          are collapsed into a single &#x2018;<code class="Li">%</code>&#x2019;
          character</dd>
    </dl>
    <p class="Pp" id="passprompt_override">On systems that use PAM for
        authentication, <i class="Em">passprompt</i> will only be used if the
        prompt provided by the PAM module matches the string &#x201C;Password:
        &#x201D; or &#x201C;username's Password: &#x201D;. This ensures that the
        <i class="Em">passprompt</i> setting does not interfere with
        challenge-response style authentication. The
        <a class="permalink" href="#passprompt_override"><i class="Em">passprompt_override</i></a>
        flag can be used to change this behavior.</p>
    <p class="Pp">The default value is &#x2018;<code class="Li">Password:
        </code>&#x2019;.</p>
  </dd>
  <dt id="limitprivs">privs</dt>
  <dd>The default Solaris privileges to use when constructing a new privilege
      set for a command. This is passed to the executing process via the
      inherited privilege set, but is bounded by the limit privileges. If the
      <i class="Em">privs</i> option is specified but the
      <a class="permalink" href="#limitprivs"><i class="Em">limitprivs</i></a>
      option is not, the limit privileges of the executing process is set to
      <i class="Em">privs</i>. The default privileges may be overridden on a
      per-command basis in <i class="Em">sudoers</i>. This option is only
      available if <code class="Nm">sudoers</code> is built on Solaris 10 or
      higher.</dd>
  <dt>role</dt>
  <dd>The default SELinux role to use when constructing a new security context
      to run the command. The default role may be overridden on a per-command
      basis in the <i class="Em">sudoers</i> file or via command line options.
      This option is only available when <code class="Nm">sudo</code> is built
      with SELinux support.</dd>
  <dt>runas_default</dt>
  <dd>The default user to run commands as if the <code class="Fl">-u</code>
      option is not specified on the command line. This defaults to
      <b class="Sy">root</b>.</dd>
  <dt>sudoers_locale</dt>
  <dd>Locale to use when parsing the sudoers file, logging commands, and sending
      email. Changing the locale may affect how sudoers is interpreted. Defaults
      to &#x2018;<code class="Li">C</code>&#x2019;.</dd>
  <dt>timestamp_type</dt>
  <dd><code class="Nm">sudoers</code> uses per-user time stamp files for
      credential caching. The <i class="Em">timestamp_type</i> option can be
      used to specify the type of time stamp record used. It has the following
      possible values:
    <dl class="Bl-tag">
      <dt>global</dt>
      <dd>A single time stamp record is used for all of a user's login sessions,
          regardless of the terminal or parent process ID. An additional record
          is used to serialize password prompts when
          <code class="Nm">sudo</code> is used multiple times in a pipeline, but
          this does not affect authentication.</dd>
      <dt>ppid</dt>
      <dd>A single time stamp record is used for all processes with the same
          parent process ID (usually the shell). Commands run from the same
          shell (or other common parent process) will not require a password for
          <i class="Em">timestamp_timeout</i> minutes (5 by default). Commands
          run via <code class="Nm">sudo</code> with a different parent process
          ID, for example from a shell script, will be authenticated
        separately.</dd>
      <dt>tty</dt>
      <dd>One time stamp record is used for each terminal, which means that a
          user's login sessions are authenticated separately. If no terminal is
          present, the behavior is the same as <i class="Em">ppid</i>. Commands
          run from the same terminal will not require a password for
          <i class="Em">timestamp_timeout</i> minutes (5 by default).</dd>
      <dt>kernel</dt>
      <dd>The time stamp is stored in the kernel as an attribute of the terminal
          device. If no terminal is present, the behavior is the same as
          <i class="Em">ppid</i>. Negative <i class="Em">timestamp_timeout</i>
          values are not supported and positive values are limited to a maximum
          of 60 minutes. This is currently only supported on
          <span class="Ux">OpenBSD</span>.</dd>
    </dl>
    <p class="Pp" id="tty">The default value is
        <a class="permalink" href="#tty"><i class="Em">tty</i></a>.</p>
    <p class="Pp">This setting is only supported by version 1.8.21 or
      higher.</p>
  </dd>
  <dt>timestampdir</dt>
  <dd>The directory in which <code class="Nm">sudo</code> stores its time stamp
      files. This directory should be cleared when the system reboots. The
      default is <span class="Pa">/var/run/sudo/ts</span>.</dd>
  <dt>timestampowner</dt>
  <dd>The owner of the lecture status directory, time stamp directory and all
      files stored therein. The default is <b class="Sy">root</b>.</dd>
  <dt>type</dt>
  <dd>The default SELinux type to use when constructing a new security context
      to run the command. The default type may be overridden on a per-command
      basis in the <i class="Em">sudoers</i> file or via command line options.
      This option is only available when <code class="Nm">sudo</code> is built
      with SELinux support.</dd>
</dl>
<p class="Pp"><b class="Sy">Strings that can be used in a boolean
  context</b>:</p>
<dl class="Bl-tag">
  <dt id="admin_flag">admin_flag</dt>
  <dd>The
      <a class="permalink" href="#admin_flag"><i class="Em">admin_flag</i></a>
      option specifies the path to a file that is created the first time a user
      that is a member of the <i class="Em">sudo</i> or
      <a class="permalink" href="#admin"><i class="Em" id="admin">admin</i></a>
      groups runs <code class="Nm">sudo</code>. Only available if
      <code class="Nm">sudo</code> is configured with the
      <code class="Li">--enable-admin-flag</code> option. The default value is
      <span class="Pa">~/.sudo_as_admin_successful</span>.</dd>
  <dt>env_file</dt>
  <dd>The <i class="Em">env_file</i> option specifies the fully qualified path
      to a file containing variables to be set in the environment of the program
      being run. Entries in this file should either be of the form
      &#x2018;<code class="Li">VARIABLE=value</code>&#x2019; or
      &#x2018;<code class="Li">export VARIABLE=value</code>&#x2019;. The value
      may optionally be enclosed in single or double quotes. Variables in this
      file are only added if the variable does not already exist in the
      environment. This file is considered to be part of the security policy,
      its contents are not subject to other <code class="Nm">sudo</code>
      environment restrictions such as <i class="Em">env_keep</i> and
      <i class="Em">env_check</i>.</dd>
  <dt>exempt_group</dt>
  <dd>Users in this group are exempt from password and PATH requirements. The
      group name specified should not include a
      &#x2018;<code class="Li">%</code>&#x2019; prefix. This is not set by
      default.</dd>
  <dt>fdexec</dt>
  <dd>Determines whether <code class="Nm">sudo</code> will execute a command by
      its path or by an open file descriptor. It has the following possible
      values:
    <dl class="Bl-tag">
      <dt>always</dt>
      <dd>Always execute by file descriptor.</dd>
      <dt>never</dt>
      <dd>Never execute by file descriptor.</dd>
      <dt>digest_only</dt>
      <dd>Only execute by file descriptor if the command has an associated
          digest in the <i class="Em">sudoers</i> file.</dd>
    </dl>
    <p class="Pp" id="digest_only">The default value is
        <a class="permalink" href="#digest_only"><i class="Em">digest_only</i></a>.
        This avoids a time of check versus time of use race condition when the
        command is located in a directory writable by the invoking user.</p>
    <p class="Pp"><i class="Em">fdexec</i> will change the first element of the
        argument vector for scripts ($0 in the shell) due to the way the kernel
        runs script interpreters. Instead of being a normal path, it will refer
        to a file descriptor. For example, <span class="Pa">/dev/fd/4</span> on
        Solaris and <span class="Pa">/proc/self/fd/4</span> on Linux. A
        workaround is to use the <code class="Dv">SUDO_COMMAND</code>
        environment variable instead.</p>
    <p class="Pp">The <i class="Em">fdexec</i> setting is only used when the
        command is matched by path name. It has no effect if the command is
        matched by the built-in <b class="Sy">ALL</b> alias.</p>
    <p class="Pp">This setting is only supported by version 1.8.20 or higher. If
        the operating system does not support the
        <a class="Xr" aria-label="fexecve, section 2">fexecve(2)</a> system
        call, this setting has no effect.</p>
  </dd>
  <dt>group_plugin</dt>
  <dd>A string containing a <code class="Nm">sudoers</code> group plugin with
      optional arguments. The string should consist of the plugin path, either
      fully-qualified or relative to the
      <span class="Pa">/usr/local/libexec/sudo</span> directory, followed by any
      configuration arguments the plugin requires. These arguments (if any) will
      be passed to the plugin's initialization function. If arguments are
      present, the string must be enclosed in double quotes (&quot;&quot;).
    <p class="Pp">On 64-bit systems, if the plugin is present but cannot be
        loaded, <code class="Nm">sudoers</code> will look for a 64-bit version
        and, if it exists, load that as a fallback. The exact rules for this
        vary by system. On Solaris, if the plugin is stored in a directory
        ending in &#x201C;lib&#x201D;, <code class="Nm">sudoers</code> will
        create a fallback path by appending &#x201C;/64&#x201D; to the directory
        name; <span class="Pa">/usr/local/lib/group_plugin.so</span> becomes
        <span class="Pa">/usr/local/lib/64/group_plugin.so</span>. On Linux, a
        directory ending in &#x201C;lib&#x201D; will be transformed to
        &#x201C;lib64&#x201D; as the fallback path;
        <span class="Pa">/usr/local/lib/group_plugin.so</span> becomes
        <span class="Pa">/usr/local/lib64/group_plugin.so</span>. On all other
        systems, the fallback path is generated by adding a &#x201C;64&#x201D;
        before the file extension; <span class="Pa">group_plugin.so</span>
        becomes <span class="Pa">group_plugin64.so</span>.</p>
    <p class="Pp">On AIX systems, the plugin may be either a shared object
        ending in &#x2018;<code class="Li">.so</code>&#x2019; or an archive file
        containing a shared object ending in
        &#x2018;<code class="Li">.a</code>&#x2019; with the name of the shared
        object in parentheses at the end.</p>
    <p class="Pp">For more information see
        <a class="Sx" href="#GROUP_PROVIDER_PLUGINS">GROUP PROVIDER
      PLUGINS</a>.</p>
  </dd>
  <dt>lecture</dt>
  <dd>This option controls when a short lecture will be printed along with the
      password prompt. It has the following possible values:
    <dl class="Bl-tag">
      <dt>always</dt>
      <dd>Always lecture the user.</dd>
      <dt>never</dt>
      <dd>Never lecture the user.</dd>
      <dt>once</dt>
      <dd>Only lecture the user the first time they run
          <code class="Nm">sudo</code>.</dd>
    </dl>
    <p class="Pp">If no value is specified, a value of <i class="Em">once</i> is
        implied. Negating the option results in a value of
        <i class="Em">never</i> being used. The default value is
        <i class="Em">once</i>.</p>
  </dd>
  <dt>lecture_file</dt>
  <dd>Path to a file containing an alternate <code class="Nm">sudo</code>
      lecture that will be used in place of the standard lecture if the named
      file exists. By default, <code class="Nm">sudo</code> uses a built-in
      lecture.</dd>
  <dt>listpw</dt>
  <dd>This option controls when a password will be required when a user runs
      <code class="Nm">sudo</code> with the <code class="Fl">-l</code> option.
      It has the following possible values:
    <dl class="Bl-tag">
      <dt>all</dt>
      <dd>All the user's <i class="Em">sudoers</i> file entries for the current
          host must have the <code class="Dv">NOPASSWD</code> flag set to avoid
          entering a password.</dd>
      <dt>always</dt>
      <dd>The user must always enter a password to use the
          <code class="Fl">-l</code> option.</dd>
      <dt>any</dt>
      <dd>At least one of the user's <i class="Em">sudoers</i> file entries for
          the current host must have the <code class="Dv">NOPASSWD</code> flag
          set to avoid entering a password.</dd>
      <dt>never</dt>
      <dd>The user need never enter a password to use the
          <code class="Fl">-l</code> option.</dd>
    </dl>
    <p class="Pp">If no value is specified, a value of <i class="Em">any</i> is
        implied. Negating the option results in a value of
        <i class="Em">never</i> being used. The default value is
        <i class="Em">any</i>.</p>
  </dd>
  <dt>log_format</dt>
  <dd>The event log format. Supported log formats are:
    <dl class="Bl-tag">
      <dt id="json">json</dt>
      <dd>Currently, this is an alias for <i class="Em">json_pretty</i>. In a
          future version of <code class="Nm">sudo</code>,
          <a class="permalink" href="#json"><i class="Em">json</i></a> will be
          equivalent to <i class="Em">json_compact</i>. JSON log entries contain
          the full user details as well as the execution environment if the
          command was allowed.</dd>
      <dt>json_compact</dt>
      <dd>Log events in &#x201C;compact&#x201D; (minified) JSON format. Each
          event is written as a separate JSON object on single line without
          extraneous white space. Due to limitations of the protocol, JSON
          events sent via <i class="Em">syslog</i> may be truncated.</dd>
      <dt>json_pretty</dt>
      <dd>Log events in &#x201C;pretty&#x201D; JSON format. When logging to a
          file, the entire file is treated as a single JSON object consisting of
          multiple events, each event spanning multiple lines. When logging via
          <i class="Em">syslog</i>, there is no difference between the
          <i class="Em">json_pretty</i> and <i class="Em">json_compact</i>
          formats.</dd>
      <dt>sudo</dt>
      <dd>Log events in traditional sudo-style format, see
          <a class="Sx" href="#EVENT_LOGGING">EVENT LOGGING</a> for
        details.</dd>
    </dl>
    <p class="Pp">This setting affects logs sent via
        <a class="Xr" aria-label="syslog, section 3">syslog(3)</a> as well as
        the file specified by the <i class="Em">logfile</i> setting, if any. The
        default value is <i class="Em">sudo</i>.</p>
  </dd>
  <dt>logfile</dt>
  <dd>Path to the <code class="Nm">sudo</code> log file (not the syslog log
      file). Setting a path turns on logging to a file; negating this option
      turns it off. By default, <code class="Nm">sudo</code> logs via
    syslog.</dd>
  <dt>mailerflags</dt>
  <dd>Flags to use when invoking mailer. Defaults to
    <code class="Fl">-t</code>.</dd>
  <dt>mailerpath</dt>
  <dd>Path to mail program used to send warning mail (negate to prevent
      <code class="Nm">sudo</code> from sending mail). Defaults to the path to
      sendmail found at configure time.</dd>
  <dt>mailfrom</dt>
  <dd>Address to use for the &#x201C;from&#x201D; address when sending warning
      and error mail. The address should be enclosed in double quotes
      (&quot;&quot;) to protect against <code class="Nm">sudo</code>
      interpreting the &#x2018;<code class="Li">@</code>&#x2019; sign. Defaults
      to the name of the user running <code class="Nm">sudo</code>.</dd>
  <dt>mailto</dt>
  <dd>Address to send warning and error mail to (negate to prevent
      <code class="Nm">sudo</code> from sending mail). The address should be
      enclosed in double quotes (&quot;&quot;) to protect against
      <code class="Nm">sudo</code> interpreting the
      &#x2018;<code class="Li">@</code>&#x2019; sign. Defaults to root.</dd>
  <dt>rlimit_as</dt>
  <dd>The maximum size to which the process's address space may grow (in bytes),
      if supported by the operating system. See
      <a class="Sx" href="#Resource_limits">Resource limits</a> for more
      information.</dd>
  <dt>rlimit_core</dt>
  <dd>The largest size core dump file that may be created (in bytes). See
      <a class="Sx" href="#Resource_limits">Resource limits</a> for more
      information. Defaults to 0 (no core dump created).</dd>
  <dt>rlimit_cpu</dt>
  <dd>The maximum amount of CPU time that the process may use (in seconds). See
      <a class="Sx" href="#Resource_limits">Resource limits</a> for more
      information.</dd>
  <dt>rlimit_data</dt>
  <dd>The maximum size of the data segment for the process (in bytes). See
      <a class="Sx" href="#Resource_limits">Resource limits</a> for more
      information.</dd>
  <dt>rlimit_fsize</dt>
  <dd>The largest size file that the process may create (in bytes). See
      <a class="Sx" href="#Resource_limits">Resource limits</a> for more
      information.</dd>
  <dt>rlimit_locks</dt>
  <dd>The maximum number of locks that the process may establish, if supported
      by the operating system. See
      <a class="Sx" href="#Resource_limits">Resource limits</a> for more
      information.</dd>
  <dt>rlimit_memlock</dt>
  <dd>The maximum size that the process may lock in memory (in bytes), if
      supported by the operating system. See
      <a class="Sx" href="#Resource_limits">Resource limits</a> for more
      information.</dd>
  <dt>rlimit_nofile</dt>
  <dd>The maximum number of files that the process may have open. See
      <a class="Sx" href="#Resource_limits">Resource limits</a> for more
      information.</dd>
  <dt>rlimit_nproc</dt>
  <dd>The maximum number of processes that the user may run simultaneously. See
      <a class="Sx" href="#Resource_limits">Resource limits</a> for more
      information.</dd>
  <dt>rlimit_rss</dt>
  <dd>The maximum size to which the process's resident set size may grow (in
      bytes). See <a class="Sx" href="#Resource_limits">Resource limits</a> for
      more information.</dd>
  <dt>rlimit_stack</dt>
  <dd>The maximum size to which the process's stack may grow (in bytes). See
      <a class="Sx" href="#Resource_limits">Resource limits</a> for more
      information.</dd>
  <dt>restricted_env_file</dt>
  <dd>The <i class="Em">restricted_env_file</i> option specifies the fully
      qualified path to a file containing variables to be set in the environment
      of the program being run. Entries in this file should be assignments in
      the form &#x2018;<code class="Li">VARIABLE=value</code>&#x2019; or
      &#x2018;<code class="Li">export VARIABLE=value</code>&#x2019;, separated
      by newline characters. The value may optionally be enclosed in single or
      double quotes. Shell-style variable substitution is not supported. Empty
      lines and comments starting with a pound sign
      (&#x2018;<code class="Li">#</code>&#x2019;) are ignored. Variables in this
      file are only added if the variable does not already exist in the
      environment. Unlike <i class="Em">env_file</i>, the file's contents are
      not trusted and are processed in a manner similar to that of the invoking
      user's environment. If <i class="Em">env_reset</i> is enabled, variables
      in the file will only be added if they are matched by either the
      <i class="Em">env_check</i> or <i class="Em">env_keep</i> list. If
      <i class="Em">env_reset</i> is disabled, variables in the file are added
      as long as they are not matched by the <i class="Em">env_delete</i> list.
      In either case, the contents of <i class="Em">restricted_env_file</i> are
      processed before the contents of <i class="Em">env_file</i>.</dd>
  <dt>runchroot</dt>
  <dd>If set, <code class="Nm">sudo</code> will use this value for the root
      directory when running a command. The special value &#x201C;*&#x201D; will
      allow the user to specify the root directory via
      <code class="Nm">sudo</code>'s <code class="Fl">-R</code> option. See the
      <a class="Sx" href="#Chroot_Spec">Chroot_Spec</a> section for more
      details.
    <p class="Pp" id="runchroot">It is only possible to use
        <a class="permalink" href="#runchroot"><i class="Em">runchroot</i></a>
        as a command-specific Defaults setting if the command exists with the
        same path both inside and outside the chroot jail. This restriction does
        not apply to global, host, or user-based Defaults settings or to a
        <a class="permalink" href="#Cmnd_Spec"><i class="Em" id="Cmnd_Spec">Cmnd_Spec</i></a>
        that includes a <i class="Em">Chroot_Spec</i>.</p>
    <p class="Pp">This setting is only supported by version 1.9.3 or higher.</p>
  </dd>
  <dt>runcwd</dt>
  <dd>If set, <code class="Nm">sudo</code> will use this value for the working
      directory when running a command. The special value &#x201C;*&#x201D; will
      allow the user to specify the working directory via
      <code class="Nm">sudo</code>'s <code class="Fl">-D</code> option. See the
      <a class="Sx" href="#Chdir_Spec">Chdir_Spec</a> section for more details.
    <p class="Pp">This setting is only supported by version 1.9.3 or higher.</p>
  </dd>
  <dt>secure_path</dt>
  <dd>If set, <code class="Nm">sudo</code> will use this value in place of the
      user's <code class="Ev">PATH</code> environment variable. There are two
      basic use cases for <i class="Em">secure_path</i>:
    <ol class="Bl-enum">
      <li>To make it possible for <code class="Nm">sudo</code> to find system
          administrator commands located in directories that may not be in the
          default user path, such as <span class="Pa">/usr/sbin</span>.</li>
      <li>To help protect scripts and programs that execute other commands
          without first setting <code class="Ev">PATH</code> to a safe value.
          Otherwise, a user with limited privileges may be able to run arbitrary
          commands by manipulating the <code class="Ev">PATH</code> if the
          command being run executes other commands without using a
          fully-qualified path name.</li>
    </ol>
    <p class="Pp">Users in the group specified by the
        <i class="Em">exempt_group</i> option are not affected by
        <i class="Em">secure_path</i>. This option is disabled by default.</p>
  </dd>
  <dt>syslog</dt>
  <dd>Syslog facility if syslog is being used for logging (negate to disable
      syslog logging). Defaults to auth.
    <p class="Pp" id="authpriv">The following syslog facilities are supported:
        <a class="permalink" href="#authpriv"><b class="Sy">authpriv</b></a> (if
        your OS supports it), <b class="Sy">auth</b>,
        <a class="permalink" href="#daemon"><b class="Sy" id="daemon">daemon</b></a>,
        <b class="Sy">user</b>,
        <a class="permalink" href="#local0"><b class="Sy" id="local0">local0</b></a>,
        <a class="permalink" href="#local1"><b class="Sy" id="local1">local1</b></a>,
        <a class="permalink" href="#local2"><b class="Sy" id="local2">local2</b></a>,
        <a class="permalink" href="#local3"><b class="Sy" id="local3">local3</b></a>,
        <a class="permalink" href="#local4"><b class="Sy" id="local4">local4</b></a>,
        <a class="permalink" href="#local5"><b class="Sy" id="local5">local5</b></a>,
        <a class="permalink" href="#local6"><b class="Sy" id="local6">local6</b></a>,
        and
        <a class="permalink" href="#local7"><b class="Sy" id="local7">local7</b></a>.</p>
  </dd>
  <dt>syslog_badpri</dt>
  <dd>Syslog priority to use when the user is not allowed to run a command or
      when authentication is unsuccessful. Defaults to alert.
    <p class="Pp" id="alert">The following syslog priorities are supported:
        <a class="permalink" href="#alert"><b class="Sy">alert</b></a>,
        <b class="Sy">crit</b>, <b class="Sy">debug</b>,
        <a class="permalink" href="#emerg"><b class="Sy" id="emerg">emerg</b></a>,
        <b class="Sy">err</b>, <b class="Sy">info</b>, <b class="Sy">notice</b>,
        <a class="permalink" href="#warning"><b class="Sy" id="warning">warning</b></a>,
        and <b class="Sy">none</b>. Negating the option or setting it to a value
        of <b class="Sy">none</b> will disable logging of unsuccessful
      commands.</p>
  </dd>
  <dt>syslog_goodpri</dt>
  <dd>Syslog priority to use when the user is allowed to run a command and
      authentication is successful. Defaults to notice.
    <p class="Pp" id="syslog_badpri">See
        <a class="permalink" href="#syslog_badpri"><i class="Em">syslog_badpri</i></a>
        for the list of supported syslog priorities. Negating the option or
        setting it to a value of <b class="Sy">none</b> will disable logging of
        successful commands.</p>
  </dd>
  <dt>verifypw</dt>
  <dd>This option controls when a password will be required when a user runs
      <code class="Nm">sudo</code> with the <code class="Fl">-v</code> option.
      It has the following possible values:
    <dl class="Bl-tag">
      <dt>all</dt>
      <dd>All the user's <i class="Em">sudoers</i> file entries for the current
          host must have the <code class="Dv">NOPASSWD</code> flag set to avoid
          entering a password.</dd>
      <dt>always</dt>
      <dd>The user must always enter a password to use the
          <code class="Fl">-v</code> option.</dd>
      <dt>any</dt>
      <dd>At least one of the user's <i class="Em">sudoers</i> file entries for
          the current host must have the <code class="Dv">NOPASSWD</code> flag
          set to avoid entering a password.</dd>
      <dt>never</dt>
      <dd>The user need never enter a password to use the
          <code class="Fl">-v</code> option.</dd>
    </dl>
    <p class="Pp">If no value is specified, a value of <i class="Em">all</i> is
        implied. Negating the option results in a value of
        <i class="Em">never</i> being used. The default value is
        <i class="Em">all</i>.</p>
  </dd>
</dl>
<p class="Pp" id="Lists"><a class="permalink" href="#Lists"><b class="Sy">Lists
    that can be used in a boolean context</b></a>:</p>
<dl class="Bl-tag">
  <dt>env_check</dt>
  <dd>Environment variables to be removed from the user's environment unless
      they are considered &#x201C;safe&#x201D;. For all variables except
      <code class="Ev">TZ</code>, &#x201C;safe&#x201D; means that the variable's
      value does not contain any &#x2018;<code class="Li">%</code>&#x2019; or
      &#x2018;<code class="Li">/</code>&#x2019; characters. This can be used to
      guard against printf-style format vulnerabilities in poorly-written
      programs. The <code class="Ev">TZ</code> variable is considered unsafe if
      any of the following are true:
    <ul class="Bl-bullet">
      <li>It consists of a fully-qualified path name, optionally prefixed with a
          colon (&#x2018;<code class="Li">:</code>&#x2019;), that does not match
          the location of the <span class="Pa">zoneinfo</span> directory.</li>
      <li>It contains a <span class="Pa">..</span> path element.</li>
      <li>It contains white space or non-printable characters.</li>
      <li>It is longer than the value of <code class="Dv">PATH_MAX</code>.</li>
    </ul>
    <p class="Pp">The argument may be a double-quoted, space-separated list or a
        single value without double-quotes. The list can be replaced, added to,
        deleted from, or disabled by using the
        &#x2018;<code class="Li">=</code>&#x2019;,
        &#x2018;<code class="Li">+=</code>&#x2019;,
        &#x2018;<code class="Li">-=</code>&#x2019;, and
        &#x2018;<code class="Li">!</code>&#x2019; operators respectively.
        Regardless of whether the <i class="Em">env_reset</i> option is enabled
        or disabled, variables specified by <i class="Em">env_check</i> will be
        preserved in the environment if they pass the aforementioned check. The
        global list of environment variables to check is displayed when
        <code class="Nm">sudo</code> is run by <b class="Sy">root</b> with the
        <code class="Fl">-V</code> option.</p>
  </dd>
  <dt>env_delete</dt>
  <dd>Environment variables to be removed from the user's environment when the
      <i class="Em">env_reset</i> option is not in effect. The argument may be a
      double-quoted, space-separated list or a single value without
      double-quotes. The list can be replaced, added to, deleted from, or
      disabled by using the &#x2018;<code class="Li">=</code>&#x2019;,
      &#x2018;<code class="Li">+=</code>&#x2019;,
      &#x2018;<code class="Li">-=</code>&#x2019;, and
      &#x2018;<code class="Li">!</code>&#x2019; operators respectively. The
      global list of environment variables to remove is displayed when
      <code class="Nm">sudo</code> is run by <b class="Sy">root</b> with the
      <code class="Fl">-V</code> option. Many operating systems will remove
      potentially dangerous variables from the environment of any set-user-ID
      process (such as <code class="Nm">sudo</code>).</dd>
  <dt>env_keep</dt>
  <dd>Environment variables to be preserved in the user's environment when the
      <i class="Em">env_reset</i> option is in effect. This allows fine-grained
      control over the environment <code class="Nm">sudo</code>-spawned
      processes will receive. The argument may be a double-quoted,
      space-separated list or a single value without double-quotes. The list can
      be replaced, added to, deleted from, or disabled by using the
      &#x2018;<code class="Li">=</code>&#x2019;,
      &#x2018;<code class="Li">+=</code>&#x2019;,
      &#x2018;<code class="Li">-=</code>&#x2019;, and
      &#x2018;<code class="Li">!</code>&#x2019; operators respectively. The
      global list of variables to keep is displayed when
      <code class="Nm">sudo</code> is run by <b class="Sy">root</b> with the
      <code class="Fl">-V</code> option.
    <p class="Pp">Preserving the <code class="Ev">HOME</code> environment
        variable has security implications since many programs use it when
        searching for configuration or data files. Adding
        <code class="Ev">HOME</code> to <i class="Em">env_keep</i> may enable a
        user to run unrestricted commands via <code class="Nm">sudo</code> and
        is strongly discouraged. Users wishing to edit files with
        <code class="Nm">sudo</code> should run <code class="Nm">sudoedit</code>
        (or <code class="Nm">sudo</code> <code class="Fl">-e</code>) to get
        their accustomed editor configuration instead of invoking the editor
        directly.</p>
  </dd>
  <dt>log_servers</dt>
  <dd>A list of one or more servers to use for remote event and I/O log storage,
      separated by white space. Log servers must be running
      <code class="Nm">sudo_logsrvd</code> or another service that implements
      the protocol described by <a class="Xr" aria-label="sudo_logsrv.proto,
      section 5">sudo_logsrv.proto(5)</a>.
    <p class="Pp">Server addresses should be of the form
        &#x201C;host[:port][(tls)]&#x201D;. The host portion may be a host name,
        an IPv4 address, or an IPv6 address in square brackets.</p>
    <p class="Pp" id="tls">If the optional
        <a class="permalink" href="#tls"><i class="Em">tls</i></a> flag is
        present, the connection will be secured with Transport Layer Security
        (TLS) version 1.2 or 1.3. Versions of TLS prior to 1.2 are not
        supported.</p>
    <p class="Pp">If a port is specified, it may either be a port number or a
        well-known service name as defined by the system service name database.
        If no port is specified, port 30343 will be used for plaintext
        connections and port 30344 will be used for TLS connections.</p>
    <p class="Pp" id="log_file">When <i class="Em">log_servers</i> is set, event
        log data will be logged both locally (see the <i class="Em">syslog</i>
        and <a class="permalink" href="#log_file"><i class="Em">log_file</i></a>
        settings) as well as remotely, but I/O log data will only be logged
        remotely. If multiple hosts are specified, they will be attempted in
        reverse order. If no log servers are available, the user will not be
        able to run a command unless either the
        <i class="Em">ignore_iolog_errors</i> flag (I/O logging enabled) or the
        <i class="Em">ignore_log_errors</i> flag (I/O logging disabled) is set.
        Likewise, if the connection to the log server is interrupted while
        <code class="Nm">sudo</code> is running, the command will be terminated
        unless the <i class="Em">ignore_iolog_errors</i> flag (I/O logging
        enabled) or the <i class="Em">ignore_log_errors</i> flag (I/O logging
        disabled) is set.</p>
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt>passprompt_regex</dt>
  <dd>A list of POSIX extended regular expressions used to match password
      prompts in the terminal output. As an extension, if the regular expression
      begins with &#x201C;(?i)&#x201D;, it will be matched in a case-insensitive
      manner. Each regular expression is limited to 1024 characters. This option
      is only used when <i class="Em">log_passwords</i> has been disabled. The
      default value is &#x201C;[Pp]assword[: ]*&#x201D;
    <p class="Pp">This setting is only supported by version 1.9.10 or
      higher.</p>
  </dd>
</dl>
</section>
<section class="Sh">
<h2 class="Sh" id="GROUP_PROVIDER_PLUGINS"><a class="permalink" href="#GROUP_PROVIDER_PLUGINS">GROUP
  PROVIDER PLUGINS</a></h2>
<p class="Pp">The <code class="Nm">sudoers</code> plugin supports its own plugin
    interface to allow non-Unix group lookups which can query a group source
    other than the standard Unix group database. This can be used to implement
    support for the <i class="Em">nonunix_group</i> syntax described
  earlier.</p>
<p class="Pp">Group provider plugins are specified via the
    <i class="Em">group_plugin</i> setting. The argument to
    <i class="Em">group_plugin</i> should consist of the plugin path, either
    fully-qualified or relative to the
    <span class="Pa">/usr/local/libexec/sudo</span> directory, followed by any
    configuration options the plugin requires. These options (if specified) will
    be passed to the plugin's initialization function. If options are present,
    the string must be enclosed in double quotes (&quot;&quot;).</p>
<p class="Pp">The following group provider plugins are installed by default:</p>
<dl class="Bl-tag">
  <dt id="group_file">group_file</dt>
  <dd>The
      <a class="permalink" href="#group_file"><i class="Em">group_file</i></a>
      plugin supports an alternate group file that uses the same syntax as the
      <span class="Pa">/etc/group</span> file. The path to the group file should
      be specified as an option to the plugin. For example, if the group file to
      be used is <span class="Pa">/etc/sudo-group</span>:
    <div class="Bd Pp Li">
    <pre>Defaults group_plugin=&quot;group_file.so /etc/sudo-group&quot;</pre>
    </div>
  </dd>
  <dt id="system_group">system_group</dt>
  <dd>The
      <a class="permalink" href="#system_group"><i class="Em">system_group</i></a>
      plugin supports group lookups via the standard C library functions
      <a class="Xr" aria-label="getgrnam, section 3">getgrnam(3)</a> and
      <a class="Xr" aria-label="getgrid, section 3">getgrid(3)</a>. This plugin
      can be used in instances where the user belongs to groups not present in
      the user's supplemental group vector. This plugin takes no options:
    <div class="Bd Pp Li">
    <pre>Defaults group_plugin=system_group.so</pre>
    </div>
  </dd>
</dl>
<p class="Pp">The group provider plugin API is described in detail in
    <a class="Xr" aria-label="sudo_plugin, section 5">sudo_plugin(5)</a>.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="EVENT_LOGGING"><a class="permalink" href="#EVENT_LOGGING">EVENT
  LOGGING</a></h2>
<p class="Pp"><code class="Nm">sudoers</code> can log events in either JSON or
    <i class="Em">sudo</i> format, this section describes the
    <i class="Em">sudo</i> log format. Depending on <i class="Em">sudoers</i>
    configuration, <code class="Nm">sudoers</code> can log events via
    <a class="Xr" aria-label="syslog, section 3">syslog(3)</a>, to a local log
    file, or both. The log format is almost identical in both cases. Any control
    characters present in the log data are formatted in octal with a leading
    &#x2018;<code class="Li">#</code>&#x2019; character. For example, a
    horizontal tab is stored as &#x2018;<code class="Li">#011</code>&#x2019; and
    an embedded carriage return is stored as
    &#x2018;<code class="Li">#015</code>&#x2019;. In addition, space characters
    in the command path are stored as
    &#x2018;<code class="Li">#040</code>&#x2019;. Command line arguments that
    contain spaces are enclosed in single quotes (''). This makes it possible to
    distinguish multiple command line arguments from a single argument that
    contains spaces. Literal single quotes and backslash characters
    (&#x2018;<code class="Li">\</code>&#x2019;) in command line arguments are
    escaped with a backslash.</p>
<section class="Ss">
<h3 class="Ss" id="Accepted_command_log_entries"><a class="permalink" href="#Accepted_command_log_entries">Accepted
  command log entries</a></h3>
<p class="Pp">Commands that sudo runs are logged using the following format
    (split into multiple lines for readability):</p>
<div class="Bd Pp Bd-indent Li">
<pre>date hostname progname: username : TTY=ttyname ; CHROOT=chroot ; \
    PWD=cwd ; USER=runasuser ; GROUP=runasgroup ; TSID=logid ; \
    ENV=env_vars COMMAND=command</pre>
</div>
<p class="Pp">Where the fields are as follows:</p>
<dl class="Bl-tag">
  <dt>date</dt>
  <dd>The date the command was run. Typically, this is in the format
      &#x201C;MMM, DD, HH:MM:SS&#x201D;. If logging via
      <a class="Xr" aria-label="syslog, section 3">syslog(3)</a>, the actual
      date format is controlled by the syslog daemon. If logging to a file and
      the <i class="Em">log_year</i> option is enabled, the date will also
      include the year.</dd>
  <dt>hostname</dt>
  <dd>The name of the host <code class="Nm">sudo</code> was run on. This field
      is only present when logging via <a class="Xr" aria-label="syslog, section
      3">syslog(3)</a>.</dd>
  <dt>progname</dt>
  <dd>The name of the program, usually <i class="Em">sudo</i> or
      <i class="Em">sudoedit</i>. This field is only present when logging via
      <a class="Xr" aria-label="syslog, section 3">syslog(3)</a>.</dd>
  <dt>username</dt>
  <dd>The login name of the user who ran <code class="Nm">sudo</code>.</dd>
  <dt>ttyname</dt>
  <dd>The short name of the terminal (e.g., &#x201C;console&#x201D;,
      &#x201C;tty01&#x201D;, or &#x201C;pts/0&#x201D;)
      <code class="Nm">sudo</code> was run on, or &#x201C;unknown&#x201D; if
      there was no terminal present.</dd>
  <dt>chroot</dt>
  <dd>The root directory that the command was run in, if one was specified.</dd>
  <dt>cwd</dt>
  <dd>The current working directory that <code class="Nm">sudo</code> was run
      in.</dd>
  <dt>runasuser</dt>
  <dd>The user the command was run as.</dd>
  <dt>runasgroup</dt>
  <dd>The group the command was run as if one was specified on the command
    line.</dd>
  <dt>logid</dt>
  <dd>An I/O log identifier that can be used to replay the command's output.
      This is only present when the <i class="Em">log_input</i> or
      <i class="Em">log_output</i> option is enabled.</dd>
  <dt>env_vars</dt>
  <dd>A list of environment variables specified on the command line, if
      specified.</dd>
  <dt>command</dt>
  <dd>The actual command that was executed, including any command line
      arguments.</dd>
</dl>
<p class="Pp">Messages are logged using the locale specified by
    <i class="Em">sudoers_locale</i>, which defaults to the
    &#x2018;<code class="Li">C</code>&#x2019; locale.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Denied_command_log_entries"><a class="permalink" href="#Denied_command_log_entries">Denied
  command log entries</a></h3>
<p class="Pp">If the user is not allowed to run the command, the reason for the
    denial will follow the user name. Possible reasons include:</p>
<dl class="Bl-tag">
  <dt>user NOT in sudoers</dt>
  <dd>The user is not listed in the <i class="Em">sudoers</i> file.</dd>
  <dt>user NOT authorized on host</dt>
  <dd>The user is listed in the <i class="Em">sudoers</i> file but is not
      allowed to run commands on the host.</dd>
  <dt>command not allowed</dt>
  <dd>The user is listed in the <i class="Em">sudoers</i> file for the host but
      they are not allowed to run the specified command.</dd>
  <dt id="passwd_tries">3 incorrect password attempts</dt>
  <dd>The user failed to enter their password after 3 tries. The actual number
      of tries will vary based on the number of failed attempts and the value of
      the
      <a class="permalink" href="#passwd_tries"><i class="Em">passwd_tries</i></a>
      option.</dd>
  <dt>a password is required</dt>
  <dd>The <code class="Fl">-n</code> option was specified but a password was
      required.</dd>
  <dt>sorry, you are not allowed to set the following environment variables</dt>
  <dd>The user specified environment variables on the command line that were not
      allowed by <i class="Em">sudoers</i>.</dd>
</dl>
</section>
<section class="Ss">
<h3 class="Ss" id="Error_log_entries"><a class="permalink" href="#Error_log_entries">Error
  log entries</a></h3>
<p class="Pp">If an error occurs, <code class="Nm">sudoers</code> will log a
    message and, in most cases, send a message to the administrator via email.
    Possible errors include:</p>
<dl class="Bl-tag">
  <dt>parse error in /etc/sudoers near line N</dt>
  <dd><code class="Nm">sudoers</code> encountered an error when parsing the
      specified file. In some cases, the actual error may be one line above or
      below the line number listed, depending on the type of error.</dd>
  <dt>problem with defaults entries</dt>
  <dd>The <i class="Em">sudoers</i> file contains one or more unknown Defaults
      settings. This does not prevent <code class="Nm">sudo</code> from running,
      but the <i class="Em">sudoers</i> file should be checked using
      <code class="Nm">visudo</code>.</dd>
  <dt>timestamp owner (username): No such user</dt>
  <dd>The time stamp directory owner, as specified by the
      <i class="Em">timestampowner</i> setting, could not be found in the
      password database.</dd>
  <dt>unable to open/read /etc/sudoers</dt>
  <dd>The <i class="Em">sudoers</i> file could not be opened for reading. This
      can happen when the <i class="Em">sudoers</i> file is located on a remote
      file system that maps user-ID 0 to a different value. Normally,
      <code class="Nm">sudoers</code> tries to open the
      <i class="Em">sudoers</i> file using group permissions to avoid this
      problem. Consider either changing the ownership of
      <span class="Pa">/etc/sudoers</span> or adding an argument like
      &#x201C;sudoers_uid=N&#x201D; (where &#x2018;N&#x2019; is the user-ID that
      owns the <i class="Em">sudoers</i> file) to the end of the
      <code class="Nm">sudoers</code> <i class="Em">Plugin</i> line in the
      <a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a>
    file.</dd>
  <dt>unable to open /etc/sudoers</dt>
  <dd>The <span class="Pa">/etc/sudoers</span> file is missing.</dd>
  <dt>/etc/sudoers is not a regular file</dt>
  <dd>The <span class="Pa">/etc/sudoers</span> file exists but is not a regular
      file or symbolic link.</dd>
  <dt>/etc/sudoers is owned by uid N, should be 0</dt>
  <dd>The <i class="Em">sudoers</i> file has the wrong owner. If you wish to
      change the <i class="Em">sudoers</i> file owner, add
      &#x201C;sudoers_uid=N&#x201D; (where &#x2018;N&#x2019; is the user-ID that
      owns the <i class="Em">sudoers</i> file) to the
      <code class="Nm">sudoers</code> <i class="Em">Plugin</i> line in the
      <a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a>
    file.</dd>
  <dt>/etc/sudoers is world writable</dt>
  <dd>The permissions on the <i class="Em">sudoers</i> file allow all users to
      write to it. The <i class="Em">sudoers</i> file must not be
      world-writable, the default file mode is 0440 (readable by owner and
      group, writable by none). The default mode may be changed via the
      &#x201C;sudoers_mode&#x201D; option to the <code class="Nm">sudoers</code>
      <i class="Em">Plugin</i> line in the <a class="Xr" aria-label="sudo.conf,
      section 5">sudo.conf(5)</a> file.</dd>
  <dt>/etc/sudoers is owned by gid N, should be 1</dt>
  <dd>The <i class="Em">sudoers</i> file has the wrong group ownership. If you
      wish to change the <i class="Em">sudoers</i> file group ownership, add
      &#x201C;sudoers_gid=N&#x201D; (where &#x2018;N&#x2019; is the group-ID
      that owns the <i class="Em">sudoers</i> file) to the
      <code class="Nm">sudoers</code> <i class="Em">Plugin</i> line in the
      <a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a>
    file.</dd>
  <dt>unable to open /var/run/sudo/ts/user-ID</dt>
  <dd><code class="Nm">sudoers</code> was unable to read or create the user's
      time stamp file. This can happen when <i class="Em">timestampowner</i> is
      set to a user other than <b class="Sy">root</b> and the mode on
      <span class="Pa">/var/run/sudo</span> is not searchable by group or other.
      The default mode for <span class="Pa">/var/run/sudo</span> is 0711.</dd>
  <dt>unable to write to /var/run/sudo/ts/user-ID</dt>
  <dd><code class="Nm">sudoers</code> was unable to write to the user's time
      stamp file.</dd>
  <dt>/var/run/sudo/ts is owned by uid X, should be Y</dt>
  <dd>The time stamp directory is owned by a user other than
      <i class="Em">timestampowner</i>. This can occur when the value of
      <i class="Em">timestampowner</i> has been changed.
      <code class="Nm">sudoers</code> will ignore the time stamp directory until
      the owner is corrected.</dd>
  <dt>/var/run/sudo/ts is group writable</dt>
  <dd>The time stamp directory is group-writable; it should be writable only by
      <i class="Em">timestampowner</i>. The default mode for the time stamp
      directory is 0700. <code class="Nm">sudoers</code> will ignore the time
      stamp directory until the mode is corrected.</dd>
</dl>
</section>
<section class="Ss">
<h3 class="Ss" id="Notes_on_logging_via_syslog"><a class="permalink" href="#Notes_on_logging_via_syslog">Notes
  on logging via syslog</a></h3>
<p class="Pp">By default, <code class="Nm">sudoers</code> logs messages via
    <a class="Xr" aria-label="syslog, section 3">syslog(3)</a>. The
    <a class="permalink" href="#date"><i class="Em" id="date">date</i></a>,
    <i class="Em">hostname</i>, and <i class="Em">progname</i> fields are added
    by the system's <a class="Xr" aria-label="syslog, section 3">syslog(3)</a>
    function, not <code class="Nm">sudoers</code> itself. As such, they may vary
    in format on different systems.</p>
<p class="Pp">The maximum size of syslog messages varies from system to system.
    The <i class="Em">syslog_maxlen</i> setting can be used to change the
    maximum syslog message size from the default value of 980 bytes. For more
    information, see the description of <i class="Em">syslog_maxlen</i>.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Notes_on_logging_to_a_file"><a class="permalink" href="#Notes_on_logging_to_a_file">Notes
  on logging to a file</a></h3>
<p class="Pp">If the <i class="Em">logfile</i> option is set,
    <code class="Nm">sudoers</code> will log to a local file, such as
    <span class="Pa">/var/log/sudo</span>. When logging to a file,
    <code class="Nm">sudoers</code> uses a format similar to
    <a class="Xr" aria-label="syslog, section 3">syslog(3)</a>, with a few
    important differences:</p>
<ol class="Bl-enum">
  <li>The <i class="Em">progname</i> field is not present.</li>
  <li id="log_host">The <i class="Em">hostname</i> is only logged if the
      <a class="permalink" href="#log_host"><i class="Em">log_host</i></a>
      option is enabled.</li>
  <li>The date does not include the year unless the <i class="Em">log_year</i>
      option is enabled.</li>
  <li>Lines that are longer than <i class="Em">loglinelen</i> characters (80 by
      default) are word-wrapped and continued on the next line with a four
      character indent. This makes entries easier to read for a human being, but
      makes it more difficult to use <a class="Xr" aria-label="grep, section
      1">grep(1)</a> on the log files. If the <i class="Em">loglinelen</i>
      option is set to 0 (or negated with a
      &#x2018;<code class="Li">!</code>&#x2019;), word wrap will be
    disabled.</li>
</ol>
</section>
</section>
<section class="Sh">
<h2 class="Sh" id="I/O_LOGGING"><a class="permalink" href="#I/O_LOGGING">I/O
  LOGGING</a></h2>
<p class="Pp">When I/O logging is enabled, <code class="Nm">sudo</code> will
    runs the command in a pseudo-terminal, logging user input and/or output,
    depending on which <code class="Nm">sudoers</code> flags are enabled. There
    are five distinct types of I/O that can be logged, each with a corresponding
    <code class="Nm">sudoers</code> flag.</p>
<table class="Bl-column">
  <tr id="Type">
    <td><a class="permalink" href="#Type"><b class="Sy">Type</b></a></td>
    <td><a class="permalink" href="#Flag"><b class="Sy" id="Flag">Flag</b></a></td>
    <td><a class="permalink" href="#Description"><b class="Sy" id="Description">Description</b></a></td>
  </tr>
  <tr>
    <td>terminal input</td>
    <td>log_ttyin</td>
    <td>keystrokes entered by the user</td>
  </tr>
  <tr>
    <td>terminal output</td>
    <td>log_ttyout</td>
    <td>command output displayed to the screen</td>
  </tr>
  <tr>
    <td>standard input</td>
    <td>log_stdin</td>
    <td>input from a pipe or a file</td>
  </tr>
  <tr>
    <td>standard output</td>
    <td>log_stdout</td>
    <td>output to a pipe or a file</td>
  </tr>
  <tr>
    <td>standard error</td>
    <td>log_stderr</td>
    <td>output to a pipe or a file</td>
  </tr>
</table>
<p class="Pp">In addition to flags described the above, the
    <i class="Em">log_input</i> flag and <code class="Dv">LOG_INPUT</code>
    command tag set both <i class="Em">log_ttyin</i> and
    <i class="Em">log_stdin</i>. The <i class="Em">log_output</i> flag and
    <code class="Dv">LOG_OUTPUT</code> command tag set
    <i class="Em">log_ttyout</i>, <i class="Em">log_stdout</i>, and
    <i class="Em">log_stderr</i>.</p>
<p class="Pp">To capture terminal input and output, <code class="Nm">sudo</code>
    run the command in a pseudo-terminal, logging the input and output before
    passing it on to the user. To capture the standard input, standard output or
    standard error, <code class="Nm">sudo</code> uses a pipe to interpose itself
    between the input or output stream, logging the I/O before passing it to the
    other end of the pipe.</p>
<p class="Pp">I/O can be logged either to the local machine or to a remote log
    server. For local logs, I/O is logged to the directory specified by the
    <i class="Em">iolog_dir</i> option (<span class="Pa">/var/log/sudo-io</span>
    by default) using a unique session ID that is included in the
    <code class="Nm">sudo</code> log line, prefixed with
    &#x2018;<code class="Li">TSID=</code>&#x2019;. The
    <i class="Em">iolog_file</i> option may be used to control the format of the
    session ID. For remote logs, the <i class="Em">log_servers</i> setting is
    used to specify one or more log servers running
    <code class="Nm">sudo_logsrvd</code> or another server that implements the
    protocol described by <a class="Xr" aria-label="sudo_logsrv.proto, section
    5">sudo_logsrv.proto(5)</a>.</p>
<section class="Ss">
<h3 class="Ss" id="I/O_logging_pitfals"><a class="permalink" href="#I/O_logging_pitfals">I/O
  logging pitfals</a></h3>
<p class="Pp">When logging standard input, anything sent to the standard input
    will be consumed, regardless of whether or not the command run via
    <code class="Nm">sudo</code> is actively reading the standard input. This
    may have unexpected results when using <code class="Nm">sudo</code> in a
    shell script that expects to process the standard input. For example, given
    the following shell script:</p>
<div class="Bd Pp Bd-indent Li">
<pre>#!/bin/sh
sudo echo testing
echo done</pre>
</div>
<p class="Pp">It will behave as expected when the script is passed to the shell
    as a an argument:</p>
<div class="Bd Pp Bd-indent Li">
<pre>$ sh test.sh
testing
done</pre>
</div>
<p class="Pp">However, if the script is passed to the shell on the standard
    input, the &#x2018;<code class="Li">sudo echo testing</code>&#x2019; command
    will consume the rest of the script. This means that the
    &#x2018;<code class="Li">echo done</code>&#x2019; statement is never
    executed.</p>
<div class="Bd Pp Bd-indent Li">
<pre>$ sh -s &lt; test.sh
testing</pre>
</div>
<p class="Pp">There are several ways to work around this problem:</p>
<ol class="Bl-enum">
  <li>Redirect the standard input from <span class="Pa">/dev/null</span> when
      running a command via <code class="Nm">sudo</code> that does not need to
      read the standard input.
    <div class="Bd Pp Bd-indent Li">
    <pre>sudo echo testing &lt; /dev/null</pre>
    </div>
  </li>
  <li>Pass the script to the shell by path name instead of via the standard
      input.
    <div class="Bd Pp Bd-indent Li">
    <pre>sh test.sh</pre>
    </div>
  </li>
  <li>Disable logging the standard input for commands that do not need to read
      the standard input.
    <div class="Bd Pp Bd-indent Li">
    <pre>Defaults!/bin/echo !log_stdin</pre>
    </div>
  </li>
</ol>
<p class="Pp">Depending on the command, it may not be desirable to log the
    standard input or standard output. For example, I/O logging of commands that
    send or receive large amount of data via the standard output or standard
    input such as <a class="Xr" aria-label="rsync, section 1">rsync(1)</a> and
    <a class="Xr" aria-label="tar, section 1">tar(1)</a> could fill up the log
    file system with superfluous data. It is possible to disable logging of the
    standard input and standard output for such commands as follows:</p>
<div class="Bd Pp Bd-indent Li">
<pre>Cmnd_Alias COPY_CMDS = /usr/bin/tar, /usr/bin/cpio, /usr/bin/rsync
<p># Log input and output but omit stdin and stdout when copying files.
Defaults log_input, log_output
Defaults!COPY_CMDS !log_stdin, !log_stdout</pre></p>
</div>
<p class="Pp" id="log_ouput">However, be aware that using the
    <i class="Em">log_input</i> flag or the <code class="Dv">LOG_INPUT</code>
    command tag will also enable <i class="Em">log_stdin</i>. Likewise, the
    <a class="permalink" href="#log_ouput"><i class="Em">log_ouput</i></a> flag
    or the <code class="Dv">LOG_OUTPUT</code> command tag will enable
    <i class="Em">log_stdout</i> and <i class="Em">log_stderr</i>. Careful
    ordering of rules may be necessary to achieve the results that you
  expect.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="I/O_log_format"><a class="permalink" href="#I/O_log_format">I/O
  log format</a></h3>
<p class="Pp">For both local and remote I/O logs, each log is stored in a
    separate directory that contains the following files:</p>
<dl class="Bl-tag">
  <dt><span class="Pa">log</span></dt>
  <dd>A text file containing information about the command. The first line
      consists of the following colon-delimited fields: the time the command was
      run, the name of the user who ran <code class="Nm">sudo</code>, the name
      of the target user, the name of the target group (optional), the terminal
      that <code class="Nm">sudo</code> was run from, and the number of lines
      and columns of the terminal. The second and third lines contain the
      working directory the command was run from and the path name of the
      command itself (with arguments if present).</dd>
  <dt><span class="Pa">log.json</span></dt>
  <dd>A JSON-formatted file containing information about the command. This is
      similar to the <span class="Pa">log</span> file but contains additional
      information and is easily extensible. The <span class="Pa">log.json</span>
      file will be used by <a class="Xr" aria-label="sudoreplay, section
      8">sudoreplay(8)</a> in preference to the <span class="Pa">log</span> file
      if it exists. The file may contain the following elements:
    <dl class="Bl-tag">
      <dt id="seconds">timestamp</dt>
      <dd>A JSON object containing time the command was run. It consists of two
          values,
          <a class="permalink" href="#seconds"><i class="Em">seconds</i></a> and
          <a class="permalink" href="#nanoseconds"><i class="Em" id="nanoseconds">nanoseconds</i></a>.</dd>
      <dt>columns</dt>
      <dd>The number of columns of the terminal the command ran on, or zero if
          no terminal was present.</dd>
      <dt>command</dt>
      <dd>The fully-qualified path of the command that was run.</dd>
      <dt>lines</dt>
      <dd>The number of lines of the terminal the command ran on, or zero if no
          terminal was present.</dd>
      <dt>runargv</dt>
      <dd>A JSON array representing the command's argument vector as passed to
          the <a class="Xr" aria-label="execve, section 2">execve(2)</a> system
          call.</dd>
      <dt>runenv</dt>
      <dd>A JSON array representing the command's environment as passed to the
          <a class="Xr" aria-label="execve, section 2">execve(2)</a> system
          call.</dd>
      <dt>rungid</dt>
      <dd>The group ID the command ran as. This element is only present when the
          user specifies a group on the command line.</dd>
      <dt>rungroup</dt>
      <dd>The name of the group the command ran as. This element is only present
          when the user specifies a group on the command line.</dd>
      <dt>runuid</dt>
      <dd>The user ID the command ran as.</dd>
      <dt>runuser</dt>
      <dd>The name of the user the command ran as.</dd>
      <dt>submitcwd</dt>
      <dd>The current working directory at the time <code class="Nm">sudo</code>
          was run.</dd>
      <dt>submithost</dt>
      <dd>The name of the host the command was run on.</dd>
      <dt>submituser</dt>
      <dd>The name of the user who ran the command via
          <code class="Nm">sudo</code>.</dd>
      <dt id="ttyname">ttyname</dt>
      <dd>The path name of the terminal the user invoked
          <code class="Nm">sudo</code> from. If the command was run in a
          pseudo-terminal,
          <a class="permalink" href="#ttyname"><i class="Em">ttyname</i></a>
          will be different from the terminal the command actually ran in.</dd>
    </dl>
  </dd>
  <dt><span class="Pa">timing</span></dt>
  <dd>Timing information used to replay the session. Each line consists of the
      I/O log entry type and amount of time since the last entry, followed by
      type-specific data. The I/O log entry types and their corresponding
      type-specific data are:
    <p class="Pp"></p>
    <dl class="Bl-tag Bl-compact">
      <dt>0</dt>
      <dd>standard input, number of bytes in the entry</dd>
      <dt>1</dt>
      <dd>standard output, number of bytes in the entry</dd>
      <dt>2</dt>
      <dd>standard error, number of bytes in the entry</dd>
      <dt>3</dt>
      <dd>terminal input, number of bytes in the entry</dd>
      <dt>4</dt>
      <dd>terminal output, number of bytes in the entry</dd>
      <dt>5</dt>
      <dd>window change, new number lines and columns</dd>
      <dt>6</dt>
      <dd>bug compatibility for <code class="Nm">sudo</code> 1.8.7 terminal
          output</dd>
      <dt>7</dt>
      <dd>command suspend or resume, signal received</dd>
    </dl>
  </dd>
  <dt><span class="Pa">ttyin</span></dt>
  <dd>Raw input from the user's terminal, exactly as it was received. This file
      is only present if the <i class="Em">log_input</i> or
      <i class="Em">log_ttyin</i> flags are set and <code class="Nm">sudo</code>
      was run from a terminal. No post-processing is performed. For manual
      viewing, you may wish to convert carriage return characters in the log to
      line feeds. For example: &#x2018;<code class="Li">gunzip -c ttyin | tr
      &quot;\r&quot; &quot;\n&quot;</code>&#x2019;</dd>
  <dt><span class="Pa">stdin</span></dt>
  <dd>The standard input when no terminal is present, or input redirected from a
      pipe or file. This file is only present if the <i class="Em">log_input</i>
      or <i class="Em">log_stdin</i> flags are set and the standard input is not
      connected to a terminal.</dd>
  <dt><span class="Pa">ttyout</span></dt>
  <dd>Output from the pseudo-terminal (what the command writes to the screen).
      Terminal-specific post-processing is performed before the data is logged.
      This means that, for example, line feeds are usually converted to line
      feed/carriage return pairs and tabs may be expanded to spaces. This file
      is only present if the <i class="Em">log_output</i> or
      <i class="Em">log_ttyout</i> flags are set and
      <code class="Nm">sudo</code> was run from a terminal.</dd>
  <dt><span class="Pa">stdout</span></dt>
  <dd>The standard output when no terminal is present, or output redirected to a
      pipe or file. This file is only present if the
      <i class="Em">log_output</i> or <i class="Em">log_stdout</i> flags are set
      and the standard output is not connected to a terminal.</dd>
  <dt><span class="Pa">stderr</span></dt>
  <dd>The standard error when no terminal is present, or output redirected to a
      pipe or file. This file is only present if the
      <i class="Em">log_output</i> or <i class="Em">log_stderr</i> flags are set
      and the standard error is not connected to a terminal.</dd>
</dl>
<p class="Pp" id="compress_io">All files other than <span class="Pa">log</span>
    are compressed in gzip format unless the
    <a class="permalink" href="#compress_io"><i class="Em">compress_io</i></a>
    flag has been disabled. Due to buffering, it is not normally possible to
    display the I/O logs in real-time as the program is executing. The I/O log
    data will not be complete until the program run by
    <code class="Nm">sudo</code> has exited or has been terminated by a signal.
    The
    <a class="permalink" href="#iolog_flush"><i class="Em" id="iolog_flush">iolog_flush</i></a>
    flag can be used to disable buffering, in which case I/O log data is written
    to disk as soon as it is available. The output portion of an I/O log file
    can be viewed with the <a class="Xr" aria-label="sudoreplay, section
    8">sudoreplay(8)</a> utility, which can also be used to list or search the
    available logs.</p>
<p class="Pp">User input may contain sensitive information such as passwords
    (even if they are not echoed to the screen), which will be stored in the log
    file unencrypted. In most cases, logging the command output via
    <i class="Em">log_output</i> or <code class="Dv">LOG_OUTPUT</code> is all
    that is required. When logging input, consider disabling the
    <i class="Em">log_passwords</i> flag.</p>
<p class="Pp">Since each session's I/O logs are stored in a separate directory,
    traditional log rotation utilities cannot be used to limit the number of I/O
    logs. The simplest way to limit the number of I/O is by setting the
    <i class="Em">maxseq</i> option to the maximum number of logs you wish to
    store. Once the I/O log sequence number reaches <i class="Em">maxseq</i>, it
    will be reset to zero and <code class="Nm">sudoers</code> will truncate and
    reuse any existing I/O logs.</p>
</section>
</section>
<section class="Sh">
<h2 class="Sh" id="FILES"><a class="permalink" href="#FILES">FILES</a></h2>
<dl class="Bl-tag">
  <dt><span class="Pa">/etc/sudo.conf</span></dt>
  <dd>Sudo front-end configuration</dd>
  <dt><span class="Pa">/etc/sudoers</span></dt>
  <dd>List of who can run what</dd>
  <dt><span class="Pa">/etc/group</span></dt>
  <dd>Local groups file</dd>
  <dt><span class="Pa">/etc/netgroup</span></dt>
  <dd>List of network groups</dd>
  <dt><span class="Pa">/var/log/sudo-io</span></dt>
  <dd>I/O log files</dd>
  <dt><span class="Pa">/var/run/sudo/ts</span></dt>
  <dd>Directory containing time stamps for the <code class="Nm">sudoers</code>
      security policy</dd>
  <dt><span class="Pa">/var/adm/sudo/lectured</span></dt>
  <dd>Directory containing lecture status files for the
      <code class="Nm">sudoers</code> security policy</dd>
  <dt><span class="Pa">/etc/environment</span></dt>
  <dd>Initial environment for <code class="Fl">-i</code> mode on AIX and Linux
      systems</dd>
</dl>
</section>
<section class="Sh">
<h2 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h2>
<p class="Pp">Below are example <i class="Em">sudoers</i> file entries.
    Admittedly, some of these are a bit contrived. First, we allow a few
    environment variables to pass and then define our
  <i class="Em">aliases</i>:</p>
<div class="Bd Pp Li">
<pre># Run X applications through sudo; HOME is used to find the
&#35; .Xauthority file.  Other programs use HOME to locate configuration
&#35; files and this may lead to privilege escalation!
Defaults env_keep += &quot;DISPLAY HOME&quot;
<p># User alias specification
User_Alias	FULLTIMERS = millert, mikef, dowdy
User_Alias	PARTTIMERS = bostley, jwfox, crawl
User_Alias	WEBADMIN = will, wendy, wim</p>
<p># Runas alias specification
Runas_Alias	OP = root, operator
Runas_Alias	DB = oracle, sybase
Runas_Alias	ADMINGRP = adm, oper</p>
<p># Host alias specification
Host_Alias	SPARC = bigtime, eclipse, moet, anchor :<br>
SGI = grolsch, dandelion, black :<br>
ALPHA = widget, thalamus, foobar :<br>
HPPA = boa, nag, python
Host_Alias	CUNETS = 128.138.0.0/255.255.0.0
Host_Alias	CSNETS = 128.138.243.0, 128.138.204.0/24, 128.138.242.0
Host_Alias	SERVERS = primary, mail, www, ns
Host_Alias	CDROM = orion, perseus, hercules</p>
<p># Cmnd alias specification
Cmnd_Alias	DUMPS = /usr/bin/mt, /usr/sbin/dump, /usr/sbin/rdump,<br>
/usr/sbin/restore, /usr/sbin/rrestore,<br>
sha224:0GomF8mNN3wlDt1HD9XldjJ3SNgpFdbjO1+NsQ== <br>
/home/operator/bin/start_backups
Cmnd_Alias	KILL = /usr/bin/kill
Cmnd_Alias	PRINTING = /usr/sbin/lpc, /usr/bin/lprm
Cmnd_Alias	SHUTDOWN = /usr/sbin/shutdown
Cmnd_Alias	HALT = /usr/sbin/halt
Cmnd_Alias	REBOOT = /usr/sbin/reboot
Cmnd_Alias	SHELLS = /usr/bin/sh, /usr/bin/csh, /usr/bin/ksh,<br>
/usr/local/bin/tcsh, /usr/bin/rsh,<br>
/usr/local/bin/zsh
Cmnd_Alias	SU = /usr/bin/su
Cmnd_Alias	PAGERS = /usr/bin/more, /usr/bin/pg, /usr/bin/less</pre></p>
</div>
<p class="Pp">Here we override some of the compiled in default values. We want
    <code class="Nm">sudo</code> to log via <a class="Xr" aria-label="syslog,
    section 3">syslog(3)</a> using the <i class="Em">auth</i> facility in all
    cases and for commands to be run with the target user's home directory as
    the working directory. We don't want to subject the full time staff to the
    <code class="Nm">sudo</code> lecture and we want to allow them to run
    commands in a <a class="Xr" aria-label="chroot, section 2">chroot(2)</a>
    &#x201C;sandbox&#x201D; via the <code class="Fl">-R</code> option. User
    <b class="Sy">millert</b> need not provide a password and we don't want to
    reset the <code class="Ev">LOGNAME</code> or <code class="Ev">USER</code>
    environment variables when running commands as <b class="Sy">root</b>.
    Additionally, on the machines in the <code class="Dv">SERVERS</code>
    <i class="Em">Host_Alias</i>, we keep an additional local log file and make
    sure we log the year in each log line since the log entries will be kept
    around for several years. Lastly, we disable shell escapes for the commands
    in the PAGERS <i class="Em">Cmnd_Alias</i>
    (<span class="Pa">/usr/bin/more</span>, <span class="Pa">/usr/bin/pg</span>
    and <span class="Pa">/usr/bin/less</span>). This will not effectively
    constrain users with <code class="Nm">sudo</code> <b class="Sy">ALL</b>
    privileges.</p>
<div class="Bd Pp Li">
<pre># Override built-in defaults
Defaults		syslog=auth,runcwd=~
Defaults&gt;root		!set_logname
Defaults:FULLTIMERS	!lecture,runchroot=*
Defaults:millert	!authenticate
Defaults@SERVERS	log_year, logfile=/var/log/sudo.log
Defaults!PAGERS		noexec</pre>
</div>
<p class="Pp">The <i class="Em">User specification</i> is the part that actually
    determines who may run what.</p>
<div class="Bd Pp Li">
<pre>root		ALL = (ALL) ALL
%wheel		ALL = (ALL) ALL</pre>
</div>
<p class="Pp">We let <b class="Sy">root</b> and any user in group
    <b class="Sy">wheel</b> run any command on any host as any user.</p>
<div class="Bd Pp Li">
<pre>FULLTIMERS	ALL = NOPASSWD: ALL</pre>
</div>
<p class="Pp" id="mikef">Full time sysadmins (<b class="Sy">millert</b>,
    <a class="permalink" href="#mikef"><b class="Sy">mikef</b></a>, and
    <a class="permalink" href="#dowdy"><b class="Sy" id="dowdy">dowdy</b></a>)
    may run any command on any host without authenticating themselves.</p>
<div class="Bd Pp Li">
<pre>PARTTIMERS	ALL = ALL</pre>
</div>
<p class="Pp" id="bostley">Part time sysadmins
    <a class="permalink" href="#bostley"><b class="Sy">bostley</b></a>,
    <a class="permalink" href="#jwfox"><b class="Sy" id="jwfox">jwfox</b></a>,
    and
    <a class="permalink" href="#crawl"><b class="Sy" id="crawl">crawl</b></a>)
    may run any command on any host but they must authenticate themselves first
    (since the entry lacks the <code class="Dv">NOPASSWD</code> tag).</p>
<div class="Bd Pp Li">
<pre>jack		CSNETS = ALL</pre>
</div>
<p class="Pp" id="jack">The user
    <a class="permalink" href="#jack"><b class="Sy">jack</b></a> may run any
    command on the machines in the <code class="Dv">CSNETS</code> alias (the
    networks 128.138.243.0, 128.138.204.0, and 128.138.242.0). Of those
    networks, only 128.138.204.0 has an explicit netmask (in CIDR notation)
    indicating it is a class C network. For the other networks in
    <code class="Dv">CSNETS</code>, the local machine's netmask will be used
    during matching.</p>
<div class="Bd Pp Li">
<pre>lisa		CUNETS = ALL</pre>
</div>
<p class="Pp" id="lisa">The user
    <a class="permalink" href="#lisa"><b class="Sy">lisa</b></a> may run any
    command on any host in the <code class="Dv">CUNETS</code> alias (the class B
    network 128.138.0.0).</p>
<div class="Bd Pp Li">
<pre>operator	ALL = DUMPS, KILL, SHUTDOWN, HALT, REBOOT, PRINTING,\
		sudoedit /etc/printcap, /usr/oper/bin/</pre>
</div>
<p class="Pp">The <b class="Sy">operator</b> user may run commands limited to
    simple maintenance. Here, those are commands related to backups, killing
    processes, the printing system, shutting down the system, and any commands
    in the directory <span class="Pa">/usr/oper/bin/</span>. One command in the
    <code class="Dv">DUMPS</code> Cmnd_Alias includes a sha224 digest,
    <span class="Pa">/home/operator/bin/start_backups</span>. This is because
    the directory containing the script is writable by the operator user. If the
    script is modified (resulting in a digest mismatch) it will no longer be
    possible to run it via <code class="Nm">sudo</code>.</p>
<div class="Bd Pp Li">
<pre>joe		ALL = /usr/bin/su operator</pre>
</div>
<p class="Pp" id="joe">The user
    <a class="permalink" href="#joe"><b class="Sy">joe</b></a> may only
    <a class="Xr" aria-label="su, section 1">su(1)</a> to operator.</p>
<div class="Bd Pp Li">
<pre>pete		HPPA = /usr/bin/passwd [A-Za-z]*, !/usr/bin/passwd *root*
<p>%opers		ALL = (: ADMINGRP) /usr/sbin/</pre></p>
</div>
<p class="Pp" id="opers">Users in the
    <a class="permalink" href="#opers"><b class="Sy">opers</b></a> group may run
    commands in <span class="Pa">/usr/sbin/</span> as themselves with any group
    in the <code class="Dv">ADMINGRP</code> <i class="Em">Runas_Alias</i> (the
    <a class="permalink" href="#adm"><b class="Sy" id="adm">adm</b></a> and
    <a class="permalink" href="#oper"><b class="Sy" id="oper">oper</b></a>
    groups).</p>
<p class="Pp" id="pete">The user
    <a class="permalink" href="#pete"><b class="Sy">pete</b></a> is allowed to
    change anyone's password except for <b class="Sy">root</b> on the
    <code class="Dv">HPPA</code> machines. Because command line arguments are
    matched as a single, concatenated string, the
    &#x2018;<code class="Li">*</code>&#x2019; wildcard will match
    <a class="permalink" href="#multiple"><i class="Em" id="multiple">multiple</i></a>
    words. This example assumes that <a class="Xr" aria-label="passwd, section
    1">passwd(1)</a> does not take multiple user names on the command line. On
    systems with GNU <a class="Xr" aria-label="getopt, section 3">getopt(3)</a>,
    options to <a class="Xr" aria-label="passwd, section 1">passwd(1)</a> may be
    specified after the user argument. As a result, this rule will also
  allow:</p>
<div class="Bd Pp Bd-indent Li">
<pre>passwd username --expire</pre>
</div>
<p class="Pp">which may not be desirable.</p>
<div class="Bd Pp Li">
<pre>bob		SPARC = (OP) ALL : SGI = (OP) ALL</pre>
</div>
<p class="Pp" id="bob">The user
    <a class="permalink" href="#bob"><b class="Sy">bob</b></a> may run anything
    on the <code class="Dv">SPARC</code> and <code class="Dv">SGI</code>
    machines as any user listed in the <code class="Dv">OP</code>
    <i class="Em">Runas_Alias</i> (<b class="Sy">root</b> and
    <b class="Sy">operator</b>.)</p>
<div class="Bd Pp Li">
<pre>jim		+biglab = ALL</pre>
</div>
<p class="Pp" id="jim">The user
    <a class="permalink" href="#jim"><b class="Sy">jim</b></a> may run any
    command on machines in the
    <a class="permalink" href="#biglab"><i class="Em" id="biglab">biglab</i></a>
    netgroup. <code class="Nm">sudo</code> knows that &#x201C;biglab&#x201D; is
    a netgroup due to the &#x2018;<code class="Li">+</code>&#x2019; prefix.</p>
<div class="Bd Pp Li">
<pre>+secretaries	ALL = PRINTING, /usr/bin/adduser, /usr/bin/rmuser</pre>
</div>
<p class="Pp" id="secretaries">Users in the
    <a class="permalink" href="#secretaries"><b class="Sy">secretaries</b></a>
    netgroup need to help manage the printers as well as add and remove users,
    so they are allowed to run those commands on all machines.</p>
<div class="Bd Pp Li">
<pre>fred		ALL = (DB) NOPASSWD: ALL</pre>
</div>
<p class="Pp" id="fred">The user
    <a class="permalink" href="#fred"><b class="Sy">fred</b></a> can run
    commands as any user in the <code class="Dv">DB</code>
    <i class="Em">Runas_Alias</i>
    (<a class="permalink" href="#oracle"><b class="Sy" id="oracle">oracle</b></a>
    or
    <a class="permalink" href="#sybase"><b class="Sy" id="sybase">sybase</b></a>)
    without giving a password.</p>
<div class="Bd Pp Li">
<pre>john		ALPHA = /usr/bin/su [!-]*, !/usr/bin/su *root*</pre>
</div>
<p class="Pp">On the <code class="Dv">ALPHA</code> machines, user
    <b class="Sy">john</b> may su to anyone except <b class="Sy">root</b> but he
    is not allowed to specify any options to the <a class="Xr" aria-label="su,
    section 1">su(1)</a> command.</p>
<div class="Bd Pp Li">
<pre>jen		ALL, !SERVERS = ALL</pre>
</div>
<p class="Pp" id="jen">The user
    <a class="permalink" href="#jen"><b class="Sy">jen</b></a> may run any
    command on any machine except for those in the
    <code class="Dv">SERVERS</code> <i class="Em">Host_Alias</i> (primary, mail,
    www, and ns).</p>
<div class="Bd Pp Li">
<pre>jill		SERVERS = /usr/bin/, !SU, !SHELLS</pre>
</div>
<p class="Pp" id="jill">For any machine in the <code class="Dv">SERVERS</code>
    <i class="Em">Host_Alias</i>,
    <a class="permalink" href="#jill"><b class="Sy">jill</b></a> may run any
    commands in the directory <span class="Pa">/usr/bin/</span> except for those
    commands belonging to the <code class="Dv">SU</code> and
    <code class="Dv">SHELLS</code>
    <a class="permalink" href="#Cmnd_Aliases"><i class="Em" id="Cmnd_Aliases">Cmnd_Aliases</i></a>.
    While not specifically mentioned in the rule, the commands in the
    <code class="Dv">PAGERS</code> <i class="Em">Cmnd_Alias</i> all reside in
    <span class="Pa">/usr/bin</span> and have the <i class="Em">noexec</i>
    option set.</p>
<div class="Bd Pp Li">
<pre>steve		CSNETS = (operator) /usr/local/op_commands/</pre>
</div>
<p class="Pp" id="steve">The user
    <a class="permalink" href="#steve"><b class="Sy">steve</b></a> may run any
    command in the directory /usr/local/op_commands/ but only as user
  operator.</p>
<div class="Bd Pp Li">
<pre>matt		valkyrie = KILL</pre>
</div>
<p class="Pp" id="matt">On his personal workstation, valkyrie,
    <a class="permalink" href="#matt"><b class="Sy">matt</b></a> needs to be
    able to kill hung processes.</p>
<div class="Bd Pp Li">
<pre>WEBADMIN	www = (www) ALL, (root) /usr/bin/su www</pre>
</div>
<p class="Pp">On the host www, any user in the <code class="Dv">WEBADMIN</code>
    <i class="Em">User_Alias</i> (will, wendy, and wim), may run any command as
    user www (which owns the web pages) or simply <a class="Xr" aria-label="su,
    section 1">su(1)</a> to www.</p>
<div class="Bd Pp Li">
<pre>ALL		CDROM = NOPASSWD: /sbin/umount /CDROM,\
		/sbin/mount -o nosuid\,nodev /dev/cd0a /CDROM</pre>
</div>
<p class="Pp">Any user may mount or unmount a CD-ROM on the machines in the
    CDROM <i class="Em">Host_Alias</i> (orion, perseus, hercules) without
    entering a password. This is a bit tedious for users to type, so it is a
    prime candidate for encapsulating in a shell script.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="SECURITY_NOTES"><a class="permalink" href="#SECURITY_NOTES">SECURITY
  NOTES</a></h2>
<section class="Ss">
<h3 class="Ss" id="Limitations_of_the_!"><a class="permalink" href="#Limitations_of_the_!">Limitations
  of the &#x2018;!&#x2019; operator</a></h3>
<p class="Pp">It is generally not effective to &#x201C;subtract&#x201D; commands
    from <b class="Sy">ALL</b> using the
    &#x2018;<code class="Li">!</code>&#x2019; operator. A user can trivially
    circumvent this by copying the desired command to a different name and then
    executing that. For example:</p>
<div class="Bd Pp Li">
<pre>bill	ALL = ALL, !SU, !SHELLS</pre>
</div>
<p class="Pp" id="bill">Doesn't really prevent
    <a class="permalink" href="#bill"><b class="Sy">bill</b></a> from running
    the commands listed in <code class="Dv">SU</code> or
    <code class="Dv">SHELLS</code> since he can simply copy those commands to a
    different name, or use a shell escape from an editor or other program.
    Therefore, these kind of restrictions should be considered advisory at best
    (and reinforced by policy).</p>
<p class="Pp">In general, if a user has sudo <b class="Sy">ALL</b> there is
    nothing to prevent them from creating their own program that gives them a
    <b class="Sy">root</b> shell (or making their own copy of a shell)
    regardless of any &#x2018;<code class="Li">!</code>&#x2019; elements in the
    user specification.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Security_implications_of_fast_glob"><a class="permalink" href="#Security_implications_of_fast_glob">Security
  implications of <i class="Em">fast_glob</i></a></h3>
<p class="Pp">If the <i class="Em">fast_glob</i> option is in use, it is not
    possible to reliably negate commands where the path name includes globbing
    (aka wildcard) characters. This is because the C library's
    <a class="Xr" aria-label="fnmatch, section 3">fnmatch(3)</a> function cannot
    resolve relative paths. While this is typically only an inconvenience for
    rules that grant privileges, it can result in a security issue for rules
    that subtract or revoke privileges.</p>
<p class="Pp">For example, given the following <i class="Em">sudoers</i> file
    entry:</p>
<div class="Bd Pp Li">
<pre>john	ALL = /usr/bin/passwd [a-zA-Z0-9]*, /usr/bin/chsh [a-zA-Z0-9]*,\
              /usr/bin/chfn [a-zA-Z0-9]*, !/usr/bin/* root</pre>
</div>
<p class="Pp">User <b class="Sy">john</b> can still run
    &#x2018;<code class="Li">/usr/bin/passwd root</code>&#x2019; if
    <i class="Em">fast_glob</i> is enabled by changing to
    <span class="Pa">/usr/bin</span> and running
    &#x2018;<code class="Li">./passwd root</code>&#x2019; instead.</p>
<p class="Pp">Another potential issue is that when <code class="Nm">sudo</code>
    executes the command, it must use the command or path specified by the user
    instead of a path listed in the <i class="Em">sudoers</i> file. This may
    lead to a time of check versus time of use race condition.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Wildcards_in_command_arguments"><a class="permalink" href="#Wildcards_in_command_arguments">Wildcards
  in command arguments</a></h3>
<p class="Pp">Command line arguments are matched as a single, concatenated
    string. This mean a wildcard character such as
    &#x2018;<code class="Li">?</code>&#x2019; or
    &#x2018;<code class="Li">*</code>&#x2019; will match across word boundaries,
    which may be unexpected. For example, while a sudoers entry like:</p>
<div class="Bd Pp Bd-indent Li">
<pre>%operator ALL = /bin/cat /var/log/messages*</pre>
</div>
<p class="Pp">will allow command like:</p>
<div class="Bd Pp Bd-indent Li">
<pre>$ sudo cat /var/log/messages.1</pre>
</div>
<p class="Pp">It will also allow:</p>
<div class="Bd Pp Bd-indent Li">
<pre>$ sudo cat /var/log/messages /etc/shadow</pre>
</div>
<p class="Pp">which is probably not what was intended. A safer alternative is to
    use a regular expression for matching command line arguments. The above
    example can be rewritten as a regular expression:</p>
<div class="Bd Pp Bd-indent Li">
<pre>%operator ALL = /bin/cat ^/var/log/messages[^[:space:]]*$</pre>
</div>
<p class="Pp">The regular expression will only match a single file with a name
    that begins with <span class="Pa">/var/log/messages</span> and does not
    include any white space in the name. It is often better to do command line
    processing outside of the <i class="Em">sudoers</i> file in a scripting
    language for anything non-trivial.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Regular_expressions_in_command_names"><a class="permalink" href="#Regular_expressions_in_command_names">Regular
  expressions in command names</a></h3>
<p class="Pp">Using a regular expression to match a command name has the same
    security implications as using the <i class="Em">fast_glob</i> option:</p>
<ul class="Bl-bullet">
  <li>It is not possible to reliably negate commands when the path name is a
      regular expression.</li>
  <li>When <code class="Nm">sudo</code> executes the command, it must use the
      command or path specified by the user instead of a path listed in the
      <i class="Em">sudoers</i> file. This may lead to a time of check versus
      time of use race condition.</li>
</ul>
<p class="Pp">These issues do not apply to rules where only the command line
    options are matched using a regular expression.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Preventing_shell_escapes"><a class="permalink" href="#Preventing_shell_escapes">Preventing
  shell escapes</a></h3>
<p class="Pp">Once <code class="Nm">sudo</code> executes a program, that program
    is free to do whatever it pleases, including run other programs. This can be
    a security issue since it is not uncommon for a program to allow shell
    escapes, which lets a user bypass <code class="Nm">sudo</code>'s access
    control and logging. Common programs that permit shell escapes include
    shells (obviously), editors, paginators, mail, and terminal programs.</p>
<p class="Pp">There are four basic approaches to this problem:</p>
<dl class="Bl-tag">
  <dt>restrict</dt>
  <dd>Avoid giving users access to commands that allow the user to run arbitrary
      commands. Many editors have a restricted mode where shell escapes are
      disabled, though <code class="Nm">sudoedit</code> is a better solution to
      running editors via <code class="Nm">sudo</code>. Due to the large number
      of programs that offer shell escapes, restricting users to the set of
      programs that do not is often unworkable.</dd>
  <dt>intercept</dt>
  <dd>On most systems, <code class="Nm">sudo</code>'s
      <i class="Em">intercept</i> functionality can be used to transparently
      intercept an attempt to run a new command, allow or deny it based on
      <i class="Em">sudoers</i> rules, and log the result. For example, this can
      be used to restrict the commands run from within a privileged shell or
      editor. However, not all programs operate correctly when
      <i class="Em">intercept</i> is enabled.
    <p class="Pp">There are two underlying mechanisms that may be used to
        implement <i class="Em">intercept</i> mode: <i class="Em">dso</i> and
        <i class="Em">trace</i>. The <i class="Em">intercept_type</i> setting
        can be used to select between them.</p>
    <p class="Pp">The first mechanism, <i class="Em">dso</i>, overrides the
        standard C library functions that are used to execute a command. It does
        this by setting an environment variable (usually
        <code class="Ev">LD_PRELOAD</code>) to the path of a dynamic shared
        object, or shared library, containing custom versions of the
        <a class="Xr" aria-label="execve, section 2">execve(2)</a>,
        <a class="Xr" aria-label="execl, section 3">execl(3)</a>,
        <a class="Xr" aria-label="execle, section 3">execle(3)</a>,
        <a class="Xr" aria-label="execlp, section 3">execlp(3)</a>,
        <a class="Xr" aria-label="execv, section 3">execv(3)</a>,
        <a class="Xr" aria-label="execvp, section 3">execvp(3)</a>,
        <a class="Xr" aria-label="execvpe, section 3">execvpe(3)</a>, and
        <a class="Xr" aria-label="system, section 3">system(3)</a> library
        functions that connect back to <code class="Nm">sudo</code> for a policy
        decision. Note, however, that this applies only to dynamically-linked
        executables. It is not possible to intercept commands for
        statically-linked executables or executables that run under binary
        emulation this way. Because most dynamic loaders ignore
        <code class="Ev">LD_PRELOAD</code> (or the equivalent) when running
        set-user-ID and set-group-ID programs, <code class="Nm">sudoers</code>
        will not permit such programs to be run in <i class="Em">intercept</i>
        mode by default. The <i class="Em">dso</i> mechanism is incompatible
        with <code class="Nm">sudo</code>'s SELinux RBAC support (but see
        below). SELinux disables <code class="Ev">LD_PRELOAD</code> by default
        and interferes with file descriptor inheritance, which
        <code class="Nm">sudo</code> relies on.</p>
    <p class="Pp">The second mechanism, <i class="Em">trace</i>, is available on
        Linux systems that support <a class="Xr" aria-label="seccomp, section
        2">seccomp(2)</a> filtering. It uses <a class="Xr" aria-label="ptrace,
        section 2">ptrace(2)</a> and <a class="Xr" aria-label="seccomp, section
        2">seccomp(2)</a> to intercept the <a class="Xr" aria-label="execve,
        section 2">execve(2)</a> system call instead of pre-loading a dynamic
        shared object. Both static and dynamic executables are supported and it
        is compatible with <code class="Nm">sudo</code>'s SELinux RBAC mode.
        Functions utilizing the <a class="Xr" aria-label="execveat, section
        2">execveat(2)</a> system call, such as
        <a class="Xr" aria-label="fexecve, section 3">fexecve(3)</a>, are not
        currently intercepted. Programs that rely on
        <a class="Xr" aria-label="ptrace, section 2">ptrace(2)</a> themselves,
        such as debuggers and system call tracers (such as
        <a class="Xr" aria-label="strace, section 1">strace(1)</a> and
        <a class="Xr" aria-label="truss, section 1">truss(1)</a>) will be unable
        to function if <i class="Em">intercept</i> is enabled in
        <i class="Em">trace</i> mode. This same restriction applies to the
        <i class="Em">log_subcmds</i> sudoers option.</p>
    <p class="Pp">The <i class="Em">intercept</i> feature is known to work on
        Solaris, *BSD, Linux, macOS, HP-UX 11.x and AIX 5.3 and above. It should
        be supported on most operating systems that support the
        <code class="Ev">LD_PRELOAD</code> environment variable or an
        equivalent. It is not possible to intercept shell built-in commands or
        restrict the ability to read or write sensitive files from within a
        shell.</p>
    <p class="Pp">To enable intercept mode on a per-command basis, use the
        <code class="Dv">INTERCEPT</code> tag as documented in the User
        Specification section above. Here is that example again:</p>
    <div class="Bd Pp Li">
    <pre>chuck	research = INTERCEPT: ALL</pre>
    </div>
    <p class="Pp">This allows user <b class="Sy">chuck</b> to run any command on
        the machine &#x201C;research&#x201D; in intercept mode. Any commands run
        via shell escapes will be validated and logged by
        <code class="Nm">sudo</code>. If you are unsure whether or not your
        system is capable of supporting <i class="Em">intercept</i>, you can
        always just try it out and check whether or not external commands run
        via a shell are logged when <i class="Em">intercept</i> is enabled.</p>
    <p class="Pp" id="intercept_verify">There is an inherent race condition
        between when a command is checked against
        <code class="Nm">sudoers</code> rules and when it is actually executed.
        If a user is allowed to run arbitrary commands, they may be able to
        change the <a class="Xr" aria-label="execve, section 2">execve(2)</a>
        arguments in the program after the <code class="Nm">sudoers</code>
        policy check has completed but before the new command is executed.
        Starting with version 1.9.12, the <i class="Em">trace</i> method will
        verify that the command and its arguments have not changed after
        <a class="Xr" aria-label="execve, section 2">execve(2)</a> has completed
        but before execution of the new program has had a chance to run. This is
        not the case with the <i class="Em">dso</i> method. See the description
        of the
        <a class="permalink" href="#intercept_verify"><i class="Em">intercept_verify</i></a>
        setting for more information.</p>
  </dd>
  <dt>log</dt>
  <dd>There are two separate but related ways to log additional commands. The
      first is to enable I/O logging using the <i class="Em">log_output</i>
      flag. This will log the command's output but will not create an event log
      entry when the additional command is run. The second is to enable the
      <i class="Em">log_subcmds</i> flag in <i class="Em">sudoers</i> which will
      create an event log entry every time a new command is run. If I/O logging
      is also enabled, the log entry will include a time offset into the I/O log
      to indicate when the command was run. This offset can be passed to the
      <a class="Xr" aria-label="sudoreplay, section 8">sudoreplay(8)</a> utility
      to replay the I/O log at the exact moment when the command was run. The
      <i class="Em">log_subcmds</i> flag uses the same mechanism as
      <i class="Em">intercept</i> (see above) and has the same limitations.</dd>
  <dt>noexec</dt>
  <dd><code class="Nm">sudo</code>'s <i class="Em">noexec</i> functionality can
      be used to prevent a program run by <code class="Nm">sudo</code> from
      executing any other programs. On most systems, it uses the same
      <code class="Ev">LD_PRELOAD</code> mechanism as
      <i class="Em">intercept</i> (see above) and thus the same caveats apply.
      The <i class="Em">noexec</i> functionality is capable of blocking
      execution of commands run via the <a class="Xr" aria-label="execve,
      section 2">execve(2)</a>, <a class="Xr" aria-label="execl, section
      3">execl(3)</a>, <a class="Xr" aria-label="execle, section
      3">execle(3)</a>, <a class="Xr" aria-label="execlp, section
      3">execlp(3)</a>, <a class="Xr" aria-label="exect, section
      3">exect(3)</a>, <a class="Xr" aria-label="execv, section 3">execv(3)</a>,
      <a class="Xr" aria-label="execveat, section 3">execveat(3)</a>,
      <a class="Xr" aria-label="execvP, section 3">execvP(3)</a>,
      <a class="Xr" aria-label="execvp, section 3">execvp(3)</a>,
      <a class="Xr" aria-label="execvpe, section 3">execvpe(3)</a>,
      <a class="Xr" aria-label="fexecve, section 3">fexecve(3)</a>,
      <a class="Xr" aria-label="popen, section 3">popen(3)</a>,
      <a class="Xr" aria-label="posix_spawn, section 3">posix_spawn(3)</a>,
      <a class="Xr" aria-label="posix_spawnp, section 3">posix_spawnp(3)</a>,
      <a class="Xr" aria-label="system, section 3">system(3)</a>, and
      <a class="Xr" aria-label="wordexp, section 3">wordexp(3)</a> functions. On
      Linux, a <a class="Xr" aria-label="seccomp, section 2">seccomp(2)</a>
      filter is used to implement <i class="Em">noexec</i>. On Solaris 10 and
      higher, <i class="Em">noexec</i> uses Solaris privileges instead of the
      <code class="Ev">LD_PRELOAD</code> environment variable.
    <p class="Pp">To enable <i class="Em">noexec</i> for a command, use the
        <code class="Dv">NOEXEC</code> tag as documented in the User
        Specification section above. Here is that example again:</p>
    <div class="Bd Pp Li">
    <pre>aaron	shanty = NOEXEC: /usr/bin/more, /usr/bin/vi</pre>
    </div>
    <p class="Pp">This allows user <b class="Sy">aaron</b> to run
        <span class="Pa">/usr/bin/more</span> and
        <span class="Pa">/usr/bin/vi</span> with <i class="Em">noexec</i>
        enabled. This will prevent those two commands from executing other
        commands (such as a shell). If you are unsure whether or not your system
        is capable of supporting <i class="Em">noexec</i> you can always just
        try it out and check whether shell escapes work when
        <i class="Em">noexec</i> is enabled.</p>
  </dd>
</dl>
<p class="Pp">Restricting shell escapes is not a panacea. Programs running as
    <b class="Sy">root</b> are still capable of many potentially hazardous
    operations (such as changing or overwriting files) that could lead to
    unintended privilege escalation. In the specific case of an editor, a safer
    approach is to give the user permission to run
    <code class="Nm">sudoedit</code> (see below).</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Secure_editing"><a class="permalink" href="#Secure_editing">Secure
  editing</a></h3>
<p class="Pp">The <code class="Nm">sudoers</code> plugin includes
    <code class="Nm">sudoedit</code> support which allows users to securely edit
    files with the editor of their choice. As <code class="Nm">sudoedit</code>
    is a built-in command, it must be specified in the <i class="Em">sudoers</i>
    file without a leading path. However, it may take command line arguments
    just as a normal command does. Wildcards used in <i class="Em">sudoedit</i>
    command line arguments are expected to be path names, so a forward slash
    (&#x2018;<code class="Li">/</code>&#x2019;) will not be matched by a
    wildcard.</p>
<p class="Pp">Unlike other <code class="Nm">sudo</code> commands, the editor is
    run with the permissions of the invoking user and with the environment
    unmodified. More information may be found in the description of the
    <code class="Fl">-e</code> option in <a class="Xr" aria-label="sudo, section
    8">sudo(8)</a>.</p>
<p class="Pp">For example, to allow user operator to edit the &#x201C;message of
    the day&#x201D; file on any machine:</p>
<div class="Bd Pp Bd-indent Li">
<pre>operator ALL = sudoedit /etc/motd</pre>
</div>
<p class="Pp">The operator user then runs <code class="Nm">sudoedit</code> as
    follows:</p>
<div class="Bd Pp Bd-indent Li">
<pre>$ sudoedit /etc/motd</pre>
</div>
<p class="Pp">The editor will run as the operator user, not
    <b class="Sy">root</b>, on a temporary copy of
    <span class="Pa">/etc/motd</span>. After the file has been edited,
    <span class="Pa">/etc/motd</span> will be updated with the contents of the
    temporary copy.</p>
<p class="Pp" id="sudoedit_checkdir">Users should <i class="Em">never</i> be
    granted <code class="Nm">sudoedit</code> permission to edit a file that
    resides in a directory the user has write access to, either directly or via
    a wildcard. If the user has write access to the directory it is possible to
    replace the legitimate file with a link to another file, allowing the
    editing of arbitrary files. To prevent this, starting with version 1.8.16,
    symbolic links will not be followed in writable directories and
    <code class="Nm">sudoedit</code> will refuse to edit a file located in a
    writable directory unless the
    <a class="permalink" href="#sudoedit_checkdir"><i class="Em">sudoedit_checkdir</i></a>
    option has been disabled or the invoking user is <b class="Sy">root</b>.
    Additionally, in version 1.8.15 and higher, <code class="Nm">sudoedit</code>
    will refuse to open a symbolic link unless either the
    <i class="Em">sudoedit_follow</i> option is enabled or the
    <i class="Em">sudoedit</i> command is prefixed with the
    <code class="Dv">FOLLOW</code> tag in the <i class="Em">sudoers</i>
  file.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Time_stamp_file_checks"><a class="permalink" href="#Time_stamp_file_checks">Time
  stamp file checks</a></h3>
<p class="Pp"><code class="Nm">sudoers</code> will check the ownership of its
    time stamp directory (<span class="Pa">/var/run/sudo/ts</span> by default)
    and ignore the directory's contents if it is not owned by
    <b class="Sy">root</b> or if it is writable by a user other than
    <b class="Sy">root</b>. Older versions of <code class="Nm">sudo</code>
    stored time stamp files in <span class="Pa">/tmp</span>; this is no longer
    recommended as it may be possible for a user to create the time stamp
    themselves on systems that allow unprivileged users to change the ownership
    of files they create.</p>
<p class="Pp" id="should">While the time stamp directory
    <a class="permalink" href="#should"><i class="Em">should</i></a> be cleared
    at reboot time, not all systems contain a <span class="Pa">/run</span> or
    <span class="Pa">/var/run</span> directory. To avoid potential problems,
    <code class="Nm">sudoers</code> will ignore time stamp files that date from
    before the machine booted on systems where the boot time is available.</p>
<p class="Pp">Some systems with graphical desktop environments allow
    unprivileged users to change the system clock. Since
    <code class="Nm">sudoers</code> relies on the system clock for time stamp
    validation, it may be possible on such systems for a user to run
    <code class="Nm">sudo</code> for longer than
    <i class="Em">timestamp_timeout</i> by setting the clock back. To combat
    this, <code class="Nm">sudoers</code> uses a monotonic clock (which never
    moves backwards) for its time stamps if the system supports it.</p>
<p class="Pp"><code class="Nm">sudoers</code> will not honor time stamps set far
    in the future. Time stamps with a date greater than current_time + 2 *
    <code class="Dv">TIMEOUT</code> will be ignored and
    <code class="Nm">sudoers</code> will log and complain.</p>
<p class="Pp">If the <i class="Em">timestamp_type</i> option is set to
    &#x201C;tty&#x201D;, the time stamp record includes the device number of the
    terminal the user authenticated with. This provides per-terminal granularity
    but time stamp records may still outlive the user's session.</p>
<p class="Pp">Unless the <i class="Em">timestamp_type</i> option is set to
    &#x201C;global&#x201D;, the time stamp record also includes the session ID
    of the process that last authenticated. This prevents processes in different
    terminal sessions from using the same time stamp record. On systems where a
    process's start time can be queried, the start time of the session leader is
    recorded in the time stamp record. If no terminal is present or the
    <i class="Em">timestamp_type</i> option is set to &#x201C;ppid&#x201D;, the
    start time of the parent process is used instead. In most cases this will
    prevent a time stamp record from being reused without the user entering a
    password when logging out and back in again.</p>
</section>
</section>
<section class="Sh">
<h2 class="Sh" id="DEBUGGING"><a class="permalink" href="#DEBUGGING">DEBUGGING</a></h2>
<p class="Pp">Versions 1.8.4 and higher of the <code class="Nm">sudoers</code>
    plugin support a flexible debugging framework that can help track down what
    the plugin is doing internally if there is a problem. This can be configured
    in the <a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a>
    file.</p>
<p class="Pp" id="subsystem">The <code class="Nm">sudoers</code> plugin uses the
    same debug flag format as the <code class="Nm">sudo</code> front-end:
    <a class="permalink" href="#subsystem"><i class="Em">subsystem</i></a>@<a class="permalink" href="#priority"><i class="Em" id="priority">priority</i></a>.</p>
<p class="Pp" id="warn">The priorities used by <code class="Nm">sudoers</code>,
    in order of decreasing severity, are: <i class="Em">crit</i>,
    <i class="Em">err</i>,
    <a class="permalink" href="#warn"><i class="Em">warn</i></a>,
    <i class="Em">notice</i>,
    <a class="permalink" href="#diag"><i class="Em" id="diag">diag</i></a>,
    <i class="Em">info</i>, <i class="Em">trace</i>, and
    <i class="Em">debug</i>. Each priority, when specified, also includes all
    priorities higher than it. For example, a priority of
    <i class="Em">notice</i> would include debug messages logged at
    <i class="Em">notice</i> and higher.</p>
<p class="Pp">The following subsystems are used by the
    <code class="Nm">sudoers</code> plugin:</p>
<dl class="Bl-tag">
  <dt id="alias"><a class="permalink" href="#alias"><i class="Em">alias</i></a></dt>
  <dd><a class="permalink" href="#User_Alias"><i class="Em" id="User_Alias">User_Alias</i></a>,
      <i class="Em">Runas_Alias</i>, <i class="Em">Host_Alias</i> and
      <i class="Em">Cmnd_Alias</i> processing</dd>
  <dt id="all"><a class="permalink" href="#all"><i class="Em">all</i></a></dt>
  <dd>matches every subsystem</dd>
  <dt id="audit"><a class="permalink" href="#audit"><i class="Em">audit</i></a></dt>
  <dd>BSM and Linux audit code</dd>
  <dt id="auth"><a class="permalink" href="#auth"><i class="Em">auth</i></a></dt>
  <dd>user authentication</dd>
  <dt id="defaults"><a class="permalink" href="#defaults"><i class="Em">defaults</i></a></dt>
  <dd><a class="permalink" href="#sudoers"><i class="Em" id="sudoers">sudoers</i></a>
      file <i class="Em">Defaults</i> settings</dd>
  <dt id="env"><a class="permalink" href="#env"><i class="Em">env</i></a></dt>
  <dd>environment handling</dd>
  <dt id="ldap"><a class="permalink" href="#ldap"><i class="Em">ldap</i></a></dt>
  <dd>LDAP-based sudoers</dd>
  <dt id="logging"><a class="permalink" href="#logging"><i class="Em">logging</i></a></dt>
  <dd>logging support</dd>
  <dt id="match"><a class="permalink" href="#match"><i class="Em">match</i></a></dt>
  <dd>matching of users, groups, hosts, and netgroups in the
      <i class="Em">sudoers</i> file</dd>
  <dt id="netif"><a class="permalink" href="#netif"><i class="Em">netif</i></a></dt>
  <dd>network interface handling</dd>
  <dt id="nss"><a class="permalink" href="#nss"><i class="Em">nss</i></a></dt>
  <dd>network service switch handling in <code class="Nm">sudoers</code></dd>
  <dt id="parser"><a class="permalink" href="#parser"><i class="Em">parser</i></a></dt>
  <dd><a class="permalink" href="#sudoers~2"><i class="Em" id="sudoers~2">sudoers</i></a>
      file parsing</dd>
  <dt id="perms"><a class="permalink" href="#perms"><i class="Em">perms</i></a></dt>
  <dd>permission setting</dd>
  <dt id="plugin"><a class="permalink" href="#plugin"><i class="Em">plugin</i></a></dt>
  <dd>The equivalent of
      <a class="permalink" href="#main"><i class="Em" id="main">main</i></a> for
      the plugin.</dd>
  <dt id="pty"><a class="permalink" href="#pty"><i class="Em">pty</i></a></dt>
  <dd>pseudo-terminal related code</dd>
  <dt id="rbtree"><a class="permalink" href="#rbtree"><i class="Em">rbtree</i></a></dt>
  <dd>redblack tree internals</dd>
  <dt id="sssd"><a class="permalink" href="#sssd"><i class="Em">sssd</i></a></dt>
  <dd>SSSD-based sudoers</dd>
  <dt id="util"><a class="permalink" href="#util"><i class="Em">util</i></a></dt>
  <dd>utility functions</dd>
</dl>
<p class="Pp">For example:</p>
<div class="Bd Pp Li">
<pre>Debug sudoers.so /var/log/sudoers_debug match@info,nss@info</pre>
</div>
<p class="Pp">For more information, see the <a class="Xr" aria-label="sudo.conf,
    section 5">sudo.conf(5)</a> manual.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h2>
<p class="Pp"><a class="Xr" aria-label="ssh, section 1">ssh(1)</a>,
    <a class="Xr" aria-label="su, section 1">su(1)</a>,
    <a class="Xr" aria-label="fnmatch, section 3">fnmatch(3)</a>,
    <a class="Xr" aria-label="glob, section 3">glob(3)</a>,
    <a class="Xr" aria-label="mktemp, section 3">mktemp(3)</a>,
    <a class="Xr" aria-label="strftime, section 3">strftime(3)</a>,
    <a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a>,
    <a class="Xr" aria-label="sudo_logsrv.proto, section
    5">sudo_logsrv.proto(5)</a>, <a class="Xr" aria-label="sudo_plugin, section
    5">sudo_plugin(5)</a>, <a class="Xr" aria-label="sudoers.ldap, section
    5">sudoers.ldap(5)</a>, <a class="Xr" aria-label="sudoers_timestamp, section
    5">sudoers_timestamp(5)</a>, <a class="Xr" aria-label="sudo, section
    8">sudo(8)</a>, <a class="Xr" aria-label="sudo_logsrvd, section
    8">sudo_logsrvd(8)</a>, <a class="Xr" aria-label="visudo, section
    8">visudo(8)</a></p>
</section>
<section class="Sh">
<h2 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h2>
<p class="Pp">Many people have worked on <code class="Nm">sudo</code> over the
    years; this version consists of code written primarily by:</p>
<div class="Bd Pp Bd-indent"><span class="An">Todd C. Miller</span></div>
<p class="Pp">See the CONTRIBUTORS.md file in the <code class="Nm">sudo</code>
    distribution (<a href="https://www.sudo.ws/about/contributors/">https://www.sudo.ws/about/contributors/</a>) for an exhaustive
    list of people who have contributed to <code class="Nm">sudo</code>.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="CAVEATS"><a class="permalink" href="#CAVEATS">CAVEATS</a></h2>
<p class="Pp">The <i class="Em">sudoers</i> file should
    <a class="permalink" href="#always"><b class="Sy" id="always">always</b></a>
    be edited by the <code class="Nm">visudo</code> utility which locks the file
    and checks for syntax errors. If <i class="Em">sudoers</i> contains syntax
    errors, <code class="Nm">sudo</code> may refuse to run, which is a serious
    problem if <code class="Nm">sudo</code> is your only method of obtaining
    superuser privileges. Recent versions of <code class="Nm">sudoers</code>
    will attempt to recover after a syntax error by ignoring the rest of the
    line after encountering an error. Older versions of
    <code class="Nm">sudo</code> will not run if <i class="Em">sudoers</i>
    contains a syntax error.</p>
<p class="Pp">When using netgroups of machines (as opposed to users), if you
    store fully qualified host name in the netgroup (as is usually the case),
    you either need to have the machine's host name be fully qualified as
    returned by the <i class="Em">hostname</i> command or use the
    <i class="Em">fqdn</i> option in <i class="Em">sudoers</i>.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h2>
<p class="Pp">If you believe you have found a bug in
    <code class="Nm">sudoers</code>, you can either file a bug report in the
    sudo bug database, <a href="https://bugzilla.sudo.ws/">https://bugzilla.sudo.ws/</a>, or open an issue at
    <a href="https://github.com/sudo-project/sudo/issues.">https://github.com/sudo-project/sudo/issues.</a> If you would prefer to use
    email, messages may be sent to the sudo-workers mailing list,
    <a href="https://www.sudo.ws/mailman/listinfo/sudo-workers">https://www.sudo.ws/mailman/listinfo/sudo-workers</a> (public) or
    &lt;sudo@sudo.ws&gt; (private).</p>
<p class="Pp">Please do not report security vulnerabilities through public
    GitHub issues, Bugzilla or mailing lists. Instead, report them via email to
    &lt;Todd.Miller@sudo.ws&gt;. You may encrypt your message with PGP if you
    would like, using the key found at <a href="https://www.sudo.ws/dist/PGPKEYS.">https://www.sudo.ws/dist/PGPKEYS.</a></p>
</section>
<section class="Sh">
<h2 class="Sh" id="SUPPORT"><a class="permalink" href="#SUPPORT">SUPPORT</a></h2>
<p class="Pp">Limited free support is available via the sudo-users mailing list,
    see <a href="https://www.sudo.ws/mailman/listinfo/sudo-users">https://www.sudo.ws/mailman/listinfo/sudo-users</a> to subscribe or search
    the archives.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="DISCLAIMER"><a class="permalink" href="#DISCLAIMER">DISCLAIMER</a></h2>
<p class="Pp"><code class="Nm">sudo</code> is provided &#x201C;AS IS&#x201D; and
    any express or implied warranties, including, but not limited to, the
    implied warranties of merchantability and fitness for a particular purpose
    are disclaimed. See the LICENSE.md file distributed with
    <code class="Nm">sudo</code> or <a href="https://www.sudo.ws/about/license/">https://www.sudo.ws/about/license/</a> for
    complete details.</p>
</section>
</main>
</div>


  </article>



          <div class="gdoc-page__footer flex flex-wrap justify-between">
            








  
  

  







          </div>
        </div>
      </main>

      

    </div>

    
  <script defer src="/js/search-835dce8f.bundle.min.js"></script>

  </body>
</html>
