<!DOCTYPE html>
<html
  lang="en"
  class="color-toggle-hidden"
  
>
  <head>
    <meta charset="UTF-8" />
<meta name="referrer" content="no-referrer" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="color-scheme" content="light dark" />
<meta name="generator" content="Hugo 0.145.0">


  <meta name="description" content=" NAME sudo_plugin &#x2014; Sudo Plugin API
DESCRIPTION Starting with version 1.8, sudo supports a plugin API for policy and session logging. Plugins may be compiled as dynamic shared objects (the default on systems that support them) or compiled statically into the sudo binary itself. By default, the sudoers plugin provides audit, security policy and I/O logging capabilities. Via the plugin API, sudo can be configured to use alternate plugins provided by third parties. The plugins to be used are specified in the sudo.conf(5) file." />

    <title>Sudo Plugin API | Sudo</title>

    
<link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
<link rel="manifest" href="/favicon/site.webmanifest">
<link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#2f333e">
<meta name="msapplication-TileColor" content="#2f333e">
<meta name="theme-color" content="#2f333e">

    

    
  <meta
    property="og:title"
    content="Sudo Plugin API"
  />
  <meta property="og:site_name" content="Sudo" />
  <meta property="og:description" content=" NAME sudo_plugin â Sudo Plugin API
DESCRIPTION Starting with version 1.8, sudo supports a plugin API for policy and session logging. Plugins may be compiled as dynamic shared objects (the default on systems that support them) or compiled statically into the sudo binary itself. By default, the sudoers plugin provides audit, security policy and I/O logging capabilities. Via the plugin API, sudo can be configured to use alternate plugins provided by third parties. The plugins to be used are specified in the sudo.conf(5) file." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sudo.ws/docs/man/sudo_plugin.man/" />

<meta property="article:section" content="Docs" />


  <meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Sudo Plugin API" />
  <meta name="twitter:description" content=" NAME sudo_plugin â Sudo Plugin API
DESCRIPTION Starting with version 1.8, sudo supports a plugin API for policy and session logging. Plugins may be compiled as dynamic shared objects (the default on systems that support them) or compiled statically into the sudo binary itself. By default, the sudoers plugin provides audit, security policy and I/O logging capabilities. Via the plugin API, sudo can be configured to use alternate plugins provided by third parties. The plugins to be used are specified in the sudo.conf(5) file." />


  <script type="application/ld+json">
  {
      "@context": "http://schema.org",
      "@type": "TechArticle",
      "articleSection": "Docs",
      "name": "Sudo Plugin API",
      "url" : "https://www.sudo.ws/docs/man/sudo_plugin.man/",
      "headline": "Sudo Plugin API",
      "description": " NAME sudo_plugin â Sudo Plugin API\nDESCRIPTION Starting with version 1.8, sudo supports a plugin API for policy and session logging. Plugins may be compiled as dynamic shared objects (the default on systems that support them) or compiled statically into the sudo binary itself. By default, the sudoers plugin provides audit, security policy and I\/O logging capabilities. Via the plugin API, sudo can be configured to use alternate plugins provided by third parties. The plugins to be used are specified in the sudo.conf(5) file.",
      "wordCount" : "17743",
      "inLanguage": "en",
      "isFamilyFriendly": "true",
      "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https://www.sudo.ws/docs/man/sudo_plugin.man/"
      },
      "copyrightHolder" : "Sudo",
      "copyrightYear" : "0001",
      "dateCreated": "0001-01-01T00:00:00.00Z",
      "datePublished": "0001-01-01T00:00:00.00Z",
      "dateModified": "0001-01-01T00:00:00.00Z",
      "publisher":{
          "@type":"Organization",
          "name": "Sudo",
          "url": "https://www.sudo.ws/",
          "logo": {
              "@type": "ImageObject",
              "url": "https://www.sudo.ws/brand.svg",
              "width":"32",
              "height":"32"
          }
      }
  }
  </script>


    <script src="/js/main-902b82d5.bundle.min.js"></script>

<link
  rel="preload"
  as="font"
  href="/fonts/Metropolis.woff2"
  type="font/woff2"
  crossorigin="anonymous"
/>
<link
  rel="preload"
  as="font"
  href="/fonts/LiberationSans.woff2"
  type="font/woff2"
  crossorigin="anonymous"
/>

<link
  rel="preload"
  href="/main-a853cbfd.min.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/main-a853cbfd.min.css"
  media="all"
/>

<link
  rel="preload"
  href="/mobile-c0e18b0e.min.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/mobile-c0e18b0e.min.css"
  media="screen and (max-width: 45rem)"
/>

<link
  rel="preload"
  href="/print-19966b38.min.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/print-19966b38.min.css"
  media="print"
/>

<link
  rel="preload"
  href="/custom.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/custom.css"
  media="all"
/>
  <link href="https://www.sudo.ws/docs/man/sudo_plugin.man/" rel="canonical" type="text/html" />

<!-- Made with Geekdoc theme https://github.com/thegeeklab/hugo-geekdoc -->

    
  </head>

  <body itemscope itemtype="https://schema.org/WebPage">
    
  <!-- geekdoc include: /sprites/blog.svg -->
  <svg class="svg-sprite" id="fa-blog" xmlns="http://www.w3.org/2000/svg" viewBox="-100 -48 665 665"><!--! Font Awesome Free 6.0.0-beta3 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2021 Fonticons, Inc. --><path d="M217.6 96.1c-12.95-.625-24.66 9.156-25.52 22.37C191.2 131.7 201.2 143.1 214.4 143.1c79.53 5.188 148.4 74.09 153.6 153.6c.8281 12.69 11.39 22.43 23.94 22.43c.5156 0 1.047-.0313 1.578-.0625c13.22-.8438 23.25-12.28 22.39-25.5C409.3 191.8 320.3 102.8 217.6 96.1zM224 0C206.3 0 192 14.31 192 32s14.33 32 32 32c123.5 0 224 100.5 224 224c0 17.69 14.33 32 32 32s32-14.31 32-32C512 129.2 382.8 0 224 0zM172.3 226.8C157.7 223.9 144 235.8 144 250.6v50.37c0 10.25 7.127 18.37 16.75 21.1c18.13 6.75 31.26 24.38 31.26 44.1c0 26.5-21.5 47.1-48.01 47.1c-26.5 0-48.01-21.5-48.01-47.1V120c0-13.25-10.75-23.1-24.01-23.1l-48.01 .0076C10.75 96.02 0 106.8 0 120v247.1c0 89.5 82.14 160.2 175 140.7c54.38-11.5 98.27-55.5 109.8-109.7C302.2 316.1 247.8 241.8 172.3 226.8z"/></svg>


  <!-- geekdoc include: /sprites/book.svg -->
  <svg class="svg-sprite" id="fa-book" xmlns="http://www.w3.org/2000/svg" viewBox="-148 -48 582 665"><!--! Font Awesome Free 6.0.0-beta3 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2021 Fonticons, Inc. --><path d="M448 336v-288C448 21.49 426.5 0 400 0H96C42.98 0 0 42.98 0 96v320c0 53.02 42.98 96 96 96h320c17.67 0 32-14.33 32-31.1c0-11.72-6.607-21.52-16-27.1v-81.36C441.8 362.8 448 350.2 448 336zM143.1 128h192C344.8 128 352 135.2 352 144C352 152.8 344.8 160 336 160H143.1C135.2 160 128 152.8 128 144C128 135.2 135.2 128 143.1 128zM143.1 192h192C344.8 192 352 199.2 352 208C352 216.8 344.8 224 336 224H143.1C135.2 224 128 216.8 128 208C128 199.2 135.2 192 143.1 192zM384 448H96c-17.67 0-32-14.33-32-32c0-17.67 14.33-32 32-32h288V448z"/></svg>


  <!-- geekdoc include: /sprites/bug.svg -->
  <svg class="svg-sprite" id="fa-bug" xmlns="http://www.w3.org/2000/svg" viewBox="-48 -48 665 665"><!--! Font Awesome Free 6.0.0-beta3 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2021 Fonticons, Inc. --><path d="M480 256h-64V205.3l54.63-54.63c12.5-12.5 12.5-32.75 0-45.25s-32.75-12.5-45.25 0L370.8 160h-229.5L86.63 105.4c-12.5-12.5-32.75-12.5-45.25 0s-12.5 32.75 0 45.25L96 205.3V256H32C14.31 256 0 270.3 0 288s14.31 32 32 32h64v32c0 15.11 3.088 29.4 7.895 42.86l-62.52 62.52c-12.5 12.5-12.5 32.75 0 45.25C47.63 508.9 55.81 512 64 512s16.38-3.125 22.62-9.375l54.13-54.13C163.2 467.9 192 480 224 480h16.1V239.9C240.1 231.2 247.2 224 256 224S272 231.2 272 239.9V480H288c31.96 0 60.82-12.13 83.25-31.5l54.13 54.13C431.6 508.9 439.8 512 448 512s16.38-3.125 22.62-9.375c12.5-12.5 12.5-32.75 0-45.25l-62.52-62.52C412.9 381.4 416 367.1 416 352v-32h64c17.69 0 32-14.33 32-32S497.7 256 480 256zM352 96c0-53.02-42.98-96-96-96S160 42.98 160 96v32h192V96z"/></svg>


  <!-- geekdoc include: /sprites/mastodon.svg -->
  <svg class="svg-sprite" id="fa-mastodon" xmlns="http://www.w3.org/2000/svg" viewBox="-148 -48 665 665"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"></svg>


  <!-- geekdoc include: /sprites/mercurial_icon_132219.svg -->
  <svg class="svg-sprite" id="jg-mercurial" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="-48 -48 665 665"><path d="M104.3676376,236.3087616c0-40.0223846-43.6237679-65.1721191-78.3347168-45.1609344c-34.7105675,20.0112-34.7105675,70.3106689,0,90.3215027C60.7438698,301.4804993,104.3676376,276.33078,104.3676376,236.3087616z M47.2328262,238.619812c0.9316254-17.4195404,28.4773483-30.8073578,38.3612366-15.1646118c8.0138016,12.6981049-8.1260452,29.328598-20.3331146,32.5216064C52.3266258,259.3628235,46.3008194,256.0454407,47.2328262,238.619812z M56.0728455,274.9062195c2.0664902-1.866272,12.5426407-1.0996094,21.9980621-6.1877136c9.448967-5.081665,20.6747437-16.2206116,22.6813202-32.055603c1.1803665-9.2999573,1.5345154-6.9642487,2.0065842-1.9011688c-1.4662628,26.3217621-25.6756516,40.8649139-39.5169563,42.7846527C59.502079,278.0620728,52.9295082,277.7450867,56.0728455,274.9062195z M256.6015015,9.6756086C72.808754,32.3940926,69.8519669,225.8470154,231.826767,271.8000488c140.1693573,39.8085327,28.9558868,128.7198792,32.2046356,187.9238281c3.2677002,59.1975098,121.8617859,80.6734619,215.3887939-74.7970276C571.2886963,232.2136993,460.0190735-15.4908123,256.6015015,9.6756086z M286.4643555,278.6645813c-6.5725708-4.3858948-22.2649841-13.5493469-54.4946289-24.1165009c-26.6823578-8.7531891-40.2438354-16.2327423-46.8600159-21.8486633c20.7881317,9.1941681,37.4838409,12.6886292,58.22229,17.9659424c43.908905,13.1656342,54.0039673,17.0483551,54.9420471,33.8263397C297.8391418,293.7355347,293.4282227,283.3299255,286.4643555,278.6645813z M367.8400269,367.5634155c40.4610901,5.006958,83.9104309-78.8473511,93.725708-130.0371246c9.5733337-49.8729095,14.2390442,3.2119598,4.9576721,37.4728241c-11.0270996,40.6351318-49.1399841,103.5227661-74.6540833,132.6401367c-19.5626526,22.3336487-41.4238281,31.6521606-67.8077698,35.5656128C269.1691589,453.902832,327.3857727,362.5571899,367.8400269,367.5634155z M436.2878418,427.8855591c-25.1414185,30.1343384-62.0288086,57.1067505-103.5784912,60.3467712c-11.0832214,1.6585083-19.3157959,0.254425-18.711792-6.9145813c0.7951355-9.4364624,11.9651794-3.4538879,28.1417847-7.3802185c58.1104431-14.1082458,83.3079529-43.2006226,118.059845-97.8321228c27.0546875-42.5238037,38.8829651-89.7004089,39.777832-98.6833801C502.6482849,288.2997131,485.2969666,363.9476318,436.2878418,427.8855591z M103.3271866,335.897583c-53.0496101,30.5836792-53.0496101,107.4578247,0,138.0414734s119.7213669-7.8534241,119.7213669-69.0207214S156.3768005,305.3139343,103.3271866,335.897583z M153.6566162,418.6166687c23.7312622-7.8772888,36.541214-60.520813,39.5726929-37.0318604c5.9950867,46.3815002-25.9058075,59.3579102-36.3235626,62.0860596C121.7500305,452.877533,117.7118454,430.5443115,153.6566162,418.6166687z M215.5815125,414.2740173c-4.8458252,32.5712891-35.6281586,56.5944824-61.8255463,57.4893494c-5.3179016,0.5463867-12.294281-1.770752-5.7960358-3.1312256c7.8970184-1.6531677,53.8238831-13.5553894,64.6083069-51.3262634C215.9292145,405.526886,216.531723,407.8940735,215.5815125,414.2740173z"/></svg>


  <!-- geekdoc include: /sprites/twitter.svg -->
  <svg class="svg-sprite" id="fa-twitter" xmlns="http://www.w3.org/2000/svg" viewBox="-148 -48 665 665"><!--! Font Awesome Free 6.0.0-beta3 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2021 Fonticons, Inc. --><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>


  <!-- geekdoc include: /sprites/geekdoc.svg -->
  <svg class="svg-sprite" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_arrow_back" xmlns="http://www.w3.org/2000/svg"><path d="M24 10.526v2.947H5.755l8.351 8.421-2.105 2.105-12-12 12-12 2.105 2.105-8.351 8.421H24z"/></svg><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_arrow_left_alt" xmlns="http://www.w3.org/2000/svg"><path d="M5.965 10.526V6.035L0 12l5.965 5.965v-4.491H24v-2.947H5.965z"/></svg><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_arrow_right_alt" xmlns="http://www.w3.org/2000/svg"><path d="M18.035 10.526V6.035L24 12l-5.965 5.965v-4.491H0v-2.947h18.035z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_bitbucket" xmlns="http://www.w3.org/2000/svg"><path d="M15.905 13.355c.189 1.444-1.564 2.578-2.784 1.839-1.375-.602-1.375-2.784-.034-3.403 1.151-.705 2.818.223 2.818 1.564zm1.907-.361c-.309-2.44-3.076-4.056-5.328-3.042-1.426.636-2.389 2.148-2.32 3.747.086 2.097 2.08 3.815 4.176 3.626s3.729-2.234 3.472-4.331zm4.108-9.315c-.756-.997-2.045-1.169-3.179-1.358-3.214-.516-6.513-.533-9.727.034-1.066.172-2.269.361-2.939 1.323 1.1 1.031 2.664 1.186 4.073 1.358 2.544.327 5.156.344 7.699.017 1.426-.172 3.008-.309 4.073-1.375zm.979 17.788c-.481 1.684-.206 3.953-1.994 4.932-3.076 1.701-6.806 1.89-10.191 1.289-1.787-.327-3.884-.894-4.864-2.578-.43-1.65-.705-3.334-.98-5.018l.103-.275.309-.155c5.121 3.386 12.288 3.386 17.427 0 .808.241.206 1.22.189 1.805zM26.01 4.951c-.584 3.764-1.255 7.51-1.908 11.257-.189 1.1-1.255 1.719-2.148 2.183-3.214 1.615-6.96 1.89-10.483 1.512-2.389-.258-4.829-.894-6.771-2.389-.911-.705-.911-1.908-1.083-2.922-.602-3.523-1.289-7.046-1.719-10.604.206-1.547 1.942-2.217 3.231-2.698C6.848.654 8.686.362 10.508.19c3.884-.378 7.854-.241 11.618.859 1.341.395 2.784.945 3.695 2.097.412.533.275 1.203.189 1.805z"/></svg><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_bookmark" xmlns="http://www.w3.org/2000/svg"><path d="M15.268 4.392q.868 0 1.532.638t.664 1.506v17.463l-7.659-3.268-7.608 3.268V6.536q0-.868.664-1.506t1.532-.638h10.876zm4.34 14.144V4.392q0-.868-.638-1.532t-1.506-.664H6.537q0-.868.664-1.532T8.733 0h10.876q.868 0 1.532.664t.664 1.532v17.412z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_brightness_auto" xmlns="http://www.w3.org/2000/svg"><path d="M16.846 18.938h2.382L15.22 7.785h-2.44L8.772 18.938h2.382l.871-2.44h3.95zm7.087-9.062L27.999 14l-4.066 4.124v5.809h-5.809L14 27.999l-4.124-4.066H4.067v-5.809L.001 14l4.066-4.124V4.067h5.809L14 .001l4.124 4.066h5.809v5.809zm-11.385 4.937L14 10.282l1.452 4.531h-2.904z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_brightness_dark" xmlns="http://www.w3.org/2000/svg"><path d="M14 21.435q3.079 0 5.257-2.178T21.435 14t-2.178-5.257T14 6.565q-1.51 0-3.079.697 1.917.871 3.108 2.701T15.22 14t-1.191 4.037-3.108 2.701q1.568.697 3.079.697zm9.933-11.559L27.999 14l-4.066 4.124v5.809h-5.809L14 27.999l-4.124-4.066H4.067v-5.809L.001 14l4.066-4.124V4.067h5.809L14 .001l4.124 4.066h5.809v5.809z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_brightness_light" xmlns="http://www.w3.org/2000/svg"><path d="M14 21.435q3.079 0 5.257-2.178T21.435 14t-2.178-5.257T14 6.565 8.743 8.743 6.565 14t2.178 5.257T14 21.435zm9.933-3.311v5.809h-5.809L14 27.999l-4.124-4.066H4.067v-5.809L.001 14l4.066-4.124V4.067h5.809L14 .001l4.124 4.066h5.809v5.809L27.999 14z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_check" xmlns="http://www.w3.org/2000/svg"><path d="M8.885 20.197 25.759 3.323l2.24 2.24L8.885 24.677 0 15.792l2.24-2.24z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_check_circle_outline" xmlns="http://www.w3.org/2000/svg"><path d="M14 25.239q4.601 0 7.92-3.319T25.239 14 21.92 6.08 14 2.761 6.08 6.08 2.761 14t3.319 7.92T14 25.239zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0zm6.441 7.822 1.972 1.972-11.239 11.239L4.207 14l1.972-1.972 4.995 4.995z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_cloud_off" xmlns="http://www.w3.org/2000/svg"><path d="M9.023 10.5H7q-1.914 0-3.281 1.395t-1.367 3.309 1.367 3.281T7 19.852h11.375zM3.5 4.976l1.477-1.477L24.5 23.022l-1.477 1.477-2.352-2.297H6.999q-2.898 0-4.949-2.051t-2.051-4.949q0-2.844 1.969-4.867t4.758-2.133zm19.086 5.578q2.242.164 3.828 1.832T28 16.351q0 3.008-2.461 4.758l-1.695-1.695q1.805-.984 1.805-3.063 0-1.422-1.039-2.461t-2.461-1.039h-1.75v-.602q0-2.68-1.859-4.539t-4.539-1.859q-1.531 0-2.953.711l-1.75-1.695Q11.431 3.5 14.001 3.5q2.953 0 5.496 2.078t3.09 4.977z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_code" xmlns="http://www.w3.org/2000/svg"><path d="M9.917 24.5a1.75 1.75 0 1 0-3.501.001 1.75 1.75 0 0 0 3.501-.001zm0-21a1.75 1.75 0 1 0-3.501.001A1.75 1.75 0 0 0 9.917 3.5zm11.666 2.333a1.75 1.75 0 1 0-3.501.001 1.75 1.75 0 0 0 3.501-.001zm1.75 0a3.502 3.502 0 0 1-1.75 3.026c-.055 6.581-4.721 8.039-7.82 9.023-2.898.911-3.846 1.349-3.846 3.117v.474a3.502 3.502 0 0 1 1.75 3.026c0 1.932-1.568 3.5-3.5 3.5s-3.5-1.568-3.5-3.5c0-1.294.711-2.424 1.75-3.026V6.526A3.502 3.502 0 0 1 4.667 3.5c0-1.932 1.568-3.5 3.5-3.5s3.5 1.568 3.5 3.5a3.502 3.502 0 0 1-1.75 3.026v9.06c.93-.456 1.914-.766 2.807-1.039 3.391-1.075 5.323-1.878 5.359-5.687a3.502 3.502 0 0 1-1.75-3.026c0-1.932 1.568-3.5 3.5-3.5s3.5 1.568 3.5 3.5z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_copy" xmlns="http://www.w3.org/2000/svg"><path d="M23.502 25.438V7.626H9.562v17.812h13.94zm0-20.315q1.013 0 1.787.745t.774 1.757v17.812q0 1.013-.774 1.787t-1.787.774H9.562q-1.013 0-1.787-.774t-.774-1.787V7.625q0-1.013.774-1.757t1.787-.745h13.94zM19.689 0v2.562H4.438v17.812H1.936V2.562q0-1.013.745-1.787T4.438.001h15.251z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_dangerous" xmlns="http://www.w3.org/2000/svg"><path d="M21.802 19.833 15.969 14l5.833-5.833-1.969-1.969L14 12.031 8.167 6.198 6.198 8.167 12.031 14l-5.833 5.833 1.969 1.969L14 15.969l5.833 5.833zM19.833 0 28 8.167v11.666L19.833 28H8.167L0 19.833V8.167L8.167 0h11.666z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_date" xmlns="http://www.w3.org/2000/svg"><path d="M27.192 28.844V11.192H4.808v17.652h22.384zm0-25.689q1.277 0 2.253.976t.976 2.253v22.459q0 1.277-.976 2.216t-2.253.939H4.808q-1.352 0-2.291-.901t-.939-2.253V6.385q0-1.277.939-2.253t2.291-.976h1.577V.001h3.23v3.155h12.769V.001h3.23v3.155h1.577zm-3.155 11.267v3.155h-3.23v-3.155h3.23zm-6.46 0v3.155h-3.155v-3.155h3.155zm-6.384 0v3.155h-3.23v-3.155h3.23z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_download" xmlns="http://www.w3.org/2000/svg"><path d="M2.866 28.209h26.269v3.79H2.866v-3.79zm26.268-16.925L16 24.418 2.866 11.284h7.493V.001h11.283v11.283h7.493z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_email" xmlns="http://www.w3.org/2000/svg"><path d="M28.845 9.615v-3.23L16 14.422 3.155 6.385v3.23L16 17.577zm0-6.46q1.277 0 2.216.977T32 6.385v19.23q0 1.277-.939 2.253t-2.216.977H3.155q-1.277 0-2.216-.977T0 25.615V6.385q0-1.277.939-2.253t2.216-.977h25.69z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_error_outline" xmlns="http://www.w3.org/2000/svg"><path d="M14 25.239q4.601 0 7.92-3.319T25.239 14 21.92 6.08 14 2.761 6.08 6.08 2.761 14t3.319 7.92T14 25.239zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0zm-1.38 6.967h2.761v8.413H12.62V6.967zm0 11.239h2.761v2.826H12.62v-2.826z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_fire" xmlns="http://www.w3.org/2000/svg"><path d="M17.689 21.998q-.32.32-.8.576t-.864.384q-1.152.384-2.272.032t-1.888-.992q-.128-.128-.096-.256t.16-.192q1.216-.384 1.92-1.216t.96-1.792q.192-.896-.064-1.728t-.384-1.728q-.128-.704-.096-1.376t.288-1.312q0-.128.128-.128t.192.064q.384.832.992 1.472t1.28 1.216 1.216 1.248.672 1.568q.064.384.064.704.064.96-.32 1.92t-1.088 1.536zm3.84-10.944q-.768-.704-1.6-1.28t-1.6-1.344q-1.536-1.536-2.016-3.584t.16-4.16q.128-.32-.096-.544t-.544-.096q-.768.32-1.44.768t-1.312.896q-1.984 1.664-3.136 3.936T8.633 10.51t.8 5.088q0 .128.032.256t.032.256q0 .576-.512.832t-1.024-.192q-.128-.192-.192-.32-1.024-1.28-1.376-2.912t-.096-3.232q.064-.384-.288-.576t-.608.128q-1.28 1.664-1.856 3.68t-.448 4.064q0 .576.096 1.184t.288 1.184q.448 1.536 1.216 2.816 1.216 2.048 3.264 3.424t4.416 1.696q2.496.32 5.024-.256t4.448-2.304q1.408-1.344 2.208-3.104t.864-3.68-.704-3.712q-.064-.128-.096-.224t-.096-.224q-.576-1.088-1.28-1.984-.256-.384-.544-.704t-.672-.64z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_git" xmlns="http://www.w3.org/2000/svg"><path d="M27.472 12.753 15.247.529a1.803 1.803 0 0 0-2.55 0l-2.84 2.84 2.137 2.137a2.625 2.625 0 0 1 3.501 3.501l3.499 3.499a2.625 2.625 0 1 1-1.237 1.237l-3.499-3.499c-.083.04-.169.075-.257.106v7.3a2.626 2.626 0 1 1-1.75 0v-7.3a2.626 2.626 0 0 1-1.494-3.607L8.62 4.606l-8.09 8.09a1.805 1.805 0 0 0 0 2.551l12.225 12.224a1.803 1.803 0 0 0 2.55 0l12.168-12.168a1.805 1.805 0 0 0 0-2.551z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_gitea" xmlns="http://www.w3.org/2000/svg"><path d="M5.581 7.229c-2.46-.005-5.755 1.559-5.573 5.48.284 6.125 6.56 6.693 9.068 6.743.275 1.149 3.227 5.112 5.412 5.32h9.573c5.741-.381 10.04-17.363 6.853-17.427-5.271.248-8.395.373-11.073.395v5.3l-.835-.369-.005-4.928c-3.075-.001-5.781-.144-10.919-.397-.643-.004-1.539-.113-2.501-.116zm.348 2.166h.293c.349 3.14.917 4.976 2.067 7.781-2.933-.347-5.429-1.199-5.888-4.38-.237-1.647.563-3.365 3.528-3.401zm11.409 3.087c.2.003.404.04.596.128l.999.431-.716 1.305h-.007a.996.996 0 0 0-.321.053l.006-.002c-.349.114-.593.406-.593.749 0 .097.019.189.055.275l-.002-.006a.767.767 0 0 0 .151.233l-.001-.001-1.235 2.248a.99.99 0 0 0-.302.052l.006-.002c-.349.114-.593.406-.593.749 0 .097.019.189.055.275l-.002-.006c.128.31.457.527.843.527a.987.987 0 0 0 .31-.049l-.006.002c.348-.114.592-.406.592-.749 0-.097-.02-.19-.056-.277l.002.006a.784.784 0 0 0-.211-.293l1.203-2.189a.999.999 0 0 0 .397-.041l-.006.002a.942.942 0 0 0 .285-.15l-.001.001c.464.195.844.353 1.117.488.411.203.556.337.6.487.044.147-.004.429-.236.925-.173.369-.46.893-.799 1.511h-.02a.991.991 0 0 0-.321.053l.006-.002c-.349.114-.593.406-.593.749 0 .097.019.189.055.275l-.002-.006c.128.31.457.527.843.527a.987.987 0 0 0 .31-.049l-.006.002c.348-.114.592-.406.592-.749a.703.703 0 0 0-.055-.275l.002.006a.802.802 0 0 0-.183-.27l.001.001c.335-.611.623-1.136.808-1.531.251-.536.381-.935.267-1.32s-.467-.636-.933-.867c-.307-.151-.689-.311-1.147-.503a.723.723 0 0 0-.052-.324l.002.006a.792.792 0 0 0-.194-.279l.704-1.284 3.899 1.684c.704.305.995 1.053.653 1.68l-2.68 4.907c-.343.625-1.184.884-1.888.58l-5.516-2.384c-.704-.304-.996-1.053-.653-1.68l2.68-4.905c.235-.431.707-.687 1.207-.707z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_github" xmlns="http://www.w3.org/2000/svg"><path d="M16 .394c8.833 0 15.999 7.166 15.999 15.999 0 7.062-4.583 13.062-10.937 15.187-.813.146-1.104-.354-1.104-.771 0-.521.021-2.25.021-4.396 0-1.5-.5-2.458-1.083-2.958 3.562-.396 7.312-1.75 7.312-7.896 0-1.75-.625-3.167-1.646-4.291.167-.417.708-2.042-.167-4.25-1.333-.417-4.396 1.646-4.396 1.646a15.032 15.032 0 0 0-8 0S8.937 6.602 7.603 7.018c-.875 2.208-.333 3.833-.167 4.25-1.021 1.125-1.646 2.542-1.646 4.291 0 6.125 3.729 7.5 7.291 7.896-.458.417-.875 1.125-1.021 2.146-.917.417-3.25 1.125-4.646-1.333-.875-1.521-2.458-1.646-2.458-1.646-1.562-.021-.104.979-.104.979 1.042.479 1.771 2.333 1.771 2.333.938 2.854 5.396 1.896 5.396 1.896 0 1.333.021 2.583.021 2.979 0 .417-.292.917-1.104.771C4.582 29.455-.001 23.455-.001 16.393-.001 7.56 7.165.394 15.998.394zM6.063 23.372c.042-.083-.021-.187-.146-.25-.125-.042-.229-.021-.271.042-.042.083.021.187.146.25.104.062.229.042.271-.042zm.646.709c.083-.062.062-.208-.042-.333-.104-.104-.25-.146-.333-.062-.083.062-.062.208.042.333.104.104.25.146.333.062zm.625.937c.104-.083.104-.25 0-.396-.083-.146-.25-.208-.354-.125-.104.062-.104.229 0 .375s.271.208.354.146zm.875.875c.083-.083.042-.271-.083-.396-.146-.146-.333-.167-.417-.062-.104.083-.062.271.083.396.146.146.333.167.417.062zm1.187.521c.042-.125-.083-.271-.271-.333-.167-.042-.354.021-.396.146s.083.271.271.312c.167.062.354 0 .396-.125zm1.313.104c0-.146-.167-.25-.354-.229-.187 0-.333.104-.333.229 0 .146.146.25.354.229.187 0 .333-.104.333-.229zm1.208-.208c-.021-.125-.187-.208-.375-.187-.187.042-.312.167-.292.312.021.125.187.208.375.167s.312-.167.292-.292z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_gitlab" xmlns="http://www.w3.org/2000/svg"><path d="M1.629 11.034 14 26.888.442 17.048a1.09 1.09 0 0 1-.39-1.203l1.578-4.811zm7.217 0h10.309l-5.154 15.854zM5.753 1.475l3.093 9.559H1.63l3.093-9.559a.548.548 0 0 1 1.031 0zm20.618 9.559 1.578 4.811c.141.437-.016.922-.39 1.203l-13.558 9.84 12.371-15.854zm0 0h-7.216l3.093-9.559a.548.548 0 0 1 1.031 0z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_heart" xmlns="http://www.w3.org/2000/svg"><path d="M16 29.714a1.11 1.11 0 0 1-.786-.321L4.072 18.643c-.143-.125-4.071-3.714-4.071-8 0-5.232 3.196-8.357 8.535-8.357 3.125 0 6.053 2.464 7.464 3.857 1.411-1.393 4.339-3.857 7.464-3.857 5.339 0 8.535 3.125 8.535 8.357 0 4.286-3.928 7.875-4.089 8.035L16.785 29.392c-.214.214-.5.321-.786.321z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_home" xmlns="http://www.w3.org/2000/svg"><path d="M24.003 15.695v8.336c0 .608-.504 1.111-1.111 1.111h-6.669v-6.669h-4.446v6.669H5.108a1.119 1.119 0 0 1-1.111-1.111v-8.336c0-.035.017-.069.017-.104L14 7.359l9.986 8.232a.224.224 0 0 1 .017.104zm3.873-1.198-1.077 1.285a.578.578 0 0 1-.365.191h-.052a.547.547 0 0 1-.365-.122L14 5.831 1.983 15.851a.594.594 0 0 1-.417.122.578.578 0 0 1-.365-.191L.124 14.497a.57.57 0 0 1 .069-.781L12.679 3.314c.729-.608 1.91-.608 2.64 0l4.237 3.543V3.471c0-.313.243-.556.556-.556h3.334c.313 0 .556.243.556.556v7.085l3.803 3.161c.226.191.26.556.069.781z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_info_outline" xmlns="http://www.w3.org/2000/svg"><path d="M12.62 9.793V6.967h2.761v2.826H12.62zM14 25.239q4.601 0 7.92-3.319T25.239 14 21.92 6.08 14 2.761 6.08 6.08 2.761 14t3.319 7.92T14 25.239zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0zm-1.38 21.033V12.62h2.761v8.413H12.62z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_keyboard_arrow_down" xmlns="http://www.w3.org/2000/svg"><path d="M3.281 5.36 14 16.079 24.719 5.36 28 8.641l-14 14-14-14z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_keyboard_arrow_left" xmlns="http://www.w3.org/2000/svg"><path d="M25.875 28.25 22.125 32 6.126 16.001 22.125.002l3.75 3.75-12.25 12.25z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_keyboard_arrow_right" xmlns="http://www.w3.org/2000/svg"><path d="M6.125 28.25 18.375 16 6.125 3.75 9.875 0l15.999 15.999L9.875 31.998z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_keyboard_arrow_up" xmlns="http://www.w3.org/2000/svg"><path d="M24.719 22.64 14 11.921 3.281 22.64 0 19.359l14-14 14 14z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_language" xmlns="http://www.w3.org/2000/svg"><path d="M20.112 16.826h4.732q.394-1.84.394-2.826t-.394-2.826h-4.732q.197 1.38.197 2.826t-.197 2.826zm-2.497 7.756q1.643-.526 3.418-2.005t2.695-2.991h-4.141q-.657 2.629-1.972 4.995zm-.329-7.756q.197-1.38.197-2.826t-.197-2.826h-6.573q-.197 1.38-.197 2.826t.197 2.826h6.573zM14 25.173q1.84-2.695 2.695-5.587h-5.39q.854 2.892 2.695 5.587zM8.413 8.413q.789-2.826 1.972-4.995-1.643.526-3.451 2.005T4.272 8.414h4.141zM4.272 19.587q.854 1.512 2.662 2.991t3.451 2.005q-1.315-2.366-1.972-4.995H4.272zm-1.117-2.761h4.732Q7.69 15.446 7.69 14t.197-2.826H3.155q-.394 1.84-.394 2.826t.394 2.826zM14 2.826q-1.84 2.695-2.695 5.587h5.39Q15.841 5.521 14 2.826zm9.727 5.587q-.92-1.512-2.695-2.991t-3.418-2.005q1.183 2.169 1.972 4.995h4.141zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_link" xmlns="http://www.w3.org/2000/svg"><path d="M24.037 7.963q3.305 0 5.634 2.366T32 16t-2.329 5.671-5.634 2.366h-6.46v-3.08h6.46q2.028 0 3.493-1.465t1.465-3.493-1.465-3.493-3.493-1.465h-6.46v-3.08h6.46zM9.615 17.578v-3.155h12.77v3.155H9.615zM3.005 16q0 2.028 1.465 3.493t3.493 1.465h6.46v3.08h-6.46q-3.305 0-5.634-2.366T0 16.001t2.329-5.671 5.634-2.366h6.46v3.08h-6.46q-2.028 0-3.493 1.465t-1.465 3.493z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_mastodon" xmlns="http://www.w3.org/2000/svg"><path d="M30.924 10.506c0-6.941-4.548-8.976-4.548-8.976C24.083.477 20.144.034 16.054.001h-.101C11.862.034 7.926.477 5.633 1.53c0 0-4.548 2.035-4.548 8.976 0 1.589-.031 3.491.02 5.505.165 6.79 1.245 13.479 7.522 15.14 2.893.765 5.379.927 7.38.816 3.629-.2 5.667-1.296 5.667-1.296l-.12-2.633s-2.593.817-5.505.719c-2.887-.099-5.932-.311-6.399-3.855a7.069 7.069 0 0 1-.064-.967v-.028.001s2.833.693 6.423.857c2.195.1 4.253-.129 6.344-.377 4.009-.479 7.5-2.949 7.939-5.207.689-3.553.633-8.676.633-8.676zm-5.366 8.945h-3.329v-8.159c0-1.72-.724-2.592-2.171-2.592-1.6 0-2.403 1.035-2.403 3.083v4.465h-3.311v-4.467c0-2.048-.803-3.083-2.403-3.083-1.447 0-2.171.873-2.171 2.592v8.159H6.441v-8.404c0-1.719.437-3.084 1.316-4.093.907-1.011 2.092-1.528 3.565-1.528 1.704 0 2.995.655 3.848 1.965l.828 1.391.829-1.391c.853-1.311 2.144-1.965 3.848-1.965 1.472 0 2.659.517 3.565 1.528.877 1.009 1.315 2.375 1.315 4.093z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_matrix" xmlns="http://www.w3.org/2000/svg"><path d="M.843.734v30.532H3.04v.733H0V0h3.04v.733zm9.391 9.68v1.543h.044a4.417 4.417 0 0 1 1.489-1.365c.577-.327 1.248-.487 2-.487.72 0 1.377.143 1.975.419.597.277 1.047.776 1.36 1.477.339-.499.8-.941 1.379-1.323.579-.383 1.267-.573 2.061-.573.604 0 1.163.075 1.68.223a3.34 3.34 0 0 1 1.324.707c.368.327.652.745.861 1.268.203.523.307 1.151.307 1.889v7.637h-3.132v-6.468c0-.381-.013-.745-.043-1.083a2.315 2.315 0 0 0-.246-.893l.006.013a1.484 1.484 0 0 0-.577-.593l-.007-.004c-.259-.147-.609-.221-1.047-.221-.443 0-.8.085-1.071.252-.267.166-.483.39-.635.656l-.005.009a2.558 2.558 0 0 0-.307.915l-.002.013a7.156 7.156 0 0 0-.08 1.044v6.359h-3.133v-6.4c0-.339-.005-.671-.024-1.003a2.772 2.772 0 0 0-.197-.936l.007.019a1.41 1.41 0 0 0-.548-.667l-.006-.003c-.259-.167-.635-.253-1.139-.253-.148 0-.345.032-.585.099-.24.068-.48.191-.707.376-.228.184-.425.449-.585.793-.16.345-.24.8-.24 1.36v6.621H7.279v-11.42zm20.923 20.852V.734H28.96V.001H32V32h-3.04v-.733z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_menu" xmlns="http://www.w3.org/2000/svg"><path d="M.001 5.334h31.998v3.583H.001V5.334zm0 12.416v-3.5h31.998v3.5H.001zm0 8.916v-3.583h31.998v3.583H.001z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_notification" xmlns="http://www.w3.org/2000/svg"><path d="m22.615 19.384 2.894 2.894v1.413H2.49v-1.413l2.894-2.894V12.25q0-3.365 1.716-5.856t4.745-3.231v-1.01q0-.875.606-1.514T13.999 0t1.548.639.606 1.514v1.01q3.029.74 4.745 3.231t1.716 5.856v7.134zM14 27.999q-1.211 0-2.053-.808t-.841-2.019h5.788q0 1.144-.875 1.986T14 27.999z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_path" xmlns="http://www.w3.org/2000/svg"><path d="M28 12.62h-9.793V8.414h-2.826v11.173h2.826v-4.206H28V26.62h-9.793v-4.206H12.62v-14H9.794v4.206H.001V1.381h9.793v4.206h8.413V1.381H28V12.62z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_person" xmlns="http://www.w3.org/2000/svg"><path d="M16 20.023q5.052 0 10.526 2.199t5.473 5.754v4.023H0v-4.023q0-3.555 5.473-5.754t10.526-2.199zM16 16q-3.275 0-5.614-2.339T8.047 8.047t2.339-5.661T16 0t5.614 2.386 2.339 5.661-2.339 5.614T16 16z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_search" xmlns="http://www.w3.org/2000/svg"><path d="M11.925 20.161q3.432 0 5.834-2.402t2.402-5.834-2.402-5.834-5.834-2.402-5.834 2.402-2.402 5.834 2.402 5.834 5.834 2.402zm10.981 0L32 29.255 29.255 32l-9.094-9.094v-1.458l-.515-.515q-3.26 2.831-7.721 2.831-4.976 0-8.45-3.432T.001 11.925t3.474-8.45 8.45-3.474 8.407 3.474 3.432 8.45q0 1.802-.858 4.075t-1.973 3.646l.515.515h1.458z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_shield" xmlns="http://www.w3.org/2000/svg"><path d="M22.167 15.166V3.5h-8.166v20.726c.93-.492 2.424-1.349 3.883-2.497 1.95-1.531 4.284-3.919 4.284-6.562zm3.499-13.999v14c0 7.674-10.737 12.523-11.192 12.724-.146.073-.31.109-.474.109s-.328-.036-.474-.109c-.456-.201-11.192-5.049-11.192-12.724v-14C2.334.529 2.863 0 3.501 0H24.5c.638 0 1.167.529 1.167 1.167z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_star" xmlns="http://www.w3.org/2000/svg"><path d="M14 22.052 5.324 27.31l2.3-9.859L0 10.813l10.056-.854L14 .692l3.944 9.267L28 10.813l-7.624 6.638 2.3 9.859z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_tag" xmlns="http://www.w3.org/2000/svg"><path d="M17.52 17.52v-7.041h-7.041v7.041h7.041zM28 10.479h-7.041v7.041H28v3.439h-7.041V28H17.52v-7.041h-7.041V28H7.04v-7.041H-.001V17.52H7.04v-7.041H-.001V7.04H7.04V-.001h3.439V7.04h7.041V-.001h3.439V7.04H28v3.439z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_timer" xmlns="http://www.w3.org/2000/svg"><path d="M16 29q4.428 0 7.536-3.143t3.107-7.571-3.107-7.536T16 7.643 8.464 10.75t-3.107 7.536 3.107 7.571T16 29zM26.714 9.786q1.214 1.571 2.107 4.036t.893 4.464q0 5.643-4 9.678T16 32t-9.714-4.036-4-9.678 4-9.678T16 4.572q1.929 0 4.464.929t4.107 2.143l2.143-2.214q1.143.929 2.143 2.143zM14.5 19.857v-9.143h3v9.143h-3zM20.571.001v3.071h-9.143V.001h9.143z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_xmpp" xmlns="http://www.w3.org/2000/svg"><path d="M31.995 4.237c-.449.175-1.12.433-1.936.745-1.544.591-2.328.891-2.924 1.093-.613.208-1.287.409-2.635.813-.911.272-1.672.495-2.212.651-.031.875 0 2.177-.292 3.635a21.837 21.837 0 0 1-2.016 5.765c-1.496 2.944-3.236 4.817-3.88 5.476-.056-.059-.112-.117-.168-.179-.707-.763-2.403-2.703-3.815-5.683-1.053-2.223-1.484-4.044-1.605-4.584-.356-1.589-.427-2.955-.427-4.117 0-.075-.036-.129-.101-.149-.721-.223-1.765-.519-2.887-.853-1.271-.379-2.193-.744-3.408-1.2-.493-.185-1.409-.547-2.217-.859C.723 4.499.113 4.236.041 4.236c-.005 0-.015 0-.023.012a.131.131 0 0 0-.019.076c.009.593.08 1.361.256 2.365.615 3.503 2.688 7.061 4.36 9.244 0 0 3.717 5.035 9.128 8.144l.303.176c-.009.008-.02.015-.028.021-1.717 1.316-3.201 1.977-3.579 2.14a15.71 15.71 0 0 1-2.219.772v.407a25.31 25.31 0 0 0 2.72-.487 26.72 26.72 0 0 0 5.075-1.792c.136.067.276.136.42.204 1.527.725 3.571 1.627 6.073 2.048.613.103 1.136.165 1.507.195a.109.109 0 0 0 .115-.091.55.55 0 0 0 .004-.217.107.107 0 0 0-.063-.073c-.505-.209-1.201-.4-1.983-.719-.935-.381-2.241-1.067-3.648-2.128a13.528 13.528 0 0 1-.367-.287c4.64-2.656 7.989-6.588 7.989-6.588 1.735-2.036 4.441-5.623 5.431-9.795.349-1.473.539-2.741.5-3.628z"/></svg></defs></svg>




    <div
      class="wrapper "
    >
      <input type="checkbox" class="hidden" id="menu-control" />
      <input type="checkbox" class="hidden" id="menu-header-control" />
      
      <header class="gdoc-header">
  <div class="container flex align-center justify-between">
    
      <label for="menu-control" class="gdoc-nav__control" tabindex="0">
        <svg class="gdoc-icon gdoc_menu">
          <title>Open Navigation</title>
          <use xlink:href="#gdoc_menu"></use>
        </svg>
        <svg class="gdoc-icon gdoc_arrow_back">
          <title>Close Navigation</title>
          <use xlink:href="#gdoc_arrow_back"></use>
        </svg>
      </label>
    
    <div>
      <a class="gdoc-brand gdoc-header__link" href="https://www.sudo.ws/">
        <span class="flex align-center"><span class="gdoc-brand__title">Sudo</span>
        </span>
      </a>
    </div>
    <div class="gdoc-menu-header">
      <span class="gdoc-menu-header__items">
        
          

  
  
  
  

  
    
      
      
      

      
      

      

      
        <span>
          <a
            href="
              https://github.com/sudo-project/sudo
            "
            class="gdoc-header__link"
          >
            <svg class="gdoc-icon gdoc_github">
              <title>GitHub</title>
              <use xlink:href="#gdoc_github"></use>
            </svg>
          </a>
        </span>
      
    
  
    
      
      
      

      
      

      

      
        <span>
          <a
            href="
              /posts/
            "
            class="gdoc-header__link"
          >
            <svg class="gdoc-icon fa-blog">
              <title>Blog</title>
              <use xlink:href="#fa-blog"></use>
            </svg>
          </a>
        </span>
      
    
  






        


        <span id="gdoc-color-theme">
          <svg class="gdoc-icon gdoc_brightness_dark">
            <title>Toggle Dark/Light/Auto mode</title>
            <use xlink:href="#gdoc_brightness_dark"></use>
          </svg>
          <svg class="gdoc-icon gdoc_brightness_light">
            <title>Toggle Dark/Light/Auto mode</title>
            <use xlink:href="#gdoc_brightness_light"></use>
          </svg>
          <svg class="gdoc-icon gdoc_brightness_auto">
            <title>Toggle Dark/Light/Auto mode</title>
            <use xlink:href="#gdoc_brightness_auto"></use>
          </svg>
        </span>

        <span class="gdoc-menu-header__home">
          <a href="https://www.sudo.ws/" class="gdoc-header__link">
            <svg class="gdoc-icon gdoc_home">
              <title>Back to homepage</title>
              <use xlink:href="#gdoc_home"></use>
            </svg>
          </a>
        </span>

        



        <span class="gdoc-menu-header__control">
          <label for="menu-header-control">
            <svg class="gdoc-icon gdoc_keyboard_arrow_right">
              <use xlink:href="#gdoc_keyboard_arrow_right"></use>
              <title>Close Menu Bar</title>
            </svg>
          </label>
        </span>
      </span>
      <label for="menu-header-control" class="gdoc-menu-header__control">
        <svg class="gdoc-icon gdoc_keyboard_arrow_left">
          <use xlink:href="#gdoc_keyboard_arrow_left"></use>
          <title>Open Menu Bar</title>
        </svg>
      </label>
    </div>
  </div>
</header>



      <main class="container flex flex-even">
        
          <aside class="gdoc-nav">
            <nav><a class="container hidden-mobile" href="/">
          <img src="/images/sudo-sandwich-logo-65.png" alt="Sudo Logo" />
      </a>
  <div class="gdoc-search flex align-center">
    <svg class="gdoc-icon gdoc_search"><use xlink:href="#gdoc_search"></use></svg>
    <input
      type="text"
      id="gdoc-search-input"
      class="gdoc-search__input"
      placeholder="Search"
      aria-label="Search"
      maxlength="64"
      data-site-base-url="https://www.sudo.ws/"
      data-site-lang="en"
    />
    <div class="gdoc-search__spinner spinner hidden"></div>
    <ul id="gdoc-search-results" class="gdoc-search__list"></ul>
  </div>




  <section class="gdoc-nav--main">
    
      

  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">About Sudo</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/intro/"
                    class="gdoc-nav__entry"
                  >
                    A Short Introduction
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/history/"
                    class="gdoc-nav__entry"
                  >
                    A Brief History of Sudo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/contributors/"
                    class="gdoc-nav__entry"
                  >
                    Contributors
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/translations/"
                    class="gdoc-nav__entry"
                  >
                    Translations
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/plugins/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Plugins
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/license/"
                    class="gdoc-nav__entry"
                  >
                    Sudo License
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/logo/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Logo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/about/export/"
                    class="gdoc-nav__entry"
                  >
                    Export Controls
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Releases</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/releases/stable/"
                    class="gdoc-nav__entry"
                  >
                    Stable Release
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/releases/legacy/"
                    class="gdoc-nav__entry"
                  >
                    Legacy Release
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/releases/devel/"
                    class="gdoc-nav__entry"
                  >
                    Development Release
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/releases/changelog/"
                    class="gdoc-nav__entry"
                  >
                    ChangeLog
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Getting Sudo</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
      
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/getting/repo/"
                    class="gdoc-nav__entry"
                  >
                    Source Repo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/getting/source/"
                    class="gdoc-nav__entry"
                  >
                    Source Distribution
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/getting/packages/"
                    class="gdoc-nav__entry"
                  >
                    Prebuilt Packages
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/getting/download_mirrors/"
                    class="gdoc-nav__entry"
                  >
                    Download Mirrors
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/getting/mirror/"
                    class="gdoc-nav__entry"
                  >
                    Mirroring Sudo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Documentation</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="gdoc-nav__toggle" id="navtree-7533376e"
                checked
              
            />
            <label
              
                for="navtree-7533376e" class="flex justify-between align-center"
              
            >
              
                <span class="flex">Manual Pages (latest)</span>
              
              
                <svg class="gdoc-icon toggle gdoc_keyboard_arrow_left">
                  <use xlink:href="#gdoc_keyboard_arrow_left"></use>
                </svg>
                <svg class="gdoc-icon toggle gdoc_keyboard_arrow_down">
                  <use xlink:href="#gdoc_keyboard_arrow_down"></use>
                </svg>
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/cvtsudoers.man/"
                    class="gdoc-nav__entry"
                  >
                    Cvtsudoers Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo.conf.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Configuration Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_sendlog.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Log Client Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_logsrvd.conf.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Log Server Configuration Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_logsrvd.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Log Server Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_logsrv.proto.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Log Server Protocol Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_plugin.man/"
                    class="gdoc-nav__entry is-active"
                  >
                    Sudo Plugin API
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudo_plugin_python.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Python Plugin API
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudoers.ldap.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudoers LDAP Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudoers.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudoers Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudoers_timestamp.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudoers Time Stamp Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/sudoreplay.man/"
                    class="gdoc-nav__entry"
                  >
                    Sudoreplay Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man/visudo.man/"
                    class="gdoc-nav__entry"
                  >
                    Visudo Manual
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/man_all/"
                    class="gdoc-nav__entry"
                  >
                    Manual Pages (all versions)
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="gdoc-nav__toggle" id="navtree-3f8f9cdc"
                
              
            />
            <label
              
                for="navtree-3f8f9cdc" class="flex justify-between align-center"
              
            >
              
                <span class="flex">README Files</span>
              
              
                <svg class="gdoc-icon toggle gdoc_keyboard_arrow_left">
                  <use xlink:href="#gdoc_keyboard_arrow_left"></use>
                </svg>
                <svg class="gdoc-icon toggle gdoc_keyboard_arrow_down">
                  <use xlink:href="#gdoc_keyboard_arrow_down"></use>
                </svg>
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/readme/readme/"
                    class="gdoc-nav__entry"
                  >
                    README
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/readme/readme_ldap/"
                    class="gdoc-nav__entry"
                  >
                    README.LDAP
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/install/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Installation Notes
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/upgrade/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Upgrade Notes
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/contributing/"
                    class="gdoc-nav__entry"
                  >
                    Contributing to Sudo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/troubleshooting/"
                    class="gdoc-nav__entry"
                  >
                    Troubleshooting FAQ
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/packaging/"
                    class="gdoc-nav__entry"
                  >
                    Building Sudo Packages
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/other/"
                    class="gdoc-nav__entry"
                  >
                    Other Documentation
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/docs/alternatives/"
                    class="gdoc-nav__entry"
                  >
                    Sudo Alternatives
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Security</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/security/advisories/"
                    class="gdoc-nav__entry"
                  >
                    Security Advisories
                  </a>
                </span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/security/policy/"
                    class="gdoc-nav__entry"
                  >
                    Security Policy
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/security/static_analysis/"
                    class="gdoc-nav__entry"
                  >
                    Static Analysis
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/security/fuzzing/"
                    class="gdoc-nav__entry"
                  >
                    Fuzzing Sudo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/security/sanitizers/"
                    class="gdoc-nav__entry"
                  >
                    Sanitizers and Sudo
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
  </ul>






    
  </section>

  


  <section class="gdoc-nav--more">
    
      

  
  


  <ul class="gdoc-nav__list">
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon fa-blog"><use xlink:href="#fa-blog"></use></svg>
                
                <a
                  href="/posts"
                  class="gdoc-nav__entry"
                >
                  Blog
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon fa-bug"><use xlink:href="#fa-bug"></use></svg>
                
                <a
                  href="
                    https://bugzilla.sudo.ws"
                  class="gdoc-nav__entry"
                >
                  Bug Tracker
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon gdoc_notification"><use xlink:href="#gdoc_notification"></use></svg>
                
                <a
                  href="/news"
                  class="gdoc-nav__entry"
                >
                  News
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon gdoc_email"><use xlink:href="#gdoc_email"></use></svg>
                
                <a
                  href="/lists"
                  class="gdoc-nav__entry"
                >
                  Mailing Lists
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon gdoc_github"><use xlink:href="#gdoc_github"></use></svg>
                
                <a
                  href="
                    https://github.com/sudo-project/sudo"
                  class="gdoc-nav__entry"
                >
                  GitHub Repo
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon gdoc_git"><use xlink:href="#gdoc_git"></use></svg>
                
                <a
                  href="
                    https://git.sudo.ws/sudo"
                  class="gdoc-nav__entry"
                >
                  Git Mirror
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon fa-mastodon"><use xlink:href="#fa-mastodon"></use></svg>
                
                <a
                  href="
                    https://fosstodon.org/@sudoproject"
                  class="gdoc-nav__entry"
                >
                  Mastodon
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon fa-book"><use xlink:href="#fa-book"></use></svg>
                
                <a
                  href="
                    https://mwl.io/nonfiction/tools#sudo2"
                  class="gdoc-nav__entry"
                >
                  Sudo Mastery Book
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
  </ul>






    
  </section>
</nav>

          </aside>
        


        <div class="gdoc-page">
          
  


  






<div
  class="gdoc-page__header flex flex-wrap
  
    justify-end
  
  hidden-mobile
  hidden"
  itemprop="breadcrumb"
>
  
  
</div>



  <article
    class="gdoc-markdown gdoc-markdown__align--left"
  >
    <h1>Sudo Plugin API</h1>
    






<div class="gdoc-include"><link rel="preload" href="/mandoc.css" as="style">
<link rel="stylesheet" href="/mandoc.css" media="all">
<main class="manual-text">
<section class="Sh">
<h2 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h2>
<p class="Pp"><code class="Nm">sudo_plugin</code> &#x2014;
    <span class="Nd" role="doc-subtitle">Sudo Plugin API</span></p>
</section>
<section class="Sh">
<h2 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h2>
<p class="Pp">Starting with version 1.8, <code class="Nm">sudo</code> supports a
    plugin API for policy and session logging. Plugins may be compiled as
    dynamic shared objects (the default on systems that support them) or
    compiled statically into the <code class="Nm">sudo</code> binary itself. By
    default, the <code class="Nm">sudoers</code> plugin provides audit, security
    policy and I/O logging capabilities. Via the plugin API,
    <code class="Nm">sudo</code> can be configured to use alternate plugins
    provided by third parties. The plugins to be used are specified in the
    <a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a> file.</p>
<p class="Pp">The API is versioned with a major and minor number. The minor
    version number is incremented when additions are made. The major number is
    incremented when incompatible changes are made. A plugin should be check the
    version passed to it and make sure that the major version matches.</p>
<p class="Pp">The plugin API is defined by the
    <code class="In">&lt;<a class="In">sudo_plugin.h</a>&gt;</code> header
  file.</p>
<section class="Ss">
<h3 class="Ss" id="Policy_plugin_API"><a class="permalink" href="#Policy_plugin_API">Policy
  plugin API</a></h3>
<p class="Pp">A policy plugin must declare and populate a <var class="Vt">struct
    policy_plugin</var> in the global scope. This structure contains pointers to
    the functions that implement the <code class="Nm">sudo</code> policy checks.
    The name of the symbol should be specified in
    <a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a> along with
    a path to the plugin so that <code class="Nm">sudo</code> can load it.</p>
<div class="Bd Pp Li">
<pre>struct policy_plugin {
&#35;define SUDO_POLICY_PLUGIN     1
    unsigned int type; /* always SUDO_POLICY_PLUGIN */
    unsigned int version; /* always SUDO_API_VERSION */
    int (*open)(unsigned int version, sudo_conv_t conversation,
        sudo_printf_t sudo_plugin_printf, char * const settings[],
        char * const user_info[], char * const user_env[],
        char * const plugin_options[], const char **errstr);
    void (*close)(int exit_status, int error);
    int (*show_version)(int verbose);
    int (*check_policy)(int argc, char * const argv[],
        char *env_add[], char **command_info[],
        char **argv_out[], char **user_env_out[], const char **errstr);
    int (*list)(int argc, char * const argv[], int verbose,
        const char *user, const char **errstr);
    int (*validate)(const char **errstr);
    void (*invalidate)(int rmcred);
    int (*init_session)(struct passwd *pwd, char **user_env[],
        const char **errstr);
    void (*register_hooks)(int version,
       int (*register_hook)(struct sudo_hook *hook));
    void (*deregister_hooks)(int version,
       int (*deregister_hook)(struct sudo_hook *hook));
    struct sudo_plugin_event * (*event_alloc)(void);
};</pre>
</div>
<p class="Pp">A <var class="Vt">struct policy_plugin</var> has the following
    fields:</p>
<dl class="Bl-tag">
  <dt><var class="Fa">type</var></dt>
  <dd>The <var class="Fa">type</var> field should always be set to
      SUDO_POLICY_PLUGIN.</dd>
  <dt><var class="Fa">version</var></dt>
  <dd>The <var class="Fa">version</var> field should be set to
      <code class="Dv">SUDO_API_VERSION</code>.
    <p class="Pp">This allows <code class="Nm">sudo</code> to determine the API
        version the plugin was built against.</p>
  </dd>
  <dt><var class="Fa">open</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*open)(unsigned int version, sudo_conv_t conversation,
    sudo_printf_t sudo_plugin_printf, char * const settings[],
    char * const user_info[], char * const user_env[],
    char * const plugin_options[], const char **errstr);</pre>
    </div>
    <p class="Pp" id="conversation">Returns 1 on success, 0 on failure, -1 if a
        general error occurred, or -2 if there was a usage error. In the latter
        case, <code class="Nm">sudo</code> will print a usage message before it
        exits. If an error occurs, the plugin may optionally call the
        <a class="permalink" href="#conversation"><code class="Fn">conversation</code></a>()
        or
        <a class="permalink" href="#sudo_plugin_printf"><code class="Fn" id="sudo_plugin_printf">sudo_plugin_printf</code></a>()
        function with <code class="Dv">SUDO_CONF_ERROR_MSG</code> to present
        additional error information to the user.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">version</var></dt>
      <dd>The version passed in by <code class="Nm">sudo</code> allows the
          plugin to determine the major and minor version number of the plugin
          API supported by <code class="Nm">sudo</code>.</dd>
      <dt id="conversation~2"><var class="Fa">conversation</var></dt>
      <dd>A pointer to the
          <a class="permalink" href="#conversation~2"><code class="Fn">conversation</code></a>()
          function that can be used by the plugin to interact with the user (see
          <a class="Sx" href="#Conversation_API">Conversation API</a> for
          details). Returns 0 on success and -1 on failure.</dd>
      <dt><var class="Fa">sudo_plugin_printf</var></dt>
      <dd>A pointer to a <code class="Fn">printf</code>()-style function that
          may be used to display informational or error messages (see
          <a class="Sx" href="#Conversation_API">Conversation API</a> for
          details). Returns the number of characters printed on success and -1
          on failure.</dd>
      <dt><var class="Fa">settings</var></dt>
      <dd>A vector of user-supplied <code class="Nm">sudo</code> settings in the
          form of &#x201C;name=value&#x201D; strings. The vector is terminated
          by a <code class="Dv">NULL</code> pointer. These settings correspond
          to options the user specified when running
          <code class="Nm">sudo</code>. As such, they will only be present when
          the corresponding option has been specified on the command line.
        <p class="Pp">When parsing <var class="Fa">settings</var>, the plugin
            should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
        <p class="Pp">The following values may be set by
            <code class="Nm">sudo</code>:</p>
        <dl class="Bl-tag">
          <dt>bsdauth_type=string</dt>
          <dd>Authentication type, if specified by the
              <code class="Fl">-a</code> option, to use on systems where
              <span class="Ux">BSD</span> authentication is supported.</dd>
          <dt>closefrom=number</dt>
          <dd>If specified, the user has requested via the
              <code class="Fl">-C</code> option that
              <code class="Nm">sudo</code> close all files descriptors with a
              value of <i class="Em">number</i> or higher. The plugin may
              optionally pass this, or another value, back in the
              <var class="Fa">command_info</var> list.</dd>
          <dt>cmnd_chroot=string</dt>
          <dd>The root directory (see <a class="Xr" aria-label="chroot, section
              2">chroot(2)</a>) to run the command in, as specified by the user
              via the <code class="Fl">-R</code> option. The plugin may ignore
              or restrict the user's ability to specify a new root directory.
              Only available starting with API version 1.16.</dd>
          <dt>cmnd_cwd=string</dt>
          <dd>The working directory to run the command in, as specified by the
              user via the <code class="Fl">-D</code> option. The plugin may
              ignore or restrict the user's ability to specify a new working
              directory. Only available starting with API version 1.16.</dd>
          <dt id="subsystem">debug_flags=string</dt>
          <dd>A debug file path name followed by a space and a comma-separated
              list of debug flags that correspond to the plugin's
              <i class="Em">Debug</i> entry in
              <a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a>,
              if there is one. The flags are passed to the plugin exactly as
              they appear in <a class="Xr" aria-label="sudo.conf, section
              5">sudo.conf(5)</a>. The syntax used by
              <code class="Nm">sudo</code> and the
              <code class="Nm">sudoers</code> plugin is
              <a class="permalink" href="#subsystem"><i class="Em">subsystem</i></a>@<a class="permalink" href="#priority"><i class="Em" id="priority">priority</i></a>
              but a plugin is free to use a different format so long as it does
              not include a comma (&#x2018;<code class="Li">,</code>&#x2019;).
              Prior to <code class="Nm">sudo</code> 1.8.12, there was no way to
              specify plugin-specific <i class="Em">debug_flags</i> so the value
              was always the same as that used by the
              <code class="Nm">sudo</code> front-end and did not include a path
              name, only the flags themselves. As of version 1.7 of the plugin
              interface, <code class="Nm">sudo</code> will only pass
              <i class="Em">debug_flags</i> if
              <a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a>
              contains a plugin-specific <i class="Em">Debug</i> entry.</dd>
          <dt id="check_policy">ignore_ticket=bool</dt>
          <dd>Set to true if the user specified the <code class="Fl">-k</code>
              option along with a command, indicating that the user wishes to
              ignore any cached authentication credentials.
              <i class="Em">implied_shell</i> to true. This allows
              <code class="Nm">sudo</code> with no arguments to be used
              similarly to <a class="Xr" aria-label="su, section 1">su(1)</a>.
              If the plugin does not to support this usage, it may return a
              value of -2 from the
              <a class="permalink" href="#check_policy"><code class="Fn">check_policy</code></a>()
              function, which will cause <code class="Nm">sudo</code> to print a
              usage message and exit.</dd>
          <dt>implied_shell=bool</dt>
          <dd>If the user does not specify a program on the command line,
              <code class="Nm">sudo</code> will pass the plugin the path to the
              user's shell and set <i class="Em">implied_shell</i>.</dd>
          <dt>intercept_ptrace=bool</dt>
          <dd>Indicates whether or not the system supports intercept mode using
              <a class="Xr" aria-label="ptrace, section 2">ptrace(2)</a>. This
              is currently only true for Linux systems that support
              <a class="Xr" aria-label="seccomp, section 2">seccomp(2)</a>
              filtering and the &#x201C;trap&#x201D; action. Other systems will
              use a dynamic shared object to implement intercept. Only available
              starting with API version 1.19.</dd>
          <dt>intercept_setid=bool</dt>
          <dd>Indicates whether or not the system supports running set-user-ID
              and set-group-ID binaries in intercept mode. This is currently
              only true for Linux systems that support
              <a class="Xr" aria-label="seccomp, section 2">seccomp(2)</a>
              filtering and the &#x201C;trap&#x201D; action. On systems that use
              a dynamic shared object to implement intercept, the dynamic linker
              (ld.so or the equivalent) will disable preloading of shared
              objects when executing a set-user-ID or set-group-ID binary. This
              will disable intercept mode for that program and any other
              programs that it executes. The policy plugin may refuse to execute
              a set-user-ID or set-group-ID binary in intercept mode to avoid
              this. Only available starting with API version 1.19.</dd>
          <dt>login_class=string</dt>
          <dd><span class="Ux">BSD</span> login class to use when setting
              resource limits and nice value, if specified by the
              <code class="Fl">-c</code> option.</dd>
          <dt>login_shell=bool</dt>
          <dd>Set to true if the user specified the <code class="Fl">-i</code>
              option, indicating that the user wishes to run a login shell.</dd>
          <dt>max_groups=int</dt>
          <dd>The maximum number of groups a user may belong to. This will only
              be present if there is a corresponding setting in
              <a class="Xr" aria-label="sudo.conf, section
            5">sudo.conf(5)</a>.</dd>
          <dt>network_addrs=list</dt>
          <dd>A space-separated list of IP network addresses and netmasks in the
              form &#x201C;addr/netmask&#x201D;, e.g.,
              &#x201C;192.168.1.2/255.255.255.0&#x201D;. The address and netmask
              pairs may be either IPv4 or IPv6, depending on what the operating
              system supports. If the address contains a colon
              (&#x2018;<code class="Li">:</code>&#x2019;), it is an IPv6
              address, else it is IPv4.</dd>
          <dt>noninteractive=bool</dt>
          <dd>Set to true if the user specified the <code class="Fl">-n</code>
              option, indicating that <code class="Nm">sudo</code> should
              operate in non-interactive mode. The plugin may reject a command
              run in non-interactive mode if user interaction is required.</dd>
          <dt>plugin_dir=string</dt>
          <dd>The default plugin directory used by the
              <code class="Nm">sudo</code> front-end. This is the default
              directory set at compile time and may not correspond to the
              directory the running plugin was loaded from. It may be used by a
              plugin to locate support files.</dd>
          <dt>plugin_path=string</dt>
          <dd>The path name of plugin loaded by the <code class="Nm">sudo</code>
              front-end. The path name will be a fully-qualified unless the
              plugin was statically compiled into
            <code class="Nm">sudo</code>.</dd>
          <dt>preserve_environment=bool</dt>
          <dd>Set to true if the user specified the <code class="Fl">-E</code>
              option, indicating that the user wishes to preserve the
              environment.</dd>
          <dt>preserve_groups=bool</dt>
          <dd>Set to true if the user specified the <code class="Fl">-P</code>
              option, indicating that the user wishes to preserve the group
              vector instead of setting it based on the runas user.</dd>
          <dt>progname=string</dt>
          <dd>The command name that sudo was run as, typically
              &#x201C;sudo&#x201D; or &#x201C;sudoedit&#x201D;.</dd>
          <dt>prompt=string</dt>
          <dd>The prompt to use when requesting a password, if specified via the
              <code class="Fl">-p</code> option.</dd>
          <dt>remote_host=string</dt>
          <dd>The name of the remote host to run the command on, if specified
              via the <code class="Fl">-h</code> option. Support for running the
              command on a remote host is meant to be implemented via a helper
              program that is executed in place of the user-specified command.
              The <code class="Nm">sudo</code> front-end is only capable of
              executing commands on the local host. Only available starting with
              API version 1.4.</dd>
          <dt>run_shell=bool</dt>
          <dd>Set to true if the user specified the <code class="Fl">-s</code>
              option, indicating that the user wishes to run a shell.</dd>
          <dt>runas_group=string</dt>
          <dd>The group name or group-ID to run the command as, if specified via
              the <code class="Fl">-g</code> option.</dd>
          <dt>runas_user=string</dt>
          <dd>The user name or user-ID to run the command as, if specified via
              the <code class="Fl">-u</code> option.</dd>
          <dt>selinux_role=string</dt>
          <dd>SELinux role to use when executing the command, if specified by
              the <code class="Fl">-r</code> option.</dd>
          <dt>selinux_type=string</dt>
          <dd>SELinux type to use when executing the command, if specified by
              the <code class="Fl">-t</code> option.</dd>
          <dt>set_home=bool</dt>
          <dd>Set to true if the user specified the <code class="Fl">-H</code>
              option. If true, set the <code class="Ev">HOME</code> environment
              variable to the target user's home directory.</dd>
          <dt>sudoedit=bool</dt>
          <dd>Set to true when the <code class="Fl">-e</code> option is
              specified or if invoked as <code class="Nm">sudoedit</code>. The
              plugin shall substitute an editor into <var class="Fa">argv</var>
              in the <code class="Fn">check_policy</code>() function or return
              -2 with a usage error if the plugin does not support
              <i class="Em">sudoedit</i>. For more information, see the
              <code class="Fn">check_policy</code>() section.</dd>
          <dt>timeout=string</dt>
          <dd>Command timeout specified by the user via the
              <code class="Fl">-T</code> option. Not all plugins support command
              timeouts and the ability of the user to set a timeout may be
              restricted by policy. The format of the timeout string is
              plugin-specific.</dd>
          <dt>update_ticket=bool</dt>
          <dd>Set to false if the user specified the <code class="Fl">-N</code>
              option, indicating that the user wishes to avoid updating any
              cached authentication credentials. Only available starting with
              API version 1.20.</dd>
        </dl>
        <p class="Pp">Additional settings may be added in the future so the
            plugin should silently ignore settings that it does not
          recognize.</p>
      </dd>
      <dt><var class="Fa">user_info</var></dt>
      <dd>A vector of information about the user running the command in the form
          of &#x201C;name=value&#x201D; strings. The vector is terminated by a
          <code class="Dv">NULL</code> pointer.
        <p class="Pp">When parsing <var class="Fa">user_info</var>, the plugin
            should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
        <p class="Pp">The following values may be set by
            <code class="Nm">sudo</code>:</p>
        <dl class="Bl-tag">
          <dt>cols=int</dt>
          <dd>The number of columns the user's terminal supports. If there is no
              terminal device available, a default value of 80 is used.</dd>
          <dt>cwd=string</dt>
          <dd>The user's current working directory.</dd>
          <dt>egid=gid_t</dt>
          <dd>The effective group-ID of the user invoking
              <code class="Nm">sudo</code>.</dd>
          <dt>euid=uid_t</dt>
          <dd>The effective user-ID of the user invoking
              <code class="Nm">sudo</code>.</dd>
          <dt>gid=gid_t</dt>
          <dd>The real group-ID of the user invoking
              <code class="Nm">sudo</code>.</dd>
          <dt>groups=list</dt>
          <dd>The user's supplementary group list formatted as a string of
              comma-separated group-IDs.</dd>
          <dt>host=string</dt>
          <dd>The local machine's hostname as returned by the
              <a class="Xr" aria-label="gethostname, section
              2">gethostname(2)</a> system call.</dd>
          <dt>lines=int</dt>
          <dd>The number of lines the user's terminal supports. If there is no
              terminal device available, a default value of 24 is used.</dd>
          <dt>pgid=int</dt>
          <dd>The ID of the process group that the running
              <code class="Nm">sudo</code> process is a member of. Only
              available starting with API version 1.2.</dd>
          <dt>pid=int</dt>
          <dd>The process ID of the running <code class="Nm">sudo</code>
              process. Only available starting with API version 1.2.</dd>
          <dt>ppid=int</dt>
          <dd>The parent process ID of the running <code class="Nm">sudo</code>
              process. Only available starting with API version 1.2.</dd>
          <dt>rlimit_as=soft,hard</dt>
          <dd>The maximum size to which the process's address space may grow (in
              bytes), if supported by the operating system. The soft and hard
              limits are separated by a comma. A value of
              &#x201C;infinity&#x201D; indicates that there is no limit. Only
              available starting with API version 1.16.</dd>
          <dt>rlimit_core=soft,hard</dt>
          <dd>The largest size core dump file that may be created (in bytes).
              The soft and hard limits are separated by a comma. A value of
              &#x201C;infinity&#x201D; indicates that there is no limit. Only
              available starting with API version 1.16.</dd>
          <dt>rlimit_cpu=soft,hard</dt>
          <dd>The maximum amount of CPU time that the process may use (in
              seconds). The soft and hard limits are separated by a comma. A
              value of &#x201C;infinity&#x201D; indicates that there is no
              limit. Only available starting with API version 1.16.</dd>
          <dt>rlimit_data=soft,hard</dt>
          <dd>The maximum size of the data segment for the process (in bytes).
              The soft and hard limits are separated by a comma. A value of
              &#x201C;infinity&#x201D; indicates that there is no limit. Only
              available starting with API version 1.16.</dd>
          <dt>rlimit_fsize=soft,hard</dt>
          <dd>The largest size file that the process may create (in bytes). The
              soft and hard limits are separated by a comma. A value of
              &#x201C;infinity&#x201D; indicates that there is no limit. Only
              available starting with API version 1.16.</dd>
          <dt>rlimit_locks=soft,hard</dt>
          <dd>The maximum number of locks that the process may establish, if
              supported by the operating system. The soft and hard limits are
              separated by a comma. A value of &#x201C;infinity&#x201D;
              indicates that there is no limit. Only available starting with API
              version 1.16.</dd>
          <dt>rlimit_memlock=soft,hard</dt>
          <dd>The maximum size that the process may lock in memory (in bytes),
              if supported by the operating system. The soft and hard limits are
              separated by a comma. A value of &#x201C;infinity&#x201D;
              indicates that there is no limit. Only available starting with API
              version 1.16.</dd>
          <dt>rlimit_nofile=soft,hard</dt>
          <dd>The maximum number of files that the process may have open. The
              soft and hard limits are separated by a comma. A value of
              &#x201C;infinity&#x201D; indicates that there is no limit. Only
              available starting with API version 1.16.</dd>
          <dt>rlimit_nproc=soft,hard</dt>
          <dd>The maximum number of processes that the user may run
              simultaneously. The soft and hard limits are separated by a comma.
              A value of &#x201C;infinity&#x201D; indicates that there is no
              limit. Only available starting with API version 1.16.</dd>
          <dt>rlimit_rss=soft,hard</dt>
          <dd>The maximum size to which the process's resident set size may grow
              (in bytes). The soft and hard limits are separated by a comma. A
              value of &#x201C;infinity&#x201D; indicates that there is no
              limit. Only available starting with API version 1.16.</dd>
          <dt>rlimit_stack=soft,hard</dt>
          <dd>The maximum size to which the process's stack may grow (in bytes).
              The soft and hard limits are separated by a comma. A value of
              &#x201C;infinity&#x201D; indicates that there is no limit. Only
              available starting with API version 1.16.</dd>
          <dt>sid=int</dt>
          <dd>The session ID of the running <code class="Nm">sudo</code> process
              or 0 if <code class="Nm">sudo</code> is not part of a POSIX job
              control session. Only available starting with API version
            1.2.</dd>
          <dt>tcpgid=int</dt>
          <dd>The ID of the foreground process group associated with the
              terminal device associated with the <code class="Nm">sudo</code>
              process or 0 if there is no terminal present. Only available
              starting with API version 1.2.</dd>
          <dt>tty=string</dt>
          <dd>The path to the user's terminal device, if one exists. This entry
              is only present if the user has a terminal device associated with
              the session.</dd>
          <dt>ttydev=dev_t</dt>
          <dd>The number of the user's terminal device, if one exists, formatted
              as a <var class="Vt">long long</var> value. This entry is only
              present if the user has a terminal device associated with the
              session. Only available starting with API version 1.22.</dd>
          <dt>uid=uid_t</dt>
          <dd>The real user-ID of the user invoking
              <code class="Nm">sudo</code>.</dd>
          <dt>umask=octal</dt>
          <dd>The invoking user's file creation mask. Only available starting
              with API version 1.10.</dd>
          <dt>user=string</dt>
          <dd>The name of the user invoking <code class="Nm">sudo</code>.</dd>
        </dl>
      </dd>
      <dt><var class="Fa">user_env</var></dt>
      <dd>The user's environment in the form of a
          <code class="Dv">NULL</code>-terminated vector of
          &#x201C;name=value&#x201D; strings.
        <p class="Pp">When parsing <var class="Fa">user_env</var>, the plugin
            should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
      </dd>
      <dt><var class="Fa">plugin_options</var></dt>
      <dd>Any (non-comment) strings immediately after the plugin path are passed
          as arguments to the plugin. These arguments are split on a white space
          boundary and are passed to the plugin in the form of a
          <code class="Dv">NULL</code>-terminated array of strings. If no
          arguments were specified, <var class="Fa">plugin_options</var> will be
          the <code class="Dv">NULL</code> pointer.
        <p class="Pp">The <var class="Fa">plugin_options</var> parameter is only
            available starting with API version 1.2. A plugin
            <b class="Sy">must</b> check the API version specified by the
            <code class="Nm">sudo</code> front-end before using
            <var class="Fa">plugin_options</var>. Failure to do so may result in
            a crash.</p>
      </dd>
      <dt id="open"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#open"><code class="Fn">open</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.
        <p class="Pp">The <var class="Fa">errstr</var> parameter is only
            available starting with API version 1.15. A plugin
            <b class="Sy">must</b> check the API version specified by the
            <code class="Nm">sudo</code> front-end before using
            <var class="Fa">errstr</var>. Failure to do so may result in a
            crash.</p>
      </dd>
    </dl>
  </dd>
  <dt><var class="Fa">close</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>void (*close)(int exit_status, int error);</pre>
    </div>
    <p class="Pp" id="close">The
        <a class="permalink" href="#close"><code class="Fn">close</code></a>()
        function is called when <code class="Nm">sudo</code> is finished,
        shortly before it exits. Starting with API version 1.15,
        <code class="Fn">close</code>() is called regardless of whether or not a
        command was actually executed. This makes it possible for plugins to
        perform cleanup even when a command was not run. It is not possible to
        tell whether a command was run based solely on the arguments passed to
        the <code class="Fn">close</code>() function. To determine if a command
        was actually run, the plugin must keep track of whether or not the
        <code class="Fn">check_policy</code>() function returned
      successfully.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">exit_status</var></dt>
      <dd>The command's exit status, as returned by the
          <a class="Xr" aria-label="wait, section 2">wait(2)</a> system call, or
          zero if no command was run. The value of
          <var class="Fa">exit_status</var> is undefined if
          <var class="Fa">error</var> is non-zero.</dd>
      <dt id="conversation~3"><var class="Fa">error</var></dt>
      <dd>If the command could not be executed, this is set to the value of
          <var class="Va">errno</var> set by the
          <a class="Xr" aria-label="execve, section 2">execve(2)</a> system
          call. The plugin is responsible for displaying error information via
          the
          <a class="permalink" href="#conversation~3"><code class="Fn">conversation</code></a>()
          or
          <a class="permalink" href="#sudo_plugin_printf~2"><code class="Fn" id="sudo_plugin_printf~2">sudo_plugin_printf</code></a>()
          function. If the command was successfully executed, the value of
          <var class="Fa">error</var> is zero.</dd>
    </dl>
    <p class="Pp" id="close~2">If no
        <a class="permalink" href="#close~2"><code class="Fn">close</code></a>()
        function is defined, no I/O logging plugins are loaded, and neither the
        <i class="Em">timeout</i> nor <i class="Em">use_pty</i> options are set
        in the <var class="Fa">command_info</var> list, the
        <code class="Nm">sudo</code> front-end may execute the command directly
        instead of running it as a child process.</p>
  </dd>
  <dt><var class="Fa">show_version</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*show_version)(int verbose);</pre>
    </div>
    <p class="Pp" id="show_version">The
        <a class="permalink" href="#show_version"><code class="Fn">show_version</code></a>()
        function is called by <code class="Nm">sudo</code> when the user
        specifies the <code class="Fl">-V</code> option. The plugin may display
        its version information to the user via the
        <code class="Fn">conversation</code>() or
        <code class="Fn">sudo_plugin_printf</code>() function using
        <code class="Dv">SUDO_CONV_INFO_MSG</code>. If the user requests
        detailed version information, the <var class="Fa">verbose</var> flag
        will be non-zero.</p>
    <p class="Pp">Returns 1 on success, 0 on failure, -1 if a general error
        occurred, or -2 if there was a usage error, although the return value is
        currently ignored.</p>
  </dd>
  <dt><var class="Fa">check_policy</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*check_policy)(int argc, char * const argv[], char *env_add[],
    char **command_info[], char **argv_out[], char **user_env_out[],
    const char **errstr);</pre>
    </div>
    <p class="Pp" id="check_policy~2">The
        <a class="permalink" href="#check_policy~2"><code class="Fn">check_policy</code></a>()
        function is called by <code class="Nm">sudo</code> to determine whether
        the user is allowed to run the specified commands.</p>
    <p class="Pp" id="open~2">If the <i class="Em">sudoedit</i> option was
        enabled in the <var class="Fa">settings</var> array passed to the
        <a class="permalink" href="#open~2"><code class="Fn">open</code></a>()
        function, the user has requested <i class="Em">sudoedit</i> mode.
        <i class="Em">sudoedit</i> is a mechanism for editing one or more files
        where an editor is run with the user's credentials instead of with
        elevated privileges. <code class="Nm">sudo</code> achieves this by
        creating user-writable temporary copies of the files to be edited and
        then overwriting the originals with the temporary copies after editing
        is complete. If the plugin supports <i class="Em">sudoedit</i>, it must
        set
        <a class="permalink" href="#sudoedit=true"><i class="Em" id="sudoedit=true">sudoedit=true</i></a>
        in the <var class="Fa">command_info</var> list. The plugin is
        responsible for choosing the editor to be used, potentially from a
        variable in the user's environment, such as
        <code class="Ev">EDITOR</code>, and should be stored in
        <var class="Fa">argv_out</var> (environment variables may include
        command line options). The files to be edited should be copied from
        <var class="Fa">argv</var> to <var class="Fa">argv_out</var>, separated
        from the editor and its arguments by a
        &#x2018;<code class="Li">--</code>&#x2019; element. The
        &#x2018;<code class="Li">--</code>&#x2019; will be removed by
        <code class="Nm">sudo</code> before the editor is executed. The plugin
        may also set <i class="Em">sudoedit_nfiles</i> to the number of files to
        be edited in the <var class="Fa">command_info</var> list; this will only
        be used by the <code class="Nm">sudo</code> front-end starting with API
        version 1.21.</p>
    <p class="Pp" id="check_policy~3">The
        <a class="permalink" href="#check_policy~3"><code class="Fn">check_policy</code></a>()
        function returns 1 if the command is allowed, 0 if not allowed, -1 for a
        general error, or -2 for a usage error or if <i class="Em">sudoedit</i>
        was specified but is unsupported by the plugin. In the latter case,
        <code class="Nm">sudo</code> will print a usage message before it exits.
        If an error occurs, the plugin may optionally call the
        <code class="Fn">conversation</code>() or
        <code class="Fn">sudo_plugin_printf</code>() function with
        <code class="Dv">SUDO_CONF_ERROR_MSG</code> to present additional error
        information to the user.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">argc</var></dt>
      <dd>The number of elements in <var class="Fa">argv</var>, not counting the
          final <code class="Dv">NULL</code> pointer.</dd>
      <dt><var class="Fa">argv</var></dt>
      <dd>The argument vector describing the command the user wishes to run, in
          the same form as what would be passed to the
          <a class="Xr" aria-label="execve, section 2">execve(2)</a> system
          call. The vector is terminated by a <code class="Dv">NULL</code>
          pointer.</dd>
      <dt><var class="Fa">env_add</var></dt>
      <dd>Additional environment variables specified by the user on the command
          line in the form of a <code class="Dv">NULL</code>-terminated vector
          of &#x201C;name=value&#x201D; strings. The plugin may reject the
          command if one or more variables are not allowed to be set, or it may
          silently ignore such variables.
        <p class="Pp">When parsing <var class="Fa">env_add</var>, the plugin
            should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
      </dd>
      <dt><var class="Fa">command_info</var></dt>
      <dd>Information about the command being run in the form of
          &#x201C;name=value&#x201D; strings. These values are used by
          <code class="Nm">sudo</code> to set the execution environment when
          running a command. The plugin is responsible for creating and
          populating the vector, which must be terminated with a
          <code class="Dv">NULL</code> pointer. The following values are
          recognized by <code class="Nm">sudo</code>:
        <dl class="Bl-tag">
          <dt>apparmor_profile=string</dt>
          <dd>AppArmor profile to transition to when executing the command. Only
              available starting with API version 1.19.</dd>
          <dt>chroot=string</dt>
          <dd>The root directory to use when running the command.</dd>
          <dt>closefrom=number</dt>
          <dd>If specified, <code class="Nm">sudo</code> will close all files
              descriptors with a value of <i class="Em">number</i> or
            higher.</dd>
          <dt>command=string</dt>
          <dd>Fully qualified path to the command to be executed.</dd>
          <dt>cwd=string</dt>
          <dd>The current working directory to change to when executing the
              command. If <code class="Nm">sudo</code> is unable to change to
              the new working directory, the command will not be run unless
              <i class="Em">cwd_optional</i> is also set (see below).</dd>
          <dt id="cwd">cwd_optional=bool</dt>
          <dd>If set, <code class="Nm">sudo</code> will treat an inability to
              change to the new working directory as a non-fatal error. This
              setting has no effect unless
              <a class="permalink" href="#cwd"><i class="Em">cwd</i></a> is also
              set.</dd>
          <dt>exec_background=bool</dt>
          <dd>By default, <code class="Nm">sudo</code> runs a command as the
              foreground process as long as <code class="Nm">sudo</code> itself
              is running in the foreground. When
              <i class="Em">exec_background</i> is enabled and the command is
              being run in a pseudo-terminal (due to I/O logging or the
              <i class="Em">use_pty</i> setting), the command will be run as a
              background process. Attempts to read from the controlling terminal
              (or to change terminal settings) will result in the command being
              suspended with the <code class="Dv">SIGTTIN</code> signal (or
              <code class="Dv">SIGTTOU</code> in the case of terminal settings).
              If this happens when <code class="Nm">sudo</code> is a foreground
              process, the command will be granted the controlling terminal and
              resumed in the foreground with no user intervention required. The
              advantage of initially running the command in the background is
              that <code class="Nm">sudo</code> need not read from the terminal
              unless the command explicitly requests it. Otherwise, any terminal
              input must be passed to the command, whether it has required it or
              not (the kernel buffers terminals so it is not possible to tell
              whether the command really wants the input). This is different
              from historic <code class="Nm">sudo</code> behavior or when the
              command is not being run in a pseudo-terminal.
            <p class="Pp" id="tcgetattr">For this to work seamlessly, the
                operating system must support the automatic restarting of system
                calls. Unfortunately, not all operating systems do this by
                default, and even those that do may have bugs. For example,
                macOS fails to restart the
                <a class="permalink" href="#tcgetattr"><code class="Fn">tcgetattr</code></a>()
                and
                <a class="permalink" href="#tcsetattr"><code class="Fn" id="tcsetattr">tcsetattr</code></a>()
                system calls (this is a bug in macOS). Furthermore, because this
                behavior depends on the command stopping with the
                <code class="Dv">SIGTTIN</code> or
                <code class="Dv">SIGTTOU</code> signals, programs that catch
                these signals and suspend themselves with a different signal
                (usually <code class="Dv">SIGTOP</code>) will not be
                automatically foregrounded. Some versions of the linux
                <a class="Xr" aria-label="su, section 1">su(1)</a> command
                behave this way. Because of this, a plugin should not set
                <i class="Em">exec_background</i> unless it is explicitly
                enabled by the administrator and there should be a way to
                enabled or disable it on a per-command basis.</p>
            <p class="Pp">This setting has no effect unless I/O logging is
                enabled or <i class="Em">use_pty</i> is enabled.</p>
          </dd>
          <dt>execfd=number</dt>
          <dd>If specified, <code class="Nm">sudo</code> will use the
              <a class="Xr" aria-label="fexecve, section 2">fexecve(2)</a>
              system call to execute the command instead of
              <a class="Xr" aria-label="execve, section 2">execve(2)</a>. The
              specified <i class="Em">number</i> must refer to an open file
              descriptor.</dd>
          <dt id="check_policy~4">intercept=bool</dt>
          <dd>If set, <code class="Nm">sudo</code> will intercept attempts to
              execute a subsequent command and perform a policy check via the
              policy plugin's
              <a class="permalink" href="#check_policy~4"><code class="Fn">check_policy</code></a>()
              function to determine whether or not the command is permitted.
              This can be used to prevent shell escapes on supported platforms
              but it has a number of limitations. See <b class="Sy">Preventing
              shell escapes</b> in <a class="Xr" aria-label="sudoers, section
              5">sudoers(5)</a> for details. Only available starting with API
              version 1.18.</dd>
          <dt>intercept_verify=bool</dt>
          <dd>If set, <code class="Nm">sudo</code> will attempt to verify that a
              command run in intercept mode has the expected path name, command
              line arguments and environment. This setting has no effect unless
              <i class="Em">use_ptrace</i> is also enabled. Only available
              starting with API version 1.20.</dd>
          <dt>iolog_compress=bool</dt>
          <dd>Set to true if the I/O logging plugins, if any, should compress
              the log data. This is a hint to the I/O logging plugin which may
              choose to ignore it.</dd>
          <dt>iolog_group=string</dt>
          <dd>The group that will own newly created I/O log files and
              directories. This is a hint to the I/O logging plugin which may
              choose to ignore it.</dd>
          <dt>iolog_mode=octal</dt>
          <dd>The file permission mode to use when creating I/O log files and
              directories. This is a hint to the I/O logging plugin which may
              choose to ignore it.</dd>
          <dt>iolog_user=string</dt>
          <dd>The user that will own newly created I/O log files and
              directories. This is a hint to the I/O logging plugin which may
              choose to ignore it.</dd>
          <dt>iolog_path=string</dt>
          <dd>Fully qualified path to the file or directory in which I/O log is
              to be stored. This is a hint to the I/O logging plugin which may
              choose to ignore it. If no I/O logging plugin is loaded, this
              setting has no effect.</dd>
          <dt>iolog_stdin=bool</dt>
          <dd>Set to true if the I/O logging plugins, if any, should log the
              standard input if it is not connected to a terminal device. This
              is a hint to the I/O logging plugin which may choose to ignore
            it.</dd>
          <dt>iolog_stdout=bool</dt>
          <dd>Set to true if the I/O logging plugins, if any, should log the
              standard output if it is not connected to a terminal device. This
              is a hint to the I/O logging plugin which may choose to ignore
            it.</dd>
          <dt>iolog_stderr=bool</dt>
          <dd>Set to true if the I/O logging plugins, if any, should log the
              standard error if it is not connected to a terminal device. This
              is a hint to the I/O logging plugin which may choose to ignore
            it.</dd>
          <dt>iolog_ttyin=bool</dt>
          <dd>Set to true if the I/O logging plugins, if any, should log all
              terminal input. This only includes input typed by the user and not
              from a pipe or redirected from a file. This is a hint to the I/O
              logging plugin which may choose to ignore it.</dd>
          <dt>iolog_ttyout=bool</dt>
          <dd>Set to true if the I/O logging plugins, if any, should log all
              terminal output. This only includes output to the screen, not
              output to a pipe or file. This is a hint to the I/O logging plugin
              which may choose to ignore it.</dd>
          <dt>login_class=string</dt>
          <dd><span class="Ux">BSD</span> login class to use when setting
              resource limits and nice value (optional). This option is only set
              on systems that support login classes.</dd>
          <dt id="login_class">nice=int</dt>
          <dd>Nice value (priority) to use when executing the command. The nice
              value, if specified, overrides the priority associated with the
              <a class="permalink" href="#login_class"><i class="Em">login_class</i></a>
              on <span class="Ux">BSD</span> systems.</dd>
          <dt>log_subcmds=bool</dt>
          <dd>If set, <code class="Nm">sudo</code> will call the audit plugin's
              <code class="Fn">accept</code>() function to log when the command
              runs a subsequent command, if supported by the system. If
              <i class="Em">intercept</i> is also specified,
              <i class="Em">log_subcmds</i> will be ignored. See
              <b class="Sy">Preventing shell escapes</b> in
              <a class="Xr" aria-label="sudoers, section 5">sudoers(5)</a> for
              more information. Only available starting with API version
            1.18.</dd>
          <dt>noexec=bool</dt>
          <dd>If set, prevent the command from executing other programs.</dd>
          <dt id="closefrom">preserve_fds=list</dt>
          <dd>A comma-separated list of file descriptors that should be
              preserved, regardless of the value of the
              <a class="permalink" href="#closefrom"><i class="Em">closefrom</i></a>
              setting. Only available starting with API version 1.5.</dd>
          <dt>preserve_groups=bool</dt>
          <dd>If set, <code class="Nm">sudo</code> will preserve the user's
              group vector instead of initializing the group vector based on
              <i class="Em">runas_user</i>.</dd>
          <dt>rlimit_as=soft,hard</dt>
          <dd>The maximum size to which the process's address space may grow (in
              bytes), if supported by the operating system. The soft and hard
              limits are separated by a comma. If only a single value is
              specified, both the hard and soft limits are set. A value of
              &#x201C;infinity&#x201D; indicates that there is no limit. A value
              of &#x201C;user&#x201D; will cause the invoking user's resource
              limit to be preserved. A value of &#x201C;default&#x201D; will
              cause the target user's default resource limit to be used on
              systems that allow per-user resource limits to be configured. Only
              available starting with API version 1.18.</dd>
          <dt>rlimit_core=soft,hard</dt>
          <dd>The largest size core dump file that may be created (in bytes).
              The soft and hard limits are separated by a comma. If only a
              single value is specified, both the hard and soft limits are set.
              A value of &#x201C;infinity&#x201D; indicates that there is no
              limit. A value of &#x201C;user&#x201D; will cause the invoking
              user's resource limit to be preserved. A value of
              &#x201C;default&#x201D; will cause the target user's default
              resource limit to be used on systems that allow per-user resource
              limits to be configured. Only available starting with API version
              1.18.</dd>
          <dt>rlimit_cpu=soft,hard</dt>
          <dd>The maximum amount of CPU time that the process may use (in
              seconds). The soft and hard limits are separated by a comma. If
              only a single value is specified, both the hard and soft limits
              are set. A value of &#x201C;infinity&#x201D; indicates that there
              is no limit. A value of &#x201C;user&#x201D; will cause the
              invoking user's resource limit to be preserved. A value of
              &#x201C;default&#x201D; will cause the target user's default
              resource limit to be used on systems that allow per-user resource
              limits to be configured. Only available starting with API version
              1.18.</dd>
          <dt>rlimit_data=soft,hard</dt>
          <dd>The maximum size of the data segment for the process (in bytes).
              The soft and hard limits are separated by a comma. If only a
              single value is specified, both the hard and soft limits are set.
              A value of &#x201C;infinity&#x201D; indicates that there is no
              limit. A value of &#x201C;user&#x201D; will cause the invoking
              user's resource limit to be preserved. A value of
              &#x201C;default&#x201D; will cause the target user's default
              resource limit to be used on systems that allow per-user resource
              limits to be configured. Only available starting with API version
              1.18.</dd>
          <dt>rlimit_fsize=soft,hard</dt>
          <dd>The largest size file that the process may create (in bytes). The
              soft and hard limits are separated by a comma. If only a single
              value is specified, both the hard and soft limits are set. A value
              of &#x201C;infinity&#x201D; indicates that there is no limit. A
              value of &#x201C;user&#x201D; will cause the invoking user's
              resource limit to be preserved. A value of &#x201C;default&#x201D;
              will cause the target user's default resource limit to be used on
              systems that allow per-user resource limits to be configured. Only
              available starting with API version 1.18.</dd>
          <dt>rlimit_locks=soft,hard</dt>
          <dd>The maximum number of locks that the process may establish, if
              supported by the operating system. The soft and hard limits are
              separated by a comma. If only a single value is specified, both
              the hard and soft limits are set. A value of
              &#x201C;infinity&#x201D; indicates that there is no limit. A value
              of &#x201C;user&#x201D; will cause the invoking user's resource
              limit to be preserved. A value of &#x201C;default&#x201D; will
              cause the target user's default resource limit to be used on
              systems that allow per-user resource limits to be configured. Only
              available starting with API version 1.18.</dd>
          <dt>rlimit_memlock=soft,hard</dt>
          <dd>The maximum size that the process may lock in memory (in bytes),
              if supported by the operating system. The soft and hard limits are
              separated by a comma. If only a single value is specified, both
              the hard and soft limits are set. A value of
              &#x201C;infinity&#x201D; indicates that there is no limit. A value
              of &#x201C;user&#x201D; will cause the invoking user's resource
              limit to be preserved. A value of &#x201C;default&#x201D; will
              cause the target user's default resource limit to be used on
              systems that allow per-user resource limits to be configured. Only
              available starting with API version 1.18.</dd>
          <dt>rlimit_nofile=soft,hard</dt>
          <dd>The maximum number of files that the process may have open. The
              soft and hard limits are separated by a comma. If only a single
              value is specified, both the hard and soft limits are set. A value
              of &#x201C;infinity&#x201D; indicates that there is no limit. A
              value of &#x201C;user&#x201D; will cause the invoking user's
              resource limit to be preserved. A value of &#x201C;default&#x201D;
              will cause the target user's default resource limit to be used on
              systems that allow per-user resource limits to be configured. Only
              available starting with API version 1.18.</dd>
          <dt>rlimit_nproc=soft,hard</dt>
          <dd>The maximum number of processes that the user may run
              simultaneously. The soft and hard limits are separated by a comma.
              If only a single value is specified, both the hard and soft limits
              are set. A value of &#x201C;infinity&#x201D; indicates that there
              is no limit. A value of &#x201C;user&#x201D; will cause the
              invoking user's resource limit to be preserved. A value of
              &#x201C;default&#x201D; will cause the target user's default
              resource limit to be used on systems that allow per-user resource
              limits to be configured. Only available starting with API version
              1.18.</dd>
          <dt>rlimit_rss=soft,hard</dt>
          <dd>The maximum size to which the process's resident set size may grow
              (in bytes). The soft and hard limits are separated by a comma. If
              only a single value is specified, both the hard and soft limits
              are set. A value of &#x201C;infinity&#x201D; indicates that there
              is no limit. A value of &#x201C;user&#x201D; will cause the
              invoking user's resource limit to be preserved. A value of
              &#x201C;default&#x201D; will cause the target user's default
              resource limit to be used on systems that allow per-user resource
              limits to be configured. Only available starting with API version
              1.18.</dd>
          <dt>rlimit_stack=soft,hard</dt>
          <dd>The maximum size to which the process's stack may grow (in bytes).
              The soft and hard limits are separated by a comma. If only a
              single value is specified, both the hard and soft limits are set.
              A value of &#x201C;infinity&#x201D; indicates that there is no
              limit. A value of &#x201C;user&#x201D; will cause the invoking
              user's resource limit to be preserved. A value of
              &#x201C;default&#x201D; will cause the target user's default
              resource limit to be used on systems that allow per-user resource
              limits to be configured. Only available starting with API version
              1.18.</dd>
          <dt>runas_egid=gid</dt>
          <dd>Effective group-ID to run the command as. If not specified, the
              value of <i class="Em">runas_gid</i> is used.</dd>
          <dt>runas_euid=uid</dt>
          <dd>Effective user-ID to run the command as. If not specified, the
              value of <i class="Em">runas_uid</i> is used.</dd>
          <dt>runas_gid=gid</dt>
          <dd>Group-ID to run the command as.</dd>
          <dt id="runas_egid">runas_group=string</dt>
          <dd>The name of the group the command will run as, if it is different
              from the <i class="Em">runas_user</i>'s default group. This value
              is provided for auditing purposes only, the
              <code class="Nm">sudo</code> front-end uses
              <a class="permalink" href="#runas_egid"><i class="Em">runas_egid</i></a>
              and <i class="Em">runas_gid</i> when executing the command.</dd>
          <dt id="preserve_groups">runas_groups=list</dt>
          <dd>The supplementary group vector to use for the command in the form
              of a comma-separated list of group-IDs. If
              <a class="permalink" href="#preserve_groups"><i class="Em">preserve_groups</i></a>
              is set, this option is ignored.</dd>
          <dt>runas_uid=uid</dt>
          <dd>User-ID to run the command as.</dd>
          <dt>runas_user=string</dt>
          <dd>The name of the user the command will run as, which should
              correspond to <i class="Em">runas_euid</i> (or
              <i class="Em">runas_uid</i> if <i class="Em">runas_euid</i> is not
              set). This value is provided for auditing purposes only, the
              <code class="Nm">sudo</code> front-end uses
              <i class="Em">runas_euid</i> and <i class="Em">runas_uid</i> when
              executing the command.</dd>
          <dt>selinux_role=string</dt>
          <dd>SELinux role to use when executing the command.</dd>
          <dt>selinux_type=string</dt>
          <dd>SELinux type to use when executing the command.</dd>
          <dt>set_utmp=bool</dt>
          <dd>Create a utmp (or utmpx) entry when a pseudo-terminal is
              allocated. By default, the new entry will be a copy of the user's
              existing utmp entry (if any), with the tty, time, type, and pid
              fields updated.</dd>
          <dt>sudoedit=bool</dt>
          <dd>Set to true when in <i class="Em">sudoedit</i> mode. The plugin
              may enable <i class="Em">sudoedit</i> mode even if
              <code class="Nm">sudo</code> was not invoked as
              <code class="Nm">sudoedit</code>. This allows the plugin to
              perform command substitution and transparently enable
              <i class="Em">sudoedit</i> when the user attempts to run an
              editor.</dd>
          <dt>sudoedit_checkdir=bool</dt>
          <dd>Set to false to disable directory writability checks in
              <code class="Nm">sudoedit</code>. By default,
              <code class="Nm">sudoedit</code> 1.8.16 and higher will check all
              directory components of the path to be edited for writability by
              the invoking user. Symbolic links will not be followed in writable
              directories and <code class="Nm">sudoedit</code> will refuse to
              edit a file located in a writable directory. These restrictions
              are not enforced when <code class="Nm">sudoedit</code> is run by
              root. The <i class="Em">sudoedit_checkdir</i> option can be set to
              false to disable this check. Only available starting with API
              version 1.8.</dd>
          <dt>sudoedit_follow=bool</dt>
          <dd>Set to true to allow <code class="Nm">sudoedit</code> to edit
              files that are symbolic links. By default,
              <code class="Nm">sudoedit</code> 1.8.15 and higher will refuse to
              open a symbolic link. The <i class="Em">sudoedit_follow</i> option
              can be used to restore the older behavior and allow
              <code class="Nm">sudoedit</code> to open symbolic links. Only
              available starting with API version 1.8.</dd>
          <dt>sudoedit_nfiles=number</dt>
          <dd>The number of files to be edited by the user. If present, this is
              will be used by the <code class="Nm">sudo</code> front-end to
              determine which elements of the <var class="Fa">argv_out</var>
              vector are files to be edited. The
              &#x2018;<code class="Li">--</code>&#x2019; element must
              immediately precede the first file to be edited. If
              <i class="Em">sudoedit_nfiles</i> is not specified, the
              <code class="Nm">sudo</code> front-end will use the position of
              the &#x2018;<code class="Li">--</code>&#x2019; element to
              determine where the file list begins. Only available starting with
              API version 1.21.</dd>
          <dt>timeout=int</dt>
          <dd>Command timeout. If non-zero then when the timeout expires the
              command will be killed.</dd>
          <dt>umask=octal</dt>
          <dd>The file creation mask to use when executing the command. This
              value may be overridden by PAM or login.conf on some systems
              unless the <i class="Em">umask_override</i> option is also
            set.</dd>
          <dt>umask_override=bool</dt>
          <dd>Force the value specified by the <i class="Em">umask</i> option to
              override any umask set by PAM or login.conf.</dd>
          <dt>use_ptrace=bool</dt>
          <dd>If set, <code class="Nm">sudo</code> will use
              <a class="Xr" aria-label="ptrace, section 2">ptrace(2)</a> to
              implement intercept mode if supported by the system. This setting
              has no effect unless <i class="Em">intercept</i> is also set. Only
              available starting with API version 1.19.</dd>
          <dt>use_pty=bool</dt>
          <dd>Allocate a pseudo-terminal to run the command in, regardless of
              whether or not I/O logging is in use. By default,
              <code class="Nm">sudo</code> will only run the command in a
              pseudo-terminal when an I/O log plugin is loaded.</dd>
          <dt id="set_utmp">utmp_user=string</dt>
          <dd>User name to use when constructing a new utmp (or utmpx) entry
              when
              <a class="permalink" href="#set_utmp"><i class="Em">set_utmp</i></a>
              is enabled. This option can be used to set the user field in the
              utmp entry to the user the command runs as rather than the
              invoking user. If not set, <code class="Nm">sudo</code> will base
              the new entry on the invoking user's existing entry.</dd>
        </dl>
        <p class="Pp">Unsupported values will be ignored.</p>
      </dd>
      <dt><var class="Fa">argv_out</var></dt>
      <dd>The <code class="Dv">NULL</code>-terminated argument vector to pass to
          the <a class="Xr" aria-label="execve, section 2">execve(2)</a> system
          call when executing the command. The plugin is responsible for
          allocating and populating the vector.</dd>
      <dt><var class="Fa">user_env_out</var></dt>
      <dd>The <code class="Dv">NULL</code>-terminated environment vector to use
          when executing the command. The plugin is responsible for allocating
          and populating the vector.</dd>
      <dt id="check_policy~5"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#check_policy~5"><code class="Fn">check_policy</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.
        <p class="Pp">The <var class="Fa">errstr</var> parameter is only
            available starting with API version 1.15. A plugin
            <b class="Sy">must</b> check the API version specified by the
            <code class="Nm">sudo</code> front-end before using
            <var class="Fa">errstr</var>. Failure to do so may result in a
            crash.</p>
      </dd>
    </dl>
  </dd>
  <dt><var class="Fa">list</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*list)(int argc, char * const argv[], int verbose,
    const char *user, const char **errstr);</pre>
    </div>
    <p class="Pp" id="conversation~4">List available privileges for the invoking
        user. Returns 1 on success, 0 on failure, and -1 on error. On error, the
        plugin may optionally call the
        <a class="permalink" href="#conversation~4"><code class="Fn">conversation</code></a>()
        or
        <a class="permalink" href="#sudo_plugin_printf~3"><code class="Fn" id="sudo_plugin_printf~3">sudo_plugin_printf</code></a>()
        function with <code class="Dv">SUDO_CONF_ERROR_MSG</code> to present
        additional error information to the user.</p>
    <p class="Pp" id="conversation~5">Privileges should be output via the
        <a class="permalink" href="#conversation~5"><code class="Fn">conversation</code></a>()
        or
        <a class="permalink" href="#sudo_plugin_printf~4"><code class="Fn" id="sudo_plugin_printf~4">sudo_plugin_printf</code></a>()
        function using <code class="Dv">SUDO_CONV_INFO_MSG</code>.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">argc</var></dt>
      <dd>The number of elements in <var class="Fa">argv</var>, not counting the
          final <code class="Dv">NULL</code> pointer.</dd>
      <dt><var class="Fa">argv</var></dt>
      <dd>If <span class="No">non-</span><code class="Dv">NULL</code>, an
          argument vector describing a command the user wishes to check against
          the policy in the same form as what would be passed to the
          <a class="Xr" aria-label="execve, section 2">execve(2)</a> system
          call. If the command is permitted by the policy, the fully-qualified
          path to the command should be displayed along with any command line
          arguments.</dd>
      <dt><var class="Fa">verbose</var></dt>
      <dd>Flag indicating whether to list in verbose mode or not.</dd>
      <dt><var class="Fa">user</var></dt>
      <dd>The name of a different user to list privileges for if the policy
          allows it. If <code class="Dv">NULL</code>, the plugin should list the
          privileges of the invoking user.</dd>
      <dt id="list"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#list"><code class="Fn">list</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.
        <p class="Pp">The <var class="Fa">errstr</var> parameter is only
            available starting with API version 1.15. A plugin
            <b class="Sy">must</b> check the API version specified by the
            <code class="Nm">sudo</code> front-end before using
            <var class="Fa">errstr</var>. Failure to do so may result in a
            crash.</p>
      </dd>
    </dl>
  </dd>
  <dt><var class="Fa">validate</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*validate)(const char **errstr);</pre>
    </div>
    <p class="Pp" id="validate">The
        <a class="permalink" href="#validate"><code class="Fn">validate</code></a>()
        function is called when <code class="Nm">sudo</code> is run with the
        <code class="Fl">-v</code> option. For policy plugins such as
        <code class="Nm">sudoers</code> that cache authentication credentials,
        this function will validate and cache the credentials.</p>
    <p class="Pp" id="validate~2">The
        <a class="permalink" href="#validate~2"><code class="Fn">validate</code></a>()
        function should be <code class="Dv">NULL</code> if the plugin does not
        support credential caching.</p>
    <p class="Pp" id="conversation~6">Returns 1 on success, 0 on failure, and -1
        on error. On error, the plugin may optionally call the
        <a class="permalink" href="#conversation~6"><code class="Fn">conversation</code></a>()
        or
        <a class="permalink" href="#sudo_plugin_printf~5"><code class="Fn" id="sudo_plugin_printf~5">sudo_plugin_printf</code></a>()
        function with <code class="Dv">SUDO_CONF_ERROR_MSG</code> to present
        additional error information to the user.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt id="errstr"><var class="Va">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#validate~3"><code class="Fn" id="validate~3">validate</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.
        <p class="Pp">The <var class="Fa">errstr</var> parameter is only
            available starting with API version 1.15. A plugin
            <b class="Sy">must</b> check the API version specified by the
            <code class="Nm">sudo</code> front-end before using
            <var class="Fa">errstr</var>. Failure to do so may result in a
            crash.</p>
      </dd>
    </dl>
  </dd>
  <dt><var class="Fa">invalidate</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>void (*invalidate)(int rmcred);</pre>
    </div>
    <p class="Pp" id="invalidate">The
        <a class="permalink" href="#invalidate"><code class="Fn">invalidate</code></a>()
        function is called when <code class="Nm">sudo</code> is run with the
        <code class="Fl">-k</code> or <code class="Fl">-K</code> option. For
        policy plugins such as <code class="Nm">sudoers</code> that cache
        authentication credentials, this function will invalidate the
        credentials. If the <var class="Fa">rmcred</var> flag is non-zero, the
        plugin may remove the credentials instead of simply invalidating
      them.</p>
    <p class="Pp" id="invalidate~2">The
        <a class="permalink" href="#invalidate~2"><code class="Fn">invalidate</code></a>()
        function should be <code class="Dv">NULL</code> if the plugin does not
        support credential caching.</p>
  </dd>
  <dt><var class="Fa">init_session</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*init_session)(struct passwd *pwd, char **user_env[],
    const char **errstr);</pre>
    </div>
    <p class="Pp" id="init_session">The
        <a class="permalink" href="#init_session"><code class="Fn">init_session</code></a>()
        function is called before <code class="Nm">sudo</code> sets up the
        execution environment for the command. It is run in the parent
        <code class="Nm">sudo</code> process before any user-ID or group-ID
        changes. This can be used to perform session setup that is not supported
        by <var class="Fa">command_info</var>, such as opening the PAM session.
        The <code class="Fn">close</code>() function can be used to tear down
        the session that was opened by
      <code class="Fn">init_session</code>().</p>
    <p class="Pp" id="conversation~7">Returns 1 on success, 0 on failure, and -1
        on error. On error, the plugin may optionally call the
        <a class="permalink" href="#conversation~7"><code class="Fn">conversation</code></a>()
        or
        <a class="permalink" href="#sudo_plugin_printf~6"><code class="Fn" id="sudo_plugin_printf~6">sudo_plugin_printf</code></a>()
        function with <code class="Dv">SUDO_CONF_ERROR_MSG</code> to present
        additional error information to the user.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">pwd</var></dt>
      <dd>If the user-ID the command will run as was found in the password
          database, <var class="Fa">pwd</var> will describe that user, otherwise
          it will be <code class="Dv">NULL</code>.</dd>
      <dt id="init_session~2"><var class="Fa">user_env_out</var></dt>
      <dd>The <code class="Dv">NULL</code>-terminated environment vector to use
          when executing the command. This is the same string passed back to the
          front-end via the Policy Plugin's <var class="Fa">user_env_out</var>
          parameter. If the
          <a class="permalink" href="#init_session~2"><code class="Fn">init_session</code></a>()
          function needs to modify the user environment, it should update the
          pointer stored in <var class="Fa">user_env_out</var>. The expected use
          case is to merge the contents of the PAM environment (if any) with the
          contents of <var class="Fa">user_env_out</var>. The
          <var class="Fa">user_env_out</var> parameter is only available
          starting with API version 1.2. A plugin <b class="Sy">must</b> check
          the API version specified by the <code class="Nm">sudo</code>
          front-end before using <var class="Fa">user_env_out</var>. Failure to
          do so may result in a crash.</dd>
      <dt><var class="Fa">errstr</var></dt>
      <dd>If the <code class="Fn">init_session</code>() function returns a value
          other than 1, the plugin may store a message describing the failure or
          error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.
        <p class="Pp">The <var class="Fa">errstr</var> parameter is only
            available starting with API version 1.15. A plugin
            <b class="Sy">must</b> check the API version specified by the
            <code class="Nm">sudo</code> front-end before using
            <var class="Fa">errstr</var>. Failure to do so may result in a
            crash.</p>
      </dd>
    </dl>
  </dd>
  <dt><var class="Fa">register_hooks</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>void (*register_hooks)(int version,
   int (*register_hook)(struct sudo_hook *hook));</pre>
    </div>
    <p class="Pp" id="register_hooks">The
        <a class="permalink" href="#register_hooks"><code class="Fn">register_hooks</code></a>()
        function is called by the sudo front-end to register any hooks the
        plugin needs. If the plugin does not support hooks,
        <var class="Fa">register_hooks</var> should be set to the
        <code class="Dv">NULL</code> pointer.</p>
    <p class="Pp">The <var class="Fa">version</var> argument describes the
        version of the hooks API supported by the <code class="Nm">sudo</code>
        front-end.</p>
    <p class="Pp" id="register_hook">The
        <a class="permalink" href="#register_hook"><code class="Fn">register_hook</code></a>()
        function should be used to register any supported hooks the plugin
        needs. It returns 0 on success, 1 if the hook type is not supported, and
        -1 if the major version in <var class="Vt">struct sudo_hook</var> does
        not match the front-end's major hook API version.</p>
    <p class="Pp">See the <a class="Sx" href="#Hook_function_API">Hook function
        API</a> section below for more information about hooks.</p>
    <p class="Pp" id="register_hooks~2">The
        <a class="permalink" href="#register_hooks~2"><code class="Fn">register_hooks</code></a>()
        function is only available starting with API version 1.2. If the
        <code class="Nm">sudo</code> front-end doesn't support API version 1.2
        or higher, <code class="Fn">register_hooks</code>() will not be
      called.</p>
  </dd>
  <dt><var class="Fa">deregister_hooks</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>void (*deregister_hooks)(int version,
   int (*deregister_hook)(struct sudo_hook *hook));</pre>
    </div>
    <p class="Pp" id="deregister_hooks">The
        <a class="permalink" href="#deregister_hooks"><code class="Fn">deregister_hooks</code></a>()
        function is called by the sudo front-end to deregister any hooks the
        plugin has registered. If the plugin does not support hooks,
        <var class="Fa">deregister_hooks</var> should be set to the
        <code class="Dv">NULL</code> pointer.</p>
    <p class="Pp">The <var class="Fa">version</var> argument describes the
        version of the hooks API supported by the <code class="Nm">sudo</code>
        front-end.</p>
    <p class="Pp" id="deregister_hook">The
        <a class="permalink" href="#deregister_hook"><code class="Fn">deregister_hook</code></a>()
        function should be used to deregister any hooks that were put in place
        by the <code class="Fn">register_hook</code>() function. If the plugin
        tries to deregister a hook that the front-end does not support,
        <code class="Fn">deregister_hook</code>() will return an error.</p>
    <p class="Pp">See the <a class="Sx" href="#Hook_function_API">Hook function
        API</a> section below for more information about hooks.</p>
    <p class="Pp" id="deregister_hooks~2">The
        <a class="permalink" href="#deregister_hooks~2"><code class="Fn">deregister_hooks</code></a>()
        function is only available starting with API version 1.2. If the
        <code class="Nm">sudo</code> front-end doesn't support API version 1.2
        or higher, <code class="Fn">deregister_hooks</code>() will not be
        called.</p>
  </dd>
  <dt><var class="Fa">event_alloc</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>struct sudo_plugin_event * (*event_alloc)(void);</pre>
    </div>
    <p class="Pp" id="event_alloc">The
        <a class="permalink" href="#event_alloc"><code class="Fn">event_alloc</code></a>()
        function is used to allocate a <var class="Vt">struct
        sudo_plugin_event</var> which provides access to the main
        <code class="Nm">sudo</code> event loop. Unlike the other fields, the
        <var class="Fa">event_alloc</var> pointer is filled in by the
        <code class="Nm">sudo</code> front-end, not by the plugin.</p>
    <p class="Pp">See the <a class="Sx" href="#Event_API">Event API</a> section
        below for more information about events.</p>
    <p class="Pp" id="event_alloc~2">The
        <a class="permalink" href="#event_alloc~2"><code class="Fn">event_alloc</code></a>()
        function is only available starting with API version 1.15. If the
        <code class="Nm">sudo</code> front-end doesn't support API version 1.15
        or higher, <var class="Fa">event_alloc</var> will not be set.</p>
  </dd>
</dl>
<p class="Pp" id="Policy"><a class="permalink" href="#Policy"><i class="Em">Policy
    Plugin Version Macros</i></a></p>
<div class="Bd Pp Li">
<pre>/* Plugin API version major/minor. */
&#35;define SUDO_API_VERSION_MAJOR 1
&#35;define SUDO_API_VERSION_MINOR 13
&#35;define SUDO_API_MKVERSION(x, y) ((x &lt;&lt; 16) | y)
&#35;define SUDO_API_VERSION SUDO_API_MKVERSION(SUDO_API_VERSION_MAJOR,\
                                            SUDO_API_VERSION_MINOR)
<p>/* Getters and setters for API version */
#define SUDO_API_VERSION_GET_MAJOR(v) ((v) &gt;&gt; 16)
#define SUDO_API_VERSION_GET_MINOR(v) ((v) &amp; 0xffff)
#define SUDO_API_VERSION_SET_MAJOR(vp, n) do { <br>
<em>(vp) = (</em>(vp) &amp; 0x0000ffff) | ((n) &lt;&lt; 16); <br>
} while(0)
#define SUDO_API_VERSION_SET_MINOR(vp, n) do { <br>
<em>(vp) = (</em>(vp) &amp; 0xffff0000) | (n); <br>
} while(0)</pre></p>
</div>
</section>
<section class="Ss">
<h3 class="Ss" id="I/O_plugin_API"><a class="permalink" href="#I/O_plugin_API">I/O
  plugin API</a></h3>
<div class="Bd Li">
<pre>struct io_plugin {
&#35;define SUDO_IO_PLUGIN 2
    unsigned int type; /* always SUDO_IO_PLUGIN */
    unsigned int version; /* always SUDO_API_VERSION */
    int (*open)(unsigned int version, sudo_conv_t conversation,
        sudo_printf_t sudo_plugin_printf, char * const settings[],
        char * const user_info[], char * const command_info[],
        int argc, char * const argv[], char * const user_env[],
        char * const plugin_options[], const char **errstr);
    void (*close)(int exit_status, int error); /* wait status or error */
    int (*show_version)(int verbose);
    int (*log_ttyin)(const char *buf, unsigned int len,
        const char **errstr);
    int (*log_ttyout)(const char *buf, unsigned int len,
        const char **errstr);
    int (*log_stdin)(const char *buf, unsigned int len,
        const char **errstr);
    int (*log_stdout)(const char *buf, unsigned int len,
        const char **errstr);
    int (*log_stderr)(const char *buf, unsigned int len,
        const char **errstr);
    void (*register_hooks)(int version,
       int (*register_hook)(struct sudo_hook *hook));
    void (*deregister_hooks)(int version,
       int (*deregister_hook)(struct sudo_hook *hook));
    int (*change_winsize)(unsigned int lines, unsigned int cols,
        const char **errstr);
    int (*log_suspend)(int signo, const char **errstr);
    struct sudo_plugin_event * (*event_alloc)(void);
};</pre>
</div>
<p class="Pp">When an I/O plugin is loaded, <code class="Nm">sudo</code> runs
    the command in a pseudo-terminal. This makes it possible to log the input
    and output from the user's session. If any of the standard input, standard
    output, or standard error do not correspond to a tty,
    <code class="Nm">sudo</code> will open a pipe to capture the I/O for logging
    before passing it on.</p>
<p class="Pp" id="log_ttyin">The
    <a class="permalink" href="#log_ttyin"><code class="Fn">log_ttyin</code></a>()
    function receives the raw user input from the terminal device (this will
    include input even when echo is disabled, such as when a password is read).
    The <code class="Fn">log_ttyout</code>() function receives output from the
    pseudo-terminal that is suitable for replaying the user's session at a later
    time. The <code class="Fn">log_stdin</code>(),
    <code class="Fn">log_stdout</code>(), and
    <code class="Fn">log_stderr</code>() functions are only called if the
    standard input, standard output, or standard error respectively correspond
    to something other than a tty.</p>
<p class="Pp">Any of the logging functions may be set to the
    <code class="Dv">NULL</code> pointer if no logging is to be performed. If
    the open function returns 0, no I/O will be sent to the plugin.</p>
<p class="Pp">If a logging function returns an error (-1), the running command
    will be terminated and all of the plugin's logging functions will be
    disabled. Other I/O logging plugins will still receive any remaining input
    or output that has not yet been processed.</p>
<p class="Pp">If an input logging function rejects the data by returning 0, the
    command will be terminated and the data will not be passed to the command,
    though it will still be sent to any other I/O logging plugins. If an output
    logging function rejects the data by returning 0, the command will be
    terminated and the data will not be written to the terminal, though it will
    still be sent to any other I/O logging plugins.</p>
<p class="Pp">A <var class="Vt">struct audit_plugin</var> has the following
    fields:</p>
<dl class="Bl-tag">
  <dt><var class="Fa">type</var></dt>
  <dd>The <var class="Fa">type</var> field should always be set to
      <code class="Dv">SUDO_IO_PLUGIN</code>.</dd>
  <dt><var class="Fa">version</var></dt>
  <dd>The <var class="Fa">version</var> field should be set to
      <code class="Dv">SUDO_API_VERSION</code>.
    <p class="Pp">This allows <code class="Nm">sudo</code> to determine the API
        version the plugin was built against.</p>
  </dd>
  <dt><var class="Fa">open</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*open)(unsigned int version, sudo_conv_t conversation,
    sudo_printf_t sudo_plugin_printf, char * const settings[],
    char * const user_info[], char * const command_info[],
    int argc, char * const argv[], char * const user_env[],
    char * const plugin_options[]);</pre>
    </div>
    <p class="Pp" id="open~3">The
        <a class="permalink" href="#open~3"><code class="Fn">open</code></a>()
        function is run before the <code class="Fn">log_ttyin</code>(),
        <code class="Fn">log_ttyout</code>(),
        <code class="Fn">log_stdin</code>(),
        <code class="Fn">log_stdout</code>(),
        <code class="Fn">log_stderr</code>(),
        <code class="Fn">log_suspend</code>(),
        <code class="Fn">change_winsize</code>(), or
        <code class="Fn">show_version</code>() functions are called. It is only
        called if the version is being requested or if the policy plugin's
        <code class="Fn">check_policy</code>() function has returned
        successfully. It returns 1 on success, 0 on failure, -1 if a general
        error occurred, or -2 if there was a usage error. In the latter case,
        <code class="Nm">sudo</code> will print a usage message before it exits.
        If an error occurs, the plugin may optionally call the
        <code class="Fn">conversation</code>() or
        <code class="Fn">sudo_plugin_printf</code>() function with
        <code class="Dv">SUDO_CONF_ERROR_MSG</code> to present additional error
        information to the user.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">version</var></dt>
      <dd>The version passed in by <code class="Nm">sudo</code> allows the
          plugin to determine the major and minor version number of the plugin
          API supported by <code class="Nm">sudo</code>.</dd>
      <dt id="conversation~8"><var class="Fa">conversation</var></dt>
      <dd>A pointer to the
          <a class="permalink" href="#conversation~8"><code class="Fn">conversation</code></a>()
          function that may be used by the
          <a class="permalink" href="#Fa"><code class="Fn" id="Fa">Fa</code></a>(<var class="Fa">show_version</var>)
          function to display version information (see
          <code class="Fn">show_version</code>() below). The
          <code class="Fn">conversation</code>() function may also be used to
          display additional error message to the user. The
          <code class="Fn">conversation</code>() function returns 0 on success
          and -1 on failure.</dd>
      <dt><var class="Fa">sudo_plugin_printf</var></dt>
      <dd>A pointer to a <code class="Fn">printf</code>()-style function that
          may be used by the <code class="Fn">show_version</code>() function to
          display version information (see show_version below). The
          <code class="Fn">sudo_plugin_printf</code>() function may also be used
          to display additional error message to the user. The
          <code class="Fn">sudo_plugin_printf</code>() function returns number
          of characters printed on success and -1 on failure.</dd>
      <dt><var class="Fa">settings</var></dt>
      <dd>A vector of user-supplied <code class="Nm">sudo</code> settings in the
          form of &#x201C;name=value&#x201D; strings. The vector is terminated
          by a <code class="Dv">NULL</code> pointer. These settings correspond
          to options the user specified when running
          <code class="Nm">sudo</code>. As such, they will only be present when
          the corresponding option has been specified on the command line.
        <p class="Pp">When parsing <var class="Fa">settings</var>, the plugin
            should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
        <p class="Pp">See the <a class="Sx" href="#Policy_plugin_API">Policy
            plugin API</a> section for a list of all possible settings.</p>
      </dd>
      <dt><var class="Fa">user_info</var></dt>
      <dd>A vector of information about the user running the command in the form
          of &#x201C;name=value&#x201D; strings. The vector is terminated by a
          <code class="Dv">NULL</code> pointer.
        <p class="Pp">When parsing <var class="Fa">user_info</var>, the plugin
            should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
        <p class="Pp">See the <a class="Sx" href="#Policy_plugin_API">Policy
            plugin API</a> section for a list of all possible strings.</p>
      </dd>
      <dt><var class="Fa">command_info</var></dt>
      <dd>A vector of information describing the command being run in the form
          of &#x201C;name=value&#x201D; strings. The vector is terminated by a
          <code class="Dv">NULL</code> pointer.
        <p class="Pp">When parsing <var class="Fa">command_info</var>, the
            plugin should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
        <p class="Pp">See the <a class="Sx" href="#Policy_plugin_API">Policy
            plugin API</a> section for a list of all possible strings.</p>
      </dd>
      <dt><var class="Fa">argc</var></dt>
      <dd>The number of elements in <var class="Fa">argv</var>, not counting the
          final <code class="Dv">NULL</code> pointer. It can be zero, such as
          when <code class="Nm">sudo</code> is called with the
          <code class="Fl">-V</code> option.</dd>
      <dt><var class="Fa">argv</var></dt>
      <dd>If <span class="No">non-</span><code class="Dv">NULL</code>, an
          argument vector describing a command the user wishes to run in the
          same form as what would be passed to the
          <a class="Xr" aria-label="execve, section 2">execve(2)</a> system
          call.</dd>
      <dt><var class="Fa">user_env</var></dt>
      <dd>The user's environment in the form of a
          <code class="Dv">NULL</code>-terminated vector of
          &#x201C;name=value&#x201D; strings.
        <p class="Pp">When parsing <var class="Fa">user_env</var>, the plugin
            should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
      </dd>
      <dt><var class="Fa">plugin_options</var></dt>
      <dd>Any (non-comment) strings immediately after the plugin path are
          treated as arguments to the plugin. These arguments are split on a
          white space boundary and are passed to the plugin in the form of a
          <code class="Dv">NULL</code>-terminated array of strings. If no
          arguments were specified, <var class="Fa">plugin_options</var> will be
          the <code class="Dv">NULL</code> pointer.
        <p class="Pp">The <var class="Fa">plugin_options</var> parameter is only
            available starting with API version 1.2. A plugin
            <b class="Sy">must</b> check the API version specified by the
            <code class="Nm">sudo</code> front-end before using
            <var class="Fa">plugin_options</var>. Failure to do so may result in
            a crash.</p>
      </dd>
      <dt id="open~4"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#open~4"><code class="Fn">open</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.
        <p class="Pp">The <var class="Fa">errstr</var> parameter is only
            available starting with API version 1.15. A plugin
            <b class="Sy">must</b> check the API version specified by the
            <code class="Nm">sudo</code> front-end before using
            <var class="Fa">errstr</var>. Failure to do so may result in a
            crash.</p>
      </dd>
    </dl>
  </dd>
  <dt><var class="Fa">close</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>void (*close)(int exit_status, int error);</pre>
    </div>
    <p class="Pp" id="close~3">The
        <a class="permalink" href="#close~3"><code class="Fn">close</code></a>()
        function is called when <code class="Nm">sudo</code> is finished,
        shortly before it exits.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">exit_status</var></dt>
      <dd>The command's exit status, as returned by the
          <a class="Xr" aria-label="wait, section 2">wait(2)</a> system call, or
          zero if no command was run. The value of
          <var class="Fa">exit_status</var> is undefined if
          <var class="Fa">error</var> is non-zero.</dd>
      <dt><var class="Fa">error</var></dt>
      <dd>If the command could not be executed, this is set to the value of
          <var class="Va">errno</var> set by the
          <a class="Xr" aria-label="execve, section 2">execve(2)</a> system
          call. If the command was successfully executed, the value of
          <var class="Fa">error</var> is zero.</dd>
    </dl>
  </dd>
  <dt><var class="Fa">show_version</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*show_version)(int verbose);</pre>
    </div>
    <p class="Pp" id="show_version~2">The
        <a class="permalink" href="#show_version~2"><code class="Fn">show_version</code></a>()
        function is called by <code class="Nm">sudo</code> when the user
        specifies the <code class="Fl">-V</code> option. The plugin may display
        its version information to the user via the
        <code class="Fn">conversation</code>() or
        <code class="Fn">sudo_plugin_printf</code>() function using
        <code class="Dv">SUDO_CONV_INFO_MSG</code>. If the user requests
        detailed version information, the <var class="Fa">verbose</var> flag
        will be non-zero.</p>
    <p class="Pp">Returns 1 on success, 0 on failure, -1 if a general error
        occurred, or -2 if there was a usage error, although the return value is
        currently ignored.</p>
  </dd>
  <dt><var class="Fa">log_ttyin</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*log_ttyin)(const char *buf, unsigned int len,
    const char **errstr);</pre>
    </div>
    <p class="Pp" id="log_ttyin~2">The
        <a class="permalink" href="#log_ttyin~2"><code class="Fn">log_ttyin</code></a>()
        function is called whenever data can be read from the user but before it
        is passed to the running command. This allows the plugin to reject data
        if it chooses to (for instance if the input contains banned content).
        Returns 1 if the data should be passed to the command, 0 if the data is
        rejected (which will terminate the running command), or -1 if an error
        occurred.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">buf</var></dt>
      <dd>The buffer containing user input.</dd>
      <dt><var class="Fa">len</var></dt>
      <dd>The length of <var class="Fa">buf</var> in bytes.</dd>
      <dt id="log_ttyin~3"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#log_ttyin~3"><code class="Fn">log_ttyin</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.
        <p class="Pp">The <var class="Fa">errstr</var> parameter is only
            available starting with API version 1.15. A plugin
            <b class="Sy">must</b> check the API version specified by the
            <code class="Nm">sudo</code> front-end before using
            <var class="Fa">errstr</var>. Failure to do so may result in a
            crash.</p>
      </dd>
    </dl>
  </dd>
  <dt><var class="Fa">log_ttyout</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*log_ttyout)(const char *buf, unsigned int len,
    const char **errstr);</pre>
    </div>
    <p class="Pp" id="log_ttyout">The
        <a class="permalink" href="#log_ttyout"><code class="Fn">log_ttyout</code></a>()
        function is called whenever data can be read from the command but before
        it is written to the user's terminal. This allows the plugin to reject
        data if it chooses to (for instance if the output contains banned
        content). Returns 1 if the data should be passed to the user, 0 if the
        data is rejected (which will terminate the running command), or -1 if an
        error occurred.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">buf</var></dt>
      <dd>The buffer containing command output.</dd>
      <dt><var class="Fa">len</var></dt>
      <dd>The length of <var class="Fa">buf</var> in bytes.</dd>
      <dt id="log_ttyout~2"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#log_ttyout~2"><code class="Fn">log_ttyout</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.
        <p class="Pp">The <var class="Fa">errstr</var> parameter is only
            available starting with API version 1.15. A plugin
            <b class="Sy">must</b> check the API version specified by the
            <code class="Nm">sudo</code> front-end before using
            <var class="Fa">errstr</var>. Failure to do so may result in a
            crash.</p>
      </dd>
    </dl>
  </dd>
  <dt><var class="Fa">log_stdin</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*log_stdin)(const char *buf, unsigned int len,
    const char **errstr);</pre>
    </div>
    <p class="Pp" id="log_stdin">The
        <a class="permalink" href="#log_stdin"><code class="Fn">log_stdin</code></a>()
        function is only used if the standard input does not correspond to a tty
        device. It is called whenever data can be read from the standard input
        but before it is passed to the running command. This allows the plugin
        to reject data if it chooses to (for instance if the input contains
        banned content). Returns 1 if the data should be passed to the command,
        0 if the data is rejected (which will terminate the running command), or
        -1 if an error occurred.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">buf</var></dt>
      <dd>The buffer containing user input.</dd>
      <dt><var class="Fa">len</var></dt>
      <dd>The length of <var class="Fa">buf</var> in bytes.</dd>
      <dt id="log_stdin~2"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#log_stdin~2"><code class="Fn">log_stdin</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.
        <p class="Pp">The <var class="Fa">errstr</var> parameter is only
            available starting with API version 1.15. A plugin
            <b class="Sy">must</b> check the API version specified by the
            <code class="Nm">sudo</code> front-end before using
            <var class="Fa">errstr</var>. Failure to do so may result in a
            crash.</p>
      </dd>
    </dl>
  </dd>
  <dt><var class="Fa">log_stdout</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*log_stdout)(const char *buf, unsigned int len,
    const char **errstr);</pre>
    </div>
    <p class="Pp" id="log_stdout">The
        <a class="permalink" href="#log_stdout"><code class="Fn">log_stdout</code></a>()
        function is only used if the standard output does not correspond to a
        tty device. It is called whenever data can be read from the command but
        before it is written to the standard output. This allows the plugin to
        reject data if it chooses to (for instance if the output contains banned
        content). Returns 1 if the data should be passed to the user, 0 if the
        data is rejected (which will terminate the running command), or -1 if an
        error occurred.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">buf</var></dt>
      <dd>The buffer containing command output.</dd>
      <dt><var class="Fa">len</var></dt>
      <dd>The length of <var class="Fa">buf</var> in bytes.</dd>
      <dt id="log_stdout~2"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#log_stdout~2"><code class="Fn">log_stdout</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.
        <p class="Pp">The <var class="Fa">errstr</var> parameter is only
            available starting with API version 1.15. A plugin
            <b class="Sy">must</b> check the API version specified by the
            <code class="Nm">sudo</code> front-end before using
            <var class="Fa">errstr</var>. Failure to do so may result in a
            crash.</p>
      </dd>
    </dl>
  </dd>
  <dt><var class="Fa">log_stderr</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*log_stderr)(const char *buf, unsigned int len,
    const char **errstr);</pre>
    </div>
    <p class="Pp" id="log_stderr">The
        <a class="permalink" href="#log_stderr"><code class="Fn">log_stderr</code></a>()
        function is only used if the standard error does not correspond to a tty
        device. It is called whenever data can be read from the command but
        before it is written to the standard error. This allows the plugin to
        reject data if it chooses to (for instance if the output contains banned
        content). Returns 1 if the data should be passed to the user, 0 if the
        data is rejected (which will terminate the running command), or -1 if an
        error occurred.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">buf</var></dt>
      <dd>The buffer containing command output.</dd>
      <dt><var class="Fa">len</var></dt>
      <dd>The length of <var class="Fa">buf</var> in bytes.</dd>
      <dt id="log_stderr~2"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#log_stderr~2"><code class="Fn">log_stderr</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.
        <p class="Pp">The <var class="Fa">errstr</var> parameter is only
            available starting with API version 1.15. A plugin
            <b class="Sy">must</b> check the API version specified by the
            <code class="Nm">sudo</code> front-end before using
            <var class="Fa">errstr</var>. Failure to do so may result in a
            crash.</p>
      </dd>
    </dl>
  </dd>
  <dt id="register_hooks~3"><var class="Fa">register_hooks</var></dt>
  <dd>See the <a class="Sx" href="#Policy_plugin_API">Policy plugin API</a>
      section for a description of
      <a class="permalink" href="#register_hooks~3"><code class="Fn">register_hooks</code></a>().</dd>
  <dt><var class="Fa">deregister_hooks</var></dt>
  <dd>See the <a class="Sx" href="#Policy_plugin_API">Policy plugin API</a>
      section for a description of
    <code class="Fn">deregister_hooks</code>().</dd>
  <dt><var class="Fa">change_winsize</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*change_winsize)(unsigned int lines, unsigned int cols,
    const char **errstr);</pre>
    </div>
    <p class="Pp" id="change_winsize">The
        <a class="permalink" href="#change_winsize"><code class="Fn">change_winsize</code></a>()
        function is called whenever the window size of the terminal changes from
        the initial values specified in the <var class="Fa">user_info</var>
        list. Returns -1 if an error occurred, in which case no further calls to
        <code class="Fn">change_winsize</code>() will be made,</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">lines</var></dt>
      <dd>The number of lines (rows) in the re-sized terminal.</dd>
      <dt><var class="Fa">cols</var></dt>
      <dd>The number of columns in the re-sized terminal.</dd>
      <dt id="change_winsize~2"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#change_winsize~2"><code class="Fn">change_winsize</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.
        <p class="Pp">The <var class="Fa">errstr</var> parameter is only
            available starting with API version 1.15. A plugin
            <b class="Sy">must</b> check the API version specified by the
            <code class="Nm">sudo</code> front-end before using
            <var class="Fa">errstr</var>. Failure to do so may result in a
            crash.</p>
      </dd>
    </dl>
  </dd>
  <dt><var class="Fa">log_suspend</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*log_suspend)(int signo, const char **errstr);</pre>
    </div>
    <p class="Pp" id="log_suspend">The
        <a class="permalink" href="#log_suspend"><code class="Fn">log_suspend</code></a>()
        function is called whenever a command is suspended or resumed. Logging
        this information makes it possible to skip the period of time when the
        command was suspended during playback of a session. Returns -1 if an
        error occurred, in which case no further calls to
        <code class="Fn">log_suspend</code>() will be made,</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">signo</var></dt>
      <dd>The signal that caused the command to be suspended, or
          <code class="Dv">SIGCONT</code> if the command was resumed.</dd>
      <dt id="log_suspend~2"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#log_suspend~2"><code class="Fn">log_suspend</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.
        <p class="Pp">The <var class="Fa">errstr</var> parameter is only
            available starting with API version 1.15. A plugin
            <b class="Sy">must</b> check the API version specified by the
            <code class="Nm">sudo</code> front-end before using
            <var class="Fa">errstr</var>. Failure to do so may result in a
            crash.</p>
      </dd>
      <dt><var class="Fa">event_alloc</var></dt>
      <dd>
        <div class="Bd Li">
        <pre>struct sudo_plugin_event * (*event_alloc)(void);</pre>
        </div>
        <p class="Pp" id="event_alloc~3">The
            <a class="permalink" href="#event_alloc~3"><code class="Fn">event_alloc</code></a>()
            function is used to allocate a <var class="Vt">struct
            sudo_plugin_event</var> which provides access to the main
            <code class="Nm">sudo</code> event loop. Unlike the other fields,
            the <code class="Fn">event_alloc</code>() pointer is filled in by
            the <code class="Nm">sudo</code> front-end, not by the plugin.</p>
        <p class="Pp">See the <a class="Sx" href="#Event_API">Event API</a>
            section below for more information about events.</p>
        <p class="Pp" id="event_alloc~4">The
            <a class="permalink" href="#event_alloc~4"><code class="Fn">event_alloc</code></a>()
            function is only available starting with API version 1.15. If the
            <code class="Nm">sudo</code> front-end doesn't support API version
            1.15 or higher, <code class="Fn">event_alloc</code>() will not be
            set.</p>
      </dd>
    </dl>
    <p class="Pp" id="I/O"><a class="permalink" href="#I/O"><i class="Em">I/O
        Plugin Version Macros</i></a></p>
    <p class="Pp">Same as for the <a class="Sx" href="#Policy_plugin_API">Policy
        plugin API</a>.</p>
  </dd>
</dl>
</section>
<section class="Ss">
<h3 class="Ss" id="Audit_plugin_API"><a class="permalink" href="#Audit_plugin_API">Audit
  plugin API</a></h3>
<div class="Bd Li">
<pre>/* Audit plugin close function status types. */
&#35;define SUDO_PLUGIN_NO_STATUS           0
&#35;define SUDO_PLUGIN_WAIT_STATUS         1
&#35;define SUDO_PLUGIN_EXEC_ERROR          2
&#35;define SUDO_PLUGIN_SUDO_ERROR          3
<p>#define SUDO_AUDIT_PLUGIN 3
struct audit_plugin {
unsigned int type; /* always SUDO_AUDIT_PLUGIN <em>/
unsigned int version; /</em> always SUDO_API_VERSION */
int (*open)(unsigned int version, sudo_conv_t conversation,
sudo_printf_t sudo_plugin_printf, char * const settings[],
char * const user_info[], int submit_optind,
char * const submit_argv[], char * const submit_envp[],
char * const plugin_options[], const char **errstr);
void (*close)(int status_type, int status);
int (*accept)(const char *plugin_name,
unsigned int plugin_type, char * const command_info[],
char * const run_argv[], char * const run_envp[],
const char **errstr);
int (*reject)(const char *plugin_name, unsigned int plugin_type,
const char *audit_msg, char * const command_info[],
const char **errstr);
int (*error)(const char *plugin_name, unsigned int plugin_type,
const char *audit_msg, char * const command_info[],
const char **errstr);
int (*show_version)(int verbose);
void (*register_hooks)(int version,
int (*register_hook)(struct sudo_hook *hook));
void (*deregister_hooks)(int version,
int (*deregister_hook)(struct sudo_hook *hook));
struct sudo_plugin_event * (*event_alloc)(void);
}</pre></p>
</div>
<p class="Pp">An audit plugin can be used to log successful and unsuccessful
    attempts to run <code class="Nm">sudo</code> independent of the policy or
    any I/O plugins. Multiple audit plugins may be specified in
    <a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a>.</p>
<p class="Pp">A <var class="Vt">struct audit_plugin</var> has the following
    fields:</p>
<dl class="Bl-tag">
  <dt><var class="Fa">type</var></dt>
  <dd>The <var class="Fa">type</var> field should always be set to
      <code class="Dv">SUDO_AUDIT_PLUGIN</code>.</dd>
  <dt><var class="Fa">version</var></dt>
  <dd>The <var class="Fa">version</var> field should be set to
      <code class="Dv">SUDO_API_VERSION</code>.
    <p class="Pp">This allows <code class="Nm">sudo</code> to determine the API
        version the plugin was built against.</p>
  </dd>
  <dt><var class="Fa">open</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*open)(unsigned int version, sudo_conv_t conversation,
    sudo_printf_t sudo_plugin_printf, char * const settings[],
    char * const user_info[], int submit_optind,
    char * const submit_argv[], char * const submit_envp[],
    char * const plugin_options[], const char **errstr);</pre>
    </div>
    <p class="Pp" id="open~5">The audit
        <a class="permalink" href="#open~5"><code class="Fn">open</code></a>()
        function is run before any other <code class="Nm">sudo</code> plugin API
        functions. This makes it possible to audit failures in the other
        plugins. It returns 1 on success, 0 on failure, -1 if a general error
        occurred, or -2 if there was a usage error. In the latter case,
        <code class="Nm">sudo</code> will print a usage message before it exits.
        If an error occurs, the plugin may optionally call the
        <code class="Fn">conversation</code>() or
        <code class="Fn">plugin_printf</code>() function with
        <code class="Dv">SUDO_CONF_ERROR_MSG</code> to present additional error
        information to the user.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">version</var></dt>
      <dd>The version passed in by <code class="Nm">sudo</code> allows the
          plugin to determine the major and minor version number of the plugin
          API supported by <code class="Nm">sudo</code>.</dd>
      <dt id="conversation~9"><var class="Fa">conversation</var></dt>
      <dd>A pointer to the
          <a class="permalink" href="#conversation~9"><code class="Fn">conversation</code></a>()
          function that may be used by the
          <code class="Fn">show_version</code>() function to display version
          information (see <code class="Fn">show_version</code>() below). The
          <code class="Fn">conversation</code>() function may also be used to
          display additional error message to the user. The
          <code class="Fn">conversation</code>() function returns 0 on success,
          and -1 on failure.</dd>
      <dt><var class="Fa">plugin_printf</var></dt>
      <dd>A pointer to a <code class="Fn">printf</code>()-style function that
          may be used by the <code class="Fn">show_version</code>() function to
          display version information (see show_version below). The
          <code class="Fn">plugin_printf</code>() function may also be used to
          display additional error message to the user. The
          <code class="Fn">plugin_printf</code>() function returns number of
          characters printed on success and -1 on failure.</dd>
      <dt><var class="Fa">settings</var></dt>
      <dd>A vector of user-supplied <code class="Nm">sudo</code> settings in the
          form of &#x201C;name=value&#x201D; strings. The vector is terminated
          by a <code class="Dv">NULL</code> pointer. These settings correspond
          to options the user specified when running
          <code class="Nm">sudo</code>. As such, they will only be present when
          the corresponding option has been specified on the command line.
        <p class="Pp">When parsing <var class="Fa">settings</var>, the plugin
            should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
        <p class="Pp">See the <a class="Sx" href="#Policy_plugin_API">Policy
            plugin API</a> section for a list of all possible settings.</p>
      </dd>
      <dt><var class="Fa">user_info</var></dt>
      <dd>A vector of information about the user running the command in the form
          of &#x201C;name=value&#x201D; strings. The vector is terminated by a
          <code class="Dv">NULL</code> pointer.
        <p class="Pp">When parsing <var class="Fa">user_info</var>, the plugin
            should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
        <p class="Pp">See the <a class="Sx" href="#Policy_plugin_API">Policy
            plugin API</a> section for a list of all possible strings.</p>
      </dd>
      <dt><var class="Fa">submit_optind</var></dt>
      <dd>The index into <var class="Fa">submit_argv</var> that corresponds to
          the first entry that is not a command line option. If
          <var class="Fa">submit_argv</var> only consists of options, which may
          be the case with the <code class="Fl">-l</code> or
          <code class="Fl">-v</code> options,
          <var class="Fa">submit_argv</var>[<var class="Fa">submit_optind</var>]
          will evaluate to the NULL pointer.</dd>
      <dt><var class="Fa">submit_argv</var></dt>
      <dd>The argument vector <code class="Nm">sudo</code> was invoked with,
          including all command line options. The
          <var class="Fa">submit_optind</var> argument can be used to determine
          the end of the command line options.</dd>
      <dt><var class="Fa">submit_envp</var></dt>
      <dd>The invoking user's environment in the form of a
          <code class="Dv">NULL</code>-terminated vector of
          &#x201C;name=value&#x201D; strings.
        <p class="Pp">When parsing <var class="Fa">submit_envp</var>, the plugin
            should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
      </dd>
      <dt><var class="Fa">plugin_options</var></dt>
      <dd>Any (non-comment) strings immediately after the plugin path are
          treated as arguments to the plugin. These arguments are split on a
          white space boundary and are passed to the plugin in the form of a
          <code class="Dv">NULL</code>-terminated array of strings. If no
          arguments were specified, <var class="Fa">plugin_options</var> will be
          the <code class="Dv">NULL</code> pointer.</dd>
      <dt id="open~6"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#open~6"><code class="Fn">open</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.</dd>
    </dl>
  </dd>
  <dt><var class="Fa">close</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>void (*close)(int status_type, int status);</pre>
    </div>
    <p class="Pp" id="close~4">The
        <a class="permalink" href="#close~4"><code class="Fn">close</code></a>()
        function is called when <code class="Nm">sudo</code> is finished,
        shortly before it exits.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">status_type</var></dt>
      <dd>The type of status being passed. One of
          <code class="Dv">SUDO_PLUGIN_NO_STATUS</code>,
          <code class="Dv">SUDO_PLUGIN_WAIT_STATUS</code>,
          <code class="Dv">SUDO_PLUGIN_EXEC_ERROR</code> or
          <code class="Dv">SUDO_PLUGIN_SUDO_ERROR</code>.</dd>
      <dt><var class="Fa">status</var></dt>
      <dd>Depending on the value of <var class="Fa">status_type</var>, this
          value is either ignored, the command's exit status as returned by the
          <a class="Xr" aria-label="wait, section 2">wait(2)</a> system call,
          the value of <var class="Va">errno</var> set by the
          <a class="Xr" aria-label="execve, section 2">execve(2)</a> system
          call, or the value of <var class="Va">errno</var> resulting from an
          error in the <code class="Nm">sudo</code> front-end.</dd>
    </dl>
  </dd>
  <dt><var class="Fa">accept</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*accept)(const char *plugin_name, unsigned int plugin_type,
    char * const command_info[], char * const run_argv[],
    char * const run_envp[], const char **errstr);</pre>
    </div>
    <p class="Pp" id="accept">The
        <a class="permalink" href="#accept"><code class="Fn">accept</code></a>()
        function is called when a command or action is accepted by a policy or
        approval plugin. The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">plugin_name</var></dt>
      <dd>The name of the plugin that accepted the command or
          &#x201C;sudo&#x201D; for the <code class="Nm">sudo</code>
        front-end.</dd>
      <dt><var class="Fa">plugin_type</var></dt>
      <dd>The type of plugin that accepted the command, currently either
          <code class="Dv">SUDO_POLICY_PLUGIN</code>,
          <code class="Dv">SUDO_POLICY_APPROVAL</code>, or
          <code class="Dv">SUDO_FRONT_END</code>. The
          <code class="Fn">accept</code>() function is called multiple
          times--once for each policy or approval plugin that succeeds and once
          for the sudo front-end. When called on behalf of the sudo front-end,
          <var class="Fa">command_info</var> may include information from an I/O
          logging plugin as well.
        <p class="Pp" id="accept~2">Typically, an audit plugin is interested in
            either the accept status from the <code class="Nm">sudo</code>
            front-end or from the various policy and approval plugins, but not
            both. It is possible for the policy plugin to accept a command that
            is later rejected by an approval plugin, in which case the audit
            plugin's
            <a class="permalink" href="#accept~2"><code class="Fn">accept</code></a>()
            and <code class="Fn">reject</code>() functions will
            <a class="permalink" href="#both"><i class="Em" id="both">both</i></a>
            be called.</p>
      </dd>
      <dt><var class="Fa">command_info</var></dt>
      <dd>An optional vector of information describing the command being run in
          the form of &#x201C;name=value&#x201D; strings. The vector is
          terminated by a <code class="Dv">NULL</code> pointer.
        <p class="Pp">When parsing <var class="Fa">command_info</var>, the
            plugin should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
        <p class="Pp">See the <a class="Sx" href="#Policy_plugin_API">Policy
            plugin API</a> section for a list of all possible strings.</p>
      </dd>
      <dt><var class="Fa">run_argv</var></dt>
      <dd>A <code class="Dv">NULL</code>-terminated argument vector describing a
          command that will be run in the same form as what would be passed to
          the <a class="Xr" aria-label="execve, section 2">execve(2)</a> system
          call.</dd>
      <dt><var class="Fa">run_envp</var></dt>
      <dd>The environment the command will be run with in the form of a
          <code class="Dv">NULL</code>-terminated vector of
          &#x201C;name=value&#x201D; strings.
        <p class="Pp">When parsing <var class="Fa">run_envp</var>, the plugin
            should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
      </dd>
      <dt id="accept~3"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#accept~3"><code class="Fn">accept</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.</dd>
    </dl>
  </dd>
  <dt><var class="Fa">reject</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*reject)(const char *plugin_name, unsigned int plugin_type,
    const char *audit_msg, char * const command_info[],
    const char **errstr);</pre>
    </div>
    <p class="Pp" id="reject">The
        <a class="permalink" href="#reject"><code class="Fn">reject</code></a>()
        function is called when a command or action is rejected by a plugin. The
        function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">plugin_name</var></dt>
      <dd>The name of the plugin that rejected the command.</dd>
      <dt><var class="Fa">plugin_type</var></dt>
      <dd>The type of plugin that rejected the command, currently either
          <code class="Dv">SUDO_POLICY_PLUGIN</code>,
          <code class="Dv">SUDO_APPROVAL_PLUGIN</code>, or
          <code class="Dv">SUDO_IO_PLUGIN</code>.
        <p class="Pp" id="accept~4">Unlike the
            <a class="permalink" href="#accept~4"><code class="Fn">accept</code></a>()
            function, the <code class="Fn">reject</code>() function is not
            called on behalf of the <code class="Nm">sudo</code> front-end.</p>
      </dd>
      <dt><var class="Fa">audit_msg</var></dt>
      <dd>An optional string describing the reason the command was rejected by
          the plugin. If the plugin did not provide a reason,
          <var class="Fa">audit_msg</var> will be the
          <code class="Dv">NULL</code> pointer.</dd>
      <dt><var class="Fa">command_info</var></dt>
      <dd>An optional vector of information describing the command being run in
          the form of &#x201C;name=value&#x201D; strings. The vector is
          terminated by a <code class="Dv">NULL</code> pointer.
        <p class="Pp">When parsing <var class="Fa">command_info</var>, the
            plugin should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
        <p class="Pp">See the <a class="Sx" href="#Policy_plugin_API">Policy
            plugin API</a> section for a list of all possible strings.</p>
      </dd>
      <dt id="reject~2"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#reject~2"><code class="Fn">reject</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.</dd>
    </dl>
  </dd>
  <dt><var class="Fa">error</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*error)(const char *plugin_name, unsigned int plugin_type,
    const char *audit_msg, char * const command_info[],
    const char **errstr);</pre>
    </div>
    <p class="Pp" id="error">The
        <a class="permalink" href="#error"><code class="Fn">error</code></a>()
        function is called when a plugin or the <code class="Nm">sudo</code>
        front-end returns an error. The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">plugin_name</var></dt>
      <dd>The name of the plugin that generated the error or
          &#x201C;sudo&#x201D; for the <code class="Nm">sudo</code>
        front-end.</dd>
      <dt><var class="Fa">plugin_type</var></dt>
      <dd>The type of plugin that generated the error, or
          <code class="Dv">SUDO_FRONT_END</code> for the
          <code class="Nm">sudo</code> front-end.</dd>
      <dt><var class="Fa">audit_msg</var></dt>
      <dd>An optional string describing the plugin error. If the plugin did not
          provide a description, <var class="Fa">audit_msg</var> will be the
          <code class="Dv">NULL</code> pointer.</dd>
      <dt><var class="Fa">command_info</var></dt>
      <dd>An optional vector of information describing the command being run in
          the form of &#x201C;name=value&#x201D; strings. The vector is
          terminated by a <code class="Dv">NULL</code> pointer.
        <p class="Pp">When parsing <var class="Fa">command_info</var>, the
            plugin should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
        <p class="Pp">See the <a class="Sx" href="#Policy_plugin_API">Policy
            plugin API</a> section for a list of all possible strings.</p>
      </dd>
      <dt id="error~2"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#error~2"><code class="Fn">error</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.</dd>
    </dl>
  </dd>
  <dt><var class="Fa">show_version</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*show_version)(int verbose);</pre>
    </div>
    <p class="Pp" id="show_version~3">The
        <a class="permalink" href="#show_version~3"><code class="Fn">show_version</code></a>()
        function is called by <code class="Nm">sudo</code> when the user
        specifies the <code class="Fl">-V</code> option. The plugin may display
        its version information to the user via the
        <code class="Fn">conversation</code>() or
        <code class="Fn">plugin_printf</code>() function using
        <code class="Dv">SUDO_CONV_INFO_MSG</code>. If the user requests
        detailed version information, the verbose flag will be set.</p>
    <p class="Pp">Returns 1 on success, 0 on failure, -1 if a general error
        occurred, or -2 if there was a usage error, although the return value is
        currently ignored.</p>
  </dd>
  <dt id="register_hooks~4"><var class="Fa">register_hooks</var></dt>
  <dd>See the <a class="Sx" href="#Policy_plugin_API">Policy plugin API</a>
      section for a description of
      <a class="permalink" href="#register_hooks~4"><code class="Fn">register_hooks</code></a>().</dd>
  <dt><var class="Fa">deregister_hooks</var></dt>
  <dd>See the <a class="Sx" href="#Policy_plugin_API">Policy plugin API</a>
      section for a description of
    <code class="Fn">deregister_hooks</code>().</dd>
  <dt><var class="Fa">event_alloc</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>struct sudo_plugin_event * (*event_alloc)(void);</pre>
    </div>
    <p class="Pp" id="event_alloc~5">The
        <a class="permalink" href="#event_alloc~5"><code class="Fn">event_alloc</code></a>()
        function is used to allocate a <var class="Vt">struct
        sudo_plugin_event</var> which provides access to the main
        <code class="Nm">sudo</code> event loop. Unlike the other fields, the
        <var class="Fa">event_alloc</var> pointer is filled in by the
        <code class="Nm">sudo</code> front-end, not by the plugin.</p>
    <p class="Pp">See the <a class="Sx" href="#Event_API">Event API</a> section
        below for more information about events.</p>
    <p class="Pp" id="event_alloc~6">The
        <a class="permalink" href="#event_alloc~6"><code class="Fn">event_alloc</code></a>()
        function is only available starting with API version 1.17. If the
        <code class="Nm">sudo</code> front-end doesn't support API version 1.17
        or higher, <code class="Fn">event_alloc</code>() will not be set.</p>
  </dd>
</dl>
</section>
<section class="Ss">
<h3 class="Ss" id="Approval_plugin_API"><a class="permalink" href="#Approval_plugin_API">Approval
  plugin API</a></h3>
<div class="Bd Li">
<pre>struct approval_plugin {
&#35;define SUDO_APPROVAL_PLUGIN 4
    unsigned int type; /* always SUDO_APPROVAL_PLUGIN */
    unsigned int version; /* always SUDO_API_VERSION */
    int (*open)(unsigned int version, sudo_conv_t conversation,
        sudo_printf_t sudo_plugin_printf, char * const settings[],
        char * const user_info[], int submit_optind,
        char * const submit_argv[], char * const submit_envp[],
        char * const plugin_options[], const char **errstr);
    void (*close)(void);
    int (*check)(char * const command_info[], char * const run_argv[],
        char * const run_envp[], const char **errstr);
    int (*show_version)(int verbose);
};</pre>
</div>
<p class="Pp" id="check">An approval plugin can be used to apply extra
    constraints after a command has been accepted by the policy plugin. Unlike
    the other plugin types, it does not remain open until the command completes.
    The plugin is opened before a call to
    <a class="permalink" href="#check"><code class="Fn">check</code></a>() or
    <code class="Fn">show_version</code>() and closed shortly thereafter (audit
    plugin functions must be called before the plugin is closed). Multiple
    approval plugins may be specified in <a class="Xr" aria-label="sudo.conf,
    section 5">sudo.conf(5)</a>.</p>
<p class="Pp">A <var class="Vt">struct approval_plugin</var> has the following
    fields:</p>
<dl class="Bl-tag">
  <dt><var class="Fa">type</var></dt>
  <dd>The <var class="Fa">type</var> field should always be set to
      <code class="Dv">SUDO_APPROVAL_PLUGIN</code>.</dd>
  <dt><var class="Fa">version</var></dt>
  <dd>The <var class="Fa">version</var> field should be set to
      <code class="Dv">SUDO_API_VERSION</code>.
    <p class="Pp">This allows <code class="Nm">sudo</code> to determine the API
        version the plugin was built against.</p>
  </dd>
  <dt><var class="Fa">open</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*open)(unsigned int version, sudo_conv_t conversation,
    sudo_printf_t sudo_plugin_printf, char * const settings[],
    char * const user_info[], int submit_optind,
    char * const submit_argv[], char * const submit_envp[],
    char * const plugin_options[], const char **errstr);</pre>
    </div>
    <p class="Pp" id="open~7">The approval
        <a class="permalink" href="#open~7"><code class="Fn">open</code></a>()
        function is run immediately before a call to the plugin's
        <code class="Fn">check</code>() or
        <code class="Fn">show_version</code>() functions. It is only called if
        the version is being requested or if the policy plugin's
        <code class="Fn">check_policy</code>() function has returned
        successfully. It returns 1 on success, 0 on failure, -1 if a general
        error occurred, or -2 if there was a usage error. In the latter case,
        <code class="Nm">sudo</code> will print a usage message before it exits.
        If an error occurs, the plugin may optionally call the
        <code class="Fn">conversation</code>() or
        <code class="Fn">plugin_printf</code>() function with
        <code class="Dv">SUDO_CONF_ERROR_MSG</code> to present additional error
        information to the user.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">version</var></dt>
      <dd>The version passed in by <code class="Nm">sudo</code> allows the
          plugin to determine the major and minor version number of the plugin
          API supported by <code class="Nm">sudo</code>.</dd>
      <dt id="conversation~10"><var class="Fa">conversation</var></dt>
      <dd>A pointer to the
          <a class="permalink" href="#conversation~10"><code class="Fn">conversation</code></a>()
          function that can be used by the plugin to interact with the user (see
          <a class="Sx" href="#Conversation_API">Conversation API</a> for
          details). Returns 0 on success and -1 on failure.</dd>
      <dt><var class="Fa">plugin_printf</var></dt>
      <dd>A pointer to a <code class="Fn">printf</code>()-style function that
          may be used to display informational or error messages (see
          <a class="Sx" href="#Conversation_API">Conversation API</a> for
          details). Returns the number of characters printed on success and -1
          on failure.</dd>
      <dt><var class="Fa">settings</var></dt>
      <dd>A vector of user-supplied <code class="Nm">sudo</code> settings in the
          form of &#x201C;name=value&#x201D; strings. The vector is terminated
          by a <code class="Dv">NULL</code> pointer. These settings correspond
          to options the user specified when running
          <code class="Nm">sudo</code>. As such, they will only be present when
          the corresponding option has been specified on the command line.
        <p class="Pp">When parsing <var class="Fa">settings</var>, the plugin
            should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
        <p class="Pp">See the <a class="Sx" href="#Policy_plugin_API">Policy
            plugin API</a> section for a list of all possible settings.</p>
      </dd>
      <dt><var class="Fa">user_info</var></dt>
      <dd>A vector of information about the user running the command in the form
          of &#x201C;name=value&#x201D; strings. The vector is terminated by a
          <code class="Dv">NULL</code> pointer.
        <p class="Pp">When parsing <var class="Fa">user_info</var>, the plugin
            should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
        <p class="Pp">See the <a class="Sx" href="#Policy_plugin_API">Policy
            plugin API</a> section for a list of all possible strings.</p>
      </dd>
      <dt><var class="Fa">submit_optind</var></dt>
      <dd>The index into <var class="Fa">submit_argv</var> that corresponds to
          the first entry that is not a command line option. If
          <var class="Fa">submit_argv</var> only consists of options, which may
          be the case with the <code class="Fl">-l</code> or
          <code class="Fl">-v</code> options,
          <var class="Fa">submit_argv</var>[<var class="Fa">submit_optind</var>]
          will evaluate to the NULL pointer.</dd>
      <dt><var class="Fa">submit_argv</var></dt>
      <dd>The argument vector <code class="Nm">sudo</code> was invoked with,
          including all command line options. The
          <var class="Fa">submit_optind</var> argument can be used to determine
          the end of the command line options.</dd>
      <dt><var class="Fa">submit_envp</var></dt>
      <dd>The invoking user's environment in the form of a
          <code class="Dv">NULL</code>-terminated vector of
          &#x201C;name=value&#x201D; strings.
        <p class="Pp">When parsing <var class="Fa">submit_envp</var>, the plugin
            should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
      </dd>
      <dt><var class="Fa">plugin_options</var></dt>
      <dd>Any (non-comment) strings immediately after the plugin path are
          treated as arguments to the plugin. These arguments are split on a
          white space boundary and are passed to the plugin in the form of a
          <code class="Dv">NULL</code>-terminated array of strings. If no
          arguments were specified, <var class="Fa">plugin_options</var> will be
          the <code class="Dv">NULL</code> pointer.</dd>
      <dt id="open~8"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#open~8"><code class="Fn">open</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.</dd>
    </dl>
  </dd>
  <dt><var class="Fa">close</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>void (*close)(void);</pre>
    </div>
    <p class="Pp" id="close~5">The
        <a class="permalink" href="#close~5"><code class="Fn">close</code></a>()
        function is called after the approval plugin's
        <code class="Fn">check</code>() or
        <code class="Fn">show_version</code>() functions have been called. It
        takes no arguments. The <code class="Fn">close</code>() function is
        typically used to perform plugin-specific cleanup, such as the freeing
        of memory objects allocated by the plugin. If the plugin does not need
        to perform any cleanup, <code class="Fn">close</code>() may be set to
        the <code class="Dv">NULL</code> pointer.</p>
  </dd>
  <dt><var class="Fa">check</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*check)(char * const command_info[], char * const run_argv[],
    char * const run_envp[], const char **errstr);</pre>
    </div>
    <p class="Pp" id="check~2">The approval
        <a class="permalink" href="#check~2"><code class="Fn">check</code></a>()
        function is run after the policy plugin
        <code class="Fn">check_policy</code>() function and before any I/O
        logging plugins. If multiple approval plugins are loaded, they must all
        succeed for the command to be allowed. It returns 1 on success, 0 on
        failure, -1 if a general error occurred, or -2 if there was a usage
        error. In the latter case, <code class="Nm">sudo</code> will print a
        usage message before it exits. If an error occurs, the plugin may
        optionally call the <code class="Fn">conversation</code>() or
        <code class="Fn">plugin_printf</code>() function with
        <code class="Dv">SUDO_CONF_ERROR_MSG</code> to present additional error
        information to the user.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">command_info</var></dt>
      <dd>A vector of information describing the command being run in the form
          of &#x201C;name=value&#x201D; strings. The vector is terminated by a
          <code class="Dv">NULL</code> pointer.
        <p class="Pp">When parsing <var class="Fa">command_info</var>, the
            plugin should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
        <p class="Pp">See the <a class="Sx" href="#Policy_plugin_API">Policy
            plugin API</a> section for a list of all possible strings.</p>
      </dd>
      <dt><var class="Fa">run_argv</var></dt>
      <dd>A <code class="Dv">NULL</code>-terminated argument vector describing a
          command that will be run in the same form as what would be passed to
          the <a class="Xr" aria-label="execve, section 2">execve(2)</a> system
          call.</dd>
      <dt><var class="Fa">run_envp</var></dt>
      <dd>The environment the command will be run with in the form of a
          <code class="Dv">NULL</code>-terminated vector of
          &#x201C;name=value&#x201D; strings.
        <p class="Pp">When parsing <var class="Fa">run_envp</var>, the plugin
            should split on the <b class="Sy">first</b> equal sign
            (&#x2018;<code class="Li">=</code>&#x2019;) since the
            <i class="Em">name</i> field will never include one itself but the
            <i class="Em">value</i> might.</p>
      </dd>
      <dt id="open~9"><var class="Fa">errstr</var></dt>
      <dd>If the
          <a class="permalink" href="#open~9"><code class="Fn">open</code></a>()
          function returns a value other than 1, the plugin may store a message
          describing the failure or error in <var class="Fa">errstr</var>. The
          <code class="Nm">sudo</code> front-end will then pass this value to
          any registered audit plugins. The string stored in
          <var class="Fa">errstr</var> must remain valid until the plugin's
          <code class="Fn">close</code>() function is called.</dd>
    </dl>
  </dd>
  <dt><var class="Fa">show_version</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*show_version)(int verbose);</pre>
    </div>
    <p class="Pp" id="show_version~4">The
        <a class="permalink" href="#show_version~4"><code class="Fn">show_version</code></a>()
        function is called by <code class="Nm">sudo</code> when the user
        specifies the <code class="Fl">-V</code> option. The plugin may display
        its version information to the user via the
        <code class="Fn">conversation</code>() or
        <code class="Fn">plugin_printf</code>() function using
        <code class="Dv">SUDO_CONV_INFO_MSG</code>. If the user requests
        detailed version information, the verbose flag will be set.</p>
    <p class="Pp">Returns 1 on success, 0 on failure, -1 if a general error
        occurred, or -2 if there was a usage error, although the return value is
        currently ignored.</p>
  </dd>
</dl>
</section>
<section class="Ss">
<h3 class="Ss" id="Signal_handlers"><a class="permalink" href="#Signal_handlers">Signal
  handlers</a></h3>
<p class="Pp">The <code class="Nm">sudo</code> front-end installs default signal
    handlers to trap common signals while the plugin functions are run. The
    following signals are trapped by default before the command is executed:</p>
<p class="Pp"></p>
<ul class="Bl-bullet Bl-compact">
  <li id="SIGALRM"><a class="permalink" href="#SIGALRM"><code class="Dv">SIGALRM</code></a></li>
  <li id="SIGHUP"><a class="permalink" href="#SIGHUP"><code class="Dv">SIGHUP</code></a></li>
  <li id="SIGINT"><a class="permalink" href="#SIGINT"><code class="Dv">SIGINT</code></a></li>
  <li id="SIGPIPE"><a class="permalink" href="#SIGPIPE"><code class="Dv">SIGPIPE</code></a></li>
  <li id="SIGQUIT"><a class="permalink" href="#SIGQUIT"><code class="Dv">SIGQUIT</code></a></li>
  <li id="SIGTERM"><a class="permalink" href="#SIGTERM"><code class="Dv">SIGTERM</code></a></li>
  <li id="SIGTSTP"><a class="permalink" href="#SIGTSTP"><code class="Dv">SIGTSTP</code></a></li>
  <li id="SIGUSR1"><a class="permalink" href="#SIGUSR1"><code class="Dv">SIGUSR1</code></a></li>
  <li id="SIGUSR2"><a class="permalink" href="#SIGUSR2"><code class="Dv">SIGUSR2</code></a></li>
</ul>
<p class="Pp" id="close~6">If a fatal signal is received before the command is
    executed, <code class="Nm">sudo</code> will call the plugin's
    <a class="permalink" href="#close~6"><code class="Fn">close</code></a>()
    function with an exit status of 128 plus the value of the signal that was
    received. This allows for consistent logging of commands killed by a signal
    for plugins that log such information in their
    <code class="Fn">close</code>() function. An exception to this is
    <code class="Dv">SIGPIPE</code>, which is ignored until the command is
    executed.</p>
<p class="Pp">A plugin may temporarily install its own signal handlers but must
    restore the original handler before the plugin function returns.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Hook_function_API"><a class="permalink" href="#Hook_function_API">Hook
  function API</a></h3>
<p class="Pp">Beginning with plugin API version 1.2, it is possible to install
    hooks for certain functions called by the <code class="Nm">sudo</code>
    front-end.</p>
<p class="Pp">Currently, the only supported hooks relate to the handling of
    environment variables. Hooks can be used to intercept attempts to get, set,
    or remove environment variables so that these changes can be reflected in
    the version of the environment that is used to execute a command. A future
    version of the API will support hooking internal
    <code class="Nm">sudo</code> front-end functions as well.</p>
<p class="Pp"><i class="Em">Hook structure</i></p>
<p class="Pp">Hooks in <code class="Nm">sudo</code> are described by the
    following structure:</p>
<div class="Bd Pp Li">
<pre>typedef int (*sudo_hook_fn_t)();
<p>struct sudo_hook {
unsigned int hook_version;
unsigned int hook_type;
sudo_hook_fn_t hook_fn;
void *closure;
};</pre></p>
</div>
<p class="Pp">A <var class="Vt">struct sudo_hook</var> has the following
  fields:</p>
<dl class="Bl-tag">
  <dt><var class="Fa">hook_version</var></dt>
  <dd>The <var class="Fa">hook_version</var> field should be set to
      <code class="Dv">SUDO_HOOK_VERSION</code>.</dd>
  <dt><var class="Fa">hook_type</var></dt>
  <dd>The <var class="Fa">hook_type</var> field may be one of the following
      supported hook types:
    <dl class="Bl-tag">
      <dt id="SUDO_HOOK_SETENV"><a class="permalink" href="#SUDO_HOOK_SETENV"><code class="Dv">SUDO_HOOK_SETENV</code></a></dt>
      <dd>The C library <a class="Xr" aria-label="setenv, section
          3">setenv(3)</a> function. Any registered hooks will run before the C
          library implementation. The <var class="Fa">hook_fn</var> field should
          be a function that matches the following typedef:
        <div class="Bd Pp Li">
        <pre>typedef int (*sudo_hook_fn_setenv_t)(const char *name,
   const char *value, int overwrite, void *closure);</pre>
        </div>
        <p class="Pp">If the registered hook does not match the typedef the
            results are unspecified.</p>
      </dd>
      <dt id="SUDO_HOOK_UNSETENV"><a class="permalink" href="#SUDO_HOOK_UNSETENV"><code class="Dv">SUDO_HOOK_UNSETENV</code></a></dt>
      <dd>The C library <a class="Xr" aria-label="unsetenv, section
          3">unsetenv(3)</a> function. Any registered hooks will run before the
          C library implementation. The <var class="Fa">hook_fn</var> field
          should be a function that matches the following typedef:
        <div class="Bd Pp Li">
        <pre>typedef int (*sudo_hook_fn_unsetenv_t)(const char *name,
   void *closure);</pre>
        </div>
      </dd>
      <dt id="SUDO_HOOK_GETENV"><a class="permalink" href="#SUDO_HOOK_GETENV"><code class="Dv">SUDO_HOOK_GETENV</code></a></dt>
      <dd>The C library <a class="Xr" aria-label="getenv, section
          3">getenv(3)</a> function. Any registered hooks will run before the C
          library implementation. The <var class="Fa">hook_fn</var> field should
          be a function that matches the following typedef:
        <div class="Bd Pp Li">
        <pre>typedef int (*sudo_hook_fn_getenv_t)(const char *name,
   char **value, void *closure);</pre>
        </div>
        <p class="Pp">If the registered hook does not match the typedef the
            results are unspecified.</p>
      </dd>
      <dt id="SUDO_HOOK_PUTENV"><a class="permalink" href="#SUDO_HOOK_PUTENV"><code class="Dv">SUDO_HOOK_PUTENV</code></a></dt>
      <dd>The C library <a class="Xr" aria-label="putenv, section
          3">putenv(3)</a> function. Any registered hooks will run before the C
          library implementation. The <var class="Fa">hook_fn</var> field should
          be a function that matches the following typedef:
        <div class="Bd Pp Li">
        <pre>typedef int (*sudo_hook_fn_putenv_t)(char *string,
   void *closure);</pre>
        </div>
        <p class="Pp">If the registered hook does not match the typedef the
            results are unspecified.</p>
      </dd>
    </dl>
  </dd>
  <dt><var class="Fa">hook_fn</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>sudo_hook_fn_t hook_fn;</pre>
    </div>
    <p class="Pp">The <var class="Fa">hook_fn</var> field should be set to the
        plugin's hook implementation. The actual function arguments will vary
        depending on the <var class="Fa">hook_type</var> (see
        <var class="Fa">hook_type</var> above). In all cases, the
        <var class="Fa">closure</var> field of <var class="Vt">struct
        sudo_hook</var> is passed as the last function parameter. This can be
        used to pass arbitrary data to the plugin's hook implementation.</p>
    <p class="Pp">The function return value may be one of the following:</p>
    <dl class="Bl-tag">
      <dt id="SUDO_HOOK_RET_ERROR"><a class="permalink" href="#SUDO_HOOK_RET_ERROR"><code class="Dv">SUDO_HOOK_RET_ERROR</code></a></dt>
      <dd>The hook function encountered an error.</dd>
      <dt id="SUDO_HOOK_RET_NEXT"><a class="permalink" href="#SUDO_HOOK_RET_NEXT"><code class="Dv">SUDO_HOOK_RET_NEXT</code></a></dt>
      <dd>The hook completed without error, go on to the next hook (including
          the system implementation if applicable). For example, a
          <a class="Xr" aria-label="getenv, section 3">getenv(3)</a> hook might
          return <code class="Dv">SUDO_HOOK_RET_NEXT</code> if the specified
          variable was not found in the private copy of the environment.</dd>
      <dt id="SUDO_HOOK_RET_STOP"><a class="permalink" href="#SUDO_HOOK_RET_STOP"><code class="Dv">SUDO_HOOK_RET_STOP</code></a></dt>
      <dd>The hook completed without error, stop processing hooks for this
          invocation. This can be used to replace the system implementation. For
          example, a <var class="Fa">setenv</var> hook that operates on a
          private copy of the environment but leaves
          <var class="Va">environ</var> unchanged.</dd>
    </dl>
  </dd>
</dl>
<p class="Pp">Care must be taken when hooking C library functions, it is very
    easy to create an infinite loop. For example, a
    <a class="Xr" aria-label="getenv, section 3">getenv(3)</a> hook that calls
    the <a class="Xr" aria-label="snprintf, section 3">snprintf(3)</a> function
    may create a loop if the <a class="Xr" aria-label="snprintf, section
    3">snprintf(3)</a> implementation calls <a class="Xr" aria-label="getenv,
    section 3">getenv(3)</a> to check the locale. To prevent this, you may wish
    to use a static variable in the hook function to guard against nested calls.
    For example:</p>
<div class="Bd Pp Bd-indent Li">
<pre>static int in_progress = 0; /* avoid recursion */
if (in_progress)
    return SUDO_HOOK_RET_NEXT;
in_progress = 1;
...
in_progress = 0;
return SUDO_HOOK_RET_STOP;</pre>
</div>
<p class="Pp"><i class="Em">Hook API Version Macros</i></p>
<div class="Bd Pp Li">
<pre>/* Hook API version major/minor */
&#35;define SUDO_HOOK_VERSION_MAJOR 1
&#35;define SUDO_HOOK_VERSION_MINOR 0
&#35;define SUDO_HOOK_VERSION SUDO_API_MKVERSION(SUDO_HOOK_VERSION_MAJOR,\
                                              SUDO_HOOK_VERSION_MINOR)</pre>
</div>
<p class="Pp">For getters and setters see the
    <a class="Sx" href="#Policy_plugin_API">Policy plugin API</a>.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Event_API"><a class="permalink" href="#Event_API">Event
  API</a></h3>
<p class="Pp">When <code class="Nm">sudo</code> runs a command, it uses an event
    loop to service signals and I/O. Events may be triggered based on time, a
    file or socket descriptor becoming ready, or due to receipt of a signal.
    Starting with API version 1.15, it is possible for a plugin to participate
    in this event loop by calling the
    <a class="permalink" href="#event_alloc~7"><code class="Fn" id="event_alloc~7">event_alloc</code></a>()
    function.</p>
<p class="Pp" id="Event"><a class="permalink" href="#Event"><i class="Em">Event
    structure</i></a></p>
<p class="Pp">Events are described by the following structure:</p>
<p class="Pp"></p>
<div class="Bd Li">
<pre>typedef void (*sudo_plugin_ev_callback_t)(int fd, int what, void *closure);
<p>struct sudo_plugin_event {
int (*set)(struct sudo_plugin_event *pev, int fd, int events,
sudo_plugin_ev_callback_t callback, void *closure);
int (*add)(struct sudo_plugin_event *pev, struct timespec *timeout);
int (*del)(struct sudo_plugin_event *pev);
int (*pending)(struct sudo_plugin_event *pev, int events,
struct timespec *ts);
int (*fd)(struct sudo_plugin_event *pev);
void (*setbase)(struct sudo_plugin_event *pev, void *base);
void (*loopbreak)(struct sudo_plugin_event *pev);
void (*free)(struct sudo_plugin_event *pev);
};</pre></p>
</div>
<p class="Pp">A <var class="Vt">struct sudo_plugin_event</var> contains the
    following function pointers:</p>
<dl class="Bl-tag">
  <dt><var class="Fa">set</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*set)(struct sudo_plugin_event *pev, int fd, int events,
    sudo_plugin_ev_callback_t callback, void *closure);</pre>
    </div>
    <p class="Pp" id="set">The
        <a class="permalink" href="#set"><code class="Fn">set</code></a>()
        function takes the following arguments:</p>
    <dl class="Bl-tag">
      <dt><var class="Vt">struct sudo_plugin_event
        *</var><var class="Fa">pev</var></dt>
      <dd>A pointer to the <var class="Vt">struct sudo_plugin_event</var>
          itself.</dd>
      <dt><var class="Fa">fd</var></dt>
      <dd>The file or socket descriptor for I/O-based events or the signal
          number for signal events. For time-based events,
          <var class="Fa">fd</var> must be -1.</dd>
      <dt><var class="Fa">events</var></dt>
      <dd>The following values determine what will trigger the event callback:
        <dl class="Bl-tag">
          <dt id="SUDO_PLUGIN_EV_TIMEOUT"><a class="permalink" href="#SUDO_PLUGIN_EV_TIMEOUT"><code class="Dv">SUDO_PLUGIN_EV_TIMEOUT</code></a></dt>
          <dd>callback is run after the specified timeout expires</dd>
          <dt id="SUDO_PLUGIN_EV_READ"><a class="permalink" href="#SUDO_PLUGIN_EV_READ"><code class="Dv">SUDO_PLUGIN_EV_READ</code></a></dt>
          <dd>callback is run when the file descriptor is readable</dd>
          <dt id="SUDO_PLUGIN_EV_WRITE"><a class="permalink" href="#SUDO_PLUGIN_EV_WRITE"><code class="Dv">SUDO_PLUGIN_EV_WRITE</code></a></dt>
          <dd>callback is run when the file descriptor is writable</dd>
          <dt id="SUDO_PLUGIN_EV_PERSIST"><a class="permalink" href="#SUDO_PLUGIN_EV_PERSIST"><code class="Dv">SUDO_PLUGIN_EV_PERSIST</code></a></dt>
          <dd>event is persistent and remains enabled until explicitly
            deleted</dd>
          <dt id="SUDO_PLUGIN_EV_SIGNAL"><a class="permalink" href="#SUDO_PLUGIN_EV_SIGNAL"><code class="Dv">SUDO_PLUGIN_EV_SIGNAL</code></a></dt>
          <dd>callback is run when the specified signal is received</dd>
        </dl>
        <p class="Pp">The <code class="Dv">SUDO_PLUGIN_EV_PERSIST</code> flag
            may be ORed with any of the event types. It is also possible to OR
            <code class="Dv">SUDO_PLUGIN_EV_READ</code> and
            <code class="Dv">SUDO_PLUGIN_EV_WRITE</code> together to run the
            callback when a descriptor is ready to be either read from or
            written to. All other event values are mutually exclusive.</p>
      </dd>
      <dt><var class="Vt">sudo_plugin_ev_callback_t</var>
        <var class="Fa">callback</var></dt>
      <dd>
        <div class="Bd Li">
        <pre>typedef void (*sudo_plugin_ev_callback_t)(int fd, int what,
    void *closure);</pre>
        </div>
        <p class="Pp" id="callback">The function to call when an event is
            triggered. The
            <a class="permalink" href="#callback"><code class="Fn">callback</code></a>()
            function is run with the following arguments:</p>
        <dl class="Bl-tag">
          <dt><var class="Fa">fd</var></dt>
          <dd>The file or socket descriptor for I/O-based events or the signal
              number for signal events.</dd>
          <dt><var class="Fa">what</var></dt>
          <dd>The event type that triggered that callback. For events that have
              multiple event types (for example
              <code class="Dv">SUDO_PLUGIN_EV_READ</code> and
              <code class="Dv">SUDO_PLUGIN_EV_WRITE</code>) or have an
              associated timeout, <var class="Fa">what</var> can be used to
              determine why the callback was run.</dd>
          <dt><var class="Fa">closure</var></dt>
          <dd>The generic pointer that was specified in the
              <code class="Fn">set</code>() function.</dd>
        </dl>
      </dd>
      <dt><var class="Fa">closure</var></dt>
      <dd>A generic pointer that will be passed to the callback function.</dd>
    </dl>
    <p class="Pp" id="set~2">The
        <a class="permalink" href="#set~2"><code class="Fn">set</code></a>()
        function returns 1 on success, and -1 if a error occurred.</p>
  </dd>
  <dt><var class="Fa">add</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*add)(struct sudo_plugin_event *pev, struct timespec *timeout);</pre>
    </div>
    <p class="Pp" id="add">The
        <a class="permalink" href="#add"><code class="Fn">add</code></a>()
        function adds the event <var class="Fa">pev</var> to
        <code class="Nm">sudo</code><span class="No">'s</span> event loop. The
        event must have previously been initialized via the
        <code class="Fn">set</code>() function. If the
        <var class="Fa">timeout</var> argument is not NULL, it should specify a
        (relative) timeout after which the event will be triggered if the main
        event criteria has not been met. This is often used to implement an I/O
        timeout where the event will fire if a descriptor is not ready within a
        certain time period. If the event is already present in the event loop,
        its <var class="Fa">timeout</var> will be adjusted to match the new
        value, if any.</p>
    <p class="Pp" id="add~2">The
        <a class="permalink" href="#add~2"><code class="Fn">add</code></a>()
        function returns 1 on success, and -1 if a error occurred.</p>
  </dd>
  <dt><var class="Fa">del</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*del)(struct sudo_plugin_event *pev);</pre>
    </div>
    <p class="Pp" id="del">The
        <a class="permalink" href="#del"><code class="Fn">del</code></a>()
        function deletes the event <var class="Fa">pev</var> from
        <code class="Nm">sudo</code><span class="No">'s</span> event loop.
        Deleted events can be added back via the <code class="Fn">add</code>()
        function.</p>
    <p class="Pp" id="del~2">The
        <a class="permalink" href="#del~2"><code class="Fn">del</code></a>()
        function returns 1 on success, and -1 if a error occurred.</p>
  </dd>
  <dt><var class="Fa">pending</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*pending)(struct sudo_plugin_event *pev, int events,
    struct timespec *ts);</pre>
    </div>
    <p class="Pp" id="pending">The
        <a class="permalink" href="#pending"><code class="Fn">pending</code></a>()
        function can be used to determine whether one or more events is pending.
        The <var class="Fa">events</var> argument specifies which events to
        check for. See the <code class="Fn">set</code>() function for a list of
        valid event types. If <code class="Dv">SUDO_PLUGIN_EV_TIMEOUT</code> is
        specified in <var class="Fa">events</var>, the event has an associated
        timeout and the <var class="Fa">ts</var> pointer is non-NULL, it will be
        filled in with the remaining time.</p>
  </dd>
  <dt><var class="Fa">fd</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*fd)(struct sudo_plugin_event *pev);</pre>
    </div>
    <p class="Pp" id="fd">The
        <a class="permalink" href="#fd"><code class="Fn">fd</code></a>()
        function returns the descriptor or signal number associated with the
        event <var class="Fa">pev</var>.</p>
  </dd>
  <dt><var class="Fa">setbase</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>void (*setbase)(struct sudo_plugin_event *pev, void *base);</pre>
    </div>
    <p class="Pp" id="setbase">The
        <a class="permalink" href="#setbase"><code class="Fn">setbase</code></a>()
        function sets the underlying event <var class="Fa">base</var> for
        <var class="Fa">pev</var> to the specified value. This can be used to
        move an event created via <code class="Fn">event_alloc</code>() to a new
        event loop allocated by sudo's event subsystem. If
        <var class="Fa">base</var> is <code class="Dv">NULL</code>,
        <var class="Fa">pev</var>'s event base is reset to the default value,
        which corresponds to <code class="Nm">sudo</code>'s main event loop.
        Using this function requires linking the plugin with the sudo_util
        library. It is unlikely to be used outside of the
        <code class="Nm">sudoers</code> plugin.</p>
  </dd>
  <dt><var class="Fa">loopbreak</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>void (*loopbreak)(struct sudo_plugin_event *pev);</pre>
    </div>
    <p class="Pp" id="loopbreak">The
        <a class="permalink" href="#loopbreak"><code class="Fn">loopbreak</code></a>()
        function causes <code class="Nm">sudo</code><span class="No">'s</span>
        event loop to exit immediately and the running command to be
      terminated.</p>
  </dd>
  <dt><var class="Fa">free</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>void (*free)(struct sudo_plugin_event *pev);</pre>
    </div>
    <p class="Pp" id="free">The
        <a class="permalink" href="#free"><code class="Fn">free</code></a>()
        function deletes the event <var class="Fa">pev</var> from the event loop
        and frees the memory associated with it.</p>
  </dd>
</dl>
</section>
<section class="Ss">
<h3 class="Ss" id="Remote_command_execution"><a class="permalink" href="#Remote_command_execution">Remote
  command execution</a></h3>
<p class="Pp">The <code class="Nm">sudo</code> front-end does not support
    running remote commands. However, starting with <code class="Nm">sudo</code>
    1.8.8, the <code class="Fl">-h</code> option may be used to specify a remote
    host that is passed to the policy plugin. A plugin may also accept a
    <i class="Em">runas_user</i> in the form of &#x201C;user@hostname&#x201D;
    which will work with older versions of <code class="Nm">sudo</code>. It is
    anticipated that remote commands will be supported by executing a
    &#x201C;helper&#x201D; program. The policy plugin should setup the execution
    environment such that the <code class="Nm">sudo</code> front-end will run
    the helper which, in turn, will connect to the remote host and run the
    command.</p>
<p class="Pp">For example, the policy plugin could utilize
    <code class="Nm">ssh</code> to perform remote command execution. The helper
    program would be responsible for running <code class="Nm">ssh</code> with
    the proper options to use a private key or certificate that the remote host
    will accept and run a program on the remote host that would setup the
    execution environment accordingly.</p>
<p class="Pp">Remote <code class="Nm">sudoedit</code> functionality must be
    handled by the policy plugin, not <code class="Nm">sudo</code> itself as the
    front-end has no knowledge that a remote command is being executed. This may
    be addressed in a future revision of the plugin API.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Conversation_API"><a class="permalink" href="#Conversation_API">Conversation
  API</a></h3>
<p class="Pp">If the plugin needs to interact with the user, it may do so via
    the
    <a class="permalink" href="#conversation~11"><code class="Fn" id="conversation~11">conversation</code></a>()
    function. A plugin should not attempt to read directly from the standard
    input or the user's terminal (neither of which are guaranteed to exist). The
    caller must include a trailing newline in <var class="Fa">msg</var> if one
    is to be printed.</p>
<p class="Pp" id="printf">A
    <a class="permalink" href="#printf"><code class="Fn">printf</code></a>()-style
    function is also available that can be used to display informational or
    error messages to the user, which is usually more convenient for simple
    messages where no use input is required.</p>
<p class="Pp" id="Conversation"><a class="permalink" href="#Conversation"><i class="Em">Conversation
    function structures</i></a></p>
<p class="Pp">The conversation function takes as arguments pointers to the
    following structures:</p>
<div class="Bd Pp Li">
<pre>struct sudo_conv_message {
&#35;define SUDO_CONV_PROMPT_ECHO_OFF  0x0001 /* do not echo user input */
&#35;define SUDO_CONV_PROMPT_ECHO_ON   0x0002 /* echo user input */
&#35;define SUDO_CONV_ERROR_MSG        0x0003 /* error message */
&#35;define SUDO_CONV_INFO_MSG         0x0004 /* informational message */
&#35;define SUDO_CONV_PROMPT_MASK      0x0005 /* mask user input */
&#35;define SUDO_CONV_PROMPT_ECHO_OK   0x1000 /* flag: allow echo if no tty */
&#35;define SUDO_CONV_PREFER_TTY       0x2000 /* flag: use tty if possible */
    int msg_type;
    int timeout;
    const char *msg;
};
<p>#define SUDO_CONV_REPL_MAX      1023</p>
<p>struct sudo_conv_reply {
char *reply;
};</p>
<p>typedef int (*sudo_conv_callback_fn_t)(int signo, void *closure);
struct sudo_conv_callback {
unsigned int version;
void *closure;
sudo_conv_callback_fn_t on_suspend;
sudo_conv_callback_fn_t on_resume;
};</pre></p>
</div>
<p class="Pp" id="conversation~12">Pointers to the
    <a class="permalink" href="#conversation~12"><code class="Fn">conversation</code></a>()
    and <code class="Fn">printf</code>()-style functions are passed in to the
    plugin's <code class="Fn">open</code>() function when the plugin is
    initialized. The following type definitions can be used in the declaration
    of the <code class="Fn">open</code>() function:</p>
<div class="Bd Pp Li">
<pre>typedef int (*sudo_conv_t)(int num_msgs,
    const struct sudo_conv_message msgs[],
    struct sudo_conv_reply replies[], struct sudo_conv_callback *callback);
<p>typedef int (*sudo_printf_t)(int msg_type, const char * restrict fmt, &hellip;);</pre></p>
</div>
<p class="Pp" id="conversation~13">To use the
    <a class="permalink" href="#conversation~13"><code class="Fn">conversation</code></a>()
    function, the plugin must pass an array of <var class="Vt">struct
    sudo_conv_message</var> and <var class="Vt">struct sudo_conv_reply</var>.
    There must be a <var class="Vt">struct sudo_conv_message</var> and
    <var class="Vt">struct sudo_conv_reply</var> for each message in the
    conversation, that is, both arrays must have the same number of elements.
    Each <var class="Vt">struct sudo_conv_reply</var> must have its
    <var class="Fa">reply</var> member initialized to
    <code class="Dv">NULL</code>. The <var class="Vt">struct
    sudo_conv_callback</var> pointer, if not <code class="Dv">NULL</code>,
    should contain function pointers to be called when the
    <code class="Nm">sudo</code> process is suspended and/or resumed during
    conversation input. The <var class="Fa">on_suspend</var> and
    <var class="Fa">on_resume</var> functions are called with the signal that
    caused <code class="Nm">sudo</code> to be suspended and the
    <var class="Fa">closure</var> pointer from the <var class="Vt">struct
    sudo_conv_callback</var>. These functions should return 0 on success and -1
    on error. On error, the conversation will end and the conversation function
    will return a value of -1. The intended use is to allow the plugin to
    release resources, such as locks, that should not be held indefinitely while
    suspended and then reacquire them when the process is resumed. The functions
    are not actually invoked from within a signal handler.</p>
<p class="Pp">The <var class="Fa">msg_type</var> must be set to one of the
    following values:</p>
<dl class="Bl-tag">
  <dt id="SUDO_CONV_PROMPT_ECHO_OFF"><a class="permalink" href="#SUDO_CONV_PROMPT_ECHO_OFF"><code class="Dv">SUDO_CONV_PROMPT_ECHO_OFF</code></a></dt>
  <dd>Prompt the user for input with echo disabled; this is generally used for
      passwords. The reply will be stored in the <var class="Fa">replies</var>
      array, and it will never be <code class="Dv">NULL</code>.</dd>
  <dt id="SUDO_CONV_PROMPT_ECHO_ON"><a class="permalink" href="#SUDO_CONV_PROMPT_ECHO_ON"><code class="Dv">SUDO_CONV_PROMPT_ECHO_ON</code></a></dt>
  <dd>Prompt the user for input with echo enabled. The reply will be stored in
      the <var class="Fa">replies</var> array, and it will never be
      <code class="Dv">NULL</code>.</dd>
  <dt id="SUDO_CONV_ERROR_MSG"><a class="permalink" href="#SUDO_CONV_ERROR_MSG"><code class="Dv">SUDO_CONV_ERROR_MSG</code></a></dt>
  <dd>Display an error message. The message is written to the standard error
      unless the <code class="Dv">SUDO_CONV_PREFER_TTY</code> flag is set, in
      which case it is written to the user's terminal if possible.</dd>
  <dt id="SUDO_CONV_INFO_MSG"><a class="permalink" href="#SUDO_CONV_INFO_MSG"><code class="Dv">SUDO_CONV_INFO_MSG</code></a></dt>
  <dd>Display a message. The message is written to the standard output unless
      the <code class="Dv">SUDO_CONV_PREFER_TTY</code> flag is set, in which
      case it is written to the user's terminal if possible.</dd>
  <dt id="SUDO_CONV_PROMPT_MASK"><a class="permalink" href="#SUDO_CONV_PROMPT_MASK"><code class="Dv">SUDO_CONV_PROMPT_MASK</code></a></dt>
  <dd>Prompt the user for input but echo an asterisk character for each
      character read. The reply will be stored in the
      <var class="Fa">replies</var> array, and it will never be
      <code class="Dv">NULL</code>. This can be used to provide visual feedback
      to the user while reading sensitive information that should not be
      displayed.</dd>
</dl>
<p class="Pp">In addition to the above values, the following flag bits may also
    be set:</p>
<dl class="Bl-tag">
  <dt id="SUDO_CONV_PROMPT_ECHO_OK"><a class="permalink" href="#SUDO_CONV_PROMPT_ECHO_OK"><code class="Dv">SUDO_CONV_PROMPT_ECHO_OK</code></a></dt>
  <dd>Allow input to be read when echo cannot be disabled when the message type
      is <code class="Dv">SUDO_CONV_PROMPT_ECHO_OFF</code> or
      <code class="Dv">SUDO_CONV_PROMPT_MASK</code>. By default,
      <code class="Nm">sudo</code> will refuse to read input if the echo cannot
      be disabled for those message types.</dd>
  <dt id="SUDO_CONV_PREFER_TTY"><a class="permalink" href="#SUDO_CONV_PREFER_TTY"><code class="Dv">SUDO_CONV_PREFER_TTY</code></a></dt>
  <dd>When displaying a message via <code class="Dv">SUDO_CONV_ERROR_MSG</code>
      or <code class="Dv">SUDO_CONV_INFO_MSG</code>, try to write the message to
      the user's terminal. If the terminal is unavailable, the standard error or
      standard output will be used, depending upon whether
      <code class="Dv">SUDO_CONV_ERROR_MSG</code> or
      <code class="Dv">SUDO_CONV_INFO_MSG</code> was used. The user's terminal
      is always used when possible for input, this flag is only used for
    output.</dd>
</dl>
<p class="Pp">The <var class="Fa">timeout</var> in seconds until the prompt will
    wait for no more input. A zero value implies an infinite timeout.</p>
<p class="Pp">The plugin is responsible for freeing the reply buffer located in
    each <var class="Vt">struct sudo_conv_reply</var>, if it is not
    <code class="Dv">NULL</code>. <code class="Dv">SUDO_CONV_REPL_MAX</code>
    represents the maximum length of the reply buffer (not including the
    trailing NUL character). In practical terms, this is the longest password
    <code class="Nm">sudo</code> will support.</p>
<p class="Pp" id="printf~2">The
    <a class="permalink" href="#printf~2"><code class="Fn">printf</code></a>()-style
    function uses the same underlying mechanism as the
    <code class="Fn">conversation</code>() function but only supports
    <code class="Dv">SUDO_CONV_INFO_MSG</code> and
    <code class="Dv">SUDO_CONV_ERROR_MSG</code> for the
    <var class="Fa">msg_type</var> parameter. It can be more convenient than
    using the <code class="Fn">conversation</code>() function if no user reply
    is needed and supports standard <code class="Fn">printf</code>() escape
    sequences.</p>
<p class="Pp" id="conversation~14">See the sample plugin for an example of the
    <a class="permalink" href="#conversation~14"><code class="Fn">conversation</code></a>()
    function usage.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Plugin_invocation_order"><a class="permalink" href="#Plugin_invocation_order">Plugin
  invocation order</a></h3>
<p class="Pp">As of <code class="Nm">sudo</code> 1.9.0, the plugin
    <code class="Fn">open</code>() and <code class="Fn">close</code>() functions
    are called in the following order:</p>
<ol class="Bl-enum">
  <li>audit open</li>
  <li>policy open</li>
  <li>approval open</li>
  <li>approval close</li>
  <li>I/O log open</li>
  <li>command runs</li>
  <li>command exits</li>
  <li>I/O log close</li>
  <li>policy close</li>
  <li>audit close</li>
  <li>sudo exits</li>
</ol>
<p class="Pp" id="close~7">Prior to <code class="Nm">sudo</code> 1.9.0, the I/O
    log <a class="permalink" href="#close~7"><code class="Fn">close</code></a>()
    function was called
    <a class="permalink" href="#after"><i class="Em" id="after">after</i></a>
    the policy <code class="Fn">close</code>() function.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Sudoers_group_plugin_API"><a class="permalink" href="#Sudoers_group_plugin_API">Sudoers
  group plugin API</a></h3>
<p class="Pp">The <code class="Nm">sudoers</code> plugin supports its own plugin
    interface to allow non-Unix group lookups. This can be used to query a group
    source other than the standard Unix group database. Two sample group plugins
    are bundled with <code class="Nm">sudo</code>,
    <a class="permalink" href="#group_file"><i class="Em" id="group_file">group_file</i></a>,
    and
    <a class="permalink" href="#system_group"><i class="Em" id="system_group">system_group</i></a>,
    are detailed in <a class="Xr" aria-label="sudoers, section
    5">sudoers(5)</a>. Third party group plugins include a QAS AD plugin
    available from Quest Software.</p>
<p class="Pp">A group plugin must declare and populate a <var class="Vt">struct
    sudoers_group_plugin</var> in the global scope. This structure contains
    pointers to the functions that implement plugin initialization, cleanup, and
    group lookup.</p>
<div class="Bd Pp Li">
<pre>struct sudoers_group_plugin {
    unsigned int version;
    int (*init)(int version, sudo_printf_t sudo_plugin_printf,
        char *const argv[]);
    void (*cleanup)(void);
    int (*query)(const char *user, const char *group,
        const struct passwd *pwd);
};</pre>
</div>
<p class="Pp">A <var class="Vt">struct sudoers_group_plugin</var> has the
    following fields:</p>
<dl class="Bl-tag">
  <dt><var class="Fa">version</var></dt>
  <dd>The <var class="Fa">version</var> field should be set to
      GROUP_API_VERSION.
    <p class="Pp">This allows <code class="Nm">sudoers</code> to determine the
        API version the group plugin was built against.</p>
  </dd>
  <dt><var class="Fa">init</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*init)(int version, sudo_printf_t sudo_plugin_printf,
    char *const argv[]);</pre>
    </div>
    <p class="Pp" id="init">The
        <a class="permalink" href="#init"><code class="Fn">init</code></a>()
        function is called after <i class="Em">sudoers</i> has been parsed but
        before any policy checks. It returns 1 on success, 0 on failure (or if
        the plugin is not configured), and -1 if a error occurred. If an error
        occurs, the plugin may call the
        <a class="permalink" href="#plugin_printf"><code class="Fn" id="plugin_printf">plugin_printf</code></a>()
        function with <code class="Dv">SUDO_CONF_ERROR_MSG</code> to present
        additional error information to the user.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">version</var></dt>
      <dd>The version passed in by <code class="Nm">sudoers</code> allows the
          plugin to determine the major and minor version number of the group
          plugin API supported by <code class="Nm">sudoers</code>.</dd>
      <dt id="printf~3"><var class="Fa">plugin_printf</var></dt>
      <dd>A pointer to a
          <a class="permalink" href="#printf~3"><code class="Fn">printf</code></a>()-style
          function that may be used to display informational or error message to
          the user. Returns the number of characters printed on success and -1
          on failure.</dd>
      <dt id="group_plugin"><var class="Fa">argv</var></dt>
      <dd>A <code class="Dv">NULL</code>-terminated array of arguments generated
          from the
          <a class="permalink" href="#group_plugin"><i class="Em">group_plugin</i></a>
          option in <i class="Em">sudoers</i>. If no arguments were given,
          <var class="Fa">argv</var> will be <code class="Dv">NULL</code>.</dd>
    </dl>
  </dd>
  <dt><var class="Fa">cleanup</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>void (*cleanup)();</pre>
    </div>
    <p class="Pp" id="cleanup">The
        <a class="permalink" href="#cleanup"><code class="Fn">cleanup</code></a>()
        function is called when <code class="Nm">sudoers</code> has finished its
        group checks. The plugin should free any memory it has allocated and
        close open file handles.</p>
  </dd>
  <dt><var class="Fa">query</var></dt>
  <dd>
    <div class="Bd Li">
    <pre>int (*query)(const char *user, const char *group,
    const struct passwd *pwd);</pre>
    </div>
    <p class="Pp" id="query">The
        <a class="permalink" href="#query"><code class="Fn">query</code></a>()
        function is used to ask the group plugin whether
        <var class="Fa">user</var> is a member of
      <var class="Fa">group</var>.</p>
    <p class="Pp">The function arguments are as follows:</p>
    <dl class="Bl-tag">
      <dt><var class="Fa">user</var></dt>
      <dd>The name of the user being looked up in the external group
        database.</dd>
      <dt><var class="Fa">group</var></dt>
      <dd>The name of the group being queried.</dd>
      <dt><var class="Fa">pwd</var></dt>
      <dd>The password database entry for <var class="Fa">user</var>, if any. If
          <var class="Fa">user</var> is not present in the password database,
          <var class="Fa">pwd</var> will be <code class="Dv">NULL</code>.</dd>
    </dl>
  </dd>
</dl>
<p class="Pp" id="Group"><a class="permalink" href="#Group"><i class="Em">Group
    API Version Macros</i></a></p>
<div class="Bd Pp Li">
<pre>/* Sudoers group plugin version major/minor */
&#35;define GROUP_API_VERSION_MAJOR 1
&#35;define GROUP_API_VERSION_MINOR 0
&#35;define GROUP_API_VERSION ((GROUP_API_VERSION_MAJOR &lt;&lt; 16) | \
                           GROUP_API_VERSION_MINOR)</pre>
</div>
For getters and setters see the <a class="Sx" href="#Policy_plugin_API">Policy
  plugin API</a>.
</section>
</section>
<section class="Sh">
<h2 class="Sh" id="PLUGIN_API_CHANGELOG"><a class="permalink" href="#PLUGIN_API_CHANGELOG">PLUGIN
  API CHANGELOG</a></h2>
<p class="Pp">The following revisions have been made to the Sudo Plugin API.</p>
<dl class="Bl-tag">
  <dt>Version 1.0</dt>
  <dd>Initial API version.</dd>
  <dt id="open~10">Version 1.1 (sudo 1.8.0)</dt>
  <dd>The I/O logging plugin's
      <a class="permalink" href="#open~10"><code class="Fn">open</code></a>()
      function was modified to take the <var class="Fa">command_info</var> list
      as an argument.</dd>
  <dt>Version 1.2 (sudo 1.8.5)</dt>
  <dd>The Policy and I/O logging plugins' <code class="Fn">open</code>()
      functions are now passed a list of plugin parameters if any are specified
      in <a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a>.
    <p class="Pp">A simple hooks API has been introduced to allow plugins to
        hook in to the system's environment handling functions.</p>
    <p class="Pp" id="init_session~3">The
        <a class="permalink" href="#init_session~3"><code class="Fn">init_session</code></a>()
        Policy plugin function is now passed a pointer to the user environment
        which can be updated as needed. This can be used to merge in environment
        variables stored in the PAM handle before a command is run.</p>
  </dd>
  <dt>Version 1.3 (sudo 1.8.7)</dt>
  <dd>Support for the <i class="Em">exec_background</i> entry has been added to
      the <var class="Fa">command_info</var> list.
    <p class="Pp" id="max_groups">The
        <a class="permalink" href="#max_groups"><i class="Em">max_groups</i></a>
        and
        <a class="permalink" href="#plugin_dir"><i class="Em" id="plugin_dir">plugin_dir</i></a>
        entries were added to the <var class="Fa">settings</var> list.</p>
    <p class="Pp" id="version">The
        <a class="permalink" href="#version"><code class="Fn">version</code></a>()
        and <code class="Fn">close</code>() functions are now optional.
        Previously, a missing <code class="Fn">version</code>() or
        <code class="Fn">close</code>() function would result in a crash. If no
        policy plugin <code class="Fn">close</code>() function is defined, a
        default <code class="Fn">close</code>() function will be provided by the
        <code class="Nm">sudo</code> front-end that displays a warning if the
        command could not be executed.</p>
    <p class="Pp">The <code class="Nm">sudo</code> front-end now installs
        default signal handlers to trap common signals while the plugin
        functions are run.</p>
  </dd>
  <dt id="remote_host">Version 1.4 (sudo 1.8.8)</dt>
  <dd>The
      <a class="permalink" href="#remote_host"><i class="Em">remote_host</i></a>
      entry was added to the <var class="Fa">settings</var> list.</dd>
  <dt id="preserve_fds">Version 1.5 (sudo 1.8.9)</dt>
  <dd>The
      <a class="permalink" href="#preserve_fds"><i class="Em">preserve_fds</i></a>
      entry was added to the <var class="Fa">command_info</var> list.</dd>
  <dt id="log_ttyin~4">Version 1.6 (sudo 1.8.11)</dt>
  <dd>The behavior when an I/O logging plugin returns an error (-1) has changed.
      Previously, the <code class="Nm">sudo</code> front-end took no action when
      the
      <a class="permalink" href="#log_ttyin~4"><code class="Fn">log_ttyin</code></a>(),
      <code class="Fn">log_ttyout</code>(), <code class="Fn">log_stdin</code>(),
      <code class="Fn">log_stdout</code>(), or
      <code class="Fn">log_stderr</code>() function returned an error.
    <p class="Pp">The behavior when an I/O logging plugin returns 0 has changed.
        Previously, output from the command would be displayed to the terminal
        even if an output logging function returned 0.</p>
  </dd>
  <dt id="plugin_path">Version 1.7 (sudo 1.8.12)</dt>
  <dd>The
      <a class="permalink" href="#plugin_path"><i class="Em">plugin_path</i></a>
      entry was added to the <var class="Fa">settings</var> list.
    <p class="Pp">The <i class="Em">debug_flags</i> entry now starts with a
        debug file path name and may occur multiple times if there are multiple
        plugin-specific Debug lines in the <a class="Xr" aria-label="sudo.conf,
        section 5">sudo.conf(5)</a> file.</p>
  </dd>
  <dt>Version 1.8 (sudo 1.8.15)</dt>
  <dd>The <i class="Em">sudoedit_checkdir</i> and
      <i class="Em">sudoedit_follow</i> entries were added to the
      <var class="Fa">command_info</var> list. The default value of
      <i class="Em">sudoedit_checkdir</i> was changed to true in sudo 1.8.16.
    <p class="Pp" id="conversation~15">The sudo
        <a class="permalink" href="#conversation~15"><code class="Fn">conversation</code></a>()
        function now takes a pointer to a <var class="Vt">struct
        sudo_conv_callback</var> as its fourth argument. The
        <var class="Vt">sudo_conv_t</var> definition has been updated to match.
        The plugin must specify that it supports plugin API version 1.8 or
        higher to receive a conversation function pointer that supports this
        argument.</p>
  </dd>
  <dt id="execfd">Version 1.9 (sudo 1.8.16)</dt>
  <dd>The <a class="permalink" href="#execfd"><i class="Em">execfd</i></a> entry
      was added to the <var class="Fa">command_info</var> list.</dd>
  <dt id="iolog_group">Version 1.10 (sudo 1.8.19)</dt>
  <dd>The <i class="Em">umask</i> entry was added to the
      <var class="Fa">user_info</var> list. The
      <a class="permalink" href="#iolog_group"><i class="Em">iolog_group</i></a>,
      <a class="permalink" href="#iolog_mode"><i class="Em" id="iolog_mode">iolog_mode</i></a>,
      and
      <a class="permalink" href="#iolog_user"><i class="Em" id="iolog_user">iolog_user</i></a>
      entries were added to the <var class="Fa">command_info</var> list.</dd>
  <dt>Version 1.11 (sudo 1.8.20)</dt>
  <dd>The <i class="Em">timeout</i> entry was added to the
      <var class="Fa">settings</var> list.</dd>
  <dt>Version 1.12 (sudo 1.8.21)</dt>
  <dd>The <code class="Fn">change_winsize</code>() function was added to
      <var class="Vt">struct io_plugin</var>.</dd>
  <dt>Version 1.13 (sudo 1.8.26)</dt>
  <dd>The <code class="Fn">log_suspend</code>() function was added to
      <var class="Vt">struct io_plugin</var>.</dd>
  <dt>Version 1.14 (sudo 1.8.29)</dt>
  <dd>The <i class="Em">umask_override</i> entry was added to the
      <var class="Fa">command_info</var> list.</dd>
  <dt>Version 1.15 (sudo 1.9.0)</dt>
  <dd>The <i class="Em">cwd_optional</i> entry was added to the
      <var class="Fa">command_info</var> list.
    <p class="Pp" id="event_alloc~8">The
        <a class="permalink" href="#event_alloc~8"><code class="Fn">event_alloc</code></a>()
        function was added to <var class="Vt">struct policy_plugin</var> and
        <var class="Vt">struct io_plugin</var>.</p>
    <p class="Pp">The <var class="Fa">errstr</var> argument was added to the
        policy and I/O plugin functions which the plugin function can use to
        return an error string. This string may be used by the audit plugin to
        report failure or error conditions set by the other plugins.</p>
    <p class="Pp" id="close~8">The
        <a class="permalink" href="#close~8"><code class="Fn">close</code></a>()
        function is now is called regardless of whether or not a command was
        actually executed. This makes it possible for plugins to perform cleanup
        even when a command was not run.</p>
    <p class="Pp"><code class="Dv">SUDO_CONV_REPL_MAX</code> has increased from
        255 to 1023 bytes.</p>
    <p class="Pp">Support for audit and approval plugins was added.</p>
  </dd>
  <dt>Version 1.16 (sudo 1.9.3)</dt>
  <dd>Initial resource limit values were added to the
      <var class="Fa">user_info</var> list.
    <p class="Pp" id="cmnd_chroot">The
        <a class="permalink" href="#cmnd_chroot"><i class="Em">cmnd_chroot</i></a>
        and
        <a class="permalink" href="#cmnd_cwd"><i class="Em" id="cmnd_cwd">cmnd_cwd</i></a>
        entries were added to the <var class="Fa">settings</var> list.</p>
  </dd>
  <dt id="event_alloc~9">Version 1.17 (sudo 1.9.4)</dt>
  <dd>The
      <a class="permalink" href="#event_alloc~9"><code class="Fn">event_alloc</code></a>()
      function was added to <var class="Vt">struct audit_plugin</var> and
      <var class="Vt">struct approval_plugin</var>.</dd>
  <dt>Version 1.18 (sudo 1.9.9)</dt>
  <dd>The policy may now set resource limit values in the
      <var class="Fa">command_info</var> list. The <i class="Em">intercept</i>
      and <i class="Em">log_subcmds</i> entries were added to the
      <var class="Fa">command_info</var> list.</dd>
  <dt id="intercept_ptrace">Version 1.19 (sudo 1.9.11)</dt>
  <dd>The
      <a class="permalink" href="#intercept_ptrace"><i class="Em">intercept_ptrace</i></a>
      and
      <a class="permalink" href="#intercept_setid"><i class="Em" id="intercept_setid">intercept_setid</i></a>
      entries were added to the <var class="Fa">settings</var> list. The
      <a class="permalink" href="#apparmor_profile"><i class="Em" id="apparmor_profile">apparmor_profile</i></a>
      and <i class="Em">use_ptrace</i> entries were added to the
      <var class="Fa">command_info</var> list.</dd>
  <dt id="update_ticket">Version 1.20 (sudo 1.9.12)</dt>
  <dd>The
      <a class="permalink" href="#update_ticket"><i class="Em">update_ticket</i></a>
      entry was added to the <var class="Fa">settings</var> list. The
      <a class="permalink" href="#intercept_verify"><i class="Em" id="intercept_verify">intercept_verify</i></a>
      entry was added to the <var class="Fa">command_info</var> list.</dd>
  <dt>Version 1.21 (sudo 1.9.13)</dt>
  <dd>The <i class="Em">sudoedit_nfiles</i> entry was added to the
      <var class="Fa">command_info</var> list.</dd>
  <dt id="ttydev">Version 1.22 (sudo 1.9.16)</dt>
  <dd>The <a class="permalink" href="#ttydev"><i class="Em">ttydev</i></a> entry
      was added to the <var class="Fa">user_info</var> list.</dd>
</dl>
</section>
<section class="Sh">
<h2 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h2>
<p class="Pp"><a class="Xr" aria-label="sudo.conf, section 5">sudo.conf(5)</a>,
    <a class="Xr" aria-label="sudoers, section 5">sudoers(5)</a>,
    <a class="Xr" aria-label="sudo, section 8">sudo(8)</a></p>
</section>
<section class="Sh">
<h2 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h2>
<p class="Pp">Many people have worked on <code class="Nm">sudo</code> over the
    years; this version consists of code written primarily by:</p>
<div class="Bd Pp Bd-indent"><span class="An">Todd C. Miller</span></div>
<p class="Pp">See the CONTRIBUTORS.md file in the <code class="Nm">sudo</code>
    distribution (<a href="https://www.sudo.ws/about/contributors/">https://www.sudo.ws/about/contributors/</a>) for an exhaustive
    list of people who have contributed to <code class="Nm">sudo</code>.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h2>
<p class="Pp">If you believe you have found a bug in
    <code class="Nm">sudo_plugin</code>, you can either file a bug report in the
    sudo bug database, <a href="https://bugzilla.sudo.ws/">https://bugzilla.sudo.ws/</a>, or open an issue at
    <a href="https://github.com/sudo-project/sudo/issues.">https://github.com/sudo-project/sudo/issues.</a> If you would prefer to use
    email, messages may be sent to the sudo-workers mailing list,
    <a href="https://www.sudo.ws/mailman/listinfo/sudo-workers">https://www.sudo.ws/mailman/listinfo/sudo-workers</a> (public) or
    &lt;sudo@sudo.ws&gt; (private).</p>
<p class="Pp">Please do not report security vulnerabilities through public
    GitHub issues, Bugzilla or mailing lists. Instead, report them via email to
    &lt;Todd.Miller@sudo.ws&gt;. You may encrypt your message with PGP if you
    would like, using the key found at <a href="https://www.sudo.ws/dist/PGPKEYS.">https://www.sudo.ws/dist/PGPKEYS.</a></p>
</section>
<section class="Sh">
<h2 class="Sh" id="SUPPORT"><a class="permalink" href="#SUPPORT">SUPPORT</a></h2>
<p class="Pp">Limited free support is available via the sudo-users mailing list,
    see <a href="https://www.sudo.ws/mailman/listinfo/sudo-users">https://www.sudo.ws/mailman/listinfo/sudo-users</a> to subscribe or search
    the archives.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="DISCLAIMER"><a class="permalink" href="#DISCLAIMER">DISCLAIMER</a></h2>
<p class="Pp"><code class="Nm">sudo</code> is provided &#x201C;AS IS&#x201D; and
    any express or implied warranties, including, but not limited to, the
    implied warranties of merchantability and fitness for a particular purpose
    are disclaimed. See the LICENSE.md file distributed with
    <code class="Nm">sudo</code> or <a href="https://www.sudo.ws/about/license/">https://www.sudo.ws/about/license/</a> for
    complete details.</p>
</section>
</main>
</div>


  </article>



          <div class="gdoc-page__footer flex flex-wrap justify-between">
            








  
  

  







          </div>
        </div>
      </main>

      

    </div>

    
  <script defer src="/js/search-835dce8f.bundle.min.js"></script>

  </body>
</html>
